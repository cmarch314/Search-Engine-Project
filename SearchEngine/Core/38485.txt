{"text": "OEChem C Theory Manual Version 1 3 1 Previous 17 Pattern Matching Up 17 Pattern Matching Next 17 2 Maximum Common Substructure 17 1 Substructure Search Substructure searches can be done in OEChem using the OESubsearch class The OESubSearch class can be initialized with a SMARTS pattern a query molecule OEQMolBase or a molecule and expression options The following example demonstrates how to initialize a OESubSearch instance with a SMARTS pattern and perform a substructure search include oechem h include iostream using namespace std using namespace OEChem int main OEGraphMol mol OEParseSmiles mol Cc1ccccc1 OESubSearch ss c1ccccc1 if ss SingleMatch mol cout benzene matches toluene endl else cout benzene does not match toluene endl return Download as text In the example program the query pattern is benzene and the molecule in which the substructure is being searched for is toluene Since benzene is a substructure of toluene the program will identify the substructure and report the substructure as found The OESubSearch class is not only able to identify the presence or absence of a substructure but also the node and edge correspondences of the pattern and target The following example extends the simple match example to write out all atom correspondences between benzene and toluene include oechem h include iostream using namespace std using namespace OEChem using namespace OESystem int main OEGraphMol mol OEParseSmiles mol c1ccccc1C OESubSearch ss c1ccccc1 unsigned int count OEIter OEMatchBase match for count 1 match ss Match mol match match count OEIter OEMatchPair OEAtomBase apr cout Match count endl cout pattern atoms for apr match GetAtoms apr apr cout apr pattern GetIdx cout endl cout target atoms for apr match GetAtoms apr apr cout apr target GetIdx cout endl return Download as text The OESubSearch Match method returns an iterator over all subgraphs Each of the subgraphs can be queried for their node and edge correspondences In this particular example the benzene substructure is identified twelve times in toluene Each of the matches differ in their node and edge correspondences to the substructure OEChem C Theory Manual Version 1 3 1 Previous 17 Pattern Matching Up 17 Pattern Matching Next 17 2 Maximum Common Substructure Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/cplusprog/node153.html", "title": "17.1 substructure search", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>17.1 Substructure Search</title>\n<META NAME=\"description\" CONTENT=\"17.1 Substructure Search\">\n<META NAME=\"keywords\" CONTENT=\"cplusprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"cplusprog.css\">\n<link rel=\"first\" href=\"cplusprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"next\" HREF=\"node154.html\">\n<LINK REL=\"previous\" HREF=\"node152.html\">\n<LINK REL=\"up\" HREF=\"node152.html\">\n<LINK REL=\"next\" HREF=\"node154.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node152.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node152.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node154.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node152.html\">17. Pattern Matching</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node152.html\">17. Pattern Matching</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node154.html\">17.2 Maximum Common Substructure</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION0020100000000000000000\">\n17.1 Substructure Search</A>\n</H1>\n\n<P>\nSubstructure searches can be done in OEChem using the\n<code>OESubsearch</code> class.  The <code>OESubSearch</code> class can be\ninitialized with a SMARTS pattern, a query molecule <code>OEQMolBase</code>,\nor a molecule and expression options.  The following example\ndemonstrates how to initialize a <code>OESubSearch</code> instance with a\nSMARTS pattern, and perform a substructure search.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#include \"oechem.h\"\n#include &lt;iostream&gt;\n\nusing namespace std;\nusing namespace OEChem;\n\nint main()\n{\n  OEGraphMol mol;\n\n  OEParseSmiles(mol, \"Cc1ccccc1\");\n  OESubSearch ss(\"c1ccccc1\");\n\n  if (ss.SingleMatch(mol))\n  {\n    cout &lt;&#60; \"benzene matches toluene\" &lt;&#60; endl;\n  }\n  else\n  {\n    cout &lt;&#60; \"benzene does not match toluene\" &lt;&#60; endl;\n  }\n\n  return 0;\n}\n</pre>\n<div class=\"verbatiminput-footer\">\n<a href=\"ch17-1.txt\" type=\"text/plain\">Download as text.</a>\n</div>\n</dd></dl>\n\n<P>\nIn the example program, the query pattern is benzene and the molecule\nin which the substructure is being searched for is toluene.  Since\nbenzene is a substructure of toluene the program will identify the\nsubstructure, and report the substructure as found.\n\n<P>\nThe <code>OESubSearch</code> class is not only able to identify the presence\nor absence of a substructure, but also the node and edge\ncorrespondences of the pattern and target.  The following example\nextends the simple match example to write out all atom correspondences\nbetween benzene and toluene.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#include \"oechem.h\"\n#include &lt;iostream&gt;\n\nusing namespace std;\nusing namespace OEChem;\nusing namespace OESystem;\n\nint main()\n{\n  OEGraphMol mol;\n\n  OEParseSmiles(mol, \"c1ccccc1C\");\n  OESubSearch ss(\"c1ccccc1\");\n\n  unsigned int count;\n  OEIter&lt;OEMatchBase&gt; match;\n  for (count=1,match = ss.Match(mol);match;++match,count++)\n  {\n    OEIter&lt;OEMatchPair&lt;OEAtomBase&gt; &gt; apr;\n\n    cout &lt;&#60; \"Match \" &lt;&#60; count &lt;&#60; ':' &lt;&#60; endl;\n    cout &lt;&#60; \"pattern atoms: \";\n    for (apr = match-&gt;GetAtoms();apr;++apr)\n      cout &lt;&#60; apr-&gt;pattern-&gt;GetIdx() &lt;&#60; ' ';\n    cout &lt;&#60; endl;\n\n    cout &lt;&#60; \"target atoms:  \";\n    for (apr = match-&gt;GetAtoms();apr;++apr)\n      cout &lt;&#60; apr-&gt;target-&gt;GetIdx() &lt;&#60; ' ';\n    cout &lt;&#60; endl;\n  }\n\n  return 0;\n}\n</pre>\n<div class=\"verbatiminput-footer\">\n<a href=\"ch17-2.txt\" type=\"text/plain\">Download as text.</a>\n</div>\n</dd></dl>\n\n<P>\nThe <code>OESubSearch::Match</code> method returns an iterator over all\nsubgraphs.  Each of the subgraphs can be queried for their node and\nedge correspondences.  In this particular example, the benzene\nsubstructure is identified twelve times in toluene.  Each of the\nmatches differ in their node and edge correspondences to the\nsubstructure..\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node152.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node152.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node154.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node152.html\">17. Pattern Matching</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node152.html\">17. Pattern Matching</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node154.html\">17.2 Maximum Common Substructure</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 38485.0}