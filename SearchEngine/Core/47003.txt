{"text": "Search LoginPreferencesHelp GuideAbout Trac WikiTimelineRoadmapBrowse SourceView TicketsSearch Context Navigation Previous ChangeNext Change Changeset 746 for nomatic trunk buddy bots src jabber bot nomatic jabber bot py View differences inlineside by side Show lines around each change Show the changes in full context Ignore Blank lines Case changes White space changes Timestamp Feb 18 2 8 6 44 21 PM 7 years ago Author cbakerMessage jabber bot works writes google talk signon signoff events to the database File 1 edited nomatic trunk buddy bots src jabber bot nomatic jabber bot py modified 5 diffs Legend UnmodifiedAddedRemoved nomatic trunk buddy bots src jabber bot nomatic jabber bot py r745 r746 1 Copyright c 2 1 2 6 Twisted Matrix Laboratories 2 See LICENSE for details 1 2Requires MySQLdb and openSSL libraries to be installed 3Twisted is included 4 35 46import sys 7from xml dom import minidom 8from xml parsers expat import ExpatError 9 1 import MySQLdb 11 512from twisted internet import reactor 613from twisted names srvconnect import SRVConnector 714from twisted words xish import domish 815from twisted words protocols jabber import xmlstream client jid 16 17WATCH LIST FILE LOCATION watch list txt 18 19class SQL Connection 2 21 def init self username password database 22 self db MySQLdb connect user username passwd password db database 23 self cursor self db cursor 24 25 def add user self username 26 Add a user to the users table if they don t already exist 27 28 sql select id from users where 29 screenname s username 3 31 self cursor execute sql 32 results self cursor fetchall 33 print looking for s found username results 34 35 if results is 36 this user isn t already in the database 37 sql insert into users screenname values 38 s username 39 self cursor execute sql 4 self db commit 41 42 def log event self screenname signon 43 44 make sure the signon parameter is a boolean 45 true is signon false is signff 46 if not type signon is type True 47 raise Exception signon parameter is expected to be a boolean 48 49 sql INSERT INTO connection history user id signon 5 VALUES SELECT id FROM users WHERE screenname s 51 s screenname signon 52 53 try 54 self cursor execute sql 55 self db commit 56 except MySQLdb OperationalError 57 tried to log a buddy that does not exist in the users table 58 pass 959 1 6 3686 3787 38 def rawDataIn self buf 39 print RECV s unicode buf utf 8 encode ascii replace 88 def rawDataIn self buf 89 input unicode buf utf 8 encode ascii replace 9 print RECV s input 91 self parse presence input 92 93 94 def rawDataOut self buf 95 print SEND s unicode buf utf 8 encode ascii replace 96 pass 97 98 def load watch list self 99 file open WATCH LIST FILE LOCATION 1 1 1 for line in file 1 2 if line is not None and line is not 1 3 if line not in self watch list 1 4 username line lower 1 5 self watch list append username 1 6 self sql conn add user username 1 7 1 8 print watch list loaded self watch list 4 1 9 4111 42 def rawDataOut self buf 43 print SEND s unicode buf utf 8 encode ascii replace 111 def parse presence self input 112 try 113 dom minidom parseString input 114 try 115 presence element dom getElementsByTagName presence 116 email attribute presence element getAttribute from 117 for watched person in self watch list 118 if email attribute lower startswith watched person 119 this is a presence string for a person in 12 the watch list 121 122 is this a sign off notification 123 type attribute presence element getAttribute type 124 if type attribute None and type attribute unavailable 125 signon False 126 else 127 signon True 128 129 log this event in the database 13 print event watched person online signon 131 self sql conn log event watched person signon 132 133 except IndexError 134 this was not a presence notification 135 pass 136 except ExpatError 137 trouble parsing 138 pass 139 4414 45141 47143 print Connected 48144 145 establish a mysql connection 146 self sql conn SQL Connection root abc nomatic 147 148 load the users we re supposed to be watching 149 from a file 15 self watch list 151 self load watch list 152 153 handle incoming and outgoing data 49154 self xmlstream xs 5 51 Log all traffic 52 xs rawDataInFn self rawDataIn 53 xs rawDataOutFn self rawDataOut 155 xs rawDataInFn self rawDataIn 156 xs rawDataOutFn self rawDataOut 54157 55158 6717 68171 wait 5 seconds then sign off 69 reactor callLater 5 xs sendFooter 172 reactor callLater 5 xs sendFooter 7 173 71174 7718 78181 79 USERNAME nomaticbot1 gmail com 8 PASSWORD nomaticim321 182if name main 81183 82 client jid jid JID USERNAME 83 secret PASSWORD 84 c Client client jid secret 85 86 reactor run 184 USERNAME nomaticbot1 gmail com 185 PASSWORD nomaticim321 186 187 client jid jid JID USERNAME 188 secret PASSWORD 189 c Client client jid secret 19 191 reactor run Note See TracChangeset for help on using the changeset viewer Download in other formats Unified Diff Zip Archive Powered by Trac 1 1 By Edgewall Software All content copyright 2 7 2 8 by LUCI http luci ics uci edu ", "_id": "http://djp3-pc2.ics.uci.edu/LUCICodeRepository/nomaticIM/changeset/746/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py", "title": "\n      changeset 746 for nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py \u2013 nomatic*im\n    ", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n  \n  \n\n  \n\n\n  <head>\n\t\t<title>\n      Changeset 746 for nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py \u2013 Nomatic*IM\n    </title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><link rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search\" /><link rel=\"help\" href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\" /><link rel=\"alternate\" href=\"?format=diff&amp;new=746\" type=\"text/plain\" class=\"diff\" title=\"Unified Diff\" /><link rel=\"alternate\" href=\"?format=zip&amp;new=746\" type=\"application/zip\" class=\"zip\" title=\"Zip Archive\" /><link rel=\"next\" href=\"/LUCICodeRepository/nomaticIM/changeset/841/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\" title=\"Changeset 841 for nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\" /><link rel=\"start\" href=\"/LUCICodeRepository/nomaticIM/wiki\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/changeset.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/diff.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/code.css\" type=\"text/css\" /><link rel=\"prev\" href=\"/LUCICodeRepository/nomaticIM/changeset/745/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\" title=\"Changeset 745 for nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\" /><link rel=\"shortcut icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link rel=\"icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link type=\"application/opensearchdescription+xml\" rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search/opensearch\" title=\"Search Nomatic*IM\" /><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/jquery.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/babel.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/messages/en_US.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/trac.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/search.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/diff.js\"></script><script type=\"text/javascript\">\n      jQuery(document).ready(function($) {\n        $(\".trac-toggledeleted\").show().click(function() {\n                  $(this).siblings().find(\".trac-deleted\").toggle();\n                  return false;\n        }).click();\n        $(\"#content\").find(\"li.entry h2 a\").parent().addAnchor(_(\"Link to this diff\"));\n      });\n    </script>\n\t</head>\n  <body>\n    <div id=\"banner\">\n      <div id=\"header\">\n        <a id=\"logo\" href=\"http://luci.ics.uci.edu/#code\"><img src=\"http://luci.ics.uci.edu/blog/archives/LUCIhorzTight.jpg\" alt=\"LUCI Code Repository\" /></a>\n      </div>\n      <form id=\"search\" action=\"/LUCICodeRepository/nomaticIM/search\" method=\"get\">\n        <div>\n          <label for=\"proj-search\">Search:</label>\n          <input type=\"text\" id=\"proj-search\" name=\"q\" size=\"18\" value=\"\" />\n          <input type=\"submit\" value=\"Search\" />\n        </div>\n      </form>\n      <div id=\"metanav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/login\">Login</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/prefs\">Preferences</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\">Help/Guide</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/about\">About Trac</a></li>\n    </ul>\n  </div>\n    </div>\n    <div id=\"mainnav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/wiki\">Wiki</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/timeline\">Timeline</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/roadmap\">Roadmap</a></li><li class=\"active\"><a href=\"/LUCICodeRepository/nomaticIM/browser\">Browse Source</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/report\">View Tickets</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/search\">Search</a></li>\n    </ul>\n  </div>\n    <div id=\"main\">\n      <div id=\"ctxtnav\" class=\"nav\">\n        <h2>Context Navigation</h2>\n        <ul>\n          <li class=\"first\"><span>&larr; <a class=\"prev\" href=\"/LUCICodeRepository/nomaticIM/changeset/745/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\" title=\"Changeset 745 for nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\">Previous Change</a></span></li><li class=\"last\"><span><a class=\"next\" href=\"/LUCICodeRepository/nomaticIM/changeset/841/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\" title=\"Changeset 841 for nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\">Next Change</a> &rarr;</span></li>\n        </ul>\n        <hr />\n      </div>\n    <div id=\"content\" class=\"changeset\">\n      <div id=\"title\">\n            <h1>Changeset <a title=\"Show full changeset\" href=\"/LUCICodeRepository/nomaticIM/changeset/746\">746</a>\n              for <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=746\">nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py</a></h1>\n      </div>\n      <form id=\"prefs\" action=\"\">\n        <div>\n          \n  <label for=\"style\">View differences</label>\n  <select id=\"style\" name=\"style\">\n    <option selected=\"selected\" value=\"inline\">inline</option>\n    <option value=\"sidebyside\">side by side</option>\n  </select>\n  <div class=\"field\">\n    <label><input type=\"radio\" name=\"contextall\" value=\"0\" checked=\"checked\" />\n             Show</label>\n      <label><input type=\"text\" name=\"contextlines\" id=\"contextlines\" size=\"2\" maxlength=\"3\" value=\"2\" />\n             lines around each change</label><br />\n    <label><input type=\"radio\" name=\"contextall\" value=\"1\" />\n           Show the changes in full context</label>\n  </div>\n  <fieldset id=\"ignore\">\n    <legend>Ignore:</legend>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignoreblanklines\" name=\"ignoreblanklines\" />\n      <label for=\"ignoreblanklines\">Blank lines</label>\n    </div>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignorecase\" name=\"ignorecase\" />\n      <label for=\"ignorecase\">Case changes</label>\n    </div>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignorewhitespace\" name=\"ignorewhitespace\" />\n      <label for=\"ignorewhitespace\">White space changes</label>\n    </div>\n  </fieldset>\n  <div class=\"buttons\">\n    <input type=\"submit\" name=\"update\" value=\"Update\" />\n  </div>\n\n        </div>\n      </form>\n      <dl id=\"overview\">\n          <dt class=\"property time\">Timestamp:</dt>\n          <dd class=\"time\">\n             Feb 18, 2008, 6:44:21 PM\n             (<a class=\"timeline\" href=\"/LUCICodeRepository/nomaticIM/timeline?from=2008-02-18T18%3A44%3A21-08%3A00&amp;precision=second\" title=\"See timeline at Feb 18, 2008, 6:44:21 PM\">7 years</a> ago)\n          </dd>\n          <dt class=\"property author\">Author:</dt>\n          <dd class=\"author\">cbaker</dd>\n          <dt class=\"property message\">Message:</dt>\n          <dd class=\"message searchable\">\n            \n            \n              <p>\njabber bot works, writes google talk signon/signoff events to the database<br />\n</p>\n\n            \n            \n          </dd>\n        <dt class=\"property files\">\n          File:\n        </dt>\n        <dd class=\"files\">\n          <div class=\"legend\" id=\"file-legend\">\n            <dl>\n              <dt class=\"mod\"></dt><dd>1 edited</dd>\n            </dl>\n          </div>\n          <br />\n          <ul>\n            <li>\n          <div class=\"mod\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=746\">\n              nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\n            </a>\n          <span class=\"comment\">(modified)</span>\n              (<a title=\"Show differences\" href=\"#file0\">5 diffs</a>)\n            </li>\n          </ul>\n        </dd>\n      </dl>\n      <div class=\"diff\">\n        <div class=\"legend\" id=\"diff-legend\">\n          <h3>Legend:</h3>\n          <dl>\n            <dt class=\"unmod\"></dt><dd>Unmodified</dd>\n            <dt class=\"add\"></dt><dd>Added</dd>\n            <dt class=\"rem\"></dt><dd>Removed</dd>\n          </dl>\n        </div>\n        <div class=\"diff\">\n  <ul class=\"entries\">\n      <li class=\"entry\">\n        <h2 id=\"file0\">\n          <a href=\"/LUCICodeRepository/nomaticIM/changeset/746/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\" title=\"Show the changeset 746 restricted to nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\">nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py</a>\n        </h2>\n        <table class=\"trac-diff inline\" summary=\"Differences\" cellspacing=\"0\">\n              <colgroup><col class=\"lineno\" /><col class=\"lineno\" /><col class=\"content\" /></colgroup>\n              <thead>\n                <tr>\n                  <th title=\"Revision 745\">\n                    <a title=\"Show revision 745 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=745#L1\">\n                      r745</a>\n                  </th>\n                  <th title=\"Revision 746\">\n                    <a title=\"Show revision 746 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=746#L1\">\n                      r746</a>\n                  </th>\n                  <td>\u00a0</td>\n                </tr>\n              </thead>\n            <tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>1</th><th>\u00a0</th><td class=\"l\"><span># Copyright (c) 2001-2006 Twisted Matrix Laboratories.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>2</th><th>\u00a0</th><td class=\"l\"><span># See LICENSE for details.</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>1</th><td class=\"r\"><span>\"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>2</th><td class=\"r\"><span>Requires MySQLdb and openSSL libraries to be installed.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>3</th><td class=\"r\"><span>Twisted is included.</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>4</th><td class=\"r\"><span>\"\"\"</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>3</th><th>5</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>4</th><th>6</th><td class=\"l\"><span>import sys</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>7</th><td class=\"r\"><ins>from xml.dom import minidom</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>8</th><td class=\"r\"><ins>from xml.parsers.expat import ExpatError</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>9</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>10</th><td class=\"r\"><ins>import MySQLdb</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>11</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>5</th><th>12</th><td class=\"l\"><span>from twisted.internet import reactor</span>\u00a0</td>\n                  </tr><tr>\n                          <th>6</th><th>13</th><td class=\"l\"><span>from twisted.names.srvconnect import SRVConnector</span>\u00a0</td>\n                  </tr><tr>\n                          <th>7</th><th>14</th><td class=\"l\"><span>from twisted.words.xish import domish</span>\u00a0</td>\n                  </tr><tr>\n                          <th>8</th><th>15</th><td class=\"l\"><span>from twisted.words.protocols.jabber import xmlstream, client, jid</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>16</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>17</th><td class=\"r\"><ins>WATCH_LIST_FILE_LOCATION = 'watch_list.txt'</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>18</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>19</th><td class=\"r\"><ins>class SQL_Connection:</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>20</th><td class=\"r\"><ins>&nbsp; &nbsp; </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>21</th><td class=\"r\"><ins>&nbsp; &nbsp; def __init__(self, username, password, database):</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>22</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; self.db = MySQLdb.connect(user=username, passwd=password, db=database)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>23</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; self.cursor = self.db.cursor()</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>24</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>25</th><td class=\"r\"><ins>&nbsp; &nbsp; def add_user(self, username):</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>26</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"Add a user to the users table if they don't already exist\"\"\"</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>27</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>28</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; sql = \"\"\"select id from users where </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>29</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; screenname='%s';\"\"\" % username</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>30</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>31</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; self.cursor.execute(sql)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>32</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; results = self.cursor.fetchall()</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>33</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; #print \"looking for %s, found\" % username, results</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>34</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>35</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; if results is ():</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>36</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # this user isn't already in the database</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>37</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sql = \"\"\"insert into users(screenname) values</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>38</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ('%s')\"\"\" % username</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>39</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.cursor.execute(sql)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>40</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.db.commit()</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>41</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>42</th><td class=\"r\"><ins>&nbsp; &nbsp; def log_event(self, screenname, signon):</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>43</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>44</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; # make sure the signon parameter is a boolean</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>45</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; # (true is signon, false is signff)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>46</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; if not type(signon) is type(True):</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>47</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; raise Exception('signon parameter is expected to be a boolean')</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>48</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>49</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; sql = \"\"\"INSERT INTO connection_history(user_id, signon)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>50</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VALUES ((SELECT id FROM users WHERE screenname='%s'),</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>51</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %s);\"\"\"&nbsp; % (screenname, signon)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>52</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>53</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; try:</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>54</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.cursor.execute(sql)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>55</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.db.commit()</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>56</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; except MySQLdb.OperationalError:</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>57</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # tried to log a buddy that does not exist in the users table</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>58</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pass</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>9</th><th>59</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>10</th><th>60</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=745#L36\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=746#L86\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>36</th><th>86</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>37</th><th>87</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>38</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; def rawDataIn(self, buf):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>39</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print \"RECV: %s\" % unicode(buf, 'utf-8').encode('ascii', 'replace')</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>88</th><td class=\"r\"><span>&nbsp; &nbsp; def _rawDataIn(self, buf):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>89</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; input = unicode(buf, 'utf-8').encode('ascii', 'replace')</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>90</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; #print \"RECV: %s\" % input</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>91</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self._parse_presence(input)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>92</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>93</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>94</th><td class=\"r\"><span>&nbsp; &nbsp; def _rawDataOut(self, buf):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>95</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; #print \"SEND: %s\" % unicode(buf, 'utf-8').encode('ascii', 'replace')</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>96</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; pass</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>97</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>98</th><td class=\"r\"><span>&nbsp; &nbsp; def _load_watch_list(self):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>99</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; file = open(WATCH_LIST_FILE_LOCATION)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>100</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>101</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; for line in file:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>102</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if line is not None and line is not \"\":</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>103</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if line not in self.watch_list:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>104</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; username = line.lower()</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>105</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.watch_list.append(username)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>106</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.sql_conn.add_user(username)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>107</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>108</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print 'watch list loaded:', self.watch_list</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>40</th><th>109</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>41</th><th>110</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>42</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; def rawDataOut(self, buf):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>43</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print \"SEND: %s\" % unicode(buf, 'utf-8').encode('ascii', 'replace')</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>111</th><td class=\"r\"><span>&nbsp; &nbsp; def _parse_presence(self, input):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>112</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; try:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>113</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dom = minidom.parseString(input)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>114</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>115</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; presence_element = dom.getElementsByTagName('presence')[0]</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>116</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; email_attribute = presence_element.getAttribute('from')</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>117</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for watched_person in self.watch_list:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>118</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if email_attribute.lower().startswith(watched_person):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>119</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # this is a presence string for a person in</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>120</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # the watch list</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>121</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>122</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # is this a sign off notification?</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>123</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type_attribute = presence_element.getAttribute('type')</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>124</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (type_attribute != None) and (type_attribute == 'unavailable'):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>125</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; signon = False</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>126</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>127</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; signon = True</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>128</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>129</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # log this event in the database</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>130</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print 'event:', watched_person, 'online =', signon</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>131</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.sql_conn.log_event(watched_person, signon);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>132</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>133</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; except IndexError:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>134</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # this was not a presence notification</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>135</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pass</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>136</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; except ExpatError:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>137</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # trouble parsing</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>138</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pass</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>139</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>44</th><th>140</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>45</th><th>141</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=745#L47\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=746#L143\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>47</th><th>143</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print 'Connected.'</span>\u00a0</td>\n                  </tr><tr>\n                          <th>48</th><th>144</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>145</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; # establish a mysql connection</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>146</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; self.sql_conn = SQL_Connection('root', 'abc', 'nomatic')</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>147</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>148</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; # load the users we're supposed to be watching</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>149</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; # from a file</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>150</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; self.watch_list = []</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>151</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; self._load_watch_list()</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>152</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>153</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; # handle incoming and outgoing data</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>49</th><th>154</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self.xmlstream = xs</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>50</th><th>\u00a0</th><td class=\"l\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>51</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; # Log all traffic</span>\u00a0</td>\n                      </tr><tr>\n                        <th>52</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xs.rawDataInFn = self.rawDataIn</span>\u00a0</td>\n                      </tr><tr>\n                        <th>53</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xs.rawDataOutFn = self.rawDataOut</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>155</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xs.rawDataInFn = self._rawDataIn</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>156</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xs.rawDataOutFn = self._rawDataOut</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>54</th><th>157</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>55</th><th>158</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=745#L67\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=746#L170\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>67</th><th>170</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>68</th><th>171</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; # wait 5 seconds, then sign off</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>69</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; <del></del>reactor.callLater(5, xs.sendFooter)</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>172</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; <ins>#</ins>reactor.callLater(5, xs.sendFooter)</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>70</th><th>173</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>71</th><th>174</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=745#L77\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=746#L180\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>77</th><th>180</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>78</th><th>181</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>79</th><th>\u00a0</th><td class=\"l\"><span>USERNAME = \"nomaticbot1@gmail.com\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>80</th><th>\u00a0</th><td class=\"l\"><span>PASSWORD = \"nomaticim321\"</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>182</th><td class=\"r\"><span>if __name__ == '__main__' :</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>81</th><th>183</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>82</th><th>\u00a0</th><td class=\"l\"><span>client_jid = jid.JID(USERNAME)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>83</th><th>\u00a0</th><td class=\"l\"><span>secret = PASSWORD</span>\u00a0</td>\n                      </tr><tr>\n                        <th>84</th><th>\u00a0</th><td class=\"l\"><span>c = Client(client_jid, secret)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>85</th><th>\u00a0</th><td class=\"l\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>86</th><th>\u00a0</th><td class=\"l\"><span>reactor.run()</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>184</th><td class=\"r\"><span>&nbsp; &nbsp; USERNAME = \"nomaticbot1@gmail.com\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>185</th><td class=\"r\"><span>&nbsp; &nbsp; PASSWORD = \"nomaticim321\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>186</th><td class=\"r\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>187</th><td class=\"r\"><span>&nbsp; &nbsp; client_jid = jid.JID(USERNAME)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>188</th><td class=\"r\"><span>&nbsp; &nbsp; secret = PASSWORD</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>189</th><td class=\"r\"><span>&nbsp; &nbsp; c = Client(client_jid, secret)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>190</th><td class=\"r\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>191</th><td class=\"r\"><span>&nbsp; &nbsp; reactor.run()</span>\u00a0</td>\n                      </tr>\n            </tbody>\n        </table>\n      </li>\n  </ul>\n</div>\n        <div id=\"help\"><strong>Note:</strong> See <a href=\"/LUCICodeRepository/nomaticIM/wiki/TracChangeset\">TracChangeset</a>\n          for help on using the changeset viewer.</div>\n      </div>\n    </div>\n    <div id=\"altlinks\">\n      <h3>Download in other formats:</h3>\n      <ul>\n        <li class=\"first\">\n          <a rel=\"nofollow\" href=\"?format=diff&amp;new=746\" class=\"diff\">Unified Diff</a>\n        </li><li class=\"last\">\n          <a rel=\"nofollow\" href=\"?format=zip&amp;new=746\" class=\"zip\">Zip Archive</a>\n        </li>\n      </ul>\n    </div>\n    </div>\n    <div id=\"footer\" lang=\"en\" xml:lang=\"en\"><hr />\n      <a id=\"tracpowered\" href=\"http://trac.edgewall.org/\"><img src=\"/LUCICodeRepository/nomaticIM/chrome/common/trac_logo_mini.png\" height=\"30\" width=\"107\" alt=\"Trac Powered\" /></a>\n      <p class=\"left\">Powered by <a href=\"/LUCICodeRepository/nomaticIM/about\"><strong>Trac 1.0.1</strong></a><br />\n        By <a href=\"http://www.edgewall.org/\">Edgewall Software</a>.</p>\n      <p class=\"right\">All content copyright 2007-2008 by LUCI <br /><a href=\"http://luci.ics.uci.edu/\">http://luci.ics.uci.edu/</a></p>\n    </div>\n\t\t<div id=\"sitefooter\">\n\t\t\t<script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\n\t\t\t</script>\n\t\t\t<script type=\"text/javascript\">\n\t\t\t\t_uacct = \"UA-338915-2\";\n\t\t\t\turchinTracker();\n\t\t\t</script>\n\t\t</div>\n\t</body>\n</html>", "id": 47003.0}