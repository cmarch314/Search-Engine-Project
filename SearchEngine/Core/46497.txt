{"text": "Search LoginPreferencesHelp GuideAbout Trac WikiTimelineRoadmapBrowse SourceView TicketsSearch Context Navigation Previous ChangesetNext Changeset Changeset 332 View differences inlineside by side Show lines around each change Show the changes in full context Ignore Blank lines Case changes White space changes Timestamp Jun 22 2 7 2 8 29 PM 8 years ago Author skaufman1Message Plugin and service now communicate As an example the service will set connecting plug ins to At home for the time being Location nomatic trunk Files 4 edited plugins gaim src nomatic c modified 4 diffs plugins gaim src service c modified 8 diffs plugins gaim src service h modified 4 diffs service edu uci ics luci nomatic service NomaticService java modified 3 diffs Legend UnmodifiedAddedRemoved nomatic trunk plugins gaim src nomatic c r331 r332 55 include plugin h 66 include version h 7 include savedstatuses h 78 89 include nomatic h 2728 2829 29 This is a callback function that gets called with the results 3 of nomatic service get async 3 This function gets called when the service reports a new status string 31 32void service new status cb NomaticService service char string 33 void data 34 35 GaimSavedStatus status 36 status gaim savedstatus new NULL GAIM STATUS AVAILABLE 37 gaim savedstatus set message status string 38 gaim savedstatus activate status 39 4 41 42 This function gets called with the results of nomatic service get async 43 That is this gets the NomaticService instance once connected 3144 3245void service get cb NomaticService service void data 4558 s service service 4659 nomatic service set error callback service service error cb data 6 nomatic service set new status callback service 61 service new status cb data 4762 nomatic service change presence service NULL 4863 5671 Connect to the Nomatic service launching if necessary 5772 nomatic service get async gaim prefs get string NOMATIC SERVICE HOST 58 service get cb plugin 73 service get cb plugin 5974out 6 75 No cleaning up to do just yet but there will be nomatic trunk plugins gaim src service c r331 r332 5555 serviceObj malloc sizeof NomaticService 5656 serviceObj error malloc sizeof NSError 57 serviceObj new status malloc sizeof NSNewStatus 5758 serviceObj to be freed FALSE 5859 TODO The connection should happen asynchronously 8586 service error cb error cb 8687 service error data data 88 89 9 void nomatic service set new status callback NomaticService service 91 service new status callback cb 92 void data 93 94 service new status cb cb 95 service new status data data 8796 8897 124133 gaim debug info nomatic nomatic service really free n 125134 Delete the NomaticService object 135 free service new status 126136 free service error 127137 free service 149159 break 15 16 case GNET CONN READ 151 if event length 1 161 if service waiting for new status length 162 unsigned short length received 163 service waiting for new status length FALSE 164 service waiting for new status string TRUE 165 gnet unpack H event buffer sizeof short length received 166 gaim debug info nomatic x 3 length was u n 167 length received 168 gnet conn readn service conn length received 169 17 else if service waiting for new status string 171 service waiting for new status string FALSE 172 char string buffer malloc event length 1 173 memcpy string buffer event buffer event length 174 string buffer event length 175 gaim debug info nomatic x 3 string was s n string buffer 176 service new status cb service string buffer 177 service new status data 178 free string buffer 179 18 Schedule the read of the next header 181 gnet conn readn conn 1 182 183 else if event length 1 152184 Then we re reading a packet header 153185 switch event buffer 156188 if service waiting for login response 157189 service waiting for login response FALSE 19 Schedule the read of the next header 191 gnet conn readn conn 1 158192 break 159193 case x 2 ERROR 1712 5 nomatic service free service 1722 6 2 7 Schedule the read of the next header 2 8 gnet conn readn conn 1 2 9 break 21 case x 3 New status 211 gaim debug info nomatic Received x 3 New status n 212 service waiting for new status length TRUE 213 gnet conn readn service conn 2 173214 break 174215 default 176217 service error cb service service error data 177218 nomatic service free service 219 Schedule the read of the next header 22 gnet conn readn conn 1 178221 break 179222 18 223 181224 else 182 gaim debug info nomatic Not reading a packet header 183 184 185 Schedule the read of the next header 186 gnet conn readn conn 1 225 gaim debug info nomatic Unexpected data Dropping it 226 227 187228 break 188229 228269 gnet pack B buffer sizeof buffer x 2 22927 gnet conn write service conn buffer sizeof buffer 23 char buffer x 1 231 gnet conn write service conn buffer 1 232271 233272 nomatic trunk plugins gaim src service h r331 r332 1313 GConn conn 1414 gboolean waiting for login response 15 gboolean waiting for new status length 16 gboolean waiting for new status string 17 gboolean to be freed 1518 struct NSError error 16 gboolean to be freed 19 struct NSNewStatus new status 172 NomaticService 1821 2 23typedef void service get callback NomaticService void 2124typedef void service error callback NomaticService void 25typedef void service new status callback NomaticService char void 2226 23 Error struct mostly to solve recursion problem 2427typedef struct NSError 2528 service error callback cb 273 NSError 2831 32typedef struct NSNewStatus 33 service new status callback cb 34 void data 35 NSNewStatus 2936 3 37 435 service error callback error cb 4451 void data 52 53 54 Sets a function to be called when the service notifies the plug in 55 that the status string should change 56 57void nomatic service set new status callback NomaticService service 58 service new status callback cb 59 void data 456 4661 nomatic trunk service edu uci ics luci nomatic service NomaticService java r32 r332 2424 static final int OK x 1 2525 static final int NOT OK x 2 26 static final int NEW STATUS STRING x 3 2627 2728 static final int MESSAGE LOG ON 1 9899 991 long waitTimeStart 1 1 1 2 TODO these conversion methods are a total mess 1 3 private byte toByte Object v 1 4 int size 1 5 long value 1 6 byte result 1 7 1 8 Determine the length of v 1 9 if v instanceof Short 11 size 2 111 else if v instanceof Integer 112 size 4 113 else if v instanceof Long 114 size 8 115 else 116 return null 117 118 119 Generate the result 12 result new byte size 121 value Number v longValue 122 for int i i size 1 i 123 result i byte value size 1 i 8 xFF 124 125 return result 126 127 128 private byte intToUnsignedShort int input 129 byte result new byte 2 13 byte inputByte toByte new Integer input 131 result inputByte 2 132 result 1 inputByte 3 133 return result 134 1 135 1 1136 private void parseMessage InputStream in 13 165 debug log Level INFO Received Change Status Message 131166 out write OK 167 debug log Level INFO Sending At home status 168 out write NEW STATUS STRING 169 byte utfS At home getBytes UTF 8 17 out write intToUnsignedShort utfS length 171 out write utfS 132172 break 133173 default Note See TracChangeset for help on using the changeset viewer Download in other formats Unified Diff Zip Archive Powered by Trac 1 1 By Edgewall Software All content copyright 2 7 2 8 by LUCI http luci ics uci edu ", "_id": "http://djp3-pc2.ics.uci.edu/LUCICodeRepository/nomaticIM/changeset/332", "title": "\n      changeset 332 \u2013 nomatic*im\n    ", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n  \n  \n\n  \n\n\n  <head>\n\t\t<title>\n      Changeset 332 \u2013 Nomatic*IM\n    </title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><link rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search\" /><link rel=\"prev\" href=\"/LUCICodeRepository/nomaticIM/changeset/331\" title=\"Changeset 331\" /><link rel=\"last\" href=\"/LUCICodeRepository/nomaticIM/changeset/1312\" title=\"Changeset 1312\" /><link rel=\"help\" href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\" /><link rel=\"alternate\" href=\"?format=diff&amp;new=332\" type=\"text/plain\" class=\"diff\" title=\"Unified Diff\" /><link rel=\"alternate\" href=\"?format=zip&amp;new=332\" type=\"application/zip\" class=\"zip\" title=\"Zip Archive\" /><link rel=\"next\" href=\"/LUCICodeRepository/nomaticIM/changeset/333\" title=\"Changeset 333\" /><link rel=\"start\" href=\"/LUCICodeRepository/nomaticIM/wiki\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/changeset.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/diff.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/code.css\" type=\"text/css\" /><link rel=\"first\" href=\"/LUCICodeRepository/nomaticIM/changeset/1\" title=\"Changeset 1\" /><link rel=\"shortcut icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link rel=\"icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link type=\"application/opensearchdescription+xml\" rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search/opensearch\" title=\"Search Nomatic*IM\" /><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/jquery.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/babel.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/messages/en_US.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/trac.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/search.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/diff.js\"></script><script type=\"text/javascript\">\n      jQuery(document).ready(function($) {\n        $(\".trac-toggledeleted\").show().click(function() {\n                  $(this).siblings().find(\".trac-deleted\").toggle();\n                  return false;\n        }).click();\n        $(\"#content\").find(\"li.entry h2 a\").parent().addAnchor(_(\"Link to this diff\"));\n      });\n    </script>\n\t</head>\n  <body>\n    <div id=\"banner\">\n      <div id=\"header\">\n        <a id=\"logo\" href=\"http://luci.ics.uci.edu/#code\"><img src=\"http://luci.ics.uci.edu/blog/archives/LUCIhorzTight.jpg\" alt=\"LUCI Code Repository\" /></a>\n      </div>\n      <form id=\"search\" action=\"/LUCICodeRepository/nomaticIM/search\" method=\"get\">\n        <div>\n          <label for=\"proj-search\">Search:</label>\n          <input type=\"text\" id=\"proj-search\" name=\"q\" size=\"18\" value=\"\" />\n          <input type=\"submit\" value=\"Search\" />\n        </div>\n      </form>\n      <div id=\"metanav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/login\">Login</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/prefs\">Preferences</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\">Help/Guide</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/about\">About Trac</a></li>\n    </ul>\n  </div>\n    </div>\n    <div id=\"mainnav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/wiki\">Wiki</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/timeline\">Timeline</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/roadmap\">Roadmap</a></li><li class=\"active\"><a href=\"/LUCICodeRepository/nomaticIM/browser\">Browse Source</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/report\">View Tickets</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/search\">Search</a></li>\n    </ul>\n  </div>\n    <div id=\"main\">\n      <div id=\"ctxtnav\" class=\"nav\">\n        <h2>Context Navigation</h2>\n        <ul>\n          <li class=\"first\"><span>&larr; <a class=\"prev\" href=\"/LUCICodeRepository/nomaticIM/changeset/331\" title=\"Changeset 331\">Previous Changeset</a></span></li><li class=\"last\"><span><a class=\"next\" href=\"/LUCICodeRepository/nomaticIM/changeset/333\" title=\"Changeset 333\">Next Changeset</a> &rarr;</span></li>\n        </ul>\n        <hr />\n      </div>\n    <div id=\"content\" class=\"changeset\">\n      <div id=\"title\">\n            <h1>Changeset 332</h1>\n      </div>\n      <form id=\"prefs\" action=\"\">\n        <div>\n          \n  <label for=\"style\">View differences</label>\n  <select id=\"style\" name=\"style\">\n    <option selected=\"selected\" value=\"inline\">inline</option>\n    <option value=\"sidebyside\">side by side</option>\n  </select>\n  <div class=\"field\">\n    <label><input type=\"radio\" name=\"contextall\" value=\"0\" checked=\"checked\" />\n             Show</label>\n      <label><input type=\"text\" name=\"contextlines\" id=\"contextlines\" size=\"2\" maxlength=\"3\" value=\"2\" />\n             lines around each change</label><br />\n    <label><input type=\"radio\" name=\"contextall\" value=\"1\" />\n           Show the changes in full context</label>\n  </div>\n  <fieldset id=\"ignore\">\n    <legend>Ignore:</legend>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignoreblanklines\" name=\"ignoreblanklines\" />\n      <label for=\"ignoreblanklines\">Blank lines</label>\n    </div>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignorecase\" name=\"ignorecase\" />\n      <label for=\"ignorecase\">Case changes</label>\n    </div>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignorewhitespace\" name=\"ignorewhitespace\" />\n      <label for=\"ignorewhitespace\">White space changes</label>\n    </div>\n  </fieldset>\n  <div class=\"buttons\">\n    <input type=\"submit\" name=\"update\" value=\"Update\" />\n  </div>\n\n        </div>\n      </form>\n      <dl id=\"overview\">\n          <dt class=\"property time\">Timestamp:</dt>\n          <dd class=\"time\">\n             Jun 22, 2007, 2:08:29 PM\n             (<a class=\"timeline\" href=\"/LUCICodeRepository/nomaticIM/timeline?from=2007-06-22T14%3A08%3A29-07%3A00&amp;precision=second\" title=\"See timeline at Jun 22, 2007, 2:08:29 PM\">8 years</a> ago)\n          </dd>\n          <dt class=\"property author\">Author:</dt>\n          <dd class=\"author\">skaufman1</dd>\n          <dt class=\"property message\">Message:</dt>\n          <dd class=\"message searchable\">\n            \n            \n              <p>\nPlugin and service now communicate. As an example, the service will set connecting plug-ins to \"At home\" for the time being.<br />\n</p>\n\n            \n            \n          </dd>\n          <dt class=\"property location\">Location:</dt>\n          <dd class=\"searchable\"><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk?rev=332\">nomatic/trunk</a></dd>\n        <dt class=\"property files\">\n          Files:\n        </dt>\n        <dd class=\"files\">\n          <div class=\"legend\" id=\"file-legend\">\n            <dl>\n              <dt class=\"mod\"></dt><dd>4 edited</dd>\n            </dl>\n          </div>\n          <br />\n          <ul>\n            <li>\n          <div class=\"mod\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=332\">\n              plugins/gaim/src/nomatic.c\n            </a>\n          <span class=\"comment\">(modified)</span>\n              (<a title=\"Show differences\" href=\"#file0\">4 diffs</a>)\n            </li><li>\n          <div class=\"mod\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332\">\n              plugins/gaim/src/service.c\n            </a>\n          <span class=\"comment\">(modified)</span>\n              (<a title=\"Show differences\" href=\"#file1\">8 diffs</a>)\n            </li><li>\n          <div class=\"mod\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=332\">\n              plugins/gaim/src/service.h\n            </a>\n          <span class=\"comment\">(modified)</span>\n              (<a title=\"Show differences\" href=\"#file2\">4 diffs</a>)\n            </li><li>\n          <div class=\"mod\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java?rev=332\">\n              service/edu/uci/ics/luci/nomatic/service/NomaticService.java\n            </a>\n          <span class=\"comment\">(modified)</span>\n              (<a title=\"Show differences\" href=\"#file3\">3 diffs</a>)\n            </li>\n          </ul>\n        </dd>\n      </dl>\n      <div class=\"diff\">\n        <div class=\"legend\" id=\"diff-legend\">\n          <h3>Legend:</h3>\n          <dl>\n            <dt class=\"unmod\"></dt><dd>Unmodified</dd>\n            <dt class=\"add\"></dt><dd>Added</dd>\n            <dt class=\"rem\"></dt><dd>Removed</dd>\n          </dl>\n        </div>\n        <div class=\"diff\">\n  <ul class=\"entries\">\n      <li class=\"entry\">\n        <h2 id=\"file0\">\n          <a href=\"/LUCICodeRepository/nomaticIM/changeset/332/nomatic/trunk/plugins/gaim/src/nomatic.c\" title=\"Show the changeset 332 restricted to nomatic/trunk/plugins/gaim/src/nomatic.c\">nomatic/trunk/plugins/gaim/src/nomatic.c</a>\n        </h2>\n        <table class=\"trac-diff inline\" summary=\"Differences\" cellspacing=\"0\">\n              <colgroup><col class=\"lineno\" /><col class=\"lineno\" /><col class=\"content\" /></colgroup>\n              <thead>\n                <tr>\n                  <th title=\"Revision 331\">\n                    <a title=\"Show revision 331 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=331#L5\">\n                      r331</a>\n                  </th>\n                  <th title=\"Revision 332\">\n                    <a title=\"Show revision 332 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=332#L5\">\n                      r332</a>\n                  </th>\n                  <td>\u00a0</td>\n                </tr>\n              </thead>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>5</th><th>5</th><td class=\"l\"><span>#include &lt;plugin.h&gt;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>6</th><th>6</th><td class=\"l\"><span>#include &lt;version.h&gt;</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"last first\">\n                          <th>\u00a0</th><th>7</th><td class=\"r\"><ins>#include &lt;savedstatuses.h&gt;</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>7</th><th>8</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>8</th><th>9</th><td class=\"l\"><span>#include \"nomatic.h\"</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=331#L27\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=332#L28\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>27</th><th>28</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>28</th><th>29</th><td class=\"l\"><span>/*</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>29</th><th>\u00a0</th><td class=\"l\"><span>&nbsp;* This is a callback function that gets called with the results</span>\u00a0</td>\n                      </tr><tr>\n                        <th>30</th><th>\u00a0</th><td class=\"l\"><span>&nbsp;* of nomatic_service_get_async.</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>30</th><td class=\"r\"><span>&nbsp;* This function gets called when the service reports a new status string.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>31</th><td class=\"r\"><span>&nbsp;*/</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>32</th><td class=\"r\"><span>void service_new_status_cb (NomaticService *service, char *string,</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>33</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; void *data)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>34</th><td class=\"r\"><span>{</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>35</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; GaimSavedStatus *status;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>36</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; status = gaim_savedstatus_new(NULL, GAIM_STATUS_AVAILABLE);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>37</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; gaim_savedstatus_set_message(status, string);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>38</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; gaim_savedstatus_activate(status);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>39</th><td class=\"r\"><span>}</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>40</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>41</th><td class=\"r\"><span>/*</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>42</th><td class=\"r\"><span>&nbsp;* This function gets called with the results of nomatic_service_get_async.</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>43</th><td class=\"r\"><span>&nbsp;* That is, this gets the NomaticService instance once connected.</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>31</th><th>44</th><td class=\"l\"><span>&nbsp;*/</span>\u00a0</td>\n                  </tr><tr>\n                          <th>32</th><th>45</th><td class=\"l\"><span>void service_get_cb (NomaticService *service, void *data) {</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=331#L45\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=332#L58\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>45</th><th>58</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s_service = service;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>46</th><th>59</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nomatic_service_set_error_callback(service, service_error_cb, data);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>60</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nomatic_service_set_new_status_callback(service,</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>61</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service_new_status_cb, data);</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>47</th><th>62</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nomatic_service_change_presence(service, NULL);</span>\u00a0</td>\n                  </tr><tr>\n                          <th>48</th><th>63</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=331#L56\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/nomatic.c?rev=332#L71\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>56</th><th>71</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; /* Connect to the Nomatic service, launching if necessary */</span>\u00a0</td>\n                  </tr><tr>\n                          <th>57</th><th>72</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; nomatic_service_get_async(gaim_prefs_get_string(NOMATIC_SERVICE_HOST),</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>58</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </del>service_get_cb, plugin);</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>73</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins></ins>service_get_cb, plugin);</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>59</th><th>74</th><td class=\"l\"><span>out:</span>\u00a0</td>\n                  </tr><tr>\n                          <th>60</th><th>75</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; /* No cleaning up to do just yet... but there will be. */</span>\u00a0</td>\n                  </tr>\n            </tbody>\n        </table>\n      </li>\n      <li class=\"entry\">\n        <h2 id=\"file1\">\n          <a href=\"/LUCICodeRepository/nomaticIM/changeset/332/nomatic/trunk/plugins/gaim/src/service.c\" title=\"Show the changeset 332 restricted to nomatic/trunk/plugins/gaim/src/service.c\">nomatic/trunk/plugins/gaim/src/service.c</a>\n        </h2>\n        <table class=\"trac-diff inline\" summary=\"Differences\" cellspacing=\"0\">\n              <colgroup><col class=\"lineno\" /><col class=\"lineno\" /><col class=\"content\" /></colgroup>\n              <thead>\n                <tr>\n                  <th title=\"Revision 331\">\n                    <a title=\"Show revision 331 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=331#L55\">\n                      r331</a>\n                  </th>\n                  <th title=\"Revision 332\">\n                    <a title=\"Show revision 332 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332#L55\">\n                      r332</a>\n                  </th>\n                  <td>\u00a0</td>\n                </tr>\n              </thead>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>55</th><th>55</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; serviceObj = malloc(sizeof(NomaticService));</span>\u00a0</td>\n                  </tr><tr>\n                          <th>56</th><th>56</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; serviceObj-&gt;error = malloc(sizeof(NSError));</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"last first\">\n                          <th>\u00a0</th><th>57</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; serviceObj-&gt;new_status = malloc(sizeof(NSNewStatus));</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>57</th><th>58</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; serviceObj-&gt;to_be_freed = FALSE;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>58</th><th>59</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; /* TODO: The connection should happen asynchronously */</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=331#L85\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332#L86\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>85</th><th>86</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; service-&gt;error-&gt;cb = error_cb;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>86</th><th>87</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; service-&gt;error-&gt;data = data;</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>88</th><td class=\"r\"><ins>}</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>89</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>90</th><td class=\"r\"><ins>void nomatic_service_set_new_status_callback(NomaticService *service,</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>91</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;service_new_status_callback cb,</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>92</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void *data)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>93</th><td class=\"r\"><ins>{</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>94</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; service-&gt;new_status-&gt;cb = cb;</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>95</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; service-&gt;new_status-&gt;data = data;</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>87</th><th>96</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>88</th><th>97</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=331#L124\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332#L133\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>124</th><th>133</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; gaim_debug_info(\"nomatic\", \"nomatic_service_really_free!\\n\");</span>\u00a0</td>\n                  </tr><tr>\n                          <th>125</th><th>134</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; /* Delete the NomaticService object */</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"last first\">\n                          <th>\u00a0</th><th>135</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; free(service-&gt;new_status);</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>126</th><th>136</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; free(service-&gt;error);</span>\u00a0</td>\n                  </tr><tr>\n                          <th>127</th><th>137</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; free(service);</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=331#L149\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332#L159\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>149</th><th>159</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>150</th><th>160</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; case GNET_CONN_READ:</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>151</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (event-&gt;length == 1) {</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>161</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (service-&gt;waiting_for_new_status_length) {</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>162</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned short length_received;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>163</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service-&gt;waiting_for_new_status_length = FALSE;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>164</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service-&gt;waiting_for_new_status_string = TRUE;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>165</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gnet_unpack(\"!H\", event-&gt;buffer, sizeof(short), &amp;length_received);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>166</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gaim_debug_info(\"nomatic\", \"0x03 length was %u\\n\",</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>167</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; length_received);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>168</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gnet_conn_readn(service-&gt;conn, length_received);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>169</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>170</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (service-&gt;waiting_for_new_status_string) {</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>171</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service-&gt;waiting_for_new_status_string = FALSE;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>172</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char * string_buffer = malloc(event-&gt;length + 1);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>173</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memcpy(string_buffer, event-&gt;buffer, event-&gt;length);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>174</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string_buffer[event-&gt;length] = '\\0';</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>175</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gaim_debug_info(\"nomatic\", \"0x03 string was %s\\n\", string_buffer);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>176</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (service-&gt;new_status-&gt;cb)(service, string_buffer,</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>177</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service-&gt;new_status-&gt;data);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>178</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; free(string_buffer);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>179</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>180</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Schedule the read of the next header */</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>181</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gnet_conn_readn(conn, 1);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>182</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>183</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (event-&gt;length == 1) {</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>152</th><th>184</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Then we're reading a packet header */</span>\u00a0</td>\n                  </tr><tr>\n                          <th>153</th><th>185</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; switch (event-&gt;buffer[0]) {</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=331#L156\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332#L188\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>156</th><th>188</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (service-&gt;waiting_for_login_response)</span>\u00a0</td>\n                  </tr><tr>\n                          <th>157</th><th>189</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service-&gt;waiting_for_login_response = FALSE;</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>190</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Schedule the read of the next header */</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>191</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gnet_conn_readn(conn, 1);</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>158</th><th>192</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>159</th><th>193</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0x02: /* ERROR */</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=331#L171\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332#L205\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>171</th><th>205</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nomatic_service_free(service);&nbsp; </span>\u00a0</td>\n                  </tr><tr>\n                          <th>172</th><th>206</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>207</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Schedule the read of the next header */</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>208</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gnet_conn_readn(conn, 1);</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>209</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>210</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0x03: /* New status */</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>211</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gaim_debug_info(\"nomatic\",\"Received [0x03] New status\\n\");</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>212</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service-&gt;waiting_for_new_status_length = TRUE;</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>213</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gnet_conn_readn(service-&gt;conn, 2);</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>173</th><th>214</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>174</th><th>215</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=331#L176\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332#L217\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>176</th><th>217</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (service-&gt;error-&gt;cb)(service, service-&gt;error-&gt;data);</span>\u00a0</td>\n                  </tr><tr>\n                          <th>177</th><th>218</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nomatic_service_free(service);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>219</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Schedule the read of the next header */</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>220</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gnet_conn_readn(conn, 1);</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>178</th><th>221</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>179</th><th>222</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr><tr>\n                          <th>180</th><th>223</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr><tr>\n                          <th>181</th><th>224</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else {</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>182</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gaim_debug_info(\"nomatic\", \"Not reading a packet header!\");</span>\u00a0</td>\n                      </tr><tr>\n                        <th>183</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>184</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>185</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Schedule the read of the next header */</span>\u00a0</td>\n                      </tr><tr>\n                        <th>186</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gnet_conn_readn(conn, 1);</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>225</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gaim_debug_info(\"nomatic\", \"Unexpected data!&nbsp; Dropping it.\");</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>226</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>227</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>187</th><th>228</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>188</th><th>229</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=331#L228\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.c?rev=332#L269\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>228</th><th>269</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; gnet_pack(\"!B\", buffer, sizeof(buffer), 0x02);</span>\u00a0</td>\n                  </tr><tr>\n                          <th>229</th><th>270</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; gnet_conn_write(service-&gt;conn, buffer, sizeof(buffer));</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"first\">\n                          <th>230</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; //char buffer = 0x01;</del>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>231</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; //gnet_conn_write(service-&gt;conn, &amp;buffer, 1);</del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>232</th><th>271</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>233</th><th>272</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody>\n        </table>\n      </li>\n      <li class=\"entry\">\n        <h2 id=\"file2\">\n          <a href=\"/LUCICodeRepository/nomaticIM/changeset/332/nomatic/trunk/plugins/gaim/src/service.h\" title=\"Show the changeset 332 restricted to nomatic/trunk/plugins/gaim/src/service.h\">nomatic/trunk/plugins/gaim/src/service.h</a>\n        </h2>\n        <table class=\"trac-diff inline\" summary=\"Differences\" cellspacing=\"0\">\n              <colgroup><col class=\"lineno\" /><col class=\"lineno\" /><col class=\"content\" /></colgroup>\n              <thead>\n                <tr>\n                  <th title=\"Revision 331\">\n                    <a title=\"Show revision 331 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=331#L13\">\n                      r331</a>\n                  </th>\n                  <th title=\"Revision 332\">\n                    <a title=\"Show revision 332 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=332#L13\">\n                      r332</a>\n                  </th>\n                  <td>\u00a0</td>\n                </tr>\n              </thead>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>13</th><th>13</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; GConn *conn;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>14</th><th>14</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; gboolean waiting_for_login_response;</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>15</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; gboolean waiting_for_new_status_length;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>16</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; gboolean waiting_for_new_status_string;</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>17</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; gboolean to_be_freed;</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>15</th><th>18</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; struct _NSError * error;</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>16</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; <del>gboolean to_be_freed</del>;</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>19</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; <ins>struct _NSNewStatus * new_status</ins>;</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>17</th><th>20</th><td class=\"l\"><span>} NomaticService;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>18</th><th>21</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=331#L20\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=332#L23\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>20</th><th>23</th><td class=\"l\"><span>typedef void (*service_get_callback)(NomaticService*, void*);</span>\u00a0</td>\n                  </tr><tr>\n                          <th>21</th><th>24</th><td class=\"l\"><span>typedef void (*service_error_callback)(NomaticService*, void*);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"last first\">\n                          <th>\u00a0</th><th>25</th><td class=\"r\"><ins>typedef void (*service_new_status_callback)(NomaticService*, char*, void*);</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>22</th><th>26</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"last first\">\n                          <th>23</th><th>\u00a0</th><td class=\"l\"><del>/* Error struct (mostly to solve recursion problem) */</del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>24</th><th>27</th><td class=\"l\"><span>typedef struct _NSError {</span>\u00a0</td>\n                  </tr><tr>\n                          <th>25</th><th>28</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; service_error_callback cb;</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=331#L27\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=332#L30\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>27</th><th>30</th><td class=\"l\"><span>} NSError;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>28</th><th>31</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>32</th><td class=\"r\"><ins>typedef struct _NSNewStatus {</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>33</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; service_new_status_callback cb;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>34</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; void *data;</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>35</th><td class=\"r\"><ins>} NSNewStatus;</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>29</th><th>36</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>30</th><th>37</th><td class=\"l\"><span>/*</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=331#L43\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/plugins/gaim/src/service.h?rev=332#L50\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>43</th><th>50</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service_error_callback error_cb,</span>\u00a0</td>\n                  </tr><tr>\n                          <th>44</th><th>51</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; void *data);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>52</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>53</th><td class=\"r\"><ins>/*</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>54</th><td class=\"r\"><ins>&nbsp;* Sets a function to be called when the service notifies the plug-in</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>55</th><td class=\"r\"><ins>&nbsp;* that the status string should change. </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>56</th><td class=\"r\"><ins>&nbsp;*/</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>57</th><td class=\"r\"><ins>void nomatic_service_set_new_status_callback(NomaticService *service,</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>58</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;service_new_status_callback cb,</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>59</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void *data);</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>45</th><th>60</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>46</th><th>61</th><td class=\"l\"><span>/*</span>\u00a0</td>\n                  </tr>\n            </tbody>\n        </table>\n      </li>\n      <li class=\"entry\">\n        <h2 id=\"file3\">\n          <a href=\"/LUCICodeRepository/nomaticIM/changeset/332/nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java\" title=\"Show the changeset 332 restricted to nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java\">nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java</a>\n        </h2>\n        <table class=\"trac-diff inline\" summary=\"Differences\" cellspacing=\"0\">\n              <colgroup><col class=\"lineno\" /><col class=\"lineno\" /><col class=\"content\" /></colgroup>\n              <thead>\n                <tr>\n                  <th title=\"Revision 320\">\n                    <a title=\"Show revision 320 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java?rev=320#L24\">\n                      r320</a>\n                  </th>\n                  <th title=\"Revision 332\">\n                    <a title=\"Show revision 332 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java?rev=332#L24\">\n                      r332</a>\n                  </th>\n                  <td>\u00a0</td>\n                </tr>\n              </thead>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>24</th><th>24</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; static final int OK = 0x01;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>25</th><th>25</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; static final int NOT_OK = 0x02;</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"last first\">\n                          <th>\u00a0</th><th>26</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; static final int NEW_STATUS_STRING = 0x03;</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>26</th><th>27</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                  </tr><tr>\n                          <th>27</th><th>28</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; static final int MESSAGE_LOG_ON = 1;</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java?rev=320#L98\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java?rev=332#L99\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>98</th><th>99</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>99</th><th>100</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; long waitTimeStart = 0;</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>101</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>102</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // TODO: these conversion methods are a total mess</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>103</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; private byte[] toByte(Object v) {</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>104</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int size;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>105</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; long value;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>106</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte[] result;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>107</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>108</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Determine the length of v</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>109</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(v instanceof Short) {</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>110</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size = 2;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>111</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if(v instanceof Integer) {</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>112</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size = 4;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>113</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if(v instanceof Long) {</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>114</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size = 8;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>115</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>116</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return null;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>117</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>118</th><td class=\"r\"><ins></ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>119</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Generate the result</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>120</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result = new byte[size];</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>121</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value = ((Number) v).longValue();</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>122</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (int i = 0; i &lt;= size-1; i++) {</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>123</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result[i] = (byte) (value&gt;&gt;&gt;((size-1-i)*8) &amp; 0xFF);</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>124</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>125</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return result;</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>126</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>127</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>128</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; private byte[] intToUnsignedShort(int input) {</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>129</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte[] result = new byte[2];</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>130</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte[] inputByte = toByte(new Integer(input));</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>131</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result[0] = inputByte[2];</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>132</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result[1] = inputByte[3];</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>133</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return result;</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>134</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>100</th><th>135</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>101</th><th>136</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; private void parseMessage(InputStream in) {</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java?rev=320#L130\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/edu/uci/ics/luci/nomatic/service/NomaticService.java?rev=332#L165\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>130</th><th>165</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug.log(Level.INFO, \"Received Change Status Message\");</span>\u00a0</td>\n                  </tr><tr>\n                          <th>131</th><th>166</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out.write(OK);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>167</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug.log(Level.INFO, \"Sending \\\"At home\\\" status\");</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>168</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out.write(NEW_STATUS_STRING);</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>169</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte[] utfS = (\"At home\").getBytes(\"UTF-8\");</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>170</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out.write(intToUnsignedShort(utfS.length));</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>171</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out.write(utfS);</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>132</th><th>172</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span>\u00a0</td>\n                  </tr><tr>\n                          <th>133</th><th>173</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:</span>\u00a0</td>\n                  </tr>\n            </tbody>\n        </table>\n      </li>\n  </ul>\n</div>\n        <div id=\"help\"><strong>Note:</strong> See <a href=\"/LUCICodeRepository/nomaticIM/wiki/TracChangeset\">TracChangeset</a>\n          for help on using the changeset viewer.</div>\n      </div>\n    </div>\n    <div id=\"altlinks\">\n      <h3>Download in other formats:</h3>\n      <ul>\n        <li class=\"first\">\n          <a rel=\"nofollow\" href=\"?format=diff&amp;new=332\" class=\"diff\">Unified Diff</a>\n        </li><li class=\"last\">\n          <a rel=\"nofollow\" href=\"?format=zip&amp;new=332\" class=\"zip\">Zip Archive</a>\n        </li>\n      </ul>\n    </div>\n    </div>\n    <div id=\"footer\" lang=\"en\" xml:lang=\"en\"><hr />\n      <a id=\"tracpowered\" href=\"http://trac.edgewall.org/\"><img src=\"/LUCICodeRepository/nomaticIM/chrome/common/trac_logo_mini.png\" height=\"30\" width=\"107\" alt=\"Trac Powered\" /></a>\n      <p class=\"left\">Powered by <a href=\"/LUCICodeRepository/nomaticIM/about\"><strong>Trac 1.0.1</strong></a><br />\n        By <a href=\"http://www.edgewall.org/\">Edgewall Software</a>.</p>\n      <p class=\"right\">All content copyright 2007-2008 by LUCI <br /><a href=\"http://luci.ics.uci.edu/\">http://luci.ics.uci.edu/</a></p>\n    </div>\n\t\t<div id=\"sitefooter\">\n\t\t\t<script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\n\t\t\t</script>\n\t\t\t<script type=\"text/javascript\">\n\t\t\t\t_uacct = \"UA-338915-2\";\n\t\t\t\turchinTracker();\n\t\t\t</script>\n\t\t</div>\n\t</body>\n</html>", "id": 46497.0}