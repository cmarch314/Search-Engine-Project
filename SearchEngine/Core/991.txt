{"text": "Writing Your Own R Functions If R doesn t have a built in function we can make our own function You were introduced to the syntax for creating a function here Let s try building another R function We want to write a function to perform a simulation of the following scenario A friend shows you three sealed envelopes one envelope has 2 cash inside it and the other two envelopes are each empty She tells you that you can pick an envelope and if you pick the one with 2 its yours You randomly choose an envelope but before you can open it she opens a different envelope and shows you that it s empty She then asks you if you want your original envelope or if you d like to choose the other non opened envelope Should you switch If you don t switch what is your probability that you have the 2 envelope in your hand Let s simulate this process many times when you switch envelopes and see what proportion of the time you end up with 2 First think about how to simulate the process once Label the envelopes 1 2 3 Suppose the envelope you choose is envelope 1 twenty sample 1 3 1 Randomly put 2 into one of the three envelopes if twenty 1 Assuming the envelope opened is selected at random open sample 2 3 1 prob c 5 5 if twenty 2 open 3 if twenty 3 open 2 Now switch doors switch 2 3 2 3 open Make sure you understand what this line is doing Did you win switch twenty Now put this into an R function Note that no arguments to the function are needed env sim function twenty sample 1 3 1 if twenty 1 open sample 2 3 1 prob c 5 5 if twenty 2 open 3 if twenty 3 open 2 switch 2 3 2 3 open switch twenty Let s see what proportion of the time we win out of 1 times win for i in 1 1 trial env sim if trial TRUE win win 1 win 1 Stats 12 A Index", "_id": "http://www.ics.uci.edu/~staceyah/120A/Functions.html", "title": "writing your own r functions", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\">\n<html>\n  <head>\n    <meta content=\"text/html; charset=windows-1252\"\n      http-equiv=\"Content-Type\">\n    <title>Writing your own R functions</title>\n    <meta content=\"Stacey Hancock\" name=\"author\">\n  </head>\n  <body>\n    <table style=\"width: 100%; background-color: rgb(102, 204, 204);\n      margin-left: auto; margin-right: auto; height: 58px; text-align:\n      left;\" border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n      <tbody>\n        <tr>\n          <td>\n            <div style=\"text-align: center;\"> </div>\n            <h1 style=\" text-align: center;\">Writing Your Own R\n              Functions<br>\n            </h1>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <span style=\"color: rgb(51, 153, 153);\"><br>\n      <font color=\"#000000\">If R doesn't have a built-in function, we\n        can make our own function. You were introduced to the syntax for\n        creating a function <a\n          href=\"http://www.ics.uci.edu/%7Estaceyah/120A/Rintro/Adv_Coding.html\">here</a>.<br>\n        <br>\n        Let's try building another R function. We want to write a\n        function to perform a simulation of the following scenario:<br>\n      </font></span>\n    <blockquote><i>A friend shows you three sealed envelopes - one\n        envelope has $20 cash inside it, and the other two envelopes are\n        each empty. She tells you that you can pick an envelope, and if\n        you pick the one with $20, its yours. You randomly choose an\n        envelope, but before you can open it, she opens a different\n        envelope and shows you that it's empty. She then asks you if you\n        want your original envelope, or if you'd like to choose the\n        other (non-opened) envelope. Should you switch?<br>\n      </i></blockquote>\n    If you don't switch, what is your probability that you have the $20\n    envelope in your hand?<br>\n    <br>\n    Let's simulate this process many times when you switch envelopes,\n    and see what proportion of the time you end up with $20. <br>\n    <br>\n    First think about how to simulate the process once. Label the\n    envelopes 1, 2, 3. Suppose the envelope you choose is envelope 1.<br>\n    <pre>twenty = sample(1:3, 1)    # Randomly put $20 into one of the three envelopes.<br>if(twenty == 1){<br>     # Assuming the envelope opened is selected at random<br>     open = sample(2:3, 1, prob=c(0.5,0.5))<br>}<br>if(twenty == 2){<br>     open = 3<br>}<br>if(twenty == 3){<br>     open = 2<br>}<br># Now switch doors:<br>switch = (2:3)[(2:3)!=open]    # Make sure you understand what this line is doing.<br># Did you win?<br>switch == twenty<br><br><i></i></pre>\n    <span style=\"color: rgb(51, 153, 153);\"></span><span style=\"color:\n      rgb(51, 153, 153);\"><font color=\"#000000\"> Now put this into an R\n        function. Note that no arguments to the function are needed.<br>\n      </font></span><span style=\"color: rgb(51, 153, 153);\"></span>\n    <pre>env.sim = function(){<br></pre>\n    <blockquote>\n      <pre>twenty = sample(1:3, 1)<br>if(twenty == 1){<br>&nbsp;open = sample(2:3, 1, prob=c(0.5,0.5))<br>}<br>if(twenty == 2){<br>&nbsp;open = 3<br>}<br>if(twenty == 3){<br>&nbsp;open = 2<br>}<br>switch = (2:3)[(2:3)!=open]<br>switch == twenty<br></pre>\n    </blockquote>\n    <pre>}<br></pre>\n    <p>Let's see what proportion of the time we win out of 1000 times:<br>\n    </p>\n    <pre>win = 0<br>for(i in 1:1000){<br></pre>\n    <blockquote>\n      <pre>trial = env.sim()<br>if(trial == TRUE){<br>    win = win + 1<br>}<br></pre>\n    </blockquote>\n    <pre>}<br><br>win/1000<br></pre>\n    <span style=\"color: rgb(51, 153, 153);\"><font color=\"#000000\"> </font></span>\n    <pre><br></pre>\n    <span style=\"color: rgb(51, 153, 153);\"></span>\n    <hr style=\"width: 100%; height: 2px;\">\n    <div style=\"text-align: center;\"><big><br>\n        <a href=\"index.html\">Stats 120A Index</a></big><br>\n      <br>\n      <hr style=\"width: 100%; height: 2px;\"><br>\n    </div>\n  </body>\n</html>\n", "id": 991.0}