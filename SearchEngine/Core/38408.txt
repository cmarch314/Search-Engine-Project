{"text": "OEChem C Theory Manual Version 1 3 1 Previous 8 3 Conformers Up 8 OEMols and OEGraphMols Next 9 Atom Bond and 8 4 Reading Multi conformer molecules Molecule streams which were introduced above can read both single and multi conformer molecules from any file format Many of the file formats supported by OEChem are inherently a single conformer format SDF and MOL2 for example However a common practice is to store multiple conformers in these files OEChem supports a rather advanced mechanism for recovering these separate conformers into a single multi conformer OEMol Note that this does not apply to file formats where conformers are stored together For example all molecules in old OEBinary file are multi conformer molecules New OEBinary oeb stores either single conformer or multi conformer molecules explicitly so the file itself determines how to deal with conformers Additionally file formats that have no notion of conformers i e SMILES files are also unaffected by this feature In early versions of OEChem the default behavior for reading into an OEMol was to attempt to combine conformers of the same molecules together into a single OEMol This is no longer the default but is instead something controlled by the programmer oemolistreams have a method SetConfTest that sets a functor to be used to compare the graphs of incoming molecules to determine whether to combine them These functors are instances of OEConfTest Several predefined versions include OEDefaultConfTestNever combine connection tables into multi conformer molecules OEIsomericConfTestThis implementation of OEConfTest combines subsequent connection tables into a multi conformer molecule if they Have the same title optional Have the same numbers of atoms and bonds in the same order Each atom and bond must have identical properties with its order correspondent in the subsequent connection table Have the same atom and bond stereochemistry No change to the connection table are made The constructor for OEIsomericConfTest has a default argument for whether or not to compare titles If the constructor is called with no arguments or with the argument true the titles will be required to be the same Otherwise the titles will not be compared In the latter instance each conformer will have the individual title of its original connection table and the multi conformer molecule will reflect the title of the active conformer OEAbsoluteConfTestThis implementation of OEConfTest combines subsequent connection tables into a multi conformer molecule if they Have the same title optional Have the same number of atoms and bonds in the same order Each atom and bond must have identical properties with its order correspondent in the subsequent connection table This conformer test sets all fully specified isomeric values to UNDEFINED The constructor for OEAbsoluteConfTest has a default argument for whether or not to compare titles If the constructor is called with no arguments or with the argument true the titles will be required to be the same Otherwise the titles will not be compared In the latter instance each conformer will have the individual title of its original connection table and the multi conformer molecule will reflect the title of the active conformer OEAbsCanonicalConfTestThis implementation of OEConfTest combines subsequent connection tables into a multi conformer molecule if they Have the same absolute non isomeric graph This conformer test puts all of the molecules in their canonical atom order In addition all fully specified isomeric values are set to UNDEFINED The following example will attempt to read multi conformer molecules from an input file based on OEAbsoluteConfTest Note that creating the instance of OEAbsoluteConfTest with the default constructor argument or false allows conformers to be combined when they have different titles This is very useful when dealing with files created by programs that modify molecule titles to indicate conformer number i e acetsali 1 acetsali 2 acetsali 3 The resulting multi conformer molecule will have the title associated with the first connection table read from the file include openeye h include oesystem h include oechem h using namespace OESystem using namespace OEChem int main OEIter OEMCMolBase mol oemolistream ims ims SetConfTest OEIsomericConfTest for mol ims GetMCMolBases mol mol cout mol GetTitle has mol NumConfs conformers endl return OEChem C Theory Manual Version 1 3 1 Previous 8 3 Conformers Up 8 OEMols and OEGraphMols Next 9 Atom Bond and Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/cplusprog/node106.html", "title": "8.4 reading multi-conformer molecules", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>8.4 Reading Multi-conformer molecules</title>\n<META NAME=\"description\" CONTENT=\"8.4 Reading Multi-conformer molecules\">\n<META NAME=\"keywords\" CONTENT=\"cplusprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"cplusprog.css\">\n<link rel=\"first\" href=\"cplusprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"previous\" HREF=\"node105.html\">\n<LINK REL=\"up\" HREF=\"node102.html\">\n<LINK REL=\"next\" HREF=\"node107.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node105.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node102.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node107.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node105.html\">8.3 Conformers</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node102.html\">8. OEMols and OEGraphMols</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node107.html\">9. Atom, Bond and</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION0011400000000000000000\">\n8.4 Reading Multi-conformer molecules</A>\n</H1>\n\n<P>\nMolecule streams, which were introduced above, can read both single and\nmulti-conformer molecules from any file format.\nMany of the file formats supported by OEChem are inherently a single\nconformer format (SDF and MOL2, for example).  However, a common\npractice is to store multiple conformers in these files. OEChem\nsupports a rather advanced mechanism for recovering these\n<i>separate</i> conformers into a single, multi-conformer OEMol.  Note\nthat this does not apply to file formats where conformers are stored\ntogether. For example, all molecules in old OEBinary file are\nmulti-conformer molecules. New OEBinary (.oeb) stores either single\nconformer or multi-conformer molecules explicitly so the file itself\ndetermines how to deal with conformers.  Additionally, file formats\nthat have no notion of conformers (<I>i.e.</I> SMILES files) are also\nunaffected by this feature.\n\n<P>\nIn early versions of OEChem, the default behavior for reading into an\nOEMol was to attempt to combine conformers of the same molecules\ntogether into a single OEMol. This is no longer the default, but is\ninstead something controlled by the programmer.\n\n<P>\noemolistreams have a method, <code>SetConfTest</code>, that sets a functor\nto be used to compare the graphs of incoming molecules to determine\nwhether to combine them.  These functors are instances of\nOEConfTest. Several predefined versions include:\n\n<P>\n<DL>\n<DT><STRONG>OEDefaultConfTest</STRONG></DT>\n<DD>Never combine connection tables into multi-conformer molecules.\n\n<P>\n</DD>\n<DT><STRONG>OEIsomericConfTest</STRONG></DT>\n<DD>This implementation of OEConfTest combines subsequent connection tables\ninto a multi-conformer molecule if they:\n\n<OL>\n<LI>Have the same title (optional)\n</LI>\n<LI>Have the same numbers of atoms and bonds in the same order\n</LI>\n<LI>Each atom and bond must have identical properties with its order\ncorrespondent in the subsequent connection table\n</LI>\n<LI>Have the same atom and bond stereochemistry\n</LI>\n</OL>\n\n<P>\nNo change to the connection table are made.\n\n<P>\nThe constructor for <code>OEIsomericConfTest</code> has a default argument for\nwhether or not to compare titles.  If the constructor is called with no\narguments\nor with the argument true, the titles will be required to be the same.\nOtherwise, the titles will not be compared.  In the latter instance, each\nconformer will have the individual title of its original connection table\nand the multi-conformer molecule will reflect the title of the active\nconformer.\n\n<P>\n</DD>\n<DT><STRONG>OEAbsoluteConfTest</STRONG></DT>\n<DD>This implementation of <code>OEConfTest</code> combines subsequent connection\ntables into a multi-conformer molecule if they:\n\n<OL>\n<LI>Have the same title (optional)\n</LI>\n<LI>Have the same number of atoms and bonds in the same order\n</LI>\n<LI>Each atom and bond must have identical properties with its order\ncorrespondent in the subsequent connection table\n</LI>\n</OL>\n\n<P>\nThis conformer test sets all fully specified isomeric values to\n<code>UNDEFINED</code>.\n\n<P>\nThe constructor for OEAbsoluteConfTest has a default argument for whether\nor not to compare titles.  If the constructor is called with no arguments\nor with the argument true, the titles will be required to be the same.\nOtherwise, the titles will not be compared.  In the latter instance, each\nconformer will have the individual title of its original connection table\nand the multi-conformer molecule will reflect the title of the active\nconformer.\n\n<P>\n</DD>\n<DT><STRONG>OEAbsCanonicalConfTest</STRONG></DT>\n<DD>This implementation of OEConfTest combines subsequent connection tables\ninto a multi-conformer molecule if they:\n\n<OL>\n<LI>Have the same absolute (non-isomeric) graph\n</LI>\n</OL>\n\n<P>\nThis conformer test puts all of the molecules in their canonical atom\norder.  In addition, all fully specified isomeric values are set to\nUNDEFINED.\n\n<P>\n</DD>\n</DL>\n\n<P>\nThe following example will attempt to read multi-conformer molecules\nfrom an input file based on OEAbsoluteConfTest. Note that creating the\ninstance of OEAbsoluteConfTest with the default constructor argument\n(0 or false), allows conformers to be combined when they have\ndifferent titles. This is very useful when dealing with files created\nby programs that modify molecule titles to indicate conformer number\n(<I>i.e.</I> acetsali_1, acetsali_2, acetsali_3). The resulting\nmulti-conformer molecule will have the title associated with the first\nconnection table read from the file.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#include \"openeye.h\"\n#include \"oesystem.h\"\n#include \"oechem.h\"\n\nusing namespace OESystem;\nusing namespace OEChem;\n\nint main()\n{\n  OEIter&lt;OEMCMolBase&gt; mol;\n  oemolistream ims;\n  ims.SetConfTest(OEIsomericConfTest());\n\n  for (mol=ims.GetMCMolBases(); mol; ++mol)\n  {\n    cout &lt;&lt; mol-&gt;GetTitle() &lt;&lt; \" has \" &lt;&lt; mol-&gt;NumConfs()\n         &lt;&lt; \" conformers\" &lt;&lt; endl;\n  }\n  return 0;\n}\n</pre></dl>\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node105.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node102.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node107.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node105.html\">8.3 Conformers</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node102.html\">8. OEMols and OEGraphMols</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node107.html\">9. Atom, Bond and</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 38408.0}