{"text": "OEChem Python Theory Manual Version 1 3 1 Previous 16 2 Working with Partial Up 16 Formal and Partial Next 16 4 Calculating Gasteiger Partial 16 3 Determining Net Charge on a Molecule The total or net charge on a molecule can be conveniently calculated by calling OEChem s OENetCharge function on a molecule If any of the atoms in the molecule has a non zero partial charge i e the function OEHasPartialCharges returns true this function returns the sum of the partial charges rounded to the nearest integer If the molecule doesn t have partial charges this function returns the sum of the formal charges on each atom This logic should return the total charge on the molecule if either formal or partial charges are present When both partial and formal charges are present partial charges take priority For valid partial charges the sum of the partial charges should always be an integer equal the sum of the formal charges so this preference typically won t matter However when reading from file formats that contain partial charges such as mol2 or Delphi PDB OEChem may be unable to correctly assign formal charges to each atom in which case the partial charges are often more trustworthy The following example contains two functions that determines whether a molecule is a cation or anion i e carries a formal positive or negative charge respectively def MyIsCation mol if OENetCharge mol return 1 return def MyIsAnion mol if OENetCharge mol return 1 return OEChem Python Theory Manual Version 1 3 1 Previous 16 2 Working with Partial Up 16 Formal and Partial Next 16 4 Calculating Gasteiger Partial Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/pyprog/node146.html", "title": "16.3 determining net charge on a molecule", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>16.3 Determining Net Charge on a Molecule</title>\n<META NAME=\"description\" CONTENT=\"16.3 Determining Net Charge on a Molecule\">\n<META NAME=\"keywords\" CONTENT=\"pyprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"pyprog.css\">\n<link rel=\"first\" href=\"pyprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"next\" HREF=\"node147.html\">\n<LINK REL=\"previous\" HREF=\"node145.html\">\n<LINK REL=\"up\" HREF=\"node143.html\">\n<LINK REL=\"next\" HREF=\"node147.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node145.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node143.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node147.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - Python Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"genindex.html\"><img src=\"../icons/index.gif\"\n  border=\"0\" alt=\"Index\"></A></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node145.html\">16.2 Working with Partial</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node143.html\">16. Formal and Partial</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node147.html\">16.4 Calculating Gasteiger Partial</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION0018300000000000000000\">\n16.3 Determining Net Charge on a Molecule</A>\n</H1>\n\n<P>\nThe total (or net) charge on a molecule can be conveniently calculated\nby calling OEChem's OENetCharge function on a molecule.  If any of the\natoms in the molecule has a non-zero partial charge, i.e. the function\nOEHasPartialCharges returns true, this function returns the sum of the\npartial charges rounded to the nearest integer.  If the molecule doesn't\nhave partial charges, this function returns the sum of the formal charges\non each atom.\n\n<P>\nThis logic should return the total charge on the molecule if either\nformal or partial charges are present.  When both partial and formal\ncharges are present, partial charges take priority.  For ``valid''\npartial charges, the sum of the partial charges should always be an\ninteger equal the sum of the formal charges, so this preference\ntypically won't matter.  However when reading from file formats that\ncontain partial charges, such as .mol2 or Delphi PDB, OEChem may be\nunable to correctly assign formal charges to each atom, in which case\nthe partial charges are often more trustworthy.\n\n<P>\nThe following example contains two functions that determines whether\na molecule is a cation or anion, i.e. carries a formal positive or\nnegative charge respectively.\n\n<P>\n<dl><dd><pre class=\"verbatim\">def MyIsCation(mol)\n    if OENetCharge(mol) &gt; 0:\n        return 1\n    return 0\n\ndef MyIsAnion(mol)\n    if OENetCharge(mol) &lt; 0:\n        return 1\n    return 0\n</pre></dl>\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node145.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node143.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node147.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - Python Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"genindex.html\"><img src=\"../icons/index.gif\"\n  border=\"0\" alt=\"Index\"></A></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node145.html\">16.2 Working with Partial</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node143.html\">16. Formal and Partial</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node147.html\">16.4 Calculating Gasteiger Partial</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 37821.0}