{"text": "View Javadoc 1 2 Created on Sep 2 2 4 3 4 To represent the whole work space including private space and public space 5 6 package swirl workspace viz pie 7 8 import java awt Point 9 import java util Iterator 1 import java util SortedMap 11 import java util TreeMap 12 import java util Map Entry 13 14 import org apache batik dom AbstractNode 15 import org apache batik dom svg ExtensibleSVGDOMImplementation 16 import org apache batik dom svg SVGDOMImplementation 17 import org apache batik util SVGConstants 18 import org apache commons logging Log 19 import org apache commons logging LogFactory 2 import org w3c dom DOMImplementation 21 import org w3c dom Element 22 import org w3c dom NamedNodeMap 23 import org w3c dom Node 24 import org w3c dom NodeList 25 import org w3c dom Text 26 import org w3c dom svg SVGDocument 27 28 import swirl workspace Peer 29 import swirl workspace PeerManager 3 import swirl workspace viz SharingLevel 31 32 33 DOCUMENT ME 34 35 author dingx 36 37 public class PieWorkSpace 38 39 TODO 4 public static String svgNS SVGDOMImplementation SVG NAMESPACE URI 41 42 TODO 43 public static final String TEXT PATH ID text path 44 45 TODO 46 public static final String FILE ROOT ID file root 47 48 TODO 49 public static final String DOT FILTER ID dot filter 5 51 TODO 52 private static final String USER ROOT ID user root 53 54 TODO 55 private static final String LOCAL MASK ID local mask 56 57 TODO 58 private static final String EXPLAIN PANEL explain panel 59 6 TODO 61 private static final String SWIRL ROOT PATH http localhost 9876 swirl 62 63 TODO 64 private static final String FILL COLOR grey 65 66 TODO 67 private static final String STROKE COLOR lightgrey 68 69 TODO 7 public static final double VIEW SIZE 9 71 72 TODO 73 public static final double RADIUS 34 74 75 TODO 76 private Element defGroup 77 78 TODO 79 private Element fileGroup 8 81 TODO 82 private Element defFilter 83 84 TODO 85 private Element maskLayer 86 87 TODO 88 private Element persisFileGroup 89 9 TODO 91 private Element persistentSpace 92 93 TODO 94 private Element privateSpace 95 96 TODO 97 private Element svgRoot 98 99 TODO 1 private Element userGroup 1 1 1 2 TODO 1 3 private Element explainpanel 1 4 1 5 TODO 1 6 private SortedMap guipeers new TreeMap 1 7 1 8 TODO 1 9 private Log log LogFactory getLog this getClass 11 111 TODO 112 private SVGDocument document 113 114 TODO 115 private SVGPieView svgview 116 private Text elabel 117 private Text etext 118 119 private int dotSize 8 12 121 private String localPeerID 122 123 124 DOCUMENT ME 125 126 param view 127 128 public PieWorkSpace SVGPieView view 129 13 svgview view 131 132 133 134 TODO 135 136 return TODO 137 138 public static Point getCenter 139 14 Point center new Point 141 142 center setLocation VIEW SIZE 2 VIEW SIZE 2 143 144 return center 145 146 147 148 DOCUMENT ME 149 15 return Returns the defGroup 151 152 public Element getDefGroup 153 154 return defGroup 155 156 157 158 TODO 159 16 return TODO 161 162 public SVGDocument getDocument 163 164 return document 165 166 167 168 DOCUMENT ME 169 17 return Returns the fileGroup 171 172 public Element getFileGroup 173 174 return fileGroup 175 176 177 178 TODO 179 18 return TODO 181 182 public GuiPeer getLocalPeer 183 184 GuiPeer guipeer GuiPeer guipeers get PeerManager getLocalUserID 185 186 return guipeer 187 188 189 19 DOCUMENT ME 191 192 return Returns the maskLayer 193 194 public Element getMaskLayer 195 196 return maskLayer 197 198 199 2 TODO 2 1 2 2 return TODO 2 3 2 4 public int getPeerNumber 2 5 2 6 return guipeers size 2 7 2 8 2 9 public int getPeerIndex String userID 21 211 SortedMap peersbefore guipeers headMap userID 212 int index peersbefore size 1 213 if log isDebugEnabled 214 215 log debug the user userID is the number index 216 217 return index 218 219 22 221 DOCUMENT ME 222 223 return Returns the persisFileGroup 224 225 public Element getPersisFileGroup 226 227 return persisFileGroup 228 229 23 231 DOCUMENT ME 232 233 return Returns the persistentSpace 234 235 public Element getPersistentSpace 236 237 return persistentSpace 238 239 24 241 DOCUMENT ME 242 243 return Returns the privateSpace 244 245 public Element getPrivateSpace 246 247 return privateSpace 248 249 25 251 DOCUMENT ME 252 253 return Returns the svgRoot 254 255 public Element getSvgRoot 256 257 return svgRoot 258 259 26 261 DOCUMENT ME 262 263 return Returns the userGroup 264 265 public Element getUserGroup 266 267 return userGroup 268 269 27 271 TODO 272 273 return TODO 274 275 public SVGPieView getView 276 277 return svgview 278 279 28 281 TODO 282 283 param fe TODO 284 285 public void addFile FileElement fe 286 287 String userID fe getOwnerKey 288 289 if log isDebugEnabled 29 291 log debug adding file for user userID 292 log debug fe sharinglevel fe getShareDegree getValue 293 294 295 GuiPeer peer GuiPeer guipeers get userID 296 297 peer addFile fe 298 299 3 3 1 TODO 3 2 3 3 param peer TODO 3 4 3 5 public void addPeer Peer peer 3 6 3 7 String key peer getUniqueID 3 8 3 9 if guipeers get key null 31 311 if log isDebugEnabled 312 313 log debug User already exist key 314 315 return 316 317 318 GuiPeer guipeer new GuiPeer peer document this 319 guipeers put key guipeer 32 adjustPeers getPeerNumber 321 wait 322 323 324 325 TODO 326 327 public void init 328 329 DOMImplementation impl ExtensibleSVGDOMImplementation 33 getDOMImplementation 331 332 document SVGDocument impl createDocument svgNS svg null 333 svgRoot document getDocumentElement 334 335 set the viewbox on the root svg element 336 String t String valueOf VIEW SIZE 337 String valueOf VIEW SIZE 338 339 svgRoot setAttributeNS null viewBox t 34 defGroup document createElementNS svgNS defs 341 userGroup document createElementNS svgNS g 342 fileGroup document createElementNS svgNS g 343 maskLayer document createElementNS svgNS g 344 explainpanel document createElementNS svgNS g 345 346 userGroup setAttributeNS null id USER ROOT ID 347 fileGroup setAttributeNS null id FILE ROOT ID 348 maskLayer setAttributeNS null id LOCAL MASK ID 349 explainpanel setAttributeNS null id EXPLAIN PANEL 35 351 String data 352 document createCDATASection data 353 354 AbstractNode maskLayer addEventListener SVGConstants SVG MOUSEMOVE EVENT TYPE 355 svgview getMouseEvent 356 false 357 358 add an empty textpath reference to start 359 Element path document createElementNS svgNS path 36 361 path setAttributeNS null id TEXT PATH ID 362 path setAttributeNS null d 363 defGroup appendChild path 364 365 appendFilter 366 they need to be appended in this sequence 367 svgRoot appendChild defGroup 368 addPrivateSpace 369 svgRoot appendChild userGroup 37 addPersistentSpace 371 svgRoot appendChild maskLayer 372 addExplainPanel 373 svgRoot appendChild explainpanel 374 svgRoot appendChild fileGroup 375 376 377 AbstractNode svgRoot addEventListener SVGConstants SVG MOUSEUP EVENT TYPE 378 svgview getMouseEvent false 379 38 381 382 383 TODO 384 385 param peerKey TODO 386 387 public void removePeer String peerKey 388 389 GuiPeer guipeer GuiPeer guipeers get peerKey 39 391 if guipeer null 392 393 guipeer detach 394 guipeers remove peerKey 395 adjustPeers getPeerNumber 396 397 398 else 399 4 if log isDebugEnabled 4 1 4 2 log debug User does not exist peerKey 4 3 4 4 4 5 4 6 4 7 4 8 TODO 4 9 41 private void addPersistentSpace 411 412 caculate the radius of the public circle 413 double radi Util getRadium SharingLevel SHARING LEVEL 414 String transform Util getTranslateString getCenter getX 415 getCenter getY 416 417 Element persistentCircle document createElementNS svgNS circle 418 if log isDebugEnabled 419 42 log debug radi radi 421 422 persistentCircle setAttributeNS null r String valueOf radi 423 persistentCircle setAttributeNS null stroke STROKE COLOR 424 persistentCircle setAttributeNS null fill FILL COLOR 425 persistentCircle setAttributeNS null transform transform 426 persistentCircle setAttributeNS null id 427 PeerManager getLocalUserID 428 SharingLevel SHARING LEVEL 429 43 svgRoot appendChild persistentCircle 431 432 Node clone persistentCircle cloneNode true 433 434 Element clone removeAttribute fill 435 Element clone removeAttribute stroke 436 maskLayer appendChild clone 437 438 439 44 TODO 441 442 private void appendFilter 443 444 defFilter document createElementNS svgNS filter 445 defFilter setAttributeNS null id DOT FILTER ID 446 defFilter setAttributeNS null filterUnits objectBoundingBox 447 defFilter setAttributeNS null width 4 8 448 defFilter setAttributeNS null height 4 8 449 45 451 Element feGaussianBlur document createElementNS svgNS feGaussianBlur 452 feGaussianBlur setAttributeNS null in SourceAlpha 453 feGaussianBlur setAttributeNS null stdDeviation 8 454 feGaussianBlur setAttributeNS null result blur 455 defFilter appendChild feGaussianBlur 456 457 458 Element feOffset document createElementNS svgNS feOffset 459 feOffset setAttributeNS null in blur 46 feOffset setAttributeNS null dx 3 461 feOffset setAttributeNS null dy 3 462 feOffset setAttributeNS null result offsetBlur 463 defFilter appendChild feOffset 464 465 Element feComponentTransfer document createElementNS svgNS feComponentTransfer 466 feComponentTransfer setAttributeNS null result shadow 467 defFilter appendChild feComponentTransfer 468 469 Element feFuncA document createElementNS svgNS feFuncA 47 feFuncA setAttributeNS null type linear 471 feFuncA setAttributeNS null slope 5 472 feFuncA setAttributeNS null intercept 473 feComponentTransfer appendChild feFuncA 474 475 Element feComposite document createElementNS svgNS feComposite 476 feComposite setAttributeNS null in2 shadow 477 feComposite setAttributeNS null in SourceGraphic 478 defFilter appendChild feComposite 479 48 Element feSpecularLighting document createElementNS svgNS feSpecularLighting 481 feSpecularLighting setAttributeNS null in blur 482 feSpecularLighting setAttributeNS null surfaceScale 5 483 feSpecularLighting setAttributeNS null specularConstant 75 484 feSpecularLighting setAttributeNS null specularExponent 2 485 feSpecularLighting setAttributeNS null lighting color bbbbbb 486 feSpecularLighting setAttributeNS null result specOut 487 defFilter appendChild feSpecularLighting 488 489 Element fePointLight document createElementNS svgNS fePointLight 49 fePointLight setAttributeNS null x 5 491 fePointLight setAttributeNS null y 1 492 fePointLight setAttributeNS null z 2 493 feSpecularLighting appendChild fePointLight 494 495 Element feComposite1 document createElementNS svgNS feComposite 496 feComposite1 setAttributeNS null in specOut 497 feComposite1 setAttributeNS null in2 SourceAlpha 498 feComposite1 setAttributeNS null operator in 499 feComposite1 setAttributeNS null result specOut 5 defFilter appendChild feComposite1 5 1 5 2 Element feComposite2 document createElementNS svgNS feComposite 5 3 feComposite2 setAttributeNS null in SourceGraphic 5 4 feComposite2 setAttributeNS null in2 specOut 5 5 feComposite2 setAttributeNS null operator arithmetic 5 6 feComposite2 setAttributeNS null k1 5 7 feComposite2 setAttributeNS null k2 1 5 8 feComposite2 setAttributeNS null k3 1 5 9 feComposite2 setAttributeNS null k4 51 feComposite2 setAttributeNS null result litPaint 511 defFilter appendChild feComposite2 512 513 Element feMerge document createElementNS svgNS feMerge 514 515 Element feMergeNode1 document createElementNS svgNS feMergeNode 516 feMergeNode1 setAttributeNS null in shadow 517 feMerge appendChild feMergeNode1 518 519 Element feMergeNode2 document createElementNS svgNS feMergeNode 52 feMergeNode2 setAttributeNS null in litPaint 521 feMerge appendChild feMergeNode2 522 defFilter appendChild feMerge 523 524 defGroup appendChild defFilter 525 526 527 528 529 TODO 53 531 private void addPrivateSpace 532 533 Element privateSpace document createElementNS svgNS rect 534 535 privateSpace setAttributeNS null id 536 PeerManager getLocalUserID 537 privateSpace setAttributeNS null fill lightgray 538 privateSpace setAttributeNS null width 539 String valueOf String valueOf VIEW SIZE 54 privateSpace setAttributeNS null height 541 String valueOf String valueOf VIEW SIZE 542 AbstractNode privateSpace addEventListener SVGConstants SVG MOUSEMOVE EVENT TYPE 543 svgview getMouseEvent 544 false 545 userGroup appendChild privateSpace 546 547 548 549 TODO 55 551 private void addExplainPanel 552 553 Element background document createElementNS svgNS rect 554 555 background setAttributeNS null fill lightgray 556 background setAttributeNS null width 25 557 background setAttributeNS null height 6 558 background setAttributeNS null style 559 fill FFEF95 fill opacity 5 stroke white 56 561 Element textg document createElementNS svgNS g 562 textg setAttributeNS null style font size 25 563 Element label document createElementNS svgNS text 564 label setAttributeNS null x 2 565 label setAttributeNS null y 3 566 elabel document createTextNode 567 label appendChild elabel 568 569 Element text document createElementNS svgNS text 57 text setAttributeNS null id varSecurity 571 text setAttributeNS null x 2 572 text setAttributeNS null y 45 573 etext document createTextNode Swirl Impromptu 574 575 text appendChild etext 576 577 explainpanel appendChild background 578 explainpanel appendChild label 579 explainpanel appendChild text 58 581 582 583 TODO 584 585 param peerNumber TODO 586 587 return TODO 588 589 private double adjustPeers int peerNumber 59 591 change the paths for the user name text 592 Node tpnode document getElementById PieWorkSpace TEXT PATH ID 593 NamedNodeMap tpmap tpnode getAttributes 594 595 make the text at the outer of the circle 596 String d Util caculateDforPath PieWorkSpace RADIUS 5 597 getPeerNumber 598 599 tpmap getNamedItem d setNodeValue d 6 in order to redraw the user name 6 1 NodeList textl userGroup getElementsByTagName text 6 2 for int i i textl getLength i 6 3 6 4 Node tn textl item i 6 5 Element parent Element tn getParentNode 6 6 6 7 parent removeChild tn 6 8 parent appendChild tn 6 9 61 611 change the actual paths 612 double start D 613 for Iterator it guipeers entrySet iterator it hasNext 614 615 Entry entry Entry it next 616 GuiPeer guipeer GuiPeer entry getValue 617 double arcAngle Util getAngle peerNumber 618 if it is the last one 619 if it hasNext 62 arcAngle 359 9 start 621 622 623 start guipeer adjustAngle start arcAngle 624 625 626 return start 627 628 629 63 param fileKey 631 param userID 632 633 public void removeFile String fileKey String userID 634 GuiPeer guipeer GuiPeer guipeers get userID 635 guipeer removeFile fileKey 636 637 638 639 64 param userId 641 return 642 643 public GuiPeer getGuiPeer String userId 644 GuiPeer guiPeer 645 return guiPeer GuiPeer guipeers get userId 646 647 648 649 param fileElement 65 param newLevel 651 652 public void setSharingText String name SharingLevel newLevel 653 elabel setData name 654 655 if etext getLength 656 etext deleteData etext getLength 657 658 etext appendData FileElement getTextSharingLevel newLevel 659 66 661 662 public int incrementDotSize 663 664 dotSize 1 5 665 setDotSize dotSize 666 667 return dotSize 668 669 67 public void setDotSize int dotSizer 671 672 if log isDebugEnabled 673 674 log debug dotSize dotSize 675 log debug guipeers guipeers 676 677 for Iterator it guipeers values iterator it hasNext 678 679 GuiPeer peer GuiPeer it next 68 if log isDebugEnabled 681 682 log debug peer peer 683 684 peer setDotSize dotSize 685 686 687 688 public int decrementDotSize 689 69 if dotSize 5 691 692 dotSize float 1 1 5 693 setDotSize dotSize 694 695 696 return dotSize 697 698 699 7 return 7 1 7 2 public int getDotSize 7 3 if log isDebugEnabled 7 4 7 5 log debug dotSize dotSize 7 6 7 7 return dotSize 7 8 7 9 71 public void moveExplainText double x double y 711 double textX VIEW SIZE 2 x 1 712 double textY VIEW SIZE 2 y 1 713 explainpanel setAttributeNS null transform translate textX textY 714 715 716 public void revealTag 717 this explainpanel setAttributeNS null style visibility visible 718 719 72 721 public void hideTag 722 this explainpanel setAttributeNS null style visibility hidden 723 724 725 This page was automatically generated by Maven", "_id": "http://drzaius.ics.uci.edu/~swirl/impromptu-0.20/xref/swirl/workspace/viz/pie/PieWorkSpace.html", "title": "pieworkspace xref", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=ISO-8859-1\" /><title>PieWorkSpace xref</title>\n<link type=\"text/css\" rel=\"stylesheet\" href=\"../../../../stylesheet.css\" />\n</head>\n<body>\n<div id=\"overview\"><a href=\"../../../../../apidocs/swirl/workspace/viz/pie/PieWorkSpace.html\">View Javadoc</a></div><pre>\n\n<a name=\"1\" href=\"#1\">1</a>   <em class=\"comment\">/*</em>\n<a name=\"2\" href=\"#2\">2</a>   <em class=\"comment\"> * Created on Sep 2, 2004</em>\n<a name=\"3\" href=\"#3\">3</a>   <em class=\"comment\"> *</em>\n<a name=\"4\" href=\"#4\">4</a>   <em class=\"comment\"> * To represent the whole work space including private space and public space</em>\n<a name=\"5\" href=\"#5\">5</a>   <em class=\"comment\"> */</em>\n<a name=\"6\" href=\"#6\">6</a>   <strong>package</strong> <a href=\"../../../../swirl/workspace/viz/pie/package-summary.html\">swirl.workspace.viz.pie</a>;\n<a name=\"7\" href=\"#7\">7</a>   \n<a name=\"8\" href=\"#8\">8</a>   <strong>import</strong> java.awt.Point;\n<a name=\"9\" href=\"#9\">9</a>   <strong>import</strong> java.util.Iterator;\n<a name=\"10\" href=\"#10\">10</a>  <strong>import</strong> java.util.SortedMap;\n<a name=\"11\" href=\"#11\">11</a>  <strong>import</strong> java.util.TreeMap;\n<a name=\"12\" href=\"#12\">12</a>  <strong>import</strong> java.util.Map.Entry;\n<a name=\"13\" href=\"#13\">13</a>  \n<a name=\"14\" href=\"#14\">14</a>  <strong>import</strong> org.apache.batik.dom.AbstractNode;\n<a name=\"15\" href=\"#15\">15</a>  <strong>import</strong> org.apache.batik.dom.svg.ExtensibleSVGDOMImplementation;\n<a name=\"16\" href=\"#16\">16</a>  <strong>import</strong> org.apache.batik.dom.svg.SVGDOMImplementation;\n<a name=\"17\" href=\"#17\">17</a>  <strong>import</strong> org.apache.batik.util.SVGConstants;\n<a name=\"18\" href=\"#18\">18</a>  <strong>import</strong> org.apache.commons.logging.Log;\n<a name=\"19\" href=\"#19\">19</a>  <strong>import</strong> org.apache.commons.logging.LogFactory;\n<a name=\"20\" href=\"#20\">20</a>  <strong>import</strong> org.w3c.dom.DOMImplementation;\n<a name=\"21\" href=\"#21\">21</a>  <strong>import</strong> org.w3c.dom.Element;\n<a name=\"22\" href=\"#22\">22</a>  <strong>import</strong> org.w3c.dom.NamedNodeMap;\n<a name=\"23\" href=\"#23\">23</a>  <strong>import</strong> org.w3c.dom.Node;\n<a name=\"24\" href=\"#24\">24</a>  <strong>import</strong> org.w3c.dom.NodeList;\n<a name=\"25\" href=\"#25\">25</a>  <strong>import</strong> org.w3c.dom.Text;\n<a name=\"26\" href=\"#26\">26</a>  <strong>import</strong> org.w3c.dom.svg.SVGDocument;\n<a name=\"27\" href=\"#27\">27</a>  \n<a name=\"28\" href=\"#28\">28</a>  <strong>import</strong> swirl.workspace.Peer;\n<a name=\"29\" href=\"#29\">29</a>  <strong>import</strong> swirl.workspace.PeerManager;\n<a name=\"30\" href=\"#30\">30</a>  <strong>import</strong> swirl.workspace.viz.SharingLevel;\n<a name=\"31\" href=\"#31\">31</a>  \n<a name=\"32\" href=\"#32\">32</a>  <em>/**<em>*</em></em>\n<a name=\"33\" href=\"#33\">33</a>  <em> * DOCUMENT ME!</em>\n<a name=\"34\" href=\"#34\">34</a>  <em> *</em>\n<a name=\"35\" href=\"#35\">35</a>  <em> * @author dingx</em>\n<a name=\"36\" href=\"#36\">36</a>  <em> */</em>\n<a name=\"37\" href=\"#37\">37</a>  <strong>public</strong> <strong>class</strong> <a href=\"../../../../swirl/workspace/viz/pie/PieWorkSpace.html\">PieWorkSpace</a>\n<a name=\"38\" href=\"#38\">38</a>  {\n<a name=\"39\" href=\"#39\">39</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"40\" href=\"#40\">40</a>      <strong>public</strong> <strong>static</strong> String svgNS = SVGDOMImplementation.SVG_NAMESPACE_URI;\n<a name=\"41\" href=\"#41\">41</a>  \n<a name=\"42\" href=\"#42\">42</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"43\" href=\"#43\">43</a>      <strong>public</strong> <strong>static</strong> <strong>final</strong> String TEXT_PATH_ID = <span class=\"string\">\"text_path\"</span>;\n<a name=\"44\" href=\"#44\">44</a>  \n<a name=\"45\" href=\"#45\">45</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"46\" href=\"#46\">46</a>      <strong>public</strong> <strong>static</strong> <strong>final</strong> String FILE_ROOT_ID = <span class=\"string\">\"file_root\"</span>;\n<a name=\"47\" href=\"#47\">47</a>      \n<a name=\"48\" href=\"#48\">48</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"49\" href=\"#49\">49</a>      <strong>public</strong> <strong>static</strong> <strong>final</strong> String DOT_FILTER_ID = <span class=\"string\">\"dot_filter\"</span>;\n<a name=\"50\" href=\"#50\">50</a>  \n<a name=\"51\" href=\"#51\">51</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"52\" href=\"#52\">52</a>      <strong>private</strong> <strong>static</strong> <strong>final</strong> String USER_ROOT_ID = <span class=\"string\">\"user_root\"</span>;\n<a name=\"53\" href=\"#53\">53</a>  \n<a name=\"54\" href=\"#54\">54</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"55\" href=\"#55\">55</a>      <strong>private</strong> <strong>static</strong> <strong>final</strong> String LOCAL_MASK_ID = <span class=\"string\">\"local_mask\"</span>;\n<a name=\"56\" href=\"#56\">56</a>      \n<a name=\"57\" href=\"#57\">57</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"58\" href=\"#58\">58</a>      <strong>private</strong> <strong>static</strong> <strong>final</strong> String EXPLAIN_PANEL = <span class=\"string\">\"explain_panel\"</span>;\n<a name=\"59\" href=\"#59\">59</a>  \n<a name=\"60\" href=\"#60\">60</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"61\" href=\"#61\">61</a>      <strong>private</strong> <strong>static</strong> <strong>final</strong> String SWIRL_ROOT_PATH = <span class=\"string\">\"http://localhost:9876/swirl\"</span>;\n<a name=\"62\" href=\"#62\">62</a>  \n<a name=\"63\" href=\"#63\">63</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"64\" href=\"#64\">64</a>      <strong>private</strong> <strong>static</strong> <strong>final</strong> String FILL_COLOR = <span class=\"string\">\"grey\"</span>;\n<a name=\"65\" href=\"#65\">65</a>  \n<a name=\"66\" href=\"#66\">66</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"67\" href=\"#67\">67</a>      <strong>private</strong> <strong>static</strong> <strong>final</strong> String STROKE_COLOR = <span class=\"string\">\"lightgrey\"</span>;\n<a name=\"68\" href=\"#68\">68</a>  \n<a name=\"69\" href=\"#69\">69</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"70\" href=\"#70\">70</a>      <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>double</strong> VIEW_SIZE = 900;\n<a name=\"71\" href=\"#71\">71</a>  \n<a name=\"72\" href=\"#72\">72</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"73\" href=\"#73\">73</a>      <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>double</strong> RADIUS = 340;\n<a name=\"74\" href=\"#74\">74</a>  \n<a name=\"75\" href=\"#75\">75</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"76\" href=\"#76\">76</a>      <strong>private</strong> Element defGroup;\n<a name=\"77\" href=\"#77\">77</a>  \n<a name=\"78\" href=\"#78\">78</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"79\" href=\"#79\">79</a>      <strong>private</strong> Element fileGroup;\n<a name=\"80\" href=\"#80\">80</a>  \n<a name=\"81\" href=\"#81\">81</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"82\" href=\"#82\">82</a>      <strong>private</strong> Element defFilter;\n<a name=\"83\" href=\"#83\">83</a>      \n<a name=\"84\" href=\"#84\">84</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"85\" href=\"#85\">85</a>      <strong>private</strong> Element maskLayer;\n<a name=\"86\" href=\"#86\">86</a>  \n<a name=\"87\" href=\"#87\">87</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"88\" href=\"#88\">88</a>      <strong>private</strong> Element persisFileGroup;\n<a name=\"89\" href=\"#89\">89</a>  \n<a name=\"90\" href=\"#90\">90</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"91\" href=\"#91\">91</a>      <strong>private</strong> Element persistentSpace;\n<a name=\"92\" href=\"#92\">92</a>  \n<a name=\"93\" href=\"#93\">93</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"94\" href=\"#94\">94</a>      <strong>private</strong> Element <strong>private</strong>Space;\n<a name=\"95\" href=\"#95\">95</a>  \n<a name=\"96\" href=\"#96\">96</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"97\" href=\"#97\">97</a>      <strong>private</strong> Element svgRoot;\n<a name=\"98\" href=\"#98\">98</a>  \n<a name=\"99\" href=\"#99\">99</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"100\" href=\"#100\">100</a>     <strong>private</strong> Element userGroup;\n<a name=\"101\" href=\"#101\">101</a>     \n<a name=\"102\" href=\"#102\">102</a>     <em>/**<em>* TODO */</em></em>\n<a name=\"103\" href=\"#103\">103</a>     <strong>private</strong> Element  explainpanel;\n<a name=\"104\" href=\"#104\">104</a> \t\n<a name=\"105\" href=\"#105\">105</a>     <em>/**<em>* TODO */</em></em>\n<a name=\"106\" href=\"#106\">106</a>     <strong>private</strong> SortedMap guipeers = <strong>new</strong> TreeMap();\n<a name=\"107\" href=\"#107\">107</a> \n<a name=\"108\" href=\"#108\">108</a>     <em>/**<em>* TODO */</em></em>\n<a name=\"109\" href=\"#109\">109</a>     <strong>private</strong> Log log = LogFactory.getLog(<strong>this</strong>.getClass());\n<a name=\"110\" href=\"#110\">110</a> \n<a name=\"111\" href=\"#111\">111</a>     <em>/**<em>* TODO */</em></em>\n<a name=\"112\" href=\"#112\">112</a>     <strong>private</strong> SVGDocument document;\n<a name=\"113\" href=\"#113\">113</a> \n<a name=\"114\" href=\"#114\">114</a>     <em>/**<em>* TODO */</em></em>\n<a name=\"115\" href=\"#115\">115</a>     <strong>private</strong> <a href=\"../../../../swirl/workspace/viz/pie/SVGPieView.html\">SVGPieView</a> svgview;\n<a name=\"116\" href=\"#116\">116</a>     <strong>private</strong> Text elabel;\n<a name=\"117\" href=\"#117\">117</a> \t<strong>private</strong> Text etext;\n<a name=\"118\" href=\"#118\">118</a> \n<a name=\"119\" href=\"#119\">119</a> \t<strong>private</strong> <strong>int</strong> dotSize = 8;\n<a name=\"120\" href=\"#120\">120</a> \t\n<a name=\"121\" href=\"#121\">121</a>     <em class=\"comment\">//private String localPeerID;</em>\n<a name=\"122\" href=\"#122\">122</a> \n<a name=\"123\" href=\"#123\">123</a>     <em>/**<em>*</em></em>\n<a name=\"124\" href=\"#124\">124</a> <em>     * DOCUMENT ME!</em>\n<a name=\"125\" href=\"#125\">125</a> <em>     *</em>\n<a name=\"126\" href=\"#126\">126</a> <em>     * @param view</em>\n<a name=\"127\" href=\"#127\">127</a> <em>     */</em>\n<a name=\"128\" href=\"#128\">128</a>     <strong>public</strong> <a href=\"../../../../swirl/workspace/viz/pie/PieWorkSpace.html\">PieWorkSpace</a>(<a href=\"../../../../swirl/workspace/viz/pie/SVGPieView.html\">SVGPieView</a> view)\n<a name=\"129\" href=\"#129\">129</a>     {\n<a name=\"130\" href=\"#130\">130</a>         svgview = view;\n<a name=\"131\" href=\"#131\">131</a>     }\n<a name=\"132\" href=\"#132\">132</a> \n<a name=\"133\" href=\"#133\">133</a>     <em>/**<em>*</em></em>\n<a name=\"134\" href=\"#134\">134</a> <em>     * TODO</em>\n<a name=\"135\" href=\"#135\">135</a> <em>     *</em>\n<a name=\"136\" href=\"#136\">136</a> <em>     * @return TODO</em>\n<a name=\"137\" href=\"#137\">137</a> <em>     */</em>\n<a name=\"138\" href=\"#138\">138</a>     <strong>public</strong> <strong>static</strong> Point getCenter()\n<a name=\"139\" href=\"#139\">139</a>     {\n<a name=\"140\" href=\"#140\">140</a>         Point center = <strong>new</strong> Point();\n<a name=\"141\" href=\"#141\">141</a> \n<a name=\"142\" href=\"#142\">142</a>         center.setLocation(VIEW_SIZE / 2, VIEW_SIZE / 2);\n<a name=\"143\" href=\"#143\">143</a> \n<a name=\"144\" href=\"#144\">144</a>         <strong>return</strong> center;\n<a name=\"145\" href=\"#145\">145</a>     }\n<a name=\"146\" href=\"#146\">146</a> \n<a name=\"147\" href=\"#147\">147</a>     <em>/**<em>*</em></em>\n<a name=\"148\" href=\"#148\">148</a> <em>     * DOCUMENT ME!</em>\n<a name=\"149\" href=\"#149\">149</a> <em>     *</em>\n<a name=\"150\" href=\"#150\">150</a> <em>     * @return Returns the defGroup.</em>\n<a name=\"151\" href=\"#151\">151</a> <em>     */</em>\n<a name=\"152\" href=\"#152\">152</a>     <strong>public</strong> Element getDefGroup()\n<a name=\"153\" href=\"#153\">153</a>     {\n<a name=\"154\" href=\"#154\">154</a>         <strong>return</strong> defGroup;\n<a name=\"155\" href=\"#155\">155</a>     }\n<a name=\"156\" href=\"#156\">156</a> \n<a name=\"157\" href=\"#157\">157</a>     <em>/**<em>*</em></em>\n<a name=\"158\" href=\"#158\">158</a> <em>     * TODO</em>\n<a name=\"159\" href=\"#159\">159</a> <em>     *</em>\n<a name=\"160\" href=\"#160\">160</a> <em>     * @return TODO</em>\n<a name=\"161\" href=\"#161\">161</a> <em>     */</em>\n<a name=\"162\" href=\"#162\">162</a>     <strong>public</strong> SVGDocument getDocument()\n<a name=\"163\" href=\"#163\">163</a>     {\n<a name=\"164\" href=\"#164\">164</a>         <strong>return</strong> document;\n<a name=\"165\" href=\"#165\">165</a>     }\n<a name=\"166\" href=\"#166\">166</a> \n<a name=\"167\" href=\"#167\">167</a>     <em>/**<em>*</em></em>\n<a name=\"168\" href=\"#168\">168</a> <em>     * DOCUMENT ME!</em>\n<a name=\"169\" href=\"#169\">169</a> <em>     *</em>\n<a name=\"170\" href=\"#170\">170</a> <em>     * @return Returns the fileGroup.</em>\n<a name=\"171\" href=\"#171\">171</a> <em>     */</em>\n<a name=\"172\" href=\"#172\">172</a>     <strong>public</strong> Element getFileGroup()\n<a name=\"173\" href=\"#173\">173</a>     {\n<a name=\"174\" href=\"#174\">174</a>         <strong>return</strong> fileGroup;\n<a name=\"175\" href=\"#175\">175</a>     }\n<a name=\"176\" href=\"#176\">176</a> \n<a name=\"177\" href=\"#177\">177</a>     <em>/**<em>*</em></em>\n<a name=\"178\" href=\"#178\">178</a> <em>     * TODO</em>\n<a name=\"179\" href=\"#179\">179</a> <em>     *</em>\n<a name=\"180\" href=\"#180\">180</a> <em>     * @return TODO</em>\n<a name=\"181\" href=\"#181\">181</a> <em>     */</em>\n<a name=\"182\" href=\"#182\">182</a>     <strong>public</strong> <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a> getLocalPeer()\n<a name=\"183\" href=\"#183\">183</a>     {\n<a name=\"184\" href=\"#184\">184</a>         <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a> guipeer = (GuiPeer)guipeers.get(PeerManager.getLocalUserID());\n<a name=\"185\" href=\"#185\">185</a> \n<a name=\"186\" href=\"#186\">186</a>         <strong>return</strong> guipeer;\n<a name=\"187\" href=\"#187\">187</a>     }\n<a name=\"188\" href=\"#188\">188</a> \n<a name=\"189\" href=\"#189\">189</a>     <em>/**<em>*</em></em>\n<a name=\"190\" href=\"#190\">190</a> <em>     * DOCUMENT ME!</em>\n<a name=\"191\" href=\"#191\">191</a> <em>     *</em>\n<a name=\"192\" href=\"#192\">192</a> <em>     * @return Returns the maskLayer.</em>\n<a name=\"193\" href=\"#193\">193</a> <em>     */</em>\n<a name=\"194\" href=\"#194\">194</a>     <strong>public</strong> Element getMaskLayer()\n<a name=\"195\" href=\"#195\">195</a>     {\n<a name=\"196\" href=\"#196\">196</a>         <strong>return</strong> maskLayer;\n<a name=\"197\" href=\"#197\">197</a>     }\n<a name=\"198\" href=\"#198\">198</a> \n<a name=\"199\" href=\"#199\">199</a>     <em>/**<em>*</em></em>\n<a name=\"200\" href=\"#200\">200</a> <em>     * TODO</em>\n<a name=\"201\" href=\"#201\">201</a> <em>     *</em>\n<a name=\"202\" href=\"#202\">202</a> <em>     * @return TODO</em>\n<a name=\"203\" href=\"#203\">203</a> <em>     */</em>\n<a name=\"204\" href=\"#204\">204</a>     <strong>public</strong> <strong>int</strong> getPeerNumber()\n<a name=\"205\" href=\"#205\">205</a>     {\n<a name=\"206\" href=\"#206\">206</a>         <strong>return</strong> guipeers.size();\n<a name=\"207\" href=\"#207\">207</a>     }\n<a name=\"208\" href=\"#208\">208</a> \n<a name=\"209\" href=\"#209\">209</a>     <strong>public</strong> <strong>int</strong> getPeerIndex(String userID)\n<a name=\"210\" href=\"#210\">210</a>     {\n<a name=\"211\" href=\"#211\">211</a>         SortedMap peersbefore = guipeers.headMap(userID);\n<a name=\"212\" href=\"#212\">212</a>         <strong>int</strong> index = peersbefore.size()+1;\n<a name=\"213\" href=\"#213\">213</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"214\" href=\"#214\">214</a>         {\n<a name=\"215\" href=\"#215\">215</a>         \tlog.debug(<span class=\"string\">\"the user \"</span> + userID + <span class=\"string\">\" is the number \"</span> + index);\n<a name=\"216\" href=\"#216\">216</a>         }\n<a name=\"217\" href=\"#217\">217</a>         <strong>return</strong> index;\n<a name=\"218\" href=\"#218\">218</a>     }\n<a name=\"219\" href=\"#219\">219</a> \n<a name=\"220\" href=\"#220\">220</a>     <em>/**<em>*</em></em>\n<a name=\"221\" href=\"#221\">221</a> <em>     * DOCUMENT ME!</em>\n<a name=\"222\" href=\"#222\">222</a> <em>     *</em>\n<a name=\"223\" href=\"#223\">223</a> <em>     * @return Returns the persisFileGroup.</em>\n<a name=\"224\" href=\"#224\">224</a> <em>     */</em>\n<a name=\"225\" href=\"#225\">225</a>     <strong>public</strong> Element getPersisFileGroup()\n<a name=\"226\" href=\"#226\">226</a>     {\n<a name=\"227\" href=\"#227\">227</a>         <strong>return</strong> persisFileGroup;\n<a name=\"228\" href=\"#228\">228</a>     }\n<a name=\"229\" href=\"#229\">229</a> \n<a name=\"230\" href=\"#230\">230</a>     <em>/**<em>*</em></em>\n<a name=\"231\" href=\"#231\">231</a> <em>     * DOCUMENT ME!</em>\n<a name=\"232\" href=\"#232\">232</a> <em>     *</em>\n<a name=\"233\" href=\"#233\">233</a> <em>     * @return Returns the persistentSpace.</em>\n<a name=\"234\" href=\"#234\">234</a> <em>     */</em>\n<a name=\"235\" href=\"#235\">235</a>     <strong>public</strong> Element getPersistentSpace()\n<a name=\"236\" href=\"#236\">236</a>     {\n<a name=\"237\" href=\"#237\">237</a>         <strong>return</strong> persistentSpace;\n<a name=\"238\" href=\"#238\">238</a>     }\n<a name=\"239\" href=\"#239\">239</a> \n<a name=\"240\" href=\"#240\">240</a>     <em>/**<em>*</em></em>\n<a name=\"241\" href=\"#241\">241</a> <em>     * DOCUMENT ME!</em>\n<a name=\"242\" href=\"#242\">242</a> <em>     *</em>\n<a name=\"243\" href=\"#243\">243</a> <em>     * @return Returns the privateSpace.</em>\n<a name=\"244\" href=\"#244\">244</a> <em>     */</em>\n<a name=\"245\" href=\"#245\">245</a>     <strong>public</strong> Element getPrivateSpace()\n<a name=\"246\" href=\"#246\">246</a>     {\n<a name=\"247\" href=\"#247\">247</a>         <strong>return</strong> privateSpace;\n<a name=\"248\" href=\"#248\">248</a>     }\n<a name=\"249\" href=\"#249\">249</a> \n<a name=\"250\" href=\"#250\">250</a>     <em>/**<em>*</em></em>\n<a name=\"251\" href=\"#251\">251</a> <em>     * DOCUMENT ME!</em>\n<a name=\"252\" href=\"#252\">252</a> <em>     *</em>\n<a name=\"253\" href=\"#253\">253</a> <em>     * @return Returns the svgRoot.</em>\n<a name=\"254\" href=\"#254\">254</a> <em>     */</em>\n<a name=\"255\" href=\"#255\">255</a>     <strong>public</strong> Element getSvgRoot()\n<a name=\"256\" href=\"#256\">256</a>     {\n<a name=\"257\" href=\"#257\">257</a>         <strong>return</strong> svgRoot;\n<a name=\"258\" href=\"#258\">258</a>     }\n<a name=\"259\" href=\"#259\">259</a> \n<a name=\"260\" href=\"#260\">260</a>     <em>/**<em>*</em></em>\n<a name=\"261\" href=\"#261\">261</a> <em>     * DOCUMENT ME!</em>\n<a name=\"262\" href=\"#262\">262</a> <em>     *</em>\n<a name=\"263\" href=\"#263\">263</a> <em>     * @return Returns the userGroup.</em>\n<a name=\"264\" href=\"#264\">264</a> <em>     */</em>\n<a name=\"265\" href=\"#265\">265</a>     <strong>public</strong> Element getUserGroup()\n<a name=\"266\" href=\"#266\">266</a>     {\n<a name=\"267\" href=\"#267\">267</a>         <strong>return</strong> userGroup;\n<a name=\"268\" href=\"#268\">268</a>     }\n<a name=\"269\" href=\"#269\">269</a> \n<a name=\"270\" href=\"#270\">270</a>     <em>/**<em>*</em></em>\n<a name=\"271\" href=\"#271\">271</a> <em>     * TODO</em>\n<a name=\"272\" href=\"#272\">272</a> <em>     *</em>\n<a name=\"273\" href=\"#273\">273</a> <em>     * @return TODO</em>\n<a name=\"274\" href=\"#274\">274</a> <em>     */</em>\n<a name=\"275\" href=\"#275\">275</a>     <strong>public</strong> <a href=\"../../../../swirl/workspace/viz/pie/SVGPieView.html\">SVGPieView</a> getView()\n<a name=\"276\" href=\"#276\">276</a>     {\n<a name=\"277\" href=\"#277\">277</a>         <strong>return</strong> svgview;\n<a name=\"278\" href=\"#278\">278</a>     }\n<a name=\"279\" href=\"#279\">279</a> \n<a name=\"280\" href=\"#280\">280</a>     <em>/**<em>*</em></em>\n<a name=\"281\" href=\"#281\">281</a> <em>     * TODO</em>\n<a name=\"282\" href=\"#282\">282</a> <em>     *</em>\n<a name=\"283\" href=\"#283\">283</a> <em>     * @param fe TODO</em>\n<a name=\"284\" href=\"#284\">284</a> <em>     */</em>\n<a name=\"285\" href=\"#285\">285</a>     <strong>public</strong> <strong>void</strong> addFile(<a href=\"../../../../swirl/workspace/viz/pie/FileElement.html\">FileElement</a> fe)\n<a name=\"286\" href=\"#286\">286</a>     {\n<a name=\"287\" href=\"#287\">287</a>         String userID = fe.getOwnerKey();\n<a name=\"288\" href=\"#288\">288</a> \n<a name=\"289\" href=\"#289\">289</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"290\" href=\"#290\">290</a>         {\n<a name=\"291\" href=\"#291\">291</a>             log.debug(<span class=\"string\">\"adding file for user \"</span> + userID);\n<a name=\"292\" href=\"#292\">292</a>             log.debug(<span class=\"string\">\"fe sharinglevel \"</span> + fe.getShareDegree().getValue());\n<a name=\"293\" href=\"#293\">293</a>         }\n<a name=\"294\" href=\"#294\">294</a> \n<a name=\"295\" href=\"#295\">295</a>         <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a> peer = (GuiPeer)guipeers.get(userID);\n<a name=\"296\" href=\"#296\">296</a> \n<a name=\"297\" href=\"#297\">297</a>         peer.addFile(fe);\n<a name=\"298\" href=\"#298\">298</a>     }\n<a name=\"299\" href=\"#299\">299</a> \n<a name=\"300\" href=\"#300\">300</a>     <em>/**<em>*</em></em>\n<a name=\"301\" href=\"#301\">301</a> <em>     * TODO</em>\n<a name=\"302\" href=\"#302\">302</a> <em>     *</em>\n<a name=\"303\" href=\"#303\">303</a> <em>     * @param peer TODO</em>\n<a name=\"304\" href=\"#304\">304</a> <em>     */</em>\n<a name=\"305\" href=\"#305\">305</a>     <strong>public</strong> <strong>void</strong> addPeer(<a href=\"../../../../swirl/workspace/Peer.html\">Peer</a> peer)\n<a name=\"306\" href=\"#306\">306</a>     {\n<a name=\"307\" href=\"#307\">307</a>         String key = peer.getUniqueID();\n<a name=\"308\" href=\"#308\">308</a> \n<a name=\"309\" href=\"#309\">309</a>         <strong>if</strong>(guipeers.get(key) != <strong>null</strong>)\n<a name=\"310\" href=\"#310\">310</a>         {\n<a name=\"311\" href=\"#311\">311</a>         \t<strong>if</strong>(log.isDebugEnabled())\n<a name=\"312\" href=\"#312\">312</a>             {\n<a name=\"313\" href=\"#313\">313</a>         \t\tlog.debug(<span class=\"string\">\"User already exist: \"</span> + key);\n<a name=\"314\" href=\"#314\">314</a>             }\n<a name=\"315\" href=\"#315\">315</a>             <strong>return</strong>;\n<a name=\"316\" href=\"#316\">316</a>         }\n<a name=\"317\" href=\"#317\">317</a>         \n<a name=\"318\" href=\"#318\">318</a>         <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a> guipeer = <strong>new</strong> <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a>(peer, document, <strong>this</strong>);\n<a name=\"319\" href=\"#319\">319</a>         guipeers.put(key, guipeer);\n<a name=\"320\" href=\"#320\">320</a>         adjustPeers(getPeerNumber());\n<a name=\"321\" href=\"#321\">321</a>         <em class=\"comment\">// wait</em>\n<a name=\"322\" href=\"#322\">322</a>     }\n<a name=\"323\" href=\"#323\">323</a> \n<a name=\"324\" href=\"#324\">324</a>     <em>/**<em>*</em></em>\n<a name=\"325\" href=\"#325\">325</a> <em>     * TODO</em>\n<a name=\"326\" href=\"#326\">326</a> <em>     */</em>\n<a name=\"327\" href=\"#327\">327</a>     <strong>public</strong> <strong>void</strong> init()\n<a name=\"328\" href=\"#328\">328</a>     {\n<a name=\"329\" href=\"#329\">329</a>         DOMImplementation impl = ExtensibleSVGDOMImplementation\n<a name=\"330\" href=\"#330\">330</a>                                  .getDOMImplementation();\n<a name=\"331\" href=\"#331\">331</a> \n<a name=\"332\" href=\"#332\">332</a>         document = (SVGDocument)impl.createDocument(svgNS, <span class=\"string\">\"svg\"</span>, <strong>null</strong>);\n<a name=\"333\" href=\"#333\">333</a>         svgRoot = document.getDocumentElement();\n<a name=\"334\" href=\"#334\">334</a> \n<a name=\"335\" href=\"#335\">335</a>         <em class=\"comment\">// set the viewbox on the root svg element</em>\n<a name=\"336\" href=\"#336\">336</a>         String t = <span class=\"string\">\"0 0 \"</span> + <span class=\"string\">\" \"</span> + String.valueOf(VIEW_SIZE) + <span class=\"string\">\" \"</span>\n<a name=\"337\" href=\"#337\">337</a>                    + String.valueOf(VIEW_SIZE);\n<a name=\"338\" href=\"#338\">338</a> \n<a name=\"339\" href=\"#339\">339</a>         svgRoot.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"viewBox\"</span>, t);\n<a name=\"340\" href=\"#340\">340</a>         defGroup = document.createElementNS(svgNS, <span class=\"string\">\"defs\"</span>);\n<a name=\"341\" href=\"#341\">341</a>         userGroup = document.createElementNS(svgNS, <span class=\"string\">\"g\"</span>);\n<a name=\"342\" href=\"#342\">342</a>         fileGroup = document.createElementNS(svgNS, <span class=\"string\">\"g\"</span>);\n<a name=\"343\" href=\"#343\">343</a>         maskLayer = document.createElementNS(svgNS, <span class=\"string\">\"g\"</span>);\n<a name=\"344\" href=\"#344\">344</a>         explainpanel = document.createElementNS(svgNS, <span class=\"string\">\"g\"</span>);\n<a name=\"345\" href=\"#345\">345</a> \n<a name=\"346\" href=\"#346\">346</a>         userGroup.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>, USER_ROOT_ID);\n<a name=\"347\" href=\"#347\">347</a>         fileGroup.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>, FILE_ROOT_ID);\n<a name=\"348\" href=\"#348\">348</a>         maskLayer.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>, LOCAL_MASK_ID);\n<a name=\"349\" href=\"#349\">349</a>         explainpanel.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>, EXPLAIN_PANEL);\n<a name=\"350\" href=\"#350\">350</a>         \n<a name=\"351\" href=\"#351\">351</a>         String data = <span class=\"string\">\"\"</span>;\n<a name=\"352\" href=\"#352\">352</a>         document.createCDATASection(data);\n<a name=\"353\" href=\"#353\">353</a>         \n<a name=\"354\" href=\"#354\">354</a>         ((AbstractNode)maskLayer).addEventListener(SVGConstants.SVG_MOUSEMOVE_EVENT_TYPE,\n<a name=\"355\" href=\"#355\">355</a>                                                    svgview.getMouseEvent(),\n<a name=\"356\" href=\"#356\">356</a>                                                    false);\n<a name=\"357\" href=\"#357\">357</a> \n<a name=\"358\" href=\"#358\">358</a>         <em class=\"comment\">//add an empty textpath reference to start</em>\n<a name=\"359\" href=\"#359\">359</a>         Element path = document.createElementNS(svgNS, <span class=\"string\">\"path\"</span>);\n<a name=\"360\" href=\"#360\">360</a> \n<a name=\"361\" href=\"#361\">361</a>         path.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>, TEXT_PATH_ID);\n<a name=\"362\" href=\"#362\">362</a>         path.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"d\"</span>, <span class=\"string\">\"\"</span>);\n<a name=\"363\" href=\"#363\">363</a>         defGroup.appendChild(path);\n<a name=\"364\" href=\"#364\">364</a>         \n<a name=\"365\" href=\"#365\">365</a>         appendFilter();\n<a name=\"366\" href=\"#366\">366</a>         <em class=\"comment\">//they need to be appended in this sequence</em>\n<a name=\"367\" href=\"#367\">367</a>         svgRoot.appendChild(defGroup);\n<a name=\"368\" href=\"#368\">368</a>         addPrivateSpace();\n<a name=\"369\" href=\"#369\">369</a>         svgRoot.appendChild(userGroup);\n<a name=\"370\" href=\"#370\">370</a>         addPersistentSpace();\n<a name=\"371\" href=\"#371\">371</a>         svgRoot.appendChild(maskLayer);\n<a name=\"372\" href=\"#372\">372</a>         addExplainPanel();\n<a name=\"373\" href=\"#373\">373</a>         svgRoot.appendChild(explainpanel);\n<a name=\"374\" href=\"#374\">374</a>         svgRoot.appendChild(fileGroup);\n<a name=\"375\" href=\"#375\">375</a>         \n<a name=\"376\" href=\"#376\">376</a>         \n<a name=\"377\" href=\"#377\">377</a>         ((AbstractNode)svgRoot).addEventListener(SVGConstants.SVG_MOUSEUP_EVENT_TYPE,\n<a name=\"378\" href=\"#378\">378</a>                                                  svgview.getMouseEvent(), false);\n<a name=\"379\" href=\"#379\">379</a>         \n<a name=\"380\" href=\"#380\">380</a>     }\n<a name=\"381\" href=\"#381\">381</a> \n<a name=\"382\" href=\"#382\">382</a>     <em>/**<em>*</em></em>\n<a name=\"383\" href=\"#383\">383</a> <em>     * TODO</em>\n<a name=\"384\" href=\"#384\">384</a> <em>     *</em>\n<a name=\"385\" href=\"#385\">385</a> <em>     * @param peerKey TODO</em>\n<a name=\"386\" href=\"#386\">386</a> <em>     */</em>\n<a name=\"387\" href=\"#387\">387</a>     <strong>public</strong> <strong>void</strong> removePeer(String peerKey)\n<a name=\"388\" href=\"#388\">388</a>     {\n<a name=\"389\" href=\"#389\">389</a>         <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a> guipeer = (GuiPeer)guipeers.get(peerKey);\n<a name=\"390\" href=\"#390\">390</a> \n<a name=\"391\" href=\"#391\">391</a>         <strong>if</strong>(guipeer != <strong>null</strong>)\n<a name=\"392\" href=\"#392\">392</a>         {\n<a name=\"393\" href=\"#393\">393</a>             guipeer.detach();\n<a name=\"394\" href=\"#394\">394</a>             guipeers.remove(peerKey);\n<a name=\"395\" href=\"#395\">395</a>             adjustPeers(getPeerNumber());\n<a name=\"396\" href=\"#396\">396</a> \n<a name=\"397\" href=\"#397\">397</a>         }\n<a name=\"398\" href=\"#398\">398</a>         <strong>else</strong>\n<a name=\"399\" href=\"#399\">399</a>         {\n<a name=\"400\" href=\"#400\">400</a>         \t<strong>if</strong>(log.isDebugEnabled())\n<a name=\"401\" href=\"#401\">401</a>             {\n<a name=\"402\" href=\"#402\">402</a>         \t\tlog.debug(<span class=\"string\">\"User does not exist: \"</span> + peerKey);\n<a name=\"403\" href=\"#403\">403</a>             }\n<a name=\"404\" href=\"#404\">404</a>         }\n<a name=\"405\" href=\"#405\">405</a>     }\n<a name=\"406\" href=\"#406\">406</a> \n<a name=\"407\" href=\"#407\">407</a>     <em>/**<em>*</em></em>\n<a name=\"408\" href=\"#408\">408</a> <em>     * TODO</em>\n<a name=\"409\" href=\"#409\">409</a> <em>     */</em>\n<a name=\"410\" href=\"#410\">410</a>     <strong>private</strong> <strong>void</strong> addPersistentSpace()\n<a name=\"411\" href=\"#411\">411</a>     {\n<a name=\"412\" href=\"#412\">412</a>         <em class=\"comment\">//caculate the radius of the public circle</em>\n<a name=\"413\" href=\"#413\">413</a>         <strong>double</strong> radi = Util.getRadium(SharingLevel.SHARING_LEVEL);\n<a name=\"414\" href=\"#414\">414</a>         String transform = Util.getTranslateString(getCenter().getX(),\n<a name=\"415\" href=\"#415\">415</a>                                                    getCenter().getY());\n<a name=\"416\" href=\"#416\">416</a> \n<a name=\"417\" href=\"#417\">417</a>         Element persistentCircle = document.createElementNS(svgNS, <span class=\"string\">\"circle\"</span>);\n<a name=\"418\" href=\"#418\">418</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"419\" href=\"#419\">419</a>         {\n<a name=\"420\" href=\"#420\">420</a>         \tlog.debug(<span class=\"string\">\"radi: \"</span> + radi);\n<a name=\"421\" href=\"#421\">421</a>         }\n<a name=\"422\" href=\"#422\">422</a>         persistentCircle.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"r\"</span>, String.valueOf(radi));\n<a name=\"423\" href=\"#423\">423</a>         persistentCircle.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"stroke\"</span>, STROKE_COLOR);\n<a name=\"424\" href=\"#424\">424</a>         persistentCircle.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"fill\"</span>, FILL_COLOR);\n<a name=\"425\" href=\"#425\">425</a>         persistentCircle.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"transform\"</span>, transform);\n<a name=\"426\" href=\"#426\">426</a>         persistentCircle.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>,\n<a name=\"427\" href=\"#427\">427</a>                                         PeerManager.getLocalUserID() + <span class=\"string\">\":\"</span>\n<a name=\"428\" href=\"#428\">428</a>                                         + SharingLevel.SHARING_LEVEL);\n<a name=\"429\" href=\"#429\">429</a> \n<a name=\"430\" href=\"#430\">430</a>         svgRoot.appendChild(persistentCircle);\n<a name=\"431\" href=\"#431\">431</a> \n<a name=\"432\" href=\"#432\">432</a>         Node clone = persistentCircle.cloneNode(<strong>true</strong>);\n<a name=\"433\" href=\"#433\">433</a> \n<a name=\"434\" href=\"#434\">434</a>         ((Element)clone).removeAttribute(<span class=\"string\">\"fill\"</span>);\n<a name=\"435\" href=\"#435\">435</a>         ((Element)clone).removeAttribute(<span class=\"string\">\"stroke\"</span>);\n<a name=\"436\" href=\"#436\">436</a>         maskLayer.appendChild(clone);\n<a name=\"437\" href=\"#437\">437</a>     }\n<a name=\"438\" href=\"#438\">438</a> \n<a name=\"439\" href=\"#439\">439</a>     <em>/**<em>*</em></em>\n<a name=\"440\" href=\"#440\">440</a> <em>     * TODO</em>\n<a name=\"441\" href=\"#441\">441</a> <em>     */</em>\n<a name=\"442\" href=\"#442\">442</a>     <strong>private</strong> <strong>void</strong> appendFilter()\n<a name=\"443\" href=\"#443\">443</a>     {\n<a name=\"444\" href=\"#444\">444</a>     \tdefFilter = document.createElementNS(svgNS, <span class=\"string\">\"filter\"</span>);\n<a name=\"445\" href=\"#445\">445</a>     \tdefFilter.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>, DOT_FILTER_ID);\n<a name=\"446\" href=\"#446\">446</a>     \tdefFilter.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"filterUnits\"</span>, <span class=\"string\">\"objectBoundingBox\"</span>);\n<a name=\"447\" href=\"#447\">447</a>     \tdefFilter.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"width\"</span>, <span class=\"string\">\"4.8\"</span>);\n<a name=\"448\" href=\"#448\">448</a>     \tdefFilter.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"height\"</span>, <span class=\"string\">\"4.8\"</span>);\n<a name=\"449\" href=\"#449\">449</a>     \t\n<a name=\"450\" href=\"#450\">450</a>     \t\n<a name=\"451\" href=\"#451\">451</a>     \tElement feGaussianBlur = document.createElementNS(svgNS, <span class=\"string\">\"feGaussianBlur\"</span>);\n<a name=\"452\" href=\"#452\">452</a>     \tfeGaussianBlur.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in\"</span>, <span class=\"string\">\"SourceAlpha\"</span>);\n<a name=\"453\" href=\"#453\">453</a>     \tfeGaussianBlur.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"stdDeviation\"</span>, <span class=\"string\">\"8\"</span>);\n<a name=\"454\" href=\"#454\">454</a>     \tfeGaussianBlur.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"result\"</span>, <span class=\"string\">\"blur\"</span>);\n<a name=\"455\" href=\"#455\">455</a>     \tdefFilter.appendChild(feGaussianBlur);\n<a name=\"456\" href=\"#456\">456</a> \t\t\n<a name=\"457\" href=\"#457\">457</a>     \t\n<a name=\"458\" href=\"#458\">458</a>     \tElement feOffset = document.createElementNS(svgNS, <span class=\"string\">\"feOffset\"</span>);\n<a name=\"459\" href=\"#459\">459</a>     \tfeOffset.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in\"</span>, <span class=\"string\">\"blur\"</span>);\n<a name=\"460\" href=\"#460\">460</a>     \tfeOffset.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"dx\"</span>, <span class=\"string\">\"3\"</span>);\n<a name=\"461\" href=\"#461\">461</a>     \tfeOffset.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"dy\"</span>, <span class=\"string\">\"3\"</span>);\n<a name=\"462\" href=\"#462\">462</a>     \tfeOffset.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"result\"</span>, <span class=\"string\">\"offsetBlur\"</span>);\n<a name=\"463\" href=\"#463\">463</a>     \tdefFilter.appendChild(feOffset);\n<a name=\"464\" href=\"#464\">464</a>     \t\n<a name=\"465\" href=\"#465\">465</a>     \tElement feComponentTransfer = document.createElementNS(svgNS, <span class=\"string\">\"feComponentTransfer\"</span>);\n<a name=\"466\" href=\"#466\">466</a>         feComponentTransfer.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"result\"</span>, <span class=\"string\">\"shadow\"</span>);\n<a name=\"467\" href=\"#467\">467</a>         defFilter.appendChild(feComponentTransfer);\n<a name=\"468\" href=\"#468\">468</a>         \n<a name=\"469\" href=\"#469\">469</a>         Element feFuncA = document.createElementNS(svgNS, <span class=\"string\">\"feFuncA\"</span>);\n<a name=\"470\" href=\"#470\">470</a>         feFuncA.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"type\"</span>, <span class=\"string\">\"linear\"</span>);\n<a name=\"471\" href=\"#471\">471</a>         feFuncA.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"slope\"</span>, <span class=\"string\">\"0.5\"</span>);\n<a name=\"472\" href=\"#472\">472</a>         feFuncA.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"intercept\"</span>, <span class=\"string\">\"0\"</span>);\n<a name=\"473\" href=\"#473\">473</a>         feComponentTransfer.appendChild(feFuncA);\n<a name=\"474\" href=\"#474\">474</a>         \n<a name=\"475\" href=\"#475\">475</a>         Element feComposite = document.createElementNS(svgNS, <span class=\"string\">\"feComposite\"</span>);\n<a name=\"476\" href=\"#476\">476</a>         feComposite.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in2\"</span>, <span class=\"string\">\"shadow\"</span>);\n<a name=\"477\" href=\"#477\">477</a>         feComposite.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in\"</span>, <span class=\"string\">\"SourceGraphic\"</span>);\n<a name=\"478\" href=\"#478\">478</a>         defFilter.appendChild(feComposite);\n<a name=\"479\" href=\"#479\">479</a> \n<a name=\"480\" href=\"#480\">480</a>         Element feSpecularLighting = document.createElementNS(svgNS, <span class=\"string\">\"feSpecularLighting\"</span>);\n<a name=\"481\" href=\"#481\">481</a>     \tfeSpecularLighting.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in\"</span>, <span class=\"string\">\"blur\"</span>);\n<a name=\"482\" href=\"#482\">482</a>     \tfeSpecularLighting.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"surfaceScale\"</span>, <span class=\"string\">\"5\"</span>);\n<a name=\"483\" href=\"#483\">483</a>     \tfeSpecularLighting.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"specularConstant\"</span>, <span class=\"string\">\".75\"</span>);\n<a name=\"484\" href=\"#484\">484</a>     \tfeSpecularLighting.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"specularExponent\"</span>, <span class=\"string\">\"20\"</span>);\n<a name=\"485\" href=\"#485\">485</a>     \tfeSpecularLighting.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"lighting-color\"</span>, <span class=\"string\">\"#bbbbbb\"</span>);\n<a name=\"486\" href=\"#486\">486</a>     \tfeSpecularLighting.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"result\"</span>, <span class=\"string\">\"specOut\"</span>);\n<a name=\"487\" href=\"#487\">487</a>     \tdefFilter.appendChild(feSpecularLighting);\n<a name=\"488\" href=\"#488\">488</a>     \t\n<a name=\"489\" href=\"#489\">489</a>     \tElement fePointLight = document.createElementNS(svgNS, <span class=\"string\">\"fePointLight\"</span>);\n<a name=\"490\" href=\"#490\">490</a>     \tfePointLight.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"x\"</span>, <span class=\"string\">\"-5000\"</span>);\n<a name=\"491\" href=\"#491\">491</a>     \tfePointLight.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"y\"</span>, <span class=\"string\">\"-10000\"</span>);\n<a name=\"492\" href=\"#492\">492</a>     \tfePointLight.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"z\"</span>, <span class=\"string\">\"20000\"</span>);\n<a name=\"493\" href=\"#493\">493</a>     \tfeSpecularLighting.appendChild(fePointLight);\n<a name=\"494\" href=\"#494\">494</a>     \t\n<a name=\"495\" href=\"#495\">495</a>     \tElement feComposite1 = document.createElementNS(svgNS, <span class=\"string\">\"feComposite\"</span>);\n<a name=\"496\" href=\"#496\">496</a>     \tfeComposite1.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in\"</span>, <span class=\"string\">\"specOut\"</span>);\n<a name=\"497\" href=\"#497\">497</a>     \tfeComposite1.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in2\"</span>, <span class=\"string\">\"SourceAlpha\"</span>);\n<a name=\"498\" href=\"#498\">498</a>     \tfeComposite1.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"operator\"</span>, <span class=\"string\">\"in\"</span>);\n<a name=\"499\" href=\"#499\">499</a>     \tfeComposite1.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"result\"</span>, <span class=\"string\">\"specOut\"</span>);\n<a name=\"500\" href=\"#500\">500</a>     \tdefFilter.appendChild(feComposite1);\n<a name=\"501\" href=\"#501\">501</a>     \t\n<a name=\"502\" href=\"#502\">502</a>     \tElement feComposite2 = document.createElementNS(svgNS, <span class=\"string\">\"feComposite\"</span>);\n<a name=\"503\" href=\"#503\">503</a>     \tfeComposite2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in\"</span>, <span class=\"string\">\"SourceGraphic\"</span>);\n<a name=\"504\" href=\"#504\">504</a>     \tfeComposite2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in2\"</span>, <span class=\"string\">\"specOut\"</span>);\n<a name=\"505\" href=\"#505\">505</a>     \tfeComposite2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"operator\"</span>, <span class=\"string\">\"arithmetic\"</span>);\n<a name=\"506\" href=\"#506\">506</a>     \tfeComposite2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"k1\"</span>, <span class=\"string\">\"0\"</span>);\n<a name=\"507\" href=\"#507\">507</a>     \tfeComposite2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"k2\"</span>, <span class=\"string\">\"1\"</span>);\n<a name=\"508\" href=\"#508\">508</a>     \tfeComposite2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"k3\"</span>, <span class=\"string\">\"1\"</span>);\n<a name=\"509\" href=\"#509\">509</a>     \tfeComposite2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"k4\"</span>, <span class=\"string\">\"0\"</span>);\n<a name=\"510\" href=\"#510\">510</a>     \tfeComposite2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"result\"</span>, <span class=\"string\">\"litPaint\"</span>);\n<a name=\"511\" href=\"#511\">511</a>     \tdefFilter.appendChild(feComposite2);\n<a name=\"512\" href=\"#512\">512</a>     \t\n<a name=\"513\" href=\"#513\">513</a>     \tElement feMerge = document.createElementNS(svgNS, <span class=\"string\">\"feMerge\"</span>);\n<a name=\"514\" href=\"#514\">514</a>     \t\n<a name=\"515\" href=\"#515\">515</a>     \tElement feMergeNode1 = document.createElementNS(svgNS, <span class=\"string\">\"feMergeNode\"</span>);\n<a name=\"516\" href=\"#516\">516</a>     \tfeMergeNode1.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in\"</span>, <span class=\"string\">\"shadow\"</span>);\n<a name=\"517\" href=\"#517\">517</a>     \tfeMerge.appendChild(feMergeNode1);\n<a name=\"518\" href=\"#518\">518</a> \t\t\n<a name=\"519\" href=\"#519\">519</a>     \tElement feMergeNode2 = document.createElementNS(svgNS, <span class=\"string\">\"feMergeNode\"</span>);\n<a name=\"520\" href=\"#520\">520</a>     \tfeMergeNode2.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"in\"</span>, <span class=\"string\">\"litPaint\"</span>);\n<a name=\"521\" href=\"#521\">521</a>     \tfeMerge.appendChild(feMergeNode2);\n<a name=\"522\" href=\"#522\">522</a>     \tdefFilter.appendChild(feMerge);\n<a name=\"523\" href=\"#523\">523</a>     \t\n<a name=\"524\" href=\"#524\">524</a>     \tdefGroup.appendChild(defFilter);\t\n<a name=\"525\" href=\"#525\">525</a>     \t\n<a name=\"526\" href=\"#526\">526</a>    }\n<a name=\"527\" href=\"#527\">527</a> \n<a name=\"528\" href=\"#528\">528</a>     <em>/**<em>*</em></em>\n<a name=\"529\" href=\"#529\">529</a> <em>     * TODO</em>\n<a name=\"530\" href=\"#530\">530</a> <em>     */</em>\n<a name=\"531\" href=\"#531\">531</a>     <strong>private</strong> <strong>void</strong> addPrivateSpace()\n<a name=\"532\" href=\"#532\">532</a>     {\n<a name=\"533\" href=\"#533\">533</a>         Element privateSpace = document.createElementNS(svgNS, <span class=\"string\">\"rect\"</span>);\n<a name=\"534\" href=\"#534\">534</a> \n<a name=\"535\" href=\"#535\">535</a>         privateSpace.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>,\n<a name=\"536\" href=\"#536\">536</a>                                     PeerManager.getLocalUserID() + <span class=\"string\">\":0\"</span>);\n<a name=\"537\" href=\"#537\">537</a>         privateSpace.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"fill\"</span>, <span class=\"string\">\"lightgray\"</span>);\n<a name=\"538\" href=\"#538\">538</a>         privateSpace.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"width\"</span>,\n<a name=\"539\" href=\"#539\">539</a>                                     String.valueOf(String.valueOf(VIEW_SIZE)));\n<a name=\"540\" href=\"#540\">540</a>         privateSpace.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"height\"</span>,\n<a name=\"541\" href=\"#541\">541</a>                                     String.valueOf(String.valueOf(VIEW_SIZE)));\n<a name=\"542\" href=\"#542\">542</a>         ((AbstractNode)privateSpace).addEventListener(SVGConstants.SVG_MOUSEMOVE_EVENT_TYPE,\n<a name=\"543\" href=\"#543\">543</a>                                                       svgview.getMouseEvent(),\n<a name=\"544\" href=\"#544\">544</a>                                                       false);\n<a name=\"545\" href=\"#545\">545</a>         userGroup.appendChild(privateSpace);\n<a name=\"546\" href=\"#546\">546</a>     }\n<a name=\"547\" href=\"#547\">547</a> \n<a name=\"548\" href=\"#548\">548</a>     <em>/**<em>*</em></em>\n<a name=\"549\" href=\"#549\">549</a> <em>     * TODO</em>\n<a name=\"550\" href=\"#550\">550</a> <em>     */</em>\n<a name=\"551\" href=\"#551\">551</a>     <strong>private</strong> <strong>void</strong> addExplainPanel()\n<a name=\"552\" href=\"#552\">552</a>     {\n<a name=\"553\" href=\"#553\">553</a>         Element background = document.createElementNS(svgNS, <span class=\"string\">\"rect\"</span>);\n<a name=\"554\" href=\"#554\">554</a> \n<a name=\"555\" href=\"#555\">555</a>         background.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"fill\"</span>, <span class=\"string\">\"lightgray\"</span>);\n<a name=\"556\" href=\"#556\">556</a>         background.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"width\"</span>, <span class=\"string\">\"250\"</span>);\n<a name=\"557\" href=\"#557\">557</a>         background.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"height\"</span>,<span class=\"string\">\"60\"</span>);\n<a name=\"558\" href=\"#558\">558</a>         background.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"style\"</span>,\n<a name=\"559\" href=\"#559\">559</a>                 <span class=\"string\">\"fill:#FFEF95; fill-opacity:0.5; stroke:white\"</span>);\n<a name=\"560\" href=\"#560\">560</a>         \n<a name=\"561\" href=\"#561\">561</a>         Element textg = document.createElementNS(svgNS, <span class=\"string\">\"g\"</span>);\n<a name=\"562\" href=\"#562\">562</a>         textg.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"style\"</span>, <span class=\"string\">\"font-size:25;\"</span>);\n<a name=\"563\" href=\"#563\">563</a>         Element label = document.createElementNS(svgNS, <span class=\"string\">\"text\"</span>);\n<a name=\"564\" href=\"#564\">564</a>         label.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"x\"</span>, <span class=\"string\">\"20\"</span>);\n<a name=\"565\" href=\"#565\">565</a>         label.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"y\"</span>,<span class=\"string\">\"30\"</span>);\n<a name=\"566\" href=\"#566\">566</a>         elabel = document.createTextNode(<span class=\"string\">\"\"</span>);\n<a name=\"567\" href=\"#567\">567</a>         label.appendChild(elabel);\n<a name=\"568\" href=\"#568\">568</a>         \n<a name=\"569\" href=\"#569\">569</a>         Element text = document.createElementNS(svgNS, <span class=\"string\">\"text\"</span>);\n<a name=\"570\" href=\"#570\">570</a>         text.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"id\"</span>, <span class=\"string\">\"varSecurity\"</span>);\n<a name=\"571\" href=\"#571\">571</a>         text.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"x\"</span>, <span class=\"string\">\"20\"</span>);\n<a name=\"572\" href=\"#572\">572</a>         text.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"y\"</span>,<span class=\"string\">\"45\"</span>);\n<a name=\"573\" href=\"#573\">573</a>         etext = document.createTextNode(<span class=\"string\">\"Swirl Impromptu\"</span>);\n<a name=\"574\" href=\"#574\">574</a>         \n<a name=\"575\" href=\"#575\">575</a>         text.appendChild(etext);\n<a name=\"576\" href=\"#576\">576</a>         \n<a name=\"577\" href=\"#577\">577</a>         explainpanel.appendChild(background);\n<a name=\"578\" href=\"#578\">578</a>         explainpanel.appendChild(label);\n<a name=\"579\" href=\"#579\">579</a>         explainpanel.appendChild(text);\n<a name=\"580\" href=\"#580\">580</a>     }\n<a name=\"581\" href=\"#581\">581</a> \n<a name=\"582\" href=\"#582\">582</a>     <em>/**<em>*</em></em>\n<a name=\"583\" href=\"#583\">583</a> <em>     * TODO</em>\n<a name=\"584\" href=\"#584\">584</a> <em>     *</em>\n<a name=\"585\" href=\"#585\">585</a> <em>     * @param peerNumber TODO</em>\n<a name=\"586\" href=\"#586\">586</a> <em>     *</em>\n<a name=\"587\" href=\"#587\">587</a> <em>     * @return TODO</em>\n<a name=\"588\" href=\"#588\">588</a> <em>     */</em>\n<a name=\"589\" href=\"#589\">589</a>     <strong>private</strong> <strong>double</strong> adjustPeers(<strong>int</strong> peerNumber)\n<a name=\"590\" href=\"#590\">590</a>     {\n<a name=\"591\" href=\"#591\">591</a>         <em class=\"comment\">//change the paths for the user name text</em>\n<a name=\"592\" href=\"#592\">592</a>         Node tpnode = document.getElementById(PieWorkSpace.TEXT_PATH_ID);\n<a name=\"593\" href=\"#593\">593</a>         NamedNodeMap tpmap = tpnode.getAttributes();\n<a name=\"594\" href=\"#594\">594</a> \n<a name=\"595\" href=\"#595\">595</a>         <em class=\"comment\">//make the text at the outer of the circle</em>\n<a name=\"596\" href=\"#596\">596</a>         String d = Util.caculateDforPath(PieWorkSpace.RADIUS + 5,\n<a name=\"597\" href=\"#597\">597</a>         \t\tgetPeerNumber());\n<a name=\"598\" href=\"#598\">598</a> \n<a name=\"599\" href=\"#599\">599</a>         (tpmap.getNamedItem(<span class=\"string\">\"d\"</span>)).setNodeValue(d);\n<a name=\"600\" href=\"#600\">600</a>         <em class=\"comment\">//in order to redraw the user name</em>\n<a name=\"601\" href=\"#601\">601</a>         NodeList textl = userGroup.getElementsByTagName(<span class=\"string\">\"text\"</span>);\n<a name=\"602\" href=\"#602\">602</a>         <strong>for</strong>(<strong>int</strong> i = 0; i &lt; textl.getLength(); i++)\n<a name=\"603\" href=\"#603\">603</a>         {\n<a name=\"604\" href=\"#604\">604</a>             Node tn = textl.item(i);\n<a name=\"605\" href=\"#605\">605</a>             Element parent = (Element)tn.getParentNode();\n<a name=\"606\" href=\"#606\">606</a> \n<a name=\"607\" href=\"#607\">607</a>             parent.removeChild(tn);\n<a name=\"608\" href=\"#608\">608</a>             parent.appendChild(tn);\n<a name=\"609\" href=\"#609\">609</a>         }\n<a name=\"610\" href=\"#610\">610</a>         \n<a name=\"611\" href=\"#611\">611</a>         <em class=\"comment\">//change the actual paths</em>\n<a name=\"612\" href=\"#612\">612</a>         <strong>double</strong> start = 0.0D;\n<a name=\"613\" href=\"#613\">613</a>         <strong>for</strong>(Iterator it = guipeers.entrySet().iterator(); it.hasNext();)\n<a name=\"614\" href=\"#614\">614</a>         {\n<a name=\"615\" href=\"#615\">615</a>             Entry entry = (Entry)it.next();\n<a name=\"616\" href=\"#616\">616</a>             <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a> guipeer = (GuiPeer)entry.getValue();\n<a name=\"617\" href=\"#617\">617</a>             <strong>double</strong> arcAngle = Util.getAngle(peerNumber);\n<a name=\"618\" href=\"#618\">618</a>             <em class=\"comment\">//if it is the last one</em>\n<a name=\"619\" href=\"#619\">619</a>             <strong>if</strong>(!it.hasNext()){\n<a name=\"620\" href=\"#620\">620</a>             \tarcAngle = 359.9 - start;\n<a name=\"621\" href=\"#621\">621</a>             \t\n<a name=\"622\" href=\"#622\">622</a>             }   \n<a name=\"623\" href=\"#623\">623</a>             start = guipeer.adjustAngle(start, arcAngle);\n<a name=\"624\" href=\"#624\">624</a>         }\n<a name=\"625\" href=\"#625\">625</a>      \n<a name=\"626\" href=\"#626\">626</a>         <strong>return</strong> start;\n<a name=\"627\" href=\"#627\">627</a>     }\n<a name=\"628\" href=\"#628\">628</a> \n<a name=\"629\" href=\"#629\">629</a> \t<em>/**<em>*</em></em>\n<a name=\"630\" href=\"#630\">630</a> <em>\t * @param fileKey</em>\n<a name=\"631\" href=\"#631\">631</a> <em>\t * @param userID</em>\n<a name=\"632\" href=\"#632\">632</a> <em>\t */</em>\n<a name=\"633\" href=\"#633\">633</a> \t<strong>public</strong> <strong>void</strong> removeFile(String fileKey, String userID) {\n<a name=\"634\" href=\"#634\">634</a>         <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a> guipeer = (GuiPeer)guipeers.get(userID);\n<a name=\"635\" href=\"#635\">635</a>         guipeer.removeFile(fileKey);\n<a name=\"636\" href=\"#636\">636</a> \t\t\n<a name=\"637\" href=\"#637\">637</a> \t}\n<a name=\"638\" href=\"#638\">638</a> \n<a name=\"639\" href=\"#639\">639</a> \t<em>/**<em>*</em></em>\n<a name=\"640\" href=\"#640\">640</a> <em>\t * @param userId</em>\n<a name=\"641\" href=\"#641\">641</a> <em>\t * @return</em>\n<a name=\"642\" href=\"#642\">642</a> <em>\t */</em>\n<a name=\"643\" href=\"#643\">643</a> \t<strong>public</strong> <a href=\"../../../../swirl/workspace/viz/pie/GuiPeer.html\">GuiPeer</a> getGuiPeer(String userId) {\n<a name=\"644\" href=\"#644\">644</a> \t\tGuiPeer guiPeer;\n<a name=\"645\" href=\"#645\">645</a> \t\t<strong>return</strong>  guiPeer = (GuiPeer)guipeers.get(userId);\n<a name=\"646\" href=\"#646\">646</a> \t}\n<a name=\"647\" href=\"#647\">647</a> \n<a name=\"648\" href=\"#648\">648</a> \t<em>/**<em>*</em></em>\n<a name=\"649\" href=\"#649\">649</a> <em>\t * @param fileElement</em>\n<a name=\"650\" href=\"#650\">650</a> <em>\t * @param newLevel</em>\n<a name=\"651\" href=\"#651\">651</a> <em>\t */</em>\n<a name=\"652\" href=\"#652\">652</a> \t<strong>public</strong> <strong>void</strong> setSharingText(String name, <a href=\"../../../../swirl/workspace/viz/SharingLevel.html\">SharingLevel</a> newLevel) {\n<a name=\"653\" href=\"#653\">653</a> \t\telabel.setData(name + <span class=\"string\">\":\"</span>);\n<a name=\"654\" href=\"#654\">654</a> \t\t\n<a name=\"655\" href=\"#655\">655</a> \t\t<strong>if</strong> (etext.getLength() != 0){\n<a name=\"656\" href=\"#656\">656</a> \t\t\tetext.deleteData(0, etext.getLength());\n<a name=\"657\" href=\"#657\">657</a> \t\t}\n<a name=\"658\" href=\"#658\">658</a> \t\tetext.appendData(FileElement.getTextSharingLevel(newLevel));\n<a name=\"659\" href=\"#659\">659</a> \t\t\n<a name=\"660\" href=\"#660\">660</a> \t}\n<a name=\"661\" href=\"#661\">661</a> \t\n<a name=\"662\" href=\"#662\">662</a> \t<strong>public</strong> <strong>int</strong> incrementDotSize()\n<a name=\"663\" href=\"#663\">663</a> \t{\n<a name=\"664\" href=\"#664\">664</a> \t\tdotSize *= 1.5;\n<a name=\"665\" href=\"#665\">665</a> \t\tsetDotSize(dotSize);\n<a name=\"666\" href=\"#666\">666</a> \t\t\n<a name=\"667\" href=\"#667\">667</a> \t\t<strong>return</strong> dotSize;\n<a name=\"668\" href=\"#668\">668</a> \t}\n<a name=\"669\" href=\"#669\">669</a> \t\n<a name=\"670\" href=\"#670\">670</a> \t<strong>public</strong> <strong>void</strong> setDotSize(<strong>int</strong> dotSizer)\n<a name=\"671\" href=\"#671\">671</a> \t{\n<a name=\"672\" href=\"#672\">672</a> \t\t<strong>if</strong>(log.isDebugEnabled())\n<a name=\"673\" href=\"#673\">673</a>         {\n<a name=\"674\" href=\"#674\">674</a> \t\t\tlog.debug(<span class=\"string\">\"dotSize: \"</span> + dotSize);\n<a name=\"675\" href=\"#675\">675</a> \t\t\tlog.debug(<span class=\"string\">\"guipeers: \"</span> + guipeers);\n<a name=\"676\" href=\"#676\">676</a>         }\n<a name=\"677\" href=\"#677\">677</a> \t\t<strong>for</strong>(Iterator it = guipeers.values().iterator(); it.hasNext(); )\n<a name=\"678\" href=\"#678\">678</a> \t\t{\n<a name=\"679\" href=\"#679\">679</a> \t\t\tGuiPeer peer = (GuiPeer)it.next();\n<a name=\"680\" href=\"#680\">680</a> \t\t\t<strong>if</strong>(log.isDebugEnabled())\n<a name=\"681\" href=\"#681\">681</a> \t        {\n<a name=\"682\" href=\"#682\">682</a> \t\t\t\tlog.debug(<span class=\"string\">\"peer: \"</span> + peer);\n<a name=\"683\" href=\"#683\">683</a> \t        }\n<a name=\"684\" href=\"#684\">684</a> \t\t\tpeer.setDotSize(dotSize);\n<a name=\"685\" href=\"#685\">685</a> \t\t}\n<a name=\"686\" href=\"#686\">686</a> \t}\n<a name=\"687\" href=\"#687\">687</a> \t\n<a name=\"688\" href=\"#688\">688</a> \t<strong>public</strong> <strong>int</strong> decrementDotSize()\n<a name=\"689\" href=\"#689\">689</a> \t{\n<a name=\"690\" href=\"#690\">690</a> \t\t<strong>if</strong>(dotSize > 5)\n<a name=\"691\" href=\"#691\">691</a> \t\t{\n<a name=\"692\" href=\"#692\">692</a> \t\t\tdotSize *= (<strong>float</strong>) 1 / 1.5;\n<a name=\"693\" href=\"#693\">693</a> \t\t\tsetDotSize(dotSize);\n<a name=\"694\" href=\"#694\">694</a> \t\t}\n<a name=\"695\" href=\"#695\">695</a> \t\t\n<a name=\"696\" href=\"#696\">696</a> \t\t<strong>return</strong> dotSize;\n<a name=\"697\" href=\"#697\">697</a> \t}\n<a name=\"698\" href=\"#698\">698</a> \n<a name=\"699\" href=\"#699\">699</a> \t<em>/**<em>*</em></em>\n<a name=\"700\" href=\"#700\">700</a> <em>\t * @return</em>\n<a name=\"701\" href=\"#701\">701</a> <em>\t */</em>\n<a name=\"702\" href=\"#702\">702</a> \t<strong>public</strong> <strong>int</strong> getDotSize() {\n<a name=\"703\" href=\"#703\">703</a> \t\t<strong>if</strong>(log.isDebugEnabled())\n<a name=\"704\" href=\"#704\">704</a>         {\n<a name=\"705\" href=\"#705\">705</a> \t\t\tlog.debug(<span class=\"string\">\"dotSize: \"</span> + dotSize);\n<a name=\"706\" href=\"#706\">706</a>         }\n<a name=\"707\" href=\"#707\">707</a> \t\t<strong>return</strong> dotSize;\n<a name=\"708\" href=\"#708\">708</a> \t}\n<a name=\"709\" href=\"#709\">709</a> \n<a name=\"710\" href=\"#710\">710</a> \t<strong>public</strong> <strong>void</strong> moveExplainText(<strong>double</strong> x, <strong>double</strong> y) {\n<a name=\"711\" href=\"#711\">711</a> \t\t<strong>double</strong> textX = VIEW_SIZE / 2 + x + 10;\n<a name=\"712\" href=\"#712\">712</a> \t\t<strong>double</strong> textY = VIEW_SIZE / 2 + y + 10;\n<a name=\"713\" href=\"#713\">713</a> \t\texplainpanel.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"transform\"</span>, <span class=\"string\">\"translate(\"</span> + textX + <span class=\"string\">\",\"</span> + textY + <span class=\"string\">\")\"</span>);\n<a name=\"714\" href=\"#714\">714</a> \t}\n<a name=\"715\" href=\"#715\">715</a> \n<a name=\"716\" href=\"#716\">716</a> \t<strong>public</strong> <strong>void</strong> revealTag() {\n<a name=\"717\" href=\"#717\">717</a> \t\t<strong>this</strong>.explainpanel.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"style\"</span>, <span class=\"string\">\"visibility:visible\"</span>);\n<a name=\"718\" href=\"#718\">718</a> \t\t\n<a name=\"719\" href=\"#719\">719</a> \t}\n<a name=\"720\" href=\"#720\">720</a> \n<a name=\"721\" href=\"#721\">721</a> \t<strong>public</strong> <strong>void</strong> hideTag() {\n<a name=\"722\" href=\"#722\">722</a> \t\t<strong>this</strong>.explainpanel.setAttributeNS(<strong>null</strong>, <span class=\"string\">\"style\"</span>, <span class=\"string\">\"visibility:hidden\"</span>);\n<a name=\"723\" href=\"#723\">723</a> \t\t\n<a name=\"724\" href=\"#724\">724</a> \t}\n<a name=\"725\" href=\"#725\">725</a> }\n</pre>\n<hr/><div id=\"footer\">This page was automatically generated by <a href=\"http://maven.apache.org/\">Maven</a></div></body>\n</html>\n\n", "id": 33039.0}