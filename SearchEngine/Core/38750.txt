{"text": "OEChem C Theory Manual Version 1 3 1 Previous 12 4 Determining Smallest Ring Up 12 Ring Processing Next 12 6 Identifying Ring Systems 12 5 Identifying Connected Components To aid in splitting molecules into discrete connected components for example to separate a parent compound from its salt or a ligand from a protein OEChem provides the function OEDetermineComponents This function arbitrarily assigns an integer index starting from one to each disconnected molecule in the OEMolBase The user provides a pointer to an array of at least OEMolBase GetMaxAtomIdx unsigned ints which is populated by the function On return this provides a mapping from each atom s index obtained by OEAtomBase GetIdx to its component index Unused atom indices are mapped to zero The function itself also returns the total number of components found i e the maximum part index stored in the array The following provides a short example of how to use this function void MyReportParts const OEMolBase mol unsigned int parts unsigned int count unsigned int size size unsigned int mol GetMaxAtomIdx sizeof unsigned int parts unsigned int malloc size count OEDetermineComponents mol parts printf The molecule has d components n count OEIter OEAtomBase atom for atom mol GetAtoms atom atom printf atom d is in part d n atom GetIdx part atom GetIdx free parts OEChem C Theory Manual Version 1 3 1 Previous 12 4 Determining Smallest Ring Up 12 Ring Processing Next 12 6 Identifying Ring Systems Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/cplusprog/node125.html", "title": "12.5 identifying connected components", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>12.5 Identifying Connected Components</title>\n<META NAME=\"description\" CONTENT=\"12.5 Identifying Connected Components\">\n<META NAME=\"keywords\" CONTENT=\"cplusprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"cplusprog.css\">\n<link rel=\"first\" href=\"cplusprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"next\" HREF=\"node126.html\">\n<LINK REL=\"previous\" HREF=\"node124.html\">\n<LINK REL=\"up\" HREF=\"node120.html\">\n<LINK REL=\"next\" HREF=\"node126.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node124.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node120.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node126.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node124.html\">12.4 Determining Smallest Ring</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node120.html\">12. Ring Processing</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node126.html\">12.6 Identifying Ring Systems</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION0015500000000000000000\">\n12.5 Identifying Connected Components</A>\n</H1>\n\n<P>\nTo aid in splitting molecules into discrete connected components, for\nexample to separate a parent compound from its salt, or a ligand from\na protein, OEChem provides the function OEDetermineComponents.  This\nfunction arbitrarily assigns an integer index, starting from one, to\neach disconnected molecule in the OEMolBase.  The user provides a\npointer to an array of at least <code>OEMolBase::GetMaxAtomIdx</code> unsigned\nints, which is populated by the function.  On return this provides a mapping\nfrom each atom's index, obtained by <code>OEAtomBase::GetIdx</code>, to its\ncomponent index.  Unused atom indices are mapped to zero.  The function\nitself also returns the total number of components found, <I>i.e.</I>\nthe maximum part index stored in the array.\n\n<P>\nThe following provides a short example of how to use this function.\n\n<P>\n<dl><dd><pre class=\"verbatim\">void MyReportParts(const OEMolBase &amp;mol)\n{\n  unsigned int *parts;\n  unsigned int count;\n  unsigned int size;\n\n  size = (unsigned int)(mol.GetMaxAtomIdx()*sizeof(unsigned int));\n  parts = (unsigned int*)malloc(size);\n\n  count = OEDetermineComponents(mol,parts);\n  printf(\"The molecule has %d components\\n\",count);\n\n  OEIter&lt;OEAtomBase&gt; atom;\n  for (atom=mol.GetAtoms; atom; ++atom)\n    printf(\"atom %d is in part %d\\n\",atom-&gt;GetIdx(),part[atom-&gt;GetIdx()]);\n\n  free(parts);\n}\n</pre></dl>\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node124.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node120.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node126.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node124.html\">12.4 Determining Smallest Ring</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node120.html\">12. Ring Processing</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node126.html\">12.6 Identifying Ring Systems</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 38750.0}