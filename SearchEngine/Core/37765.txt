{"text": "OEChem Python Theory Manual Version 1 3 1 Previous 17 2 Using Query Molecules Up 17 Pattern Matching Next 17 4 Clique Search 17 3 Maximum Common Substructure Search Another method of pattern matching looks for substructures in common between the target molecule and a pattern but does not necessarily use the pattern as the only query Maximum Common Substructure MCS as implemented in OEChem uses much of the same machinery as standard substructure searching An instance of OEMCSSearch is constructed with a SMILES an OEMolBase or an OEQMolBase and then the pattern is matched against a target OEMatchBases are returned in an analogous fashion however there the similarity with substructure searching stops MCS searching can return matches from as large as the smaller of the two molecules being compared down to a single atom match When an MCS is constructed from a SMILES standard SMARTS matching rules apply for what constitutes a match If constructed with an OEQMol then whatever atom and bond expressions have been applied to the OEQMol apply to subsequent matches in the MCS search Finally there is a constructor that takes an OEMolBase directly along with an atom expression and a bond expression as defined above This prevents the need to pre define a query molecule The next example will read us a molecule created from parsing the SMILES create an MCS object from this molecule and then search through an input file for the MCS in each target molecule import os sys from openeye oechem import ch17 4 py mol1 OEGraphMol OEParseSmiles mol1 c1ccccc1C O C OEAssignAromaticFlags mol1 OETriposAtomNames mol1 create an OEMCSSearch from this molecule mcss OEMCSSearch mol1 OEExprOpts DefaultAtoms OEExprOpts DefaultBonds ignore substructures smaller than 4 atoms mcss SetMinAtoms 4 ifs oemolistream drugs sdf for mol in ifs GetOEMols OETriposAtomNames mol print mol GetTitle matchcount for mb in mcss Match mol print Match matchcount Size mb NumAtoms atoms for mp in mb GetAtoms sys stdout write s s mp target GetName mp pattern GetName print matchcount 1 OEChem Python Theory Manual Version 1 3 1 Previous 17 2 Using Query Molecules Up 17 Pattern Matching Next 17 4 Clique Search Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/pyprog/node151.html", "title": "17.3 maximum common substructure search", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>17.3 Maximum Common Substructure Search</title>\n<META NAME=\"description\" CONTENT=\"17.3 Maximum Common Substructure Search\">\n<META NAME=\"keywords\" CONTENT=\"pyprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"pyprog.css\">\n<link rel=\"first\" href=\"pyprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"next\" HREF=\"node152.html\">\n<LINK REL=\"previous\" HREF=\"node150.html\">\n<LINK REL=\"up\" HREF=\"node148.html\">\n<LINK REL=\"next\" HREF=\"node152.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node150.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node148.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node152.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - Python Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"genindex.html\"><img src=\"../icons/index.gif\"\n  border=\"0\" alt=\"Index\"></A></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node150.html\">17.2 Using Query Molecules</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node148.html\">17. Pattern Matching</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node152.html\">17.4 Clique Search</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION0019300000000000000000\">\n17.3 Maximum Common Substructure Search</A>\n</H1>\n\n<P>\nAnother method of pattern matching looks for substructures in common\nbetween the target molecule and a pattern, but does not necessarily\nuse the pattern as the only query. Maximum Common Substructure (MCS)\nas implemented in OEChem uses much of the same machinery as standard\nsubstructure searching.  An instance of OEMCSSearch is constructed\nwith a SMILES, an OEMolBase or an OEQMolBase and then the pattern is\nmatched against a target. OEMatchBases are returned in an analogous\nfashion, however, there the similarity with substructure searching\nstops. MCS searching can return matches from as large as the smaller\nof the two molecules being compared down to a single atom match.\n\n<P>\nWhen an MCS is constructed from a SMILES, standard SMARTS matching\nrules apply for what constitutes a match. If constructed with an\nOEQMol, then whatever atom and bond expressions have been applied to\nthe OEQMol, apply to subsequent matches in the MCS search. Finally,\nthere is a constructor that takes an OEMolBase directly along with an\natom expression and a bond expression as defined above.  This prevents\nthe need to pre-define a query molecule.\n\n<P>\nThe next example will read us a molecule created from parsing the\nSMILES, create an MCS object from this molecule and then search\nthrough an input file for the MCS in each target molecule.  import os,\nsys from openeye.oechem import *\n\n<P>\n<dl><dd><pre class=\"verbatim\"># ch17-4.py\nmol1=OEGraphMol()\nOEParseSmiles(mol1, \"c1ccccc1C(=O)C\")\nOEAssignAromaticFlags(mol1)\nOETriposAtomNames(mol1)\n\n# create an OEMCSSearch from this molecule\nmcss = OEMCSSearch(mol1,\n                   OEExprOpts_DefaultAtoms,OEExprOpts_DefaultBonds)\n# ignore substructures smaller than 4 atoms\nmcss.SetMinAtoms(4)\n\nifs = oemolistream(\"drugs.sdf\")\nfor mol in ifs.GetOEMols():\n    OETriposAtomNames(mol)\n    print mol.GetTitle()\n    matchcount = 0\n    for mb in mcss.Match(mol):\n        print \"Match:\", matchcount,\"Size:\",mb.NumAtoms(),\"atoms\"\n        for mp in mb.GetAtoms():\n            sys.stdout.write(\" %s-&gt;%s \" %\n                        (mp.target.GetName(),mp.pattern.GetName()))\n        print\n        matchcount += 1\n</pre></dl>\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node150.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node148.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node152.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - Python Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"genindex.html\"><img src=\"../icons/index.gif\"\n  border=\"0\" alt=\"Index\"></A></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node150.html\">17.2 Using Query Molecules</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node148.html\">17. Pattern Matching</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node152.html\">17.4 Clique Search</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 37765.0}