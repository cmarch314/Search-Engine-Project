{"text": "3 SMILES A Simplified Chemical Language SMILES Simplified Molecular Input Line Entry System is a line notation a typographical method using printable characters for entering and representing molecules and reactions Some examples are SMILESNameSMILESNameCCethane OH3 hydronium ionO C O carbon dioxide 2H O 2H deuterium oxideC Nhydrogen cyanide 235U uranium 235CCN CC CCtriethylamineF C C FE difluoroetheneCC O Oacetic acidF C C FZ difluoroetheneC1CCCCC1cyclohexaneN C H C C O OL alaninec1ccccc1 benzeneN C H C C O OD alanine Reaction SMILESName I Na C CCBr Na Br C CCIdisplacement reaction C O O OCC C O OCC O intermolecular esterification SMILES contains the same information as might be found in an extended connection table The primary reason SMILES is more useful than a connection table is that it is a linguistic construct rather than a computer data structure SMILES is a true language albeit with a simple vocabulary atom and bond symbols and only a few grammar rules SMILES representations of structure can in turn be used as words in the vocabulary of other languages designed for storage of chemical information information about chemicals and chemical intelligence information about chemistry Part of the power of SMILES is that unique SMILES exist With standard SMILES the name of a molecule is synonymous with its structure with unique SMILES the name is universal Anyone in the world who uses unique SMILES to name a molecule will choose the exact same name One other important property of SMILES is that it is quite compact compared to most other methods of representing structure A typical SMILES will take 5 to 7 less space than an equivalent connection table even binary connection tables For example a database of 23 137 structures with an average of 2 atoms per structure uses only 1 6 bytes per atom when represented with SMILES In addition ordinary compression of SMILES is extremely effective The same database cited above was reduced to 27 of its original size by Ziv Lempel compression i e 42 bytes per atom These properties open many doors to the chemical information programmer Examples of uses for SMILES are Keys for database access Mechanism for researchers to exchange chemical information Entry system for chemical data Part of languages for artificial intelligence or expert systems in chemistry The rest of this chapter is a concise exposition of the SMILES encoding rules For further information the reader is referred to SMILES 1 Introduction and Encoding Rules Weininger D J Chem Inf Comput Sci 1988 28 31 3 1 Canonicalization SMILES denotes a molecular structure as a graph with optional chiral indications This is essentially the two dimensional picture chemists draw to describe a molecule SMILES describing only the labeled molecular graph i e atoms and bonds but no chiral or isotopic information are known as generic SMILES There are usually a large number of valid generic SMILES which represent a given structure A canonicalization algorithm exists to generate one special generic SMILES among all valid possibilities this special one is known as the unique SMILES SMILES written with isotopic and chiral specifications are collectively known as isomeric SMILES A unique isomeric SMILES is known as an absolute SMILES See the following examples Input SMILESUnique SMILESOCCCCO CH3 CH2 OH CCOC C OCCOC O CCCOOC O C Br Cl NNC Cl Br C O O ClC Br N C O ONC Cl Br C O O O C O C N Br ClNC Cl Br C O O 3 2 SMILES Specification Rules SMILES notation consists of a series of characters containing no spaces Hydrogen atoms may be omitted hydrogen suppressed graphs or included hydrogen complete graphs Aromatic structures may be specified directly or in Kekul form There are five generic SMILES encoding rules corresponding to specification of atoms bonds branches ring closures and disconnections Rules for specifying various kinds of isomerism are discussed in the following section ISOMERIC SMILES 3 2 1 Atoms Atoms are represented by their atomic symbols this is the only required use of letters in SMILES Each non hydrogen atom is specified independently by its atomic symbol enclosed in square brackets The second letter of two character symbols must be entered in lower case Elements in the organic subset B C N O P S F Cl Br and I may be written without brackets if the number of attached hydrogens conforms to the lowest normal valence consistent with explicit bonds Lowest normal valences are B 3 C 4 N 3 5 O 2 P 3 5 S 2 4 6 and 1 for the halogens Atoms in aromatic rings are specified by lower case letters e g aliphatic carbon is represented by the capital letter C aromatic carbon by lower case c Since attached hydrogens are implied in the absence of brackets the following atomic symbols are valid SMILES notations C methane CH4 P phosphine PH3 N ammonia NH3 S hydrogen sulfide H2S O water H2O Cl hydrochloric acid HCl Atoms with valences other than normal and elements not in the organic subset must be described in brackets S elemental sulfur Au elemental gold Within brackets any attached hydrogens and formal charges must always be specified The number of attached hydrogens is shown by the symbol H followed by an optional digit Similarly a formal charge is shown by one of the symbols or followed by an optional digit If unspecified the number of attached hydrogens and charge are assumed to be zero for an atom inside brackets Constructions of the form Fe are synonymous with the form Fe 3 Examples are H proton Fe 2 iron II cation OH hydroxyl anion Fe iron II cation OH3 hydronium cation NH4 ammonium cation 3 2 2 Bonds Single double triple and aromatic bonds are represented by the symbols and respectively Adjacent atoms are assumed to be connected to each other by a single or aromatic bond single and aromatic bonds may always be omitted Examples are CC ethane CH3CH3 C O formaldehyde CH2O C Cethene CH2 CH2 O C O carbon dioxide CO2 COCdimethyl ether CH3OCH3 C Nhydrogen cyanide HCN CCOethanol CH3CH2OH H H molecular hydrogen H2 For linear structures SMILES notation corresponds to conventional diagrammatic notation except that hydrogens and single bonds are generally omitted For example 6 hydroxy 1 4 hexadiene can be represented by many equally valid SMILES including the following three StructureValid SMILES C CCC CCOCH2 CH CH2 CH CH CH2 OH C C C C C C O OCC CCC C 3 2 3 Branches Branches are specified by enclosing them in parentheses and can be nested or stacked In all cases the implicit connection to a parenthesized expression a branch is to the left Examples are CCN CC CCCC C C O OC CC CCC C C C C CCCTriethylamineIsobutyric acid3 propyl 4 isopropyl 1 heptene 3 2 4 Cyclic Structures Cyclic structures are represented by breaking one bond in each ring The bonds are numbered in any order designating ring opening or ring closure bonds by a digit immediately following the atomic symbol at each ring closure This leaves a connected non cyclic graph which is written as a non cyclic structure using the three rules described above Cyclohexane is a typical example There are usually many different but equally valid descriptions of the same structure e g the following SMILES notations for 1 methyl 3 bromo cyclohexene 1 Many other notations may be written for the same structure deriving from different ring closures SMILES does not have a preferred entry on input although a above may be simplest others are just as valid A single atom may have more than one ring closure This is illustrated by the structure of cubane in which two atoms have more than one ring closure Generation of SMILES for cubane C12C3C4C1C5C4C3C25 If desired digits denoting ring closures can be reused As an example the digit 1 used twice in the specification O1CCCCC1N1CCCCC1 The ability to re use ring closure digits makes it possible to specify structures with 1 or more rings Structures that require more than 1 ring closures to be open at once are exceedingly rare If necessary or desired higher numbered ring closures may be specified by prefacing a two digit number with percent sign For example C2 13 24 is a carbon atom with a ring closures 2 13 and 24 3 2 5 Disconnected Structures Disconnected compounds are written as individual structures separated by a period The order in which ions or ligands are listed is arbitrary There is no implied pairing of one charge with another nor is it necessary to have a net zero charge If desired the SMILES of one ion may be imbedded within another as shown in the example of sodium phenoxide Matching pairs of digits following atom specifications imply that the atoms are bonded to each other The bond may be explicit bond symbol and or direction preceding the ring closure digit or implicit a nondirectional single or aromatic bond This is true whether or not the bond ends up as part of a ring Adjacent atoms separated by dot implies that the atoms are not bonded to each other This is true whether or not the atoms are in the same connected component For example C1 C1 specifies the same molecule as CC ethane 3 3 Isomeric SMILES This section describes the SMILES rules used to specify isotopism configuration about double bonds and chirality The term isomeric SMILES collectively refers to SMILES written using these rules The SMILES isomer specification rules allow chirality to be completely specified for any structure if it is known Unlike most existing chemical nomenclatures such as CIP and IUPAC these rules are also designed to allow rigorous partial specification of chirality Aside from use in macros substructure searching and other pattern matching operations this is important because much of the world s available chemical information is known for structures with incompletely resolved chiralities not all possible chiral centers are separated known or reported All isomer specification rules in SMILES are therefore optional The absence of a specification for any attribute implies that the value of that attribute is unspecified 3 3 1 Isotopic Specification Isotopic specifications are indicated by preceding the atomic symbol with a number equal to the desired integral atomic mass An atomic mass can only be specified inside brackets For instance SmilesName 12C carbon 12 13C carbon 13 C carbon unspecified mass 13CH4 C 13 methane 3 3 2 Configuration Around Double Bonds Configuration around double bonds is specified by the characters and which are directional bonds and can be thought of as kinds of single bonds These symbols indicate relative directionality between the connected atoms and have meaning only when they occur on both atoms which are double bonded For instance the following SMILES are all valid for E and Z 1 2 difluoroethene F C C FF C C FF C C FF C C F An important difference between SMILES chirality conventions and others such as CIP is that SMILES uses local chirality representation as opposed to absolute chirality which allows partial specifications An example of this is illustrated below F C C C C CF C C C CC completely specified partially specified 3 3 3 Configuration Around Tetrahedral Centers SMILES uses a very general type of chirality specification based on local chirality Instead of using a rule based numbering scheme to order neighbor atoms of a chiral center orientations are based on the order in which neighbors occur in the SMILES string As with all other aspects of SMILES any valid order is acceptable the Daylight software is responsible for retaining the meaning of the chiral specification when the structure is modified or rearranged e g to make the unique SMILES The simplest and most common kind of chirality is tetrahedral four neighbor atoms are evenly arranged about a central atom known as the chiral center If all four neighbors are different from each other in any way mirror images of the structure will not be identical The two mirror images are known as enantiomers and are the only two forms that a tetrahedral center can have If two or more of the four neighbors are identical to each other the central atom will not be chiral its mirror images can be superimposed in space In SMILES tetrahedral centers may be indicated by a simplified chiral specification or written as an atomic property following the atomic symbol of the chiral atom If a chiral specification is not present for a chiral atom its chirality is implicitly not specified For instance NC C F C O ON C C F C O ONC F C C O ON C F C C O O unspecified chirality specified chirality Looking from the amino N to the chiral C as the SMILES is written the three other neighbors appear anticlockwise in the order that they are written in the top SMILES N C C F C O O methyl C F carboxy C and clockwise in the bottom one N C F C C O O The symbol indicates that the following neighbors are listed anticlockwise it is a visual mnemonic in that the symbol looks like an anticlockwise spiral around a central circle indicates that the neighbors are listed clockwise you guessed it anti anti clockwise If the central carbon is not the very first atom in the SMILES and has an implicit hydrogen attached it can have at most one and still be chiral the implicit hydrogen is taken to be the first neighbor atom of the three neighbors that follow a tetrahedral specification If the central carbon is first in the SMILES the implicit hydrogen is taken to be the from atom Hydrogens may always be written explicitly as H in which case they are treated like any other atom In each case the implied order is exactly as written in SMILES Some of the valid SMILES for the alanine are N C H C C O ON C H C C O ON C H C C O ON C H C C O ON C H C O O C N C H C O O C H C N C C O O H C N C C O O C H N C C O O C H N C C O O The chiral order of the ring closure bond is implied by the lexical order that the ring closure digit appears on the chiral atom not in the lexical order of the substituent atom C C H 1CCCCO1 orO1CCCC C H 1C 3 3 4 General Chiral Specification There are many kinds of chirality other than tetrahedral The use of the symbol described above is actually a special case of a general chiral specification syntax The general chiral specification used in SMILES has three parts the symbol followed by a two letter chiral class indicator followed by a numerical chiral permutation designator A default chiral class is assigned to each degree number of connections the default class for four connections is tetrahedral TH Most chiralities have more than two possible choices the choices are assigned from a table numerically In most cases the 1 designation means anticlockwise around the axis represented by SMILES order and 2 means clockwise Notations in the form and are interpreted as 2 and 3 analogous to meaning 3 The and notations used above are shortcuts for the full specifications TH1 and TH2 In practice full chiral specifications are not often needed SMILES handles the full range of chiral specification including resolution of reduced chirality where the number of enantiomers is reduced by symmetry and degenerate chirality where the center becomes non chiral due to symmetrical substitution As with other aspects of SMILES the language guarantees the ability to specify exactly what is known including partial specifications The SMILES system will generate unique isomeric SMILES for any given specification and substructure recognition will operate correctly on all types of chirality The rest of this section will be limited to discussing the following chiralities tetrahedral allene like square planar trigonal bipyramidal and octahedral Although many more chiral classes can be handled by this system it s table driven these five classes are very common in chemistry and cover most of the issues to be encountered in the remainder Tetrahedral The tetrahedral class symbol is TH This is the default chiral class for degree four Possible values are 1 and 2 TH1 or just indicates that looking from the first connected atom the following three connected atoms are listed anticlockwise TH2 or indicates clockwise Allene like The allene like class symbol is AL This is the default chiral class for degree 2 the chiral center is the central atom with two double bonds Although substituted C C C structures are most common C C C C C structures are also allene like as are any odd number of serially double bonded atoms Possible values are AL1 or just and AL2 or these are interpreted by superimposing the substituted atoms and evaluating as per tetrahedral Hydrogens attached to substituted allene like atoms are taken to be immediately following that atom as shown below OC Cl C C C FOC C CFOC Cl C AL1 C C FOC H C AL1 C H F Square planar The square planar class symbol is SP Possible values are SP1 SP2 and SP3 this is not the default chiral class for degree four so shorthand specifications are not allowed Square planar is also somewhat unusual in that the ideas of clockwise and anticlockwise do not apply F Po SP1 Cl Br I SP1 lists in a U shape F Po SP2 Br Cl I SP2 lists in a 4 shape F Po SP3 Cl I Br SP3 lists in a Z shape Trigonal bipyramidal The trigonal bipyramidal class symbol is TB This is the default chiral class for degree five Possible values are TB1 to TB2 TB1 or just indicates that when the SMILES is listed from one axial connection to the other the three intermediate equatorially connected atoms are listed anticlockwise TB2 or indicates clockwise This is illustrated below s As F Cl Br C OO C As F Cl Br S Octahedral The octahedral class symbol is OH This is the default chiral class for degree six Possible values are OH1 to OH3 OH1 or just indicates that when the SMILES is listed from one axial connection to the other the four intermediate equatorially connected atoms are listed anticlockwise OH2 or indicates clockwise This is illustrated below S Co F Cl Br I C OO C Co F Cl Br I S 3 4 SMILES Conventions Aside from the above rules a small number of conventions are universally used in SMILES These are briefly discussed below for more detail see the JCICS paper ibid 3 4 1 Hydrogens Hydrogen atoms do not normally need to be specified when writing SMILES for most organic structures The presence of hydrogens may be specified in three ways Implicitly for atoms specified without brackets from normal valence assumptions Explicitly by count inside brackets by the hydrogen count supplied zero if unspecified As explicit atoms as H atoms There is no distinction between organic and inorganic SMILES nomenclature One may specify the number of attached hydrogens for any atom in any SMILES For example propane may be entered as CH3 CH2 CH3 instead of CCC There are four situations where specification of explicit hydrogen specification is required charged hydrogen i e a proton H hydrogens connected to other hydrogens e g molecular hydrogen H H hydrogens connected to other than one other atom e g bridging hydrogens and isotopic hydrogen specifications e g in heavy water 2H O 2H 3 4 2 Aromaticity Aromaticity must be deduced in a system such as SMILES which generates an unambiguous chemical nomenclature because of the fundamental requirement to characterize the symmetry of a molecule Given effective aromaticity detection algorithms it is not necessary to enter any structure as aromatic if the user prefers to enter an aliphatic Kekul like structure Entering structures as aromatic directly i e by using lower case atomic symbols provides a shortcut to accurate chemical specification and is closer to the mental molecular model used by most chemists The SMILES algorithm uses an extended version of Hueckel s rule to identify aromatic molecules and ions To qualify as aromatic all atoms in the ring must be sp2 hybridized and the number of available excess p electrons must satisfy Hueckel s 4N 2 criterion As an example benzene is written c1ccccc1 but an entry of C1 CC CC C1 cyclohexatriene the Kekul form leads to detection of aromaticity and results in an internal structural conversion to aromatic representation Conversely entries of c1ccc1 and c1ccccccc1 will produce the correct anti aromatic structures for cyclobutadiene and cyclooctatetraene C1 CC C1 and C1 CC CC CC C1 In such cases the SMILES system looks for a structure that preserves the implied sp2 hybridization the implied hydrogen count and the specified formal charge if any Some inputs however may not only be incorrect but also impossible such as c1cccc1 Here c1cccc1 cannot be converted to C1 CCC C1 since one of the carbon atoms would be sp3 with two attached hydrogens In such a structure alternating single and double bond assignments cannot be made The SMILES system will flag this as an impossible input Please note that only atoms on the following list can be considered aromatic C N O P S As Se and wildcard In addition exocyclic double bonds do not break aromaticity C1 COC C1C1 CN C NH C O 1C1 C CC C1c1cocc1c1cnc nH c O 1c1c ccc1 It is important to remember that the purpose of the SMILES aromaticity detection algorithm is for the purposes of chemical information representation only To this end rigorous rules are provided for determining the aromaticity of charged heterocyclic and electron deficient ring systems The aromaticity designation as used here is not intended to imply anything about the reactivity magnetic resonance spectra heat of formation or odor of substances 3 4 3 Aromatic Nitrogen Compounds A short note is in order about aromatic nitrogens a common source of confusion in chemical information systems All three common types of aromatic nitrogen may be specified with the aromatic nitrogen symbol n Archetypical examples are pyridine pyridine N oxide and pyrrole n1ccccc1O n1ccccc1 O n 1ccccc1Cn1cccc1 nH 1cccc1PyridinePyridine N oxideMethyl and 1H pyrrole Note that the pyrrolyl nitrogen in 1H pyrrole is written nH to distinguish this kind of nitrogen from a pyridyl N Alternative valid SMILES for 1H pyrrole include H n1cccc1 with explicit hydrogen and N1C CC C1 aliphatic form all three input forms are equivalent 3 4 4 Bonding Conventions SMILES does not dictate which valence conventions should be used to model molecular structure In fact an advantage of using SMILES is its ability to describe various valence models of the same structure Atoms may be connected and show charge separation as desired For instance nitromethane can be represented in SMILES as CN O O or as the charge separated C N O O we tend to use the former for database work because it preserves symmetry Both are right in the sense that they represent different useful models of the substance In general when symmetry is not an issue most chemists prefer charge separated structures if they can avoid representing atoms in unusual valence states e g diazomethane is written as C N N rather than C N N Given one valence model of a structure chemical database systems such as THOR and Merlin have the ability to retrieve data about that structure even if the data were stored under a different valence model of the structure With such systems the choice of valence conventions is not critical to either database design nor database query 3 4 5 Tautomers Tautomeric structures are explicitly specified in SMILES There are no tautomeric bond mobile hydrogen nor mobile charge specifications Selection of one or all tautomeric structures is left to the user and strongly depends on the application Given one tautomeric form most chemical information systems will report data for all known tautomers if needed The role of SMILES is to specify exactly which tautomeric form is requested and for which there are data A simple example with two possible tautomeric forms is shown below O c1 nH cccc1 Oc1ncccc12 pyridone 2 pyridinol 3 5 Extensions for Reactions The SMILES language is extended to handle reactions There are two areas where SMILES is extended distinguishing component parts of a reactions and atom maps Component parts of a reaction are handled by introducing the character as a new separator Any reaction must have exactly two characters in it is a valid reaction SMILES for an empty reaction Each of the separated components of a reaction must be a valid molecule SMILES As an aside molecule SMILES never have a character In a program one can quickly determine if a SMILES refers to a reaction or molecule by searching for a character in the string Reaction SMILES Grammar reaction reactant agent product reactant product reactant agent product molecule null molecule SMILES SMILES a valid molecule specification in the SMILES language For example C CCBr C CCI This is a valid reaction Note that there are no agent molecules Also note that several atoms are missing from the reaction the product Br and the reactant F I Na C CCBr Na Br C CCI This is a more complete version of the same reaction It has been canonicalized It would form the root of a datatree when stored in a THOR database C CCBr Na I CC O C C CCI Na Br This version of the reaction includes an agent Note that the SMILES does not indicate how the agent participates Whether the agent is a solvent catalyst or performs another function within the reaction must be stored separately as data This SMILES could be stored in a THOR database as an absolute SMILES and would appear on the same datatree page as the previous example In the above example note that the reaction is ambiguous with respect to the carbon atoms involved One might assume that a normal Sn2 displacement is occurring In fact an equally reasonable allylic displacement is possible via either an Sn1 like allyl cation Recognize that the reaction SMILES given above do not say which carbons are which and hence do not discriminate between the two alternate mechanisms This case demonstrates the use and need for atom maps for reaction processing Atom maps are used primarily to further define the overall reaction in cases where the reaction mechanism may not be evident from the reactant and product molecules Atom maps are non negative integer atom modifiers They follow the character within an atom expression They must be the last modifier within the atom expression SMILES Atom Expression Grammar atom SYMBOL WEIGHT SYMBOL mods WEIGHT SYMBOL mods CLASS mods mod mods mod HCOUNT CHARGE CHIRAL CLASS non negative integer class value WEIGHT atomic weight SYMBOL atomic symbol HCOUNT Atom hydrogen count specification CHARGE Atom charge specification CHIRAL Atom chirality specification Atom maps are an atomic property They can legally appear in a SMILES for any atom whether or not it is part of a reaction Atom with atom map labels in a molecule SMILES are considered valid the atom maps are ignored for molecule processing Absolute and unique SMILES generated by the system for molecules never include atom maps Finally there are some differences in the handling of atom maps and agent components in the unique versus absolute SMILES for reactions Atom maps and agent components are not part of the unique SMILES specification This is important for the THOR database where the datatree roots are formed from the unique SMILES The net result is that each reaction datatree may contain multiple specific reactions with different agents and atom maps 3 5 1 Reaction Atom Maps Atom mappings are properties of the atoms in the reaction molecules The mappings represent equivalence classes of atoms within a reaction In effect the map tells the computer which atoms are the same on the reactant and products sides of a reaction Without this map information it is difficult to derive the reaction bond changes which occur Within the SMILES language atom maps are represented as a non negative numeric atom modifier following the character e g CH3 2 is a carbon in class 2 Within the Daylight toolkit the atom maps are manipulated as sets of mapped atoms The atom map class numbers which are used in SMILES do not appear in the toolkit interface to a reaction The map class numbers in SMILES do not have any additional significance except to associate all atoms with the same map class label to one another There are no requirements for completeness or uniqueness of the atom mappings Atom mappings are independent of the connectivity and properties of the underlying molecules This is so for several reasons first there are limits to the valence representation of molecules which appear when processing reactions For example the oxygens in sodium acetate CC O O Na are chemically indistinguishable even though the valence model used in the toolkit requires that they be connected differently Some systems CAS for example recognize this equivalence in their structural representation the tautomer bond It is often useful to map these to the same class for reaction purposes CH3 1 C 2 O 3 O 3 Na 4 A second case is where there is ambiguity in a reaction mechanism which one wants to express can undergo a cope rearrangement before reaction which yields the same molecule graph In effect there are two distinct mechanisms by which the product is produced This can be expressed as part of a reaction by CH2 1 CH 2 CH2 1 CH2 3 C 4 C CH2 3 A third case is simply a lack of information about the reaction itself It should be possible to omit some atom maps or specify partial information for sets of atoms which might end up in a given position in the product It is never acceptable to force a user to make up data in order to register a reaction One should only store exactly what is known about the reaction Atom maps are by definition ambiguous with respect to the underlying molecules Atom maps do not appear in the lexical representation of a unique SMILES They do appear in the lexical representation of an absolute SMILES Finally atom maps are arbitrary class designations the values of the numbers have no meaning The Daylight system reserves the right to change the class numbers upon canonicalization of a reaction The system will reorder the atom map classes over the entire reaction during canonicalization The resulting maps are guaranteed to have the same meaning as the reaction before canonicalization Practically the maps are renumbered as small dense integers in canonical atom order but this is not guaranteed Also during canonicalization the atom map classes for agent atoms are removed 3 5 2 Hydrogens Hydrogens in reactions are handled as with molecules they are suppressed unless special Recall that for molecules hydrogens are special if they are charged isotopic bonded to another hydrogen or multiply bonded With reactions there is an additional case which will make a hydrogen special It is often desirable eg 1 5 hydride shift to store information about the location of hydrogens as part of the atom map of a reaction Hydrogens with a supplied atom map are considered special and these hydrogens are not suppressed These mapped hydrogens appear explicitly in Absolute SMILES for reactions Otherwise atom mapped hydrogens do not appear in Unique SMILES 3 6 Acknowledgments Development of SMILES was initiated by the author David Weininger at the Environmental Research Laboratory U S E P A Duluth MN the design was completed at Pomona College in Claremont CA It was embodied in the Daylight Toolkit with the assistance of Cedar River Software Go To Next Chapter 4 SMARTS A Language for Describing Molecular Patterns Back to Table of Contents", "_id": "http://www.ics.uci.edu/~dock/manuals/DaylightTheoryManual/theory.smiles.html", "title": "daylight theory: smiles", "html": "<html><head> \n    <link rel=\"stylesheet\" href=\"/b.css\" type=\"text/css\">\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<title>Daylight Theory: SMILES</title></head>\n<body leftmargin=0 marginwidth=0 topmargin=0 marginheight=0> \n<table width=750 border=0 cellpadding=0 cellspacing=0> \n     <tr> \n     <td><iframe src=\"/iframes/header2.html\" name=\"iframe4\" width=\"745\" height=\"170\" \n     scrolling=\"no\" frameborder=0></iframe></td>  \n     </tr> \n</table> \n<table width=750 cellpadding=15> \n     <tr><td class=\"border-bot\">\n\n<h1><center>\n3. SMILES - A Simplified Chemical Language</h1></center>\n<p>\n\n\nSMILES (Simplified Molecular Input Line Entry System) is a <i>line notation</i>\n(a typographical method using printable characters) for entering and representing molecules and reactions.\nSome examples are:<p>\n<center>\n<table border>\n<th>SMILES</th><th>Name</th><th>SMILES</th><th>Name</th>\n<tr>\n  <td>CC</td>\n  <td>ethane</td>\n  <td>[OH3+]</td>\n  <td>hydronium ion</td>\n</tr>\n\n<tr>\n  <td>O=C=O </td>\n  <td>carbon dioxide</td>\n  <td>[2H]O[2H]</td>\n  <td>deuterium oxide</td>\n</tr>\n\n<tr>\n  <td>C#N</td>\n  <td>hydrogen cyanide</td>\n  <td>[235U]</td>\n  <td>uranium-235</td>\n</tr>\n\n<tr>\n  <td>CCN(CC)CC</td>\n  <td>triethylamine</td>\n  <td>F/C=C/F</td>\n  <td>E-difluoroethene</td>\n</tr>\n\n<tr>\n  <td>CC(=O)O</td>\n  <td>acetic acid</td>\n  <td>F/C=C\\F</td>\n  <td>Z-difluoroethene</td>\n</tr>\n\n<tr>\n  <td>C1CCCCC1</td>\n  <td>cyclohexane</td>\n  <td>N[C@@H](C)C(=O)O</td>\n  <td>L-alanine</td>\n</tr>\n\n<tr>\n  <td>c1ccccc1 </td>\n  <td>benzene</td>\n  <td>N[C@H](C)C(=O)O</td>\n  <td>D-alanine</td>\n</tr>\n</table>\n<br><br>\n<table border>\n<th>Reaction SMILES</th><th>Name</th>\n<tr>\n  <td>[I-].[Na+].C=CCBr>>[Na+].[Br-].C=CCI</td>\n  <td>displacement reaction</td>\n</tr>\n<tr>\n  <td>(C(=O)O).(OCC)>>(C(=O)OCC).(O)</td>\n  <td>intermolecular esterification</td>\n</tr>\n</table>\n</center>\n</p>\n<p>\nSMILES contains the same information as might be found in an extended\nconnection table.  The primary reason SMILES is more useful than a connection\ntable is that it is a linguistic construct, rather than a computer data\nstructure.  SMILES is a true language, albeit with a simple vocabulary (atom\nand bond symbols) and only a few grammar rules.  SMILES representations of\nstructure can in turn be used as \"words\" in the vocabulary of other languages\ndesigned for storage of chemical information (information about chemicals) and\nchemical intelligence (information about chemistry).\n</p>\n<p>\nPart of the power of SMILES is that unique SMILES exist.  With\nstandard SMILES, the name of a molecule is synonymous with its structure; with\nunique SMILES, the name is universal.  Anyone in the world who uses unique\nSMILES to name a molecule will choose the exact same name.\n</p><p>\nOne other important property of SMILES is that it is quite compact compared to\nmost other methods of representing structure.  A typical SMILES will take 50%\nto 70% less space than an equivalent connection table, even binary connection\ntables.  For example, a database of 23,137 structures, with an average of 20\natoms per structure, uses only 1.6 bytes per atom when represented with SMILES.\nIn addition, ordinary compression of SMILES is extremely effective. \nThe same database cited above was reduced to 27% of its original size by Ziv-Lempel compression (i.e. 0.42 bytes per atom).\n</p><p>\nThese properties open many doors to the chemical information\nprogrammer.  Examples of uses for SMILES are:\n<ul>\n<li>Keys for database access\n<li>Mechanism for researchers to exchange chemical information\n<li>Entry system for chemical data\n<li>Part of languages for artificial intelligence or expert systems in chemistry\n</ul>\nThe rest of this chapter is a concise exposition of the SMILES encoding rules.\nFor further information, the reader is referred to<i> \"SMILES 1. Introduction\nand Encoding Rules\", </i>Weininger, D., <i>J.Chem. Inf. Comput. Sci.</i>\n1988, 28,31.\n\n<h2><a name=\"RTFToCX1\"></a>3.1 Canonicalization</h2>\nSMILES denotes a molecular structure as a graph with optional chiral indications. \nThis is essentially the two-dimensional picture chemists draw to describe a molecule. \nSMILES describing only the labeled molecular graph (i.e. atoms and bonds, but no chiral \nor isotopic information) are known as generic SMILES. There are usually a large number \nof valid generic SMILES which represent a given structure. A canonicalization algorithm exists \nto generate one special generic SMILES among all valid possibilities; this special \none is known as the \"unique SMILES\". SMILES written with isotopic and chiral specifications \nare collectively known as \"isomeric SMILES\". A unique isomeric SMILES is known as an \n\"absolute SMILES\". See the following examples.\n</p>\n<center>\n<table border>\n<th>Input SMILES</th><th>Unique SMILES</th>\n<tr>\n  <td>OCC</td>\n  <td>CCO</td>\n</tr>\n<tr>\n  <td>[CH3][CH2][OH] </td>\n  <td>CCO</td>\n</tr>\n<tr>\n  <td>C-C-O</td>\n  <td>CCO</td>\n</tr>\n<tr>\n  <td>C(O)C</td>\n  <td>CCO</td>\n</tr>\n<tr>\n  <td>OC(=O)C(Br)(Cl)N</td>\n  <td>NC(Cl)(Br)C(=O)O </td>\n</tr>\n<tr>\n  <td>ClC(Br)(N)C(=O)O</td>\n  <td>NC(Cl)(Br)C(=O)O </td>\n</tr>\n<tr>\n  <td>O=C(O)C(N)(Br)Cl</td>\n  <td>NC(Cl)(Br)C(=O)O </td>\n</tr>\n</table>\n</center>\n<p>\n\n<h2><a name=\"RTFToC15\"></a>3.2 SMILES Specification Rules</h2>\nSMILES notation consists of a series of characters containing no spaces.\nHydrogen atoms may be omitted (hydrogen-suppressed graphs) or included\n(hydrogen-complete graphs).  Aromatic structures may be specified directly or\nin Kekul&eacute; form.\n</p>\n<p>\nThere are five generic SMILES encoding rules, corresponding to specification of\natoms, bonds, branches, ring closures, and disconnections.  Rules for\nspecifying various kinds of isomerism are discussed in the following section,\n<i>ISOMERIC SMILES</i>.\n\n<h3><a name=\"RTFToC16\"></a>3.2.1 Atoms</h3>\nAtoms are represented by their atomic symbols: this is the only required use of\nletters in SMILES.  Each non-hydrogen atom is specified independently by its\natomic symbol enclosed in square brackets, <b>[ ]</b>.  The second letter of\ntwo-character symbols must be entered in lower case.  Elements in the \"organic\nsubset\" <b>B, C, N, O, P, S, F, Cl, Br, </b>and<b> I</b> may be written without\nbrackets if the <i>number of attached hydrogens conforms to the lowest normal\nvalence consistent with explicit bonds</i>.  \"Lowest normal valences\" are B\n(3), C (4), N (3,5), O (2), P (3,5), S (2,4,6), and 1 for the halogens. Atoms\nin aromatic rings are specified by lower case letters, e.g., aliphatic carbon\nis represented by the capital letter <tt><b>C</b></tt>, aromatic carbon by\nlower case <tt><b>c</b></tt>.  Since attached hydrogens are implied in the\nabsence of brackets, the following atomic symbols are valid SMILES notations.\n</p>\n<p>\n<center>\n<table border>\n<tr>\n  <td><b>C</b> </td>\n  <td> methane </td>\n  <td> (CH4)</td>\n</tr>\n\n<tr>\n  <td><b>P</b> </td>\n  <td> phosphine </td>\n  <td> (PH3)</td>\n</tr>\n\n<tr>\n  <td><b>N</b> </td>\n  <td> ammonia </td>\n  <td> (NH3)</td>\n</tr>\n\n<tr>\n  <td><b>S</b> </td>\n  <td> hydrogen sulfide </td>\n  <td> (H2S)</td>\n</tr>\n\n<tr>\n  <td><b>O</b> </td>\n  <td> water </td>\n  <td> (H2O)</td>\n</tr>\n\n<tr>\n  <td><b>Cl</b> </td>\n  <td> hydrochloric acid </td>\n  <td> (HCl)</td>\n</tr>\n</table>\n</center>\n<p>\n\n\nAtoms with valences other than \"normal\" and elements not in the \"organic\nsubset\" must be described in brackets.\n</p>\n<p>\n<center>\n<table border>\n<tr>\n  <td>[<b>S</b>] </td>\n  <td> elemental sulfur</td>\n</tr>\n\n<tr>\n  <td>[<b>Au</b>] </td>\n  <td> elemental gold</td>\n</tr>\n</table>\n</center><p>\n\nWithin brackets, any attached hydrogens and formal charges must always be\nspecified.  The number of attached hydrogens is shown by the symbol <b>H</b>\nfollowed by an optional digit.  Similarly, a formal charge is shown by one of\nthe symbols <b>+</b> or <b>-</b>, followed by an optional digit.  If\nunspecified, the number of attached hydrogens and charge are assumed to be zero\nfor an atom inside brackets.  Constructions of the form [Fe+++] are synonymous\nwith the form [Fe+3].  Examples are:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td>[<b>H+</b>] </td>\n  <td> proton </td>\n</tr>\n\n<tr>\n  <td>[<b>Fe+2</b>] </td>\n  <td> iron (II) cation </td>\n</tr>\n\n<tr>\n  <td>[<b>OH-</b>] </td>\n  <td>  hydroxyl anion </td>\n</tr>\n\n<tr>\n  <td>[<b>Fe++</b>] </td>\n  <td> iron (II) cation </td>\n</tr>\n\n<tr>\n  <td>[<b>OH3+</b>] </td>\n  <td> hydronium cation </td>\n</tr>\n\n<tr>\n  <td>[<b>NH4+</b>] </td>\n  <td> ammonium cation </td>\n</tr>\n</table>\n</center>\n\n<h3>\n<a name=\"RTFToC17\"></a>3.2.2 Bonds</h3>\nSingle, double, triple, and aromatic bonds are represented by the symbols -, =,\n<b>#</b>, and :, respectively.  Adjacent atoms are assumed to be connected to\neach other by a single or aromatic bond (single and aromatic bonds may always\nbe omitted).  Examples are:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><b>CC </b></td>\n  <td>ethane </td>\n  <td>(CH3CH3)</td>\n</tr>\n\n<tr>\n  <td><b>C=O </b></td>\n  <td>formaldehyde </td>\n  <td>(CH2O)</td>\n</tr>\n\n<tr>\n  <td><b>C=C</b></td>\n  <td>ethene </td>\n  <td>(CH2=CH2)</td>\n</tr>\n\n<tr>\n  <td><b>O=C=O</b> </td>\n  <td>carbon dioxide </td>\n  <td>(CO2)</td>\n</tr>\n\n<tr>\n  <td><b>COC</b></td>\n  <td>dimethyl ether </td>\n  <td>(CH3OCH3)</td>\n</tr>\n\n<tr>\n  <td><b>C#N</b></td>\n  <td>hydrogen cyanide </td>\n  <td>(HCN)</td>\n</tr>\n\n<tr>\n  <td><b>CCO</b></td>\n  <td>ethanol </td>\n  <td>(CH3CH2OH)</td>\n</tr>\n\n<tr>\n  <td><b>[H][H]</b></td>\n  <td> molecular hydrogen </td>\n  <td>(H2)</td>\n</tr>\n\n</table>\n</center>\n</p>\n<p>\n\nFor linear structures, SMILES notation corresponds to conventional diagrammatic\nnotation except that hydrogens and single bonds are generally omitted.  For\nexample, 6-hydroxy-1,4-hexadiene can be represented by many equally valid\nSMILES, including the following three:\n</p>\n<p>\n\n<center>\n<table border>\n<th>Structure</th><th>Valid SMILES</th>\n<tr>\n  <td>&nbsp;</td>\n  <td ALIGN=CENTER>C=CCC=CCO</td>\n</tr>\n\n<tr>\n  <td ALIGN=CENTER>CH2=CH-CH2-CH=CH-CH2-OH </td>\n  <td ALIGN=CENTER>C=C-C-C=C-C-O</td>\n</tr>\n\n<tr>\n  <td>&nbsp;</td>\n  <td ALIGN=CENTER>OCC=CCC=C</td>\n</tr>\n</table>\n</center><p>\n\n\n<h3>\n<a name=\"RTFToC18\"></a>3.2.3 Branches</h3>\nBranches are specified by enclosing them in parentheses, and can be nested or\nstacked.  In all cases, the implicit connection to a parenthesized expression (a\n\"branch\") is to the left. Examples are:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory1.gif\"></td>\n  <td><img src=\"theory2.gif\"></td>\n  <td><img src=\"theory3.gif\"></td>\n</tr>\n\n<tr>\n<td align=center>CCN(CC)CC</td>\n<td align=center>CC(C)C(=O)O</td>\n<td align=center>C=CC(CCC)C(C(C)C)CCC</td>\n</tr>\n\n<tr>\n  <td align=center><b>Triethylamine</b></td>\n  <td align=center><b>Isobutyric acid</b></td>\n  <td align=center><b>3-propyl-4-isopropyl-1-heptene</b></td>\n</tr>\n\n</table>\n</center>\n<p>\n\n</center>\n</p>\n<p>\n\n<h3>\n<a name=\"RTFToC19\"></a>3.2.4 Cyclic Structures</h3>\nCyclic structures are represented by breaking one bond in\neach ring.  The bonds are numbered in any order, designating ring opening (or\nring closure) bonds by a digit immediately following the atomic symbol at each\nring closure.  This leaves a connected non-cyclic graph which is written as a\nnon-cyclic structure using the three rules described above.  Cyclohexane is a\ntypical example:\n</p>\n<p>\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory4.gif\"></td>\n</tr>\n</table>\n</center><p>\n\n\nThere are usually many different, but equally valid descriptions of the same\nstructure, e.g., the following SMILES notations for\n1-methyl-3-bromo-cyclohexene-1:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory5.gif\"></td>\n</tr>\n</table>\n</center>\n</p>\n<p>\n\n\nMany other notations may be written for the same structure, deriving from\ndifferent ring closures.  SMILES does not have a preferred entry on input;\nalthough (a) above may be simplest, others are just as valid.\n</p>\n<p>\nA single atom may have more than one ring closure.  This is illustrated by the\nstructure of cubane in which two atoms have more than one ring closure:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory6.gif\"></td>\n</tr>\n\n</table>\n</center>\n</p>\n<p>\n\n\nGeneration of SMILES for cubane: <b>C12C3C4C1C5C4C3C25</b>.\n</p>\n<p>\nIf desired, digits denoting ring closures can be reused.  As an example, the\ndigit 1  used twice in the  specification:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory7.gif\"></td>\n</tr>\n\n<tr>\n  <td>O1CCCCC1N1CCCCC1</td>\n</tr>\n\n</table>\n</center>\n</p>\n<p>\n\nThe ability to re-use ring closure digits makes it possible to specify\nstructures with 10 or more rings.  Structures that require more than 10 ring\nclosures to be open at once are exceedingly rare.  If necessary or desired,\nhigher-numbered ring closures may be specified by prefacing a two-digit number\nwith  percent sign (<b>%</b>).  For example, <b>C2%13%24</b> is a carbon atom\nwith a ring closures 2, 13, and 24 .\n<h3>\n<a name=\"RTFToC20\"></a>3.2.5 Disconnected Structures</h3>\nDisconnected compounds are written as individual structures separated by a\n\"<b>.</b>\" (period).  The order in which ions or ligands are listed is\narbitrary.  There is no implied pairing of one charge with another, nor is it\nnecessary to have a net zero charge.  If desired, the SMILES of one ion may be\nimbedded within another as shown in the example of sodium phenoxide.\n</p>\n<p>\n\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory8.gif\"></td>\n</tr>\n</table>\n</center>\n</p>\n<p>\n\nMatching pairs of digits following atom specifications imply that the atoms are\nbonded to each other.  The bond may be explicit (bond symbol and/or direction\npreceding the ring closure digit) or implicit (a nondirectional single or\naromatic bond).  This is true whether or not the bond ends up as part of a\nring.\n</p>\n<p>\nAdjacent atoms separated by dot (.) implies that the atoms are not bonded to\neach other.  This is true whether or not the atoms are in the same connected\ncomponent.\n</p>\n<p>\nFor example, <b>C1.C1</b> specifies the same molecule as <tt><b>CC</b></tt>(ethane)\n\n<h2>\n<a name=\"RTFToC21\"></a>3.3 Isomeric SMILES</h2>\nThis section describes the SMILES rules used to specify isotopism, configuration\nabout double bonds, and chirality.  The term <i>isomeric SMILES</i>\ncollectively refers to SMILES written using these rules.\n</p>\n<p>\nThe SMILES isomer specification rules allow chirality to be completely\nspecified for any structure, if it is known.  Unlike most existing chemical\nnomenclatures such as CIP and IUPAC, these rules are also designed to allow\nrigorous <i>partial</i> specification of chirality.  Aside from use in macros,\nsubstructure searching, and other pattern matching operations, this is\nimportant because much of the world's available chemical information is known\nfor structures with incompletely resolved chiralities (not all possible chiral\ncenters are separated, known, or reported).\n</p>\n<p>\nAll isomer specification rules in SMILES are therefore optional.  The absence\nof a specification for any attribute implies that  the value of that attribute\nis unspecified.\n<h3>\n<a name=\"RTFToC22\"></a>3.3.1 Isotopic Specification</h3>\nIsotopic specifications are indicated by preceding the atomic symbol with a\nnumber equal to the desired integral atomic mass.    An atomic mass can only be\nspecified inside brackets.  For instance:\n</p>\n<p>\n\n\n<center>\n<table border>\n<th>Smiles</th>\n<th>Name</th>\n<tr>\n  <td>[<b>12C</b>] </td>\n  <td>carbon-12</td>\n</tr>\n<tr>\n  <td>[<b>13C</b>] </td>\n  <td>carbon-13</td>\n</tr>\n<tr>\n<td>[<b>C</b>]</td>\n<td>carbon (unspecified mass)</td> \n</tr>\n<tr>\n<td>[<b>13CH4</b>]</td>\n<td>C-13 methane</td>\n</tr>\n</table>\n</center>\n</p>\n<p>\n\n\n<h3>\n<a name=\"RTFToC23\"></a>3.3.2  Configuration Around Double Bonds></h3>\nConfiguration around double bonds is specified by the characters <b>/</b> and\n<b>\\</b> which are \"directional bonds\" and can be thought of as kinds of single\nbonds.  These symbols indicate relative directionality between the connected\natoms, and have meaning only when they occur on both atoms which are double\nbonded.  For instance, the following SMILES are all valid for E- and Z-\n1,2-difluoroethene:\n</p>\n<p>\n\n\n<center>\n<table border>\n<tr>\n<td><img src=\"theory9.gif\"></td>\n<td><img src=\"theory10.gif\"></td>\n</tr>\n\n<tr>\n<td align=center>F/C=C/F</td>\n<td align=center>F/C=C\\F</td>\n</tr>\n\n<tr>\n<td align=center>F\\C=C\\F</td>\n<td align=center>F\\C=C/F</td>\n</tr>\n</table>\n</center>\n</p>\n<p>\n\n\n<tt></tt>An important difference between SMILES chirality conventions and\nothers such as CIP is that SMILES uses <u>local chirality</u> representation\n(as opposed to <u>absolute chirality</u>), which allows <i>partial\n</i>specifications.  An example of this is illustrated below:\n</p>\n<p>\n\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory11.gif\"></td>\n  <td><img src=\"theory12.gif\"></td>\n</tr>\n\n<tr>\n<td align=center>F/C=C/C=C/C</td>\n<td align=center>F/C=C/C=CC</td>\n</tr>\n\n<tr>\n<td align=center>(completely specified)</td>\n<td align=center>(partially specified)</td>\n</tr>\n</table>\n</center>\n</p>\n<p>\n\n<h3>\n<a name=\"RTFToC24\"></a>3.3.3.  Configuration Around Tetrahedral Centers</h3>\nSMILES uses a very general type of chirality specification based on local\nchirality.  Instead of using a rule-based numbering scheme to order neighbor\natoms of a chiral center, orientations are based on the order in which\nneighbors occur in the SMILES string.  As with all other aspects of SMILES, any\nvalid order is acceptable; the Daylight software is responsible for retaining\nthe meaning of the chiral specification when the structure is modified or\nrearranged (e.g. to make the unique SMILES).\n</p>\n<p>\nThe simplest and most common kind of chirality is tetrahedral; four neighbor\natoms are evenly arranged about a central atom, known as the \"chiral center\".\nIf all four neighbors are different from each other in any way, mirror images\nof the structure will not be identical.  The two mirror images are known as\n\"enantiomers\" and are the only two forms that a tetrahedral center can have.\nIf two (or more) of the four neighbors are identical to each other, the central\natom will not be chiral (its mirror images can be superimposed in space).<p>\nIn SMILES, tetrahedral centers may be indicated by a simplified chiral\nspecification (<tt>@</tt> or <tt>@@</tt>) written as an atomic property\nfollowing the atomic symbol of the chiral atom.  If a chiral specification is\nnot present for a chiral atom, its chirality is implicitly not specified.  For\ninstance:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory13.gif\"></td>\n  <td><img src=\"theory14.gif\"></td>\n</tr>\n\n<tr>\n  <td align=center>NC(C)(F)C(=O)O</td>\n  <td align=center>N[C@](C)(F)C(=O)O</td>\n</tr>\n\n<tr>\n  <td align=center>NC(F)(C)C(=O)O</td>\n  <td align=center>N[C@@](F)(C)C(=O)O</td>\n</tr>\n\n<tr>\n  <td align=center>(unspecified chirality)</td>\n  <td align=center>(specified chirality)</td>\n</tr>\n</table>\n</center>\n</p>\n<p>\n\n\nLooking <u>from</u> the amino <tt>N</tt> <u>to</u> the chiral <tt>C</tt> (as\nthe SMILES is written), the three other neighbors appear anticlockwise in the\norder that they are written in the top SMILES, <tt>N[C@](C)(F)C(=O)O</tt>\n(methyl-C, F, carboxy-C), and clockwise in the bottom one,\n<tt>N[C@@](F)(C)C(=O)O</tt>.  The symbol \"<tt>@</tt>\" indicates that the\nfollowing neighbors are listed anticlockwise (it is a \"visual mnemonic\" in\nthat the symbol  looks like an anticlockwise spiral around a central circle).\n\"<tt>@@</tt>\" indicates that the neighbors are listed clockwise (you guessed\nit, anti-anti-clockwise).\n</p>\n<p>\nIf the central carbon is not the very first atom in the SMILES and has an\nimplicit hydrogen attached (it can have at most one and still be chiral), the\nimplicit hydrogen is taken to be the first neighbor atom of the three neighbors\nthat follow a tetrahedral specification.  If the central carbon is first in the\nSMILES, the implicit hydrogen is taken to be the \"from\" atom.  Hydrogens may\nalways be written explicitly (as <tt>[H]</tt>) in which case they are treated\nlike any other atom.  In each case, the <i>implied order is exactly as written\nin SMILES</i>.  Some of the valid SMILES for the alanine are:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td align=center><img src=\"theory15.gif\"></td>\n  <td align=center><img src=\"theory16.gif\"></td>\n</tr>\n\n<tr>\n  <td>N[C@@]([H])(C)C(=O)O</td>\n  <td>N[C@]([H])(C)C(=O)O</td>\n</tr>\n\n<tr>\n  <td>N[C@@H](C)C(=O)O</td>\n  <td>N[C@H](C)C(=O)O</td>\n</tr>\n\n<tr>\n  <td>N[C@H](C(=O)O)C </td>\n  <td>N[C@@H](C(=O)O)C</td>\n</tr>\n\n<tr>\n  <td>[H][C@](N)(C)C(=O)O</td>\n  <td>[H][C@@](N)(C)C(=O)O</td>\n</tr>\n\n<tr>\n  <td>[C@H](N)(C)C(=O)O</td>\n  <td>[C@@H](N)(C)C(=O)O</td>\n</tr>\n</table>\n</center>\n</p>\n<p>\n\n\n<tt></tt>The chiral order of the ring closure bond is implied by the lexical\norder that the ring closure digit appears <u>on the chiral atom </u>(not in the\nlexical order of the \"substituent\" atom).\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory17.gif\"></td>\n</tr>\n\n<tr>\n  <td align=center>C[C@H]1CCCCO1 </td>\n</tr>\n\n<tr>\n  <td align=center> <b>or</b></td>\n</tr>\n\n<tr>\n<td align=center>O1CCCC[C@@H]1C</td>\n</tr>\n</table>\n</center><p>\n\n\n<h3>\n<a name=\"RTFToC25\"></a>3.3.4 General Chiral Specification</h3>\nThere are many kinds of chirality other than tetrahedral.  The use of the\n\"<tt>@</tt>\" symbol described above is actually a special case of a general\nchiral specification syntax.\n</p>\n<p>\nThe general chiral specification used in SMILES has three parts: the <tt>@</tt>\nsymbol, followed by a two-letter chiral class indicator, followed by a\nnumerical chiral permutation designator.  A default chiral class is assigned to\neach degree (number of connections); the default class for four connections is\ntetrahedral (TH).  Most chiralities have more than two possible choices; the\nchoices are assigned from a table numerically.  In most cases, the <tt>@1</tt>\ndesignation means \"anticlockwise around the axis represented by SMILES order\"\nand <tt>@2</tt> means \"clockwise\".  Notations in the form \"<tt>@@</tt>\" and\n\"<tt>@@@</tt>\" are interpreted as \"<tt>@</tt>2\" and \"<tt>@</tt>3\" (analogous to\n\"<tt>+++</tt>\" meaning \"<tt>+3</tt>\").  The  \"<tt>@</tt>\" and \"<tt>@@</tt>\"\nnotations used above are shortcuts for the full specifications \"<tt>@TH1</tt>\"\nand \"<tt>@TH2</tt>\".  In practice, full chiral specifications are not often\nneeded.\n</p>\n<p>\nSMILES handles the full range of chiral specification, including resolution of\n\"reduced chirality\" (where the number of enantiomers is reduced by symmetry)\nand \"degenerate chirality\" (where the center becomes non-chiral due to\nsymmetrical substitution).  As with other aspects of SMILES, the language\nguarantees the ability to specify exactly what is known, including partial\nspecifications.  The SMILES system will generate unique isomeric SMILES for any\ngiven specification, and substructure recognition will operate correctly on all\ntypes of chirality.\n</p>\n<p>\nThe rest of this section will be limited to discussing the following\nchiralities: tetrahedral, allene-like, square-planar, trigonal-bipyramidal, and\noctahedral.  Although many more chiral classes can be handled by this system\n(it's table-driven), these five classes are very common in chemistry and cover\nmost of the issues to be encountered in the remainder.\n</p>\n<p>\n\n<u>Tetrahedral</u>.  The tetrahedral class symbol is <tt>TH</tt>.  This is the\ndefault chiral class for degree four.  Possible values are 1 and 2.\n<tt>@TH1</tt> (or just <tt>@</tt>) indicates that, looking from the first\nconnected atom, the following three connected atoms are listed anticlockwise;\n<tt>@TH2</tt> (or <tt>@@</tt>) indicates clockwise.\n</p>\n<p>\n\n<u>Allene-like</u>.  The allene-like class symbol is <tt>AL</tt>.  This is the\ndefault chiral class for degree 2 (the chiral center is the central atom with\ntwo double bonds).  Although substituted <tt>C=C=C</tt> structures are most\ncommon, <tt>C=C=C=C=C</tt> structures are also allene-like, as are any odd\nnumber of serially double-bonded atoms.  Possible values are <tt>@AL1</tt> (or\njust <tt>@</tt>) and <tt>@AL2</tt> (or <tt>@@</tt>); these are interpreted by\nsuperimposing the substituted atoms and evaluating as per tetrahedral.\nHydrogens attached to substituted allene-like atoms are taken to be immediately\nfollowing that atom, as shown below:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory18.gif\"></td>\n  <td><img src=\"theory19.gif\"></td>\n</tr>\n\n<tr>\n  <td>OC(Cl)=[C@]=C(C)F</td>\n  <td>OC=[C@]=CF</td>\n</tr>\n\n<tr>\n  <td>OC(Cl)=[C@AL1]=C(C)F</td>\n  <td>OC([H])=[C@AL1]=C([H])F</td>\n</tr>\n\n</table>\n</center>\n</p>\n<p>\n\n\n<b>Square-planar. </b> The square-planar class symbol is <b>SP</b>\nPossible values are <tt>@SP1</tt>, <tt>@SP2</tt>, and <tt>@SP3</tt>; this is\nnot the default chiral class for degree four, so shorthand specifications are\nnot allowed.  Square-planar is also somewhat unusual in that the ideas of\nclockwise and anticlockwise do not apply.\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td><img src=\"theory20.gif\"></td>\n  <td>&nbsp;</td>\n</tr>\n\n<tr>\n<td>F[Po@SP1](Cl)(Br)I</td>\n<td>(SP1 lists in a \"U shape\")</td>\n</tr>\n\n<tr>\n<td>F[Po@SP2](Br)(Cl)I</td>\n<td>(SP2 lists in a \"4-shape\")</td>\n</tr>\n\n<tr>\n<td>F[Po@SP3](Cl)(I)Br</td>\n<td>(SP3 lists in a \"Z shape\")</td>\n</tr>\n\n</table>\n</center>\n</p>\n<p>\n\n\n<b>Trigonal-bipyramidal</b>.  The trigonal-bipyramidal class symbol is TB.\nThis is the default chiral class for degree five.  Possible values are\n<tt>@TB1</tt> to <tt>@TB20</tt>.  <tt>@TB1</tt> (or just <tt>@</tt>) indicates\nthat, when the SMILES is listed from one axial connection to the other, the\nthree intermediate, equatorially-connected atoms are listed anticlockwise;\n<tt>@TB2</tt> (or <tt>@@</tt>) indicates clockwise.  This is illustrated\nbelow.\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td align=center><img src=\"theory21.gif\"></td>\n</tr>\n\n<tr>\n  <td align=center>s[As@@](F)(Cl)(Br)C=O</td>\n</tr>\n\n<tr>\n  <td align=center>O=C[As@](F)(Cl)(Br)S</td>\n</tr>\n\n</table>\n</center>\n</p>\n<p>\n\n\n<B>Octahedral</B>.  The octahedral class symbol is <tt>OH</tt>.  This is the\ndefault chiral class for degree six.  Possible values are <tt>@OH1</tt> to\n<tt>@OH30</tt>.  <tt>@OH1</tt> (or just <tt>@</tt>) indicates that, when the\nSMILES is listed from one axial connection to the other, the four intermediate,\nequatorially-connected atoms are listed anticlockwise; <tt>@OH2</tt> (or\n<tt>@@</tt>) indicates clockwise.  This is illustrated below.<p>\n\n<center>\n<table border>\n<tr>\n  <td align=center><img src=\"theory22.gif\"></td>\n</tr>\n\n<tr>\n  <td align=center>S[Co@@](F)(Cl)(Br)(I)C=O</td>\n</tr>\n\n<tr>\n  <td align=center>O=C[Co@](F)(Cl)(Br)(I)S</td>\n</tr>\n\n</table>\n</center>\n<p>\n\n<h2>\n<a name=\"RTFToC26\"></a>3.4  SMILES Conventions</h2>\nAside from the above rules, a small number of conventions are universally used\nin SMILES.  These are briefly discussed below; for more detail, see the JCICS\npaper (<i>ibid</i>).\n<h3>\n<a name=\"RTFToC27\"></a>3.4.1  Hydrogens</h3>\nHydrogen atoms do not normally need to be specified when writing SMILES for\nmost organic structures.  The presence of hydrogens may be specified in three\nways:\n</p>\n<p>\n<ul>\n<LI>Implicitly.....for atoms specified without brackets, from normal valence\nassumptions.<br>\n<LI>Explicitly by count.....inside brackets, by the hydrogen count\nsupplied; zero if unspecified.<br>\n<LI>As explicit atoms.....as [H] atoms.</UL><p>\n\n\nThere is no distinction between \"organic\" and \"inorganic\" SMILES nomenclature.\nOne may specify the number of attached hydrogens for any atom in any SMILES.\nFor example, propane may be entered as <tt>[CH3][CH2][CH3]</tt> instead of\n<tt>CCC</tt>.<p>\nThere are four situations where specification of explicit hydrogen\nspecification is required:<p>\n\n<UL>\n<LI>charged hydrogen, i.e. a proton, <tt>[H+]</tt>;<br>\n<LI>hydrogens connected to\nother hydrogens, e.g., molecular hydrogen, <tt>[H][H]</tt>;<br>\n<LI>hydrogens\nconnected to other than one other atom, e.g., bridging hydrogens; and<br>\n<LI>isotopic hydrogen specifications, e.g. in heavy water,\n<tt>[2H]O[2H]</tt>.\n</UL>\n<h3>\n<a name=\"RTFToC28\"></a>3.4.2 Aromaticity\n</h3>\nAromaticity must be deduced in a system such as SMILES which generates an\nunambiguous chemical nomenclature because of the fundamental requirement to\ncharacterize the symmetry of a molecule.  Given effective aromaticity-detection\nalgorithms, it is not necessary to enter any structure as aromatic if the user\nprefers to enter an aliphatic (Kekul&eacute;-like) structure.  Entering\nstructures as aromatic directly (i.e., by using lower case atomic symbols)\nprovides a shortcut to accurate chemical specification and is closer to the\nmental molecular model used by most chemists.\n</p>\n<p>\nThe SMILES algorithm uses an extended version of Hueckel's rule to identify\naromatic molecules and ions.  To qualify as aromatic, all atoms in the ring\nmust be sp<sup>2</sup> hybridized and the number of available \"excess\"\np-electrons must satisfy Hueckel's 4N+2 criterion.  As an example, benzene is\nwritten <tt>c1ccccc1</tt>, but an entry of <tt>C1=CC=CC=C1</tt> -\ncyclohexatriene, the Kekul&eacute; form - leads to detection of aromaticity and\nresults in an internal structural conversion to aromatic representation.\nConversely, entries of <tt>c1ccc1</tt> and <tt>c1ccccccc1</tt> will produce the\ncorrect anti-aromatic structures for cyclobutadiene and cyclooctatetraene,\n<tt>C1=CC=C1</tt> and <tt>C1=CC=CC=CC=C1</tt>.  In such cases the SMILES system\nlooks for a structure that preserves the implied sp<sup>2</sup> hybridization, the implied\nhydrogen count, and the specified formal charge, if any.  Some inputs, however,\nmay not only be  incorrect but also impossible, such as <tt>c1cccc1</tt>.  Here\n<tt>c1cccc1</tt> cannot be converted to <tt>C1=CCC=C1</tt> since one of the\ncarbon atoms would be sp<sup>3</sup> with two attached hydrogens.  In such a\nstructure alternating single and double bond assignments cannot be made.  The\nSMILES system will flag this as an \"impossible\" input. Please note that only \natoms on the following list can be considered aromatic: C, N, O, P, S, As, Se, and\n* (wildcard). In addition, exocyclic double bonds do not break aromaticity.\n</p>\n<p>\n<center>\n<table border>\n<tr>\n  <td align=center><img src=\"theory27.gif\"></td>\n  <td align=center><img src=\"theory28.gif\"></td>\n  <td align=center><img src=\"theory29.gif\"></td>\n</tr>\n<tr>\n  <td align=center>C1=COC=C1</td>\n  <td align=center>C1=CN=C[NH]C(=O)1</td>\n  <td align=center>C1=C*=CC=C1</td>\n</tr>\n<tr>\n  <td align=center>c1cocc1</td>\n  <td align=center>c1cnc[nH]c(=O)1</td>\n  <td align=center>c1c*ccc1</td>\n</tr>\n</table>\n</center>\n</p>\n<p>\nIt is important to remember that the purpose of the SMILES aromaticity\ndetection algorithm is for the purposes of chemical information representation\nonly!  To this end, rigorous rules are provided for determining the\n\"aromaticity\" of charged, heterocyclic, and electron-deficient ring systems.\nThe \"aromaticity\" designation as used here is not intended to imply anything\nabout the reactivity, magnetic resonance spectra, heat of formation, or odor of\nsubstances.\n<h3>\n<a name=\"RTFToC29\"></a>3.4.3 Aromatic Nitrogen Compounds</h3>\nA short note is in order about aromatic nitrogens, a common source of confusion\nin chemical information systems.  All three common types of aromatic nitrogen\nmay be specified with the aromatic nitrogen symbol <tt><b>n</b></tt>.\nArchetypical examples are pyridine, pyridine-N-oxide, and pyrrole.\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td align=center><img src=\"theory23.gif\"></td>\n  <td align=center><img src=\"theory24.gif\"></td>\n  <td align=center><img src=\"theory25.gif\"></td>\n</tr>\n\n\n<tr>\n  <td align=center>n1ccccc1</td>\n  <td align=center >O=n1ccccc1&nbsp;&nbsp;&nbsp;[O-][n+]1ccccc1</td>\n  <td align=center>Cn1cccc1&nbsp;&nbsp;&nbsp;&nbsp;[nH]1cccc1</td>\n</tr>\n\n\n<tr>\n  <td align=center><b>Pyridine</b></td>\n  <td align=center><b>Pyridine-N-oxide</b></td>\n  <td align=center><b>Methyl and 1H-pyrrole</b></td>\n</tr>\n</table>\n</center>\n<p>\n\n\n\nNote that the pyrrolyl nitrogen in 1H-pyrrole is written [nH] to distinguish\nthis kind of nitrogen from a pyridyl-N.  Alternative valid SMILES for\n1H-pyrrole include <tt>[H]n1cccc1</tt> (with explicit hydrogen) and\n<tt>N1C=CC=C1</tt> (aliphatic form) all three input forms are equivalent.\n<h3>\n<a name=\"RTFToC30\"></a>3.4.4 Bonding Conventions</h3>\n<i>SMILES does not dictate which valence conventions should be used to model\nmolecular structure</i>.  In fact, an advantage of using SMILES is its ability\nto describe various valence models of the same structure.  Atoms may be\nconnected and show charge separation as desired.  For instance, nitromethane\ncan be represented in SMILES as <tt>CN(=O)=O</tt> or as the charge separated\n<tt>C[N+](=O)[O-]</tt>  (we tend to use the former for database work because it\npreserves symmetry).  Both are \"right\" in the sense that they represent\ndifferent, useful models of the substance.  In general, when symmetry is not an\nissue, most chemists prefer charge-separated structures if they can avoid\nrepresenting atoms in unusual valence states, e.g., diazomethane is written as\n<tt>C=[N+]=[N-]</tt> rather than <tt>C=[N]=[N]</tt>.\n</p>\n<p>\nGiven one valence model of a structure, chemical database systems such as THOR\nand Merlin have the ability to retrieve data about that structure even if the\ndata were stored under a different valence model of the structure.  With such\nsystems, the choice of valence conventions is not critical to either database\ndesign nor database query.\n<h3>\n<a name=\"RTFToC31\"></a>3.4.5 Tautomers</h3>\nTautomeric structures are explicitly specified in SMILES.  There are no\n\"tautomeric bond\", \"mobile hydrogen\", nor \"mobile charge\" specifications.\nSelection of one or all tautomeric structures is left to the user and strongly\ndepends on the application.  Given one tautomeric form, most chemical\ninformation systems will report data for all known tautomers if needed.  The\nrole of SMILES is to specify exactly which tautomeric form is requested, and\nfor which there are data.  A simple example, with two possible tautomeric\nforms, is shown below:\n</p>\n<p>\n\n<center>\n<table border>\n<tr>\n  <td align=left><img src=\"theory26.gif\"></td>\n</tr>\n\n<tr>\n  <td align=left>O=c1[nH]cccc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oc1ncccc1</td>\n</tr>\n\n<tr>\n  <td align=left><b>2-pyridone</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>2-pyridinol </b></td>\n</tr>\n\n</table>\n</center>\n</p>\n<p>\n\n<h2><a name=\"RTFrxn5\"></a>3.5 Extensions for Reactions</h2>\n</p>\n<p>\nThe SMILES language is extended to handle reactions.  There are two areas\nwhere SMILES is extended:  distinguishing component parts of a reactions and\natom maps.\n</p>\n<p>\nComponent parts of a reaction are handled by introducing the &quot;&gt;&quot;\ncharacter as a new separator.  Any reaction must have exactly two &gt;\ncharacters in it.  &quot;&gt;&gt;&quot; is a valid reaction SMILES for an\nempty reaction.  Each of the &quot;&gt;&quot;-separated components of a\nreaction must be a valid molecule SMILES.\n</p>\n<p>\nAs an aside, molecule SMILES never have a &quot;&gt;&quot; character.\nIn a program, one can quickly determine if a SMILES refers to a reaction or\nmolecule by searching for a &quot;&gt;&quot; character in the string.\n<p>\n<b>Reaction SMILES Grammar:</b>\n</p>\n<p>\n<pre>\nreaction\t\t:\treactant '&gt;' agent '&gt;' product\n\t\t\t|\treactant '&gt;&gt;' product\n\t\t\t;\nreactant,\nagent,\nproduct\t\t\t:\tmolecule\n                        |       &lt;null&gt;\n\t\t\t;\nmolecule\t\t:\tSMILES\n\t\t\t;\n<p>\nSMILES:  a valid molecule specification in the SMILES language.\n</pre>\nFor example:\n<dl>\n  <dt>\n      <b>C=CCBr&gt;&gt;C=CCI</b>\n  <dd>\n      This is a valid reaction.  Note that there are no agent molecules.  Also\n      note that several atoms are missing from the reaction (the product\n      &quot;Br&quot; and the reactant &quot;F&quot;).\n      <p>\n  </dd>\n  </dt>\n  <dt>\n      <b>[I-].[Na+].C=CCBr&gt;&gt;[Na+].[Br-].C=CCI</b>\n  <dd>\n      This is a more complete version of the same reaction.  It has been\n      canonicalized.  It would form the root of a datatree when stored in a\n      THOR database.\n      <p>\n  </dd>\n  </dt>\n  <dt>\n      <b>C=CCBr.[Na+].[I-]&gt;CC(=O)C&gt;C=CCI.[Na+].[Br-]</b>\n  <dd>\n      This version of the reaction includes an agent.  Note that the SMILES\n      does not indicate how the agent participates.  Whether the agent is a\n      solvent, catalyst, or performs another function within the reaction must\n      be stored separately as data.  This SMILES could be stored in a THOR\n      database as an absolute SMILES and would appear on the same datatree\n      page as the previous example. \n  </dd>\n  </dt>\n</dl>\n</p>\n<p>\nIn the above example, note that the reaction is ambiguous with respect to the\ncarbon atoms involved.  One might assume that a normal Sn2 displacement is\noccurring.  In fact, an equally reasonable allylic displacement is possible, via\neither an Sn1-like allyl cation.  Recognize that the reaction SMILES given\nabove do not say which carbons are which and hence do not discriminate between\nthe two alternate mechanisms.\n</p>\n<p>\n<center><img src=\"disp.gif\"></center>\n</p>\n<p>\nThis case demonstrates the use and need for atom maps for reaction\nprocessing.  Atom maps are used primarily to further define the overall\nreaction in cases where the reaction mechanism may not be evident from the\nreactant and product molecules.  Atom maps are non-negative integer atom\nmodifiers.  They follow the &quot;:&quot; character within an atom expression.\nThey must be the last modifier within the atom expression:\n</p>\n<p>\n<b>SMILES Atom Expression Grammar:</b>\n</p>\n<p>\n<pre>\natom     \t\t:\tSYMBOL\n\t\t\t|\t[ WEIGHT SYMBOL mods ]\n\t\t\t|\t[ WEIGHT SYMBOL mods : CLASS ]\n\t\t\t;\nmods                    :       mod mods\n\t\t\t;\nmod                     :       HCOUNT | CHARGE | CHIRAL\n \t\t\t;\n<p>\nCLASS = non-negative integer class value.\nWEIGHT = atomic weight.\nSYMBOL = atomic symbol.\nHCOUNT = Atom hydrogen count specification.\nCHARGE = Atom charge specification.\nCHIRAL = Atom chirality specification.\n</pre>\n</p>\n<p>\nAtom maps are an <i>atomic</i> property.  They can legally appear in\na SMILES for any atom, whether or not it is part of a reaction.  Atom with\natom map labels in a molecule SMILES are considered valid; the atom maps are\nignored for molecule processing.  Absolute and unique SMILES generated by the\nsystem for molecules never include atom maps.\n</p>\n<p>\nFinally, there are some differences in the handling of atom maps and agent\ncomponents in the <i>unique</i> versus <i>absolute</i> SMILES for reactions.\nAtom maps and agent components are not part of the unique SMILES specification.\nThis is important for the THOR database, where the datatree roots are formed\nfrom the unique SMILES.  The net result is that each reaction datatree may\ncontain multiple specific reactions with different agents and atom maps.\n</p>\n<h3><a name=\"RTFrxn4\"></a>3.5.1 Reaction Atom Maps</h3>\n</p>\n<p>\nAtom mappings are properties of the atoms in the reaction molecules.  The\nmappings represent equivalence classes of atoms within a reaction.  In effect,\nthe map tells the computer which atoms are the same on the reactant and\nproducts sides of a reaction.  Without this map information, it is difficult \nto derive the reaction bond changes which occur.\n</p>\n<p>\nWithin the SMILES language, atom maps are represented as a non-negative\nnumeric atom modifier following the &quot;:&quot; character (e.g. [CH3:2] is\na carbon in class 2).\n</p>\n<p>\nWithin the Daylight toolkit, the atom maps are manipulated as sets of mapped\natoms.  The atom map class numbers which are used in SMILES do not appear in\nthe toolkit interface to a reaction.  The map class numbers in SMILES do not\nhave any additional significance, except to associate all atoms with the same\nmap class label to one another.\n</p>\n<p>\nThere are no requirements for completeness or uniqueness of the atom mappings.\nAtom mappings are independent of the connectivity and properties of the\nunderlying molecules.  This is so for several reasons:  first, there are\nlimits to the valence representation of molecules which appear when processing\nreactions. For example the oxygens in sodium acetate (CC(=O)[O-].[Na+])\nare chemically indistinguishable, even though the valence model used in the\ntoolkit requires that they be connected differently.  Some systems (CAS, for\nexample) recognize this equivalence in their structural representation (the\ntautomer bond).  It is often useful to map these to the same class for reaction\npurposes: <b>[CH3:1][C:2](=[O:3])[O-:3].[Na+:4]</b>\n</center>\n</p>\n<p>\nA second case is where there is ambiguity in a reaction mechanism which one\nwants to express:\n</p>\n<p>\n<center><img src=\"cope.gif\"></center>\n</p>\n<p>\ncan undergo a cope rearrangement before reaction (which yields the same\nmolecule graph).  In effect, there are two distinct mechanisms by which the\nproduct is produced.  This can be expressed as part of a reaction by:\n<b>[CH2:1]=[CH:2][CH2:1][CH2:3][C:4](C)[CH2:3]</b>\n</p>\n<p>\nA third case is simply a lack of information about the reaction itself.  It\nshould be possible to omit some atom maps or specify partial information for\nsets of atoms which *might* end up in a given position in the product.  It is\nnever acceptable to force a user to make up data in order to register a\nreaction.  One should only store exactly what is known about the reaction.\nAtom maps are, by definition ambiguous with respect to the underlying\nmolecules.  Atom maps do not appear in the lexical representation of a\nunique SMILES.  They do appear in the lexical representation of an absolute\nSMILES.\n</p>\n<p>\nFinally, atom maps are arbitrary class designations;  the values of the\nnumbers have no meaning.  The Daylight system reserves the right to\nchange the class numbers upon canonicalization of a reaction.  The system will\nreorder the atom map classes over the entire reaction during canonicalization.\nThe resulting maps are guaranteed to have the same meaning as the reaction\nbefore canonicalization. Practically, the maps are renumbered as small, dense\nintegers in canonical atom order, but this is not guaranteed.  Also, during\ncanonicalization, the atom map classes for agent atoms are removed.\n</p>\n\n<h3><a name=\"RTFrxn6\"></a>3.5.2 Hydrogens</h3>\n</p>\n<p>\nHydrogens in reactions are handled as with molecules; they are suppressed\nunless &quot;special&quot;.  Recall that for molecules, hydrogens are special\nif they are: charged, isotopic, bonded to another hydrogen, or multiply\nbonded.  With reactions, there is an additional case which will make a hydrogen\nspecial.  It is often desirable (eg. 1,5-hydride shift) to store information \nabout the location of hydrogens as part of the atom map of a reaction.\nHydrogens with a supplied atom map are considered &quot;special&quot; and\nthese hydrogens are not suppressed. These mapped hydrogens appear explicitly\nin Absolute SMILES for reactions. Otherwise, atom-mapped hydrogens do not\nappear in Unique SMILES. \n</p>\n\n\n\n<h2>\n<a name=\"RTFToC32\"></a>3.6 Acknowledgments</h2>\nDevelopment of SMILES was initiated by the author, David Weininger, at the\nEnvironmental Research Laboratory, U.S.E.P.A., Duluth, MN; the design was\ncompleted at Pomona College in Claremont, CA.  It was embodied in the\nDaylight Toolkit with the assistance of Cedar River Software.\n</p>\n<br>\n\n<i>Go To Next Chapter...</i>\n<a href=\"theory.smarts.html\"> 4. SMARTS - A Language for Describing Molecular Patterns</a><br>\n<i>Back to...</i>\n<a href=\"index.html\">Table of Contents</a>\n    </td> \n    </tr> \n    <tr> \n    <td><iframe src=\"/iframes/footer.html\" name=\"iframe3\" width=\"350\" height=\"200\" \n       scrolling=\"no\" frameborder=\"0\"></iframe></td> \n    </tr> \n</table> \n</body> \n</html>\n", "id": 37308.0}