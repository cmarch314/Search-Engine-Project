{"text": "Search LoginPreferencesHelp GuideAbout Trac WikiTimelineRoadmapBrowse SourceView TicketsSearch Context Navigation BlameRevision Log source nomatic tags NomaticIM 4 buddy bots src twisted protocols gps rockwell py View diff against View revision Visit trunk Last change on this file was 712 checked in by cbaker 7 years ago First draft of nomatic buddy bots oscar bot is functional if you give it good authentication credentials jabber bot is just an example from the web File size 11 4 KB Line 1 Copyright c 2 1 2 4 Twisted Matrix Laboratories 2 See LICENSE for details 3 45 Rockwell Semiconductor Zodiac Serial Protocol6Coded from official protocol specs Order No GPS 25 9 24 1996 Revision 11 78Maintainer U Bob Ippolito mailto bob redivi com 91 The following Rockwell Zodiac messages are currently understood 11 EARTHA r n a hack to turn on a DeLorme Earthmate 12 1 Geodesic Position Status Output 13 1 2 Channel Summary 14 1 3 Visible Satellites 15 1 11 Receiver ID 1617The following Rockwell Zodiac messages require implementation 18 None really the others aren t quite so useful and require bidirectional communication w the device192 Other desired features 21 Compatability with the DeLorme Tripmate and other devices with this chipset 22 2324import struct operator math25from twisted internet import protocol26from twisted python import log2728DEBUG 1293 class ZodiacParseError ValueError 31 pass3233class Zodiac protocol Protocol 34 dispatch 35 Output Messages means they get sent by the receiver by default periodically 36 1 fix Geodesic Position Status Output37 1 1 ecef ECEF Position Status Output38 1 2 channels Channel Summary39 1 3 satellites Visible Satellites4 1 5 dgps Differential GPS Status41 1 7 channelmeas Channel Measurement42 1 11 id Receiver ID43 1 12 usersettings User Settings Output44 11 testresults Built In Test Results45 11 2 meastimemark Measurement Time Mark46 11 8 utctimemark UTC Time Mark Pulse Output47 113 serial Serial Port Communication Parameters In Use48 1135 eepromupdate EEPROM Update49 1136 eepromstatus EEPROM Status5 51 these aren t used for anything yet just sitting here for reference52 messages 53 Input Messages54 fix 12 Geodesic Position and Velocity Initialization55 udatum 121 User Defined Datum Definition56 mdatum 1211 Map Datum Select57 smask 1212 Satellite Elevation Mask Control58 sselect 1213 Satellite Candidate Select59 dgpsc 1214 Differential GPS Control6 startc 1216 Cold Start Control61 svalid 1217 Solution Validity Control62 antenna 1218 Antenna Type Select63 altinput 1219 User Entered Altitude Input64 appctl 122 Application Platform Control65 navcfg 1221 Nav Configuration66 test 13 Perform Built In Test Command67 restart 13 3 Restart Command68 serial 133 Serial Port Communications Parameters69 msgctl 1331 Message Protocol Control7 dgpsd 1351 Raw DGPS RTCM SC 1 4 Data71 72 MAX LENGTH 29673 allow earthmate hack 174 recvd 75 76 def dataReceived self recd 77 self recvd self recvd recd78 while len self recvd 1 798 hack for DeLorme EarthMate81 if self recvd 8 EARTHA r n 82 if self allow earthmate hack 83 self allow earthmate hack 84 self transport write EARTHA r n 85 self recvd self recvd 8 86 continue87 88 if self recvd 2 xFF x81 89 if DEBUG 9 raise ZodiacParseError Invalid Sync r self recvd 91 else 92 raise ZodiacParseError93 sync msg id length acknak checksum struct unpack HHHHh self recvd 1 94 95 verify checksum96 cksum reduce operator add sync msg id length acknak xFFFF 97 cksum struct unpack h struct pack h cksum 98 if cksum checksum 99 if DEBUG 1 raise ZodiacParseError Invalid Header Checksum r r r checksum cksum self recvd 8 1 1 else 1 2 raise ZodiacParseError1 3 1 4 length was in words now it s bytes1 5 length length 21 61 7 do we need more data 1 8 neededBytes 1 1 9 if length 11 neededBytes length 2111 if len self recvd neededBytes 112 break113 114 if neededBytes self MAX LENGTH 115 raise ZodiacParseError Invalid Header 116117 empty messages pass empty strings118 message 11912 does this message have data 121 if length 122 message checksum self recvd 1 1 length struct unpack h self recvd 1 length neededBytes 123 cksum x1 reduce operator add struct unpack dH length 2 message xFFFF 124 cksum struct unpack h struct pack h cksum 125 if cksum checksum 126 if DEBUG 127 log dmsg msg id r length r msg id length debug True 128 raise ZodiacParseError Invalid Data Checksum r r r checksum cksum message 129 else 13 raise ZodiacParseError131 132 discard used buffer dispatch message133 self recvd self recvd neededBytes 134 self receivedMessage msg id message acknak 135 136 def receivedMessage self msg id message acknak 137 dispatch self dispatch get msg id None 138 if not dispatch 139 raise ZodiacParseError Unknown msg id r msg id 14 handler getattr self handle s dispatch None 141 decoder getattr self decode s dispatch None 142 if not handler and decoder 143 missing handler or decoder144 if DEBUG 145 log msg MISSING HANDLER DECODER PAIR FOR r dispatch debug True 146 return147 decoded decoder message 148 return handler decoded 149 15 def decode fix self message 151 assert len message 98 Geodesic Position Status Output should be 55 words total 98 byte message 152 ticks msgseq satseq navstatus navtype nmeasure polar gpswk gpses gpsns utcdy utcmo utcyr utchr utcmn utcsc utcns latitude longitude height geoidalsep speed course magvar climb mapdatum exhposerr exvposerr extimeerr exphvelerr clkbias clkbiasdev clkdrift clkdriftdev struct unpack LhhHHHHHLLHHHHHHLlllhLHhhHLLLHllll message 153154 there s a lot of shit in here 155 I ll just snag the important stuff and spit it out like my NMEA decoder156 utc utchr 36 utcmn 6 utcsc float utcns 1 157 158 log msg utchr utcmn utcsc utcns repr utchr utcmn utcsc utcns debug True 159 16 latitude float latitude 18 math pi161 longitude float longitude 18 math pi162 posfix not navstatus x 1c 163 satellites nmeasure164 hdop float exhposerr 1165 altitude float height 1 M 166 geoid float geoidalsep 1 M 167 dgps None168 return 169 seconds since UTC17 utc 171 latitude degrees 172 latitude 173 longitude degrees 174 longitude 175 position fix status invalid False valid True 176 posfix 177 number of satellites measurements used for fix satellites 12 178 satellites 179 horizontal dilution of precision18 hdop 181 altitude according to WGS 84 ellipsoid units always M for meters 182 altitude 183 geoid separation according to WGS 84 ellipsoid units always M for meters 184 geoid 185 None for compatability w NMEA code186 dgps 187 188189 def decode id self message 19 assert len message 1 6 Receiver ID Message should be 59 words total 1 6 byte message 191 ticks msgseq channels software version software date options list reserved struct unpack Lh2 s2 s2 s2 s2 s message 192 channels software version software date options list map lambda s s split channels software version software date options list 193 software version float software version 194 channels int channels 12 but ALWAYS 12 so we ignore 195 options list int options list 4 16 only two bitflags others are reserved196 minimize rom options list x 1 197 minimize ram options list x 2 198 version info options info 199 return software version software date minimize rom minimize ram 2 2 1 def decode channels self message 2 2 assert len message 9 Channel Summary Message should be 51 words total 9 byte message 2 3 ticks msgseq satseq gpswk gpsws gpsns struct unpack LhhHLL message 18 2 4 channels 2 5 message message 18 2 6 for i in range 12 2 7 flags prn cno struct unpack HHH message 6 i 6 i 1 2 8 measurement used ephemeris available measurement valid dgps corrections available2 9 flags flags x 1 flags x 2 flags x 4 flags x 8 21 channels append flags prn cno 211 flags satellite PRN C No in dbHz for 12 channels212 satellite message sequence number213 gps week number gps seconds in week gps nanoseconds from Epoch214 return tuple channels satseq gpswk gpsws gpsns 215216 def decode satellites self message 217 assert len message 9 Visible Satellites Message should be 51 words total 9 byte message 218 ticks msgseq gdop pdop hdop vdop tdop numsatellites struct unpack LhhhhhhH message 18 219 gdop pdop hdop vdop tdop map lambda n float n 1 gdop pdop hdop vdop tdop 22 satellites 221 message message 18 222 for i in range numsatellites 223 prn azi elev struct unpack Hhh message 6 i 6 i 1 224 azi elev map lambda n float n 18 math pi azi elev 225 satellites push prn azi elev 226 PRN 32 azimuth 18 deg elevation 9 deg satellite info 12 227 geometric position horizontal vertical time dilution of precision 228 return tuple satellites gdop pdop hdop vdop tdop 22923 def decode dgps self message 231 assert len message 38 Differential GPS Status Message should be 25 words total 38 byte message 232 raise NotImplementedError233234 def decode ecef self message 235 assert len message 96 ECEF Position Status Output Message should be 54 words total 96 byte message 236 raise NotImplementedError237238 def decode channelmeas self message 239 assert len message 296 Channel Measurement Message should be 154 words total 296 byte message 24 raise NotImplementedError241242 def decode usersettings self message 243 assert len message 32 User Settings Output Message should be 22 words total 32 byte message 244 raise NotImplementedError245246 def decode testresults self message 247 assert len message 28 Built In Test Results Message should be 2 words total 28 byte message 248 raise NotImplementedError24925 def decode meastimemark self message 251 assert len message 494 Measurement Time Mark Message should be 253 words total 494 byte message 252 raise NotImplementedError253254 def decode utctimemark self message 255 assert len message 28 UTC Time Mark Pulse Output Message should be 2 words total 28 byte message 256 raise NotImplementedError257258 def decode serial self message 259 assert len message 3 Serial Port Communication Paramaters In Use Message should be 21 words total 3 byte message 26 raise NotImplementedError261262 def decode eepromupdate self message 263 assert len message 8 EEPROM Update Message should be 1 words total 8 byte message 264 raise NotImplementedError265266 def decode eepromstatus self message 267 assert len message 24 EEPROM Status Message should be 18 words total 24 byte message 268 raise NotImplementedError Note See TracBrowser for help on using the repository browser Download in other formats Plain Text Original Format Powered by Trac 1 1 By Edgewall Software All content copyright 2 7 2 8 by LUCI http luci ics uci edu ", "_id": "http://djp3-pc2.ics.uci.edu/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py", "title": "\n      rockwell.py in nomatic/tags/nomaticim-0.0.4/buddy_bots/src/twisted/protocols/gps\n     \u2013 nomatic*im\n    ", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n  \n  \n\n  \n\n\n  <head>\n\t\t<title>\n      rockwell.py in nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps\n     \u2013 Nomatic*IM\n    </title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><link rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search\" /><link rel=\"help\" href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\" /><link rel=\"alternate\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py?format=txt\" type=\"text/plain\" title=\"Plain Text\" /><link rel=\"alternate\" href=\"/LUCICodeRepository/nomaticIM/export/1312/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py\" type=\"application/x-python; charset=iso-8859-15\" title=\"Original Format\" /><link rel=\"start\" href=\"/LUCICodeRepository/nomaticIM/wiki\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/code.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/pygments/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/browser.css\" type=\"text/css\" /><link rel=\"shortcut icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link rel=\"icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link type=\"application/opensearchdescription+xml\" rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search/opensearch\" title=\"Search Nomatic*IM\" /><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/jquery.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/babel.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/messages/en_US.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/trac.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/search.js\"></script><script type=\"text/javascript\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/folding.js\"></script><script type=\"text/javascript\">\n      jQuery(document).ready(function($) {\n        $(\".trac-toggledeleted\").show().click(function() {\n                  $(this).siblings().find(\".trac-deleted\").toggle();\n                  return false;\n        }).click();\n        $(\"#jumploc input\").hide();\n        $(\"#jumploc select\").change(function () {\n          this.parentNode.parentNode.submit();\n        });\n          $('#preview table.code').enableCollapsibleColumns($('#preview table.code thead th.content'));\n      });\n    </script>\n\t</head>\n  <body>\n    <div id=\"banner\">\n      <div id=\"header\">\n        <a id=\"logo\" href=\"http://luci.ics.uci.edu/#code\"><img src=\"http://luci.ics.uci.edu/blog/archives/LUCIhorzTight.jpg\" alt=\"LUCI Code Repository\" /></a>\n      </div>\n      <form id=\"search\" action=\"/LUCICodeRepository/nomaticIM/search\" method=\"get\">\n        <div>\n          <label for=\"proj-search\">Search:</label>\n          <input type=\"text\" id=\"proj-search\" name=\"q\" size=\"18\" value=\"\" />\n          <input type=\"submit\" value=\"Search\" />\n        </div>\n      </form>\n      <div id=\"metanav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/login\">Login</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/prefs\">Preferences</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\">Help/Guide</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/about\">About Trac</a></li>\n    </ul>\n  </div>\n    </div>\n    <div id=\"mainnav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/wiki\">Wiki</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/timeline\">Timeline</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/roadmap\">Roadmap</a></li><li class=\"active\"><a href=\"/LUCICodeRepository/nomaticIM/browser\">Browse Source</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/report\">View Tickets</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/search\">Search</a></li>\n    </ul>\n  </div>\n    <div id=\"main\">\n      <div id=\"ctxtnav\" class=\"nav\">\n        <h2>Context Navigation</h2>\n        <ul>\n          <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/twisted/protocols/gps/rockwell.py?annotate=blame\" title=\"Annotate each line with the last changed revision (this can be time consuming...)\">Blame</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/log/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py\">Revision Log</a></li>\n        </ul>\n        <hr />\n      </div>\n    <div id=\"content\" class=\"browser\">\n        <h1>\n          \n<a class=\"pathentry first\" href=\"/LUCICodeRepository/nomaticIM/browser?order=name\" title=\"Go to repository root\">source:</a>\n<a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic?order=name\" title=\"View nomatic\">nomatic</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags?order=name\" title=\"View tags\">tags</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4?order=name\" title=\"View NomaticIM-0.0.4\">NomaticIM-0.0.4</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots?order=name\" title=\"View buddy_bots\">buddy_bots</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src?order=name\" title=\"View src\">src</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted?order=name\" title=\"View twisted\">twisted</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols?order=name\" title=\"View protocols\">protocols</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps?order=name\" title=\"View gps\">gps</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py?order=name\" title=\"View rockwell.py\">rockwell.py</a>\n<br style=\"clear: both\" />\n\n        </h1>\n        <div id=\"diffrev\">\n          <form action=\"/LUCICodeRepository/nomaticIM/changeset\" method=\"get\">\n            <div>\n              <label title=\"Show the diff against a specific revision\">\n                View diff against: <input type=\"text\" name=\"old\" size=\"6\" />\n                <input type=\"hidden\" name=\"old_path\" value=\"nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py\" />\n                <input type=\"hidden\" name=\"new\" />\n                <input type=\"hidden\" name=\"new_path\" value=\"nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py\" />\n              </label>\n            </div>\n          </form>\n        </div>\n        <div id=\"jumprev\">\n          <form action=\"\" method=\"get\">\n            <div>\n              <label for=\"rev\">\n                View revision:</label>\n              <input type=\"text\" id=\"rev\" name=\"rev\" size=\"6\" />\n            </div>\n          </form>\n        </div>\n        <div id=\"jumploc\">\n          <form action=\"\" method=\"get\">\n            <div class=\"buttons\">\n              <label for=\"preselected\">Visit:</label>\n              <select id=\"preselected\" name=\"preselected\">\n                <option selected=\"selected\"></option>\n                <optgroup label=\"branches\">\n                  <option value=\"/LUCICodeRepository/nomaticIM/browser/trunk\">trunk</option>\n                </optgroup>\n              </select>\n              <input type=\"submit\" value=\"Go!\" title=\"Jump to the chosen preselected path\" />\n            </div>\n          </form>\n        </div>\n        <div class=\"trac-tags\">\n        </div>\n      <table id=\"info\" summary=\"Revision info\">\n        <tr>\n          <th>\n                <a href=\"/LUCICodeRepository/nomaticIM/changeset/712/nomatic/trunk/buddy_bots/twisted/protocols/gps/rockwell.py\" title=\"View differences\">Last change</a>\n                  on this file was\n                  <a href=\"/LUCICodeRepository/nomaticIM/changeset/712/\" title=\"View changeset 712\">712</a>,\n                  checked in by cbaker, <a class=\"timeline\" href=\"/LUCICodeRepository/nomaticIM/timeline?from=2008-02-16T08%3A16%3A53-08%3A00&amp;precision=second\" title=\"See timeline at Feb 16, 2008, 8:16:53 AM\">7 years ago</a>\n          </th>\n        </tr>\n        <tr>\n          <td class=\"message searchable\">\n              <p>\nFirst draft of nomatic buddy bots. oscar_bot is functional if you give it good authentication credentials, jabber_bot is just an example from the web <br />\n</p>\n          </td>\n        </tr>\n        <tr><td colspan=\"2\">\n            <strong>File size:</strong>\n            <span title=\"11664 bytes\">11.4 KB</span>\n          </td></tr>\n      </table>\n      <div id=\"preview\" class=\"searchable\">\n        \n  <table class=\"code\"><thead><tr><th class=\"lineno\" title=\"Line numbers\">Line</th><th class=\"content\">\u00a0</th></tr></thead><tbody><tr><th id=\"L1\"><a href=\"#L1\">1</a></th><td><span class=\"c\"># Copyright (c) 2001-2004 Twisted Matrix Laboratories.</span></td></tr><tr><th id=\"L2\"><a href=\"#L2\">2</a></th><td><span class=\"c\"># See LICENSE for details.</span></td></tr><tr><th id=\"L3\"><a href=\"#L3\">3</a></th><td>\u00a0</td></tr><tr><th id=\"L4\"><a href=\"#L4\">4</a></th><td></td></tr><tr><th id=\"L5\"><a href=\"#L5\">5</a></th><td><span class=\"sd\">\"\"\"Rockwell Semiconductor Zodiac Serial Protocol</span></td></tr><tr><th id=\"L6\"><a href=\"#L6\">6</a></th><td><span class=\"sd\">Coded from official protocol specs (Order No. GPS-25, 09/24/1996, Revision 11)</span></td></tr><tr><th id=\"L7\"><a href=\"#L7\">7</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L8\"><a href=\"#L8\">8</a></th><td><span class=\"sd\">Maintainer: U{Bob Ippolito&lt;mailto:bob@redivi.com&gt;}</span></td></tr><tr><th id=\"L9\"><a href=\"#L9\">9</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L10\"><a href=\"#L10\">10</a></th><td><span class=\"sd\">The following Rockwell Zodiac messages are currently understood::</span></td></tr><tr><th id=\"L11\"><a href=\"#L11\">11</a></th><td><span class=\"sd\">\u00a0 \u00a0 EARTHA\\\\r\\\\n (a hack to \"turn on\" a DeLorme Earthmate)</span></td></tr><tr><th id=\"L12\"><a href=\"#L12\">12</a></th><td><span class=\"sd\">\u00a0 \u00a0 1000 (Geodesic Position Status Output)</span></td></tr><tr><th id=\"L13\"><a href=\"#L13\">13</a></th><td><span class=\"sd\">\u00a0 \u00a0 1002 (Channel Summary)</span></td></tr><tr><th id=\"L14\"><a href=\"#L14\">14</a></th><td><span class=\"sd\">\u00a0 \u00a0 1003 (Visible Satellites)</span></td></tr><tr><th id=\"L15\"><a href=\"#L15\">15</a></th><td><span class=\"sd\">\u00a0 \u00a0 1011 (Receiver ID)</span></td></tr><tr><th id=\"L16\"><a href=\"#L16\">16</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L17\"><a href=\"#L17\">17</a></th><td><span class=\"sd\">The following Rockwell Zodiac messages require implementation::</span></td></tr><tr><th id=\"L18\"><a href=\"#L18\">18</a></th><td><span class=\"sd\">\u00a0 \u00a0 None really, the others aren't quite so useful and require bidirectional communication w/ the device</span></td></tr><tr><th id=\"L19\"><a href=\"#L19\">19</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L20\"><a href=\"#L20\">20</a></th><td><span class=\"sd\">Other desired features::</span></td></tr><tr><th id=\"L21\"><a href=\"#L21\">21</a></th><td><span class=\"sd\">\u00a0 \u00a0 - Compatability with the DeLorme Tripmate and other devices with this chipset (?)</span></td></tr><tr><th id=\"L22\"><a href=\"#L22\">22</a></th><td><span class=\"sd\">\"\"\"</span></td></tr><tr><th id=\"L23\"><a href=\"#L23\">23</a></th><td></td></tr><tr><th id=\"L24\"><a href=\"#L24\">24</a></th><td><span class=\"kn\">import</span>\u00a0<span class=\"nn\">struct</span><span class=\"o\">,</span>\u00a0<span class=\"nn\">operator</span><span class=\"o\">,</span>\u00a0<span class=\"nn\">math</span></td></tr><tr><th id=\"L25\"><a href=\"#L25\">25</a></th><td><span class=\"kn\">from</span>\u00a0<span class=\"nn\">twisted.internet</span>\u00a0<span class=\"kn\">import</span>\u00a0protocol</td></tr><tr><th id=\"L26\"><a href=\"#L26\">26</a></th><td><span class=\"kn\">from</span>\u00a0<span class=\"nn\">twisted.python</span>\u00a0<span class=\"kn\">import</span>\u00a0log</td></tr><tr><th id=\"L27\"><a href=\"#L27\">27</a></th><td></td></tr><tr><th id=\"L28\"><a href=\"#L28\">28</a></th><td>DEBUG <span class=\"o\">=</span>\u00a0<span class=\"mi\">1</span></td></tr><tr><th id=\"L29\"><a href=\"#L29\">29</a></th><td></td></tr><tr><th id=\"L30\"><a href=\"#L30\">30</a></th><td><span class=\"k\">class</span>\u00a0<span class=\"nc\">ZodiacParseError</span><span class=\"p\">(</span><span class=\"ne\">ValueError</span><span class=\"p\">):</span></td></tr><tr><th id=\"L31\"><a href=\"#L31\">31</a></th><td>\u00a0 <span class=\"k\">pass</span></td></tr><tr><th id=\"L32\"><a href=\"#L32\">32</a></th><td></td></tr><tr><th id=\"L33\"><a href=\"#L33\">33</a></th><td><span class=\"k\">class</span>\u00a0<span class=\"nc\">Zodiac</span><span class=\"p\">(</span>protocol<span class=\"o\">.</span>Protocol<span class=\"p\">):</span></td></tr><tr><th id=\"L34\"><a href=\"#L34\">34</a></th><td>\u00a0 dispatch <span class=\"o\">=</span>\u00a0<span class=\"p\">{</span></td></tr><tr><th id=\"L35\"><a href=\"#L35\">35</a></th><td>\u00a0 \u00a0 <span class=\"c\"># Output Messages (* means they get sent by the receiver by default periodically)</span></td></tr><tr><th id=\"L36\"><a href=\"#L36\">36</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1000</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'fix'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># *Geodesic Position Status Output</span></td></tr><tr><th id=\"L37\"><a href=\"#L37\">37</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1001</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'ecef'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0<span class=\"c\"># ECEF Position Status Output</span></td></tr><tr><th id=\"L38\"><a href=\"#L38\">38</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1002</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'channels'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># *Channel Summary</span></td></tr><tr><th id=\"L39\"><a href=\"#L39\">39</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1003</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'satellites'</span><span class=\"p\">,</span>\u00a0 \u00a0<span class=\"c\"># *Visible Satellites</span></td></tr><tr><th id=\"L40\"><a href=\"#L40\">40</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1005</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'dgps'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0<span class=\"c\"># Differential GPS Status</span></td></tr><tr><th id=\"L41\"><a href=\"#L41\">41</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1007</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'channelmeas'</span><span class=\"p\">,</span>\u00a0 <span class=\"c\"># Channel Measurement</span></td></tr><tr><th id=\"L42\"><a href=\"#L42\">42</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1011</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'id'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0<span class=\"c\"># *Receiver ID</span></td></tr><tr><th id=\"L43\"><a href=\"#L43\">43</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1012</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'usersettings'</span><span class=\"p\">,</span>\u00a0<span class=\"c\"># User-Settings Output</span></td></tr><tr><th id=\"L44\"><a href=\"#L44\">44</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1100</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'testresults'</span><span class=\"p\">,</span>\u00a0 <span class=\"c\"># Built-In Test Results</span></td></tr><tr><th id=\"L45\"><a href=\"#L45\">45</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1102</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'meastimemark'</span><span class=\"p\">,</span>\u00a0<span class=\"c\"># Measurement Time Mark</span></td></tr><tr><th id=\"L46\"><a href=\"#L46\">46</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1108</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'utctimemark'</span><span class=\"p\">,</span>\u00a0 <span class=\"c\"># UTC Time Mark Pulse Output</span></td></tr><tr><th id=\"L47\"><a href=\"#L47\">47</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1130</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'serial'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0<span class=\"c\"># Serial Port Communication Parameters In Use</span></td></tr><tr><th id=\"L48\"><a href=\"#L48\">48</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1135</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'eepromupdate'</span><span class=\"p\">,</span>\u00a0<span class=\"c\"># EEPROM Update</span></td></tr><tr><th id=\"L49\"><a href=\"#L49\">49</a></th><td>\u00a0 \u00a0 <span class=\"mi\">1136</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'eepromstatus'</span><span class=\"p\">,</span>\u00a0<span class=\"c\"># EEPROM Status</span></td></tr><tr><th id=\"L50\"><a href=\"#L50\">50</a></th><td>\u00a0 <span class=\"p\">}</span></td></tr><tr><th id=\"L51\"><a href=\"#L51\">51</a></th><td>\u00a0 <span class=\"c\"># these aren't used for anything yet, just sitting here for reference</span></td></tr><tr><th id=\"L52\"><a href=\"#L52\">52</a></th><td>\u00a0 messages <span class=\"o\">=</span>\u00a0<span class=\"p\">{</span></td></tr><tr><th id=\"L53\"><a href=\"#L53\">53</a></th><td>\u00a0 \u00a0 <span class=\"c\"># Input Messages</span></td></tr><tr><th id=\"L54\"><a href=\"#L54\">54</a></th><td>\u00a0 \u00a0 <span class=\"s\">'fix'</span><span class=\"p\">:</span>\u00a0 \u00a0 \u00a0 <span class=\"mi\">1200</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Geodesic Position and Velocity Initialization</span></td></tr><tr><th id=\"L55\"><a href=\"#L55\">55</a></th><td>\u00a0 \u00a0 <span class=\"s\">'udatum'</span><span class=\"p\">:</span>\u00a0 \u00a0<span class=\"mi\">1210</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># User-Defined Datum Definition</span></td></tr><tr><th id=\"L56\"><a href=\"#L56\">56</a></th><td>\u00a0 \u00a0 <span class=\"s\">'mdatum'</span><span class=\"p\">:</span>\u00a0 \u00a0<span class=\"mi\">1211</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Map Datum Select</span></td></tr><tr><th id=\"L57\"><a href=\"#L57\">57</a></th><td>\u00a0 \u00a0 <span class=\"s\">'smask'</span><span class=\"p\">:</span>\u00a0 \u00a0 <span class=\"mi\">1212</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Satellite Elevation Mask Control</span></td></tr><tr><th id=\"L58\"><a href=\"#L58\">58</a></th><td>\u00a0 \u00a0 <span class=\"s\">'sselect'</span><span class=\"p\">:</span>\u00a0 <span class=\"mi\">1213</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Satellite Candidate Select</span></td></tr><tr><th id=\"L59\"><a href=\"#L59\">59</a></th><td>\u00a0 \u00a0 <span class=\"s\">'dgpsc'</span><span class=\"p\">:</span>\u00a0 \u00a0 <span class=\"mi\">1214</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Differential GPS Control</span></td></tr><tr><th id=\"L60\"><a href=\"#L60\">60</a></th><td>\u00a0 \u00a0 <span class=\"s\">'startc'</span><span class=\"p\">:</span>\u00a0 \u00a0<span class=\"mi\">1216</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Cold Start Control</span></td></tr><tr><th id=\"L61\"><a href=\"#L61\">61</a></th><td>\u00a0 \u00a0 <span class=\"s\">'svalid'</span><span class=\"p\">:</span>\u00a0 \u00a0<span class=\"mi\">1217</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Solution Validity Control</span></td></tr><tr><th id=\"L62\"><a href=\"#L62\">62</a></th><td>\u00a0 \u00a0 <span class=\"s\">'antenna'</span><span class=\"p\">:</span>\u00a0 <span class=\"mi\">1218</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Antenna Type Select</span></td></tr><tr><th id=\"L63\"><a href=\"#L63\">63</a></th><td>\u00a0 \u00a0 <span class=\"s\">'altinput'</span><span class=\"p\">:</span>\u00a0<span class=\"mi\">1219</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># User-Entered Altitude Input</span></td></tr><tr><th id=\"L64\"><a href=\"#L64\">64</a></th><td>\u00a0 \u00a0 <span class=\"s\">'appctl'</span><span class=\"p\">:</span>\u00a0 \u00a0<span class=\"mi\">1220</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Application Platform Control</span></td></tr><tr><th id=\"L65\"><a href=\"#L65\">65</a></th><td>\u00a0 \u00a0 <span class=\"s\">'navcfg'</span><span class=\"p\">:</span>\u00a0 \u00a0<span class=\"mi\">1221</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Nav Configuration</span></td></tr><tr><th id=\"L66\"><a href=\"#L66\">66</a></th><td>\u00a0 \u00a0 <span class=\"s\">'test'</span><span class=\"p\">:</span>\u00a0 \u00a0 \u00a0<span class=\"mi\">1300</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Perform Built-In Test Command</span></td></tr><tr><th id=\"L67\"><a href=\"#L67\">67</a></th><td>\u00a0 \u00a0 <span class=\"s\">'restart'</span><span class=\"p\">:</span>\u00a0 <span class=\"mi\">1303</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Restart Command</span></td></tr><tr><th id=\"L68\"><a href=\"#L68\">68</a></th><td>\u00a0 \u00a0 <span class=\"s\">'serial'</span><span class=\"p\">:</span>\u00a0 \u00a0<span class=\"mi\">1330</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Serial Port Communications Parameters</span></td></tr><tr><th id=\"L69\"><a href=\"#L69\">69</a></th><td>\u00a0 \u00a0 <span class=\"s\">'msgctl'</span><span class=\"p\">:</span>\u00a0 \u00a0<span class=\"mi\">1331</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Message Protocol Control</span></td></tr><tr><th id=\"L70\"><a href=\"#L70\">70</a></th><td>\u00a0 \u00a0 <span class=\"s\">'dgpsd'</span><span class=\"p\">:</span>\u00a0 \u00a0 <span class=\"mi\">1351</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0<span class=\"c\"># Raw DGPS RTCM SC-104 Data</span></td></tr><tr><th id=\"L71\"><a href=\"#L71\">71</a></th><td>\u00a0 <span class=\"p\">}</span>\u00a0 </td></tr><tr><th id=\"L72\"><a href=\"#L72\">72</a></th><td>\u00a0 MAX_LENGTH <span class=\"o\">=</span>\u00a0<span class=\"mi\">296</span></td></tr><tr><th id=\"L73\"><a href=\"#L73\">73</a></th><td>\u00a0 allow_earthmate_hack <span class=\"o\">=</span>\u00a0<span class=\"mi\">1</span></td></tr><tr><th id=\"L74\"><a href=\"#L74\">74</a></th><td>\u00a0 recvd <span class=\"o\">=</span>\u00a0<span class=\"s\">\"\"</span></td></tr><tr><th id=\"L75\"><a href=\"#L75\">75</a></th><td>\u00a0 </td></tr><tr><th id=\"L76\"><a href=\"#L76\">76</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">dataReceived</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0recd<span class=\"p\">):</span></td></tr><tr><th id=\"L77\"><a href=\"#L77\">77</a></th><td>\u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>recvd <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd <span class=\"o\">+</span>\u00a0recd</td></tr><tr><th id=\"L78\"><a href=\"#L78\">78</a></th><td>\u00a0 \u00a0 <span class=\"k\">while</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">)</span>\u00a0<span class=\"o\">&gt;=</span>\u00a0<span class=\"mi\">10</span><span class=\"p\">:</span></td></tr><tr><th id=\"L79\"><a href=\"#L79\">79</a></th><td></td></tr><tr><th id=\"L80\"><a href=\"#L80\">80</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># hack for DeLorme EarthMate</span></td></tr><tr><th id=\"L81\"><a href=\"#L81\">81</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">[:</span><span class=\"mi\">8</span><span class=\"p\">]</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"s\">'EARTHA</span><span class=\"se\">\\r\\n</span><span class=\"s\">'</span><span class=\"p\">:</span></td></tr><tr><th id=\"L82\"><a href=\"#L82\">82</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>allow_earthmate_hack<span class=\"p\">:</span></td></tr><tr><th id=\"L83\"><a href=\"#L83\">83</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>allow_earthmate_hack <span class=\"o\">=</span>\u00a0<span class=\"mi\">0</span></td></tr><tr><th id=\"L84\"><a href=\"#L84\">84</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>transport<span class=\"o\">.</span>write<span class=\"p\">(</span><span class=\"s\">'EARTHA</span><span class=\"se\">\\r\\n</span><span class=\"s\">'</span><span class=\"p\">)</span></td></tr><tr><th id=\"L85\"><a href=\"#L85\">85</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>recvd <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">[</span><span class=\"mi\">8</span><span class=\"p\">:]</span></td></tr><tr><th id=\"L86\"><a href=\"#L86\">86</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">continue</span></td></tr><tr><th id=\"L87\"><a href=\"#L87\">87</a></th><td>\u00a0 \u00a0 \u00a0 </td></tr><tr><th id=\"L88\"><a href=\"#L88\">88</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"mi\">2</span><span class=\"p\">]</span>\u00a0<span class=\"o\">!=</span>\u00a0<span class=\"s\">'</span><span class=\"se\">\\xFF\\x81</span><span class=\"s\">'</span><span class=\"p\">:</span></td></tr><tr><th id=\"L89\"><a href=\"#L89\">89</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0DEBUG<span class=\"p\">:</span></td></tr><tr><th id=\"L90\"><a href=\"#L90\">90</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0ZodiacParseError<span class=\"p\">(</span><span class=\"s\">'Invalid Sync </span><span class=\"si\">%r</span><span class=\"s\">'</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">)</span></td></tr><tr><th id=\"L91\"><a href=\"#L91\">91</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L92\"><a href=\"#L92\">92</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0ZodiacParseError</td></tr><tr><th id=\"L93\"><a href=\"#L93\">93</a></th><td>\u00a0 \u00a0 \u00a0 sync<span class=\"p\">,</span>\u00a0msg_id<span class=\"p\">,</span>\u00a0length<span class=\"p\">,</span>\u00a0acknak<span class=\"p\">,</span>\u00a0checksum <span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;HHHHh'</span><span class=\"p\">,</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">[:</span><span class=\"mi\">10</span><span class=\"p\">])</span></td></tr><tr><th id=\"L94\"><a href=\"#L94\">94</a></th><td>\u00a0 \u00a0 \u00a0 </td></tr><tr><th id=\"L95\"><a href=\"#L95\">95</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># verify checksum</span></td></tr><tr><th id=\"L96\"><a href=\"#L96\">96</a></th><td>\u00a0 \u00a0 \u00a0 cksum <span class=\"o\">=</span>\u00a0<span class=\"o\">-</span><span class=\"p\">(</span><span class=\"nb\">reduce</span><span class=\"p\">(</span>operator<span class=\"o\">.</span>add<span class=\"p\">,</span>\u00a0<span class=\"p\">(</span>sync<span class=\"p\">,</span>\u00a0msg_id<span class=\"p\">,</span>\u00a0length<span class=\"p\">,</span>\u00a0acknak<span class=\"p\">))</span>\u00a0<span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0xFFFF</span><span class=\"p\">)</span></td></tr><tr><th id=\"L97\"><a href=\"#L97\">97</a></th><td>\u00a0 \u00a0 \u00a0 cksum<span class=\"p\">,</span>\u00a0<span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;h'</span><span class=\"p\">,</span>\u00a0struct<span class=\"o\">.</span>pack<span class=\"p\">(</span><span class=\"s\">'&lt;h'</span><span class=\"p\">,</span>\u00a0cksum<span class=\"p\">))</span></td></tr><tr><th id=\"L98\"><a href=\"#L98\">98</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0cksum <span class=\"o\">!=</span>\u00a0checksum<span class=\"p\">:</span></td></tr><tr><th id=\"L99\"><a href=\"#L99\">99</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0DEBUG<span class=\"p\">:</span></td></tr><tr><th id=\"L100\"><a href=\"#L100\">100</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0ZodiacParseError<span class=\"p\">(</span><span class=\"s\">'Invalid Header Checksum </span><span class=\"si\">%r</span><span class=\"s\">\u00a0!= </span><span class=\"si\">%r</span><span class=\"s\">\u00a0</span><span class=\"si\">%r</span><span class=\"s\">'</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>checksum<span class=\"p\">,</span>\u00a0cksum<span class=\"p\">,</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">[:</span><span class=\"mi\">8</span><span class=\"p\">]))</span></td></tr><tr><th id=\"L101\"><a href=\"#L101\">101</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L102\"><a href=\"#L102\">102</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0ZodiacParseError</td></tr><tr><th id=\"L103\"><a href=\"#L103\">103</a></th><td>\u00a0 \u00a0 \u00a0 </td></tr><tr><th id=\"L104\"><a href=\"#L104\">104</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># length was in words, now it's bytes</span></td></tr><tr><th id=\"L105\"><a href=\"#L105\">105</a></th><td>\u00a0 \u00a0 \u00a0 length <span class=\"o\">=</span>\u00a0length <span class=\"o\">*</span>\u00a0<span class=\"mi\">2</span></td></tr><tr><th id=\"L106\"><a href=\"#L106\">106</a></th><td></td></tr><tr><th id=\"L107\"><a href=\"#L107\">107</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># do we need more data ?</span></td></tr><tr><th id=\"L108\"><a href=\"#L108\">108</a></th><td>\u00a0 \u00a0 \u00a0 neededBytes <span class=\"o\">=</span>\u00a0<span class=\"mi\">10</span></td></tr><tr><th id=\"L109\"><a href=\"#L109\">109</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0length<span class=\"p\">:</span></td></tr><tr><th id=\"L110\"><a href=\"#L110\">110</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 neededBytes <span class=\"o\">+=</span>\u00a0length <span class=\"o\">+</span>\u00a0<span class=\"mi\">2</span></td></tr><tr><th id=\"L111\"><a href=\"#L111\">111</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">)</span>\u00a0<span class=\"o\">&lt;</span>\u00a0neededBytes<span class=\"p\">:</span></td></tr><tr><th id=\"L112\"><a href=\"#L112\">112</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">break</span></td></tr><tr><th id=\"L113\"><a href=\"#L113\">113</a></th><td>\u00a0 \u00a0 \u00a0 </td></tr><tr><th id=\"L114\"><a href=\"#L114\">114</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0neededBytes <span class=\"o\">&gt;</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>MAX_LENGTH<span class=\"p\">:</span></td></tr><tr><th id=\"L115\"><a href=\"#L115\">115</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0ZodiacParseError<span class=\"p\">(</span><span class=\"s\">\"Invalid Header??\"</span><span class=\"p\">)</span></td></tr><tr><th id=\"L116\"><a href=\"#L116\">116</a></th><td></td></tr><tr><th id=\"L117\"><a href=\"#L117\">117</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># empty messages pass empty strings</span></td></tr><tr><th id=\"L118\"><a href=\"#L118\">118</a></th><td>\u00a0 \u00a0 \u00a0 message <span class=\"o\">=</span>\u00a0<span class=\"s\">''</span></td></tr><tr><th id=\"L119\"><a href=\"#L119\">119</a></th><td></td></tr><tr><th id=\"L120\"><a href=\"#L120\">120</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># does this message have data ?</span></td></tr><tr><th id=\"L121\"><a href=\"#L121\">121</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0length<span class=\"p\">:</span></td></tr><tr><th id=\"L122\"><a href=\"#L122\">122</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 message<span class=\"p\">,</span>\u00a0checksum <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">[</span><span class=\"mi\">10</span><span class=\"p\">:</span><span class=\"mi\">10</span><span class=\"o\">+</span>length<span class=\"p\">],</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;h'</span><span class=\"p\">,</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">[</span><span class=\"mi\">10</span><span class=\"o\">+</span>length<span class=\"p\">:</span>neededBytes<span class=\"p\">])[</span><span class=\"mi\">0</span><span class=\"p\">]</span></td></tr><tr><th id=\"L123\"><a href=\"#L123\">123</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 cksum <span class=\"o\">=</span>\u00a0<span class=\"mh\">0x10000</span>\u00a0<span class=\"o\">-</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">reduce</span><span class=\"p\">(</span>operator<span class=\"o\">.</span>add<span class=\"p\">,</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;</span><span class=\"si\">%d</span><span class=\"s\">H'</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>length<span class=\"o\">/</span><span class=\"mi\">2</span><span class=\"p\">),</span>\u00a0message<span class=\"p\">))</span>\u00a0<span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0xFFFF</span><span class=\"p\">)</span></td></tr><tr><th id=\"L124\"><a href=\"#L124\">124</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 cksum<span class=\"p\">,</span>\u00a0<span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;h'</span><span class=\"p\">,</span>\u00a0struct<span class=\"o\">.</span>pack<span class=\"p\">(</span><span class=\"s\">'&lt;h'</span><span class=\"p\">,</span>\u00a0cksum<span class=\"p\">))</span></td></tr><tr><th id=\"L125\"><a href=\"#L125\">125</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0cksum <span class=\"o\">!=</span>\u00a0checksum<span class=\"p\">:</span></td></tr><tr><th id=\"L126\"><a href=\"#L126\">126</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0DEBUG<span class=\"p\">:</span></td></tr><tr><th id=\"L127\"><a href=\"#L127\">127</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 log<span class=\"o\">.</span>dmsg<span class=\"p\">(</span><span class=\"s\">'msg_id = </span><span class=\"si\">%r</span><span class=\"s\">\u00a0length = </span><span class=\"si\">%r</span><span class=\"s\">'</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>msg_id<span class=\"p\">,</span>\u00a0length<span class=\"p\">),</span>\u00a0debug<span class=\"o\">=</span><span class=\"bp\">True</span><span class=\"p\">)</span></td></tr><tr><th id=\"L128\"><a href=\"#L128\">128</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0ZodiacParseError<span class=\"p\">(</span><span class=\"s\">'Invalid Data Checksum </span><span class=\"si\">%r</span><span class=\"s\">\u00a0!= </span><span class=\"si\">%r</span><span class=\"s\">\u00a0</span><span class=\"si\">%r</span><span class=\"s\">'</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>checksum<span class=\"p\">,</span>\u00a0cksum<span class=\"p\">,</span>\u00a0message<span class=\"p\">))</span></td></tr><tr><th id=\"L129\"><a href=\"#L129\">129</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L130\"><a href=\"#L130\">130</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0ZodiacParseError</td></tr><tr><th id=\"L131\"><a href=\"#L131\">131</a></th><td>\u00a0 \u00a0 \u00a0 </td></tr><tr><th id=\"L132\"><a href=\"#L132\">132</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># discard used buffer, dispatch message</span></td></tr><tr><th id=\"L133\"><a href=\"#L133\">133</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>recvd <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>recvd<span class=\"p\">[</span>neededBytes<span class=\"p\">:]</span></td></tr><tr><th id=\"L134\"><a href=\"#L134\">134</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>receivedMessage<span class=\"p\">(</span>msg_id<span class=\"p\">,</span>\u00a0message<span class=\"p\">,</span>\u00a0acknak<span class=\"p\">)</span></td></tr><tr><th id=\"L135\"><a href=\"#L135\">135</a></th><td>\u00a0 </td></tr><tr><th id=\"L136\"><a href=\"#L136\">136</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">receivedMessage</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0msg_id<span class=\"p\">,</span>\u00a0message<span class=\"p\">,</span>\u00a0acknak<span class=\"p\">):</span></td></tr><tr><th id=\"L137\"><a href=\"#L137\">137</a></th><td>\u00a0 \u00a0 dispatch <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>dispatch<span class=\"o\">.</span>get<span class=\"p\">(</span>msg_id<span class=\"p\">,</span>\u00a0<span class=\"bp\">None</span><span class=\"p\">)</span></td></tr><tr><th id=\"L138\"><a href=\"#L138\">138</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"ow\">not</span>\u00a0dispatch<span class=\"p\">:</span></td></tr><tr><th id=\"L139\"><a href=\"#L139\">139</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0ZodiacParseError<span class=\"p\">(</span><span class=\"s\">'Unknown msg_id = </span><span class=\"si\">%r</span><span class=\"s\">'</span>\u00a0<span class=\"o\">%</span>\u00a0msg_id<span class=\"p\">)</span></td></tr><tr><th id=\"L140\"><a href=\"#L140\">140</a></th><td>\u00a0 \u00a0 handler <span class=\"o\">=</span>\u00a0<span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'handle_</span><span class=\"si\">%s</span><span class=\"s\">'</span>\u00a0<span class=\"o\">%</span>\u00a0dispatch<span class=\"p\">,</span>\u00a0<span class=\"bp\">None</span><span class=\"p\">)</span></td></tr><tr><th id=\"L141\"><a href=\"#L141\">141</a></th><td>\u00a0 \u00a0 decoder <span class=\"o\">=</span>\u00a0<span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'decode_</span><span class=\"si\">%s</span><span class=\"s\">'</span>\u00a0<span class=\"o\">%</span>\u00a0dispatch<span class=\"p\">,</span>\u00a0<span class=\"bp\">None</span><span class=\"p\">)</span></td></tr><tr><th id=\"L142\"><a href=\"#L142\">142</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"ow\">not</span>\u00a0<span class=\"p\">(</span>handler <span class=\"ow\">and</span>\u00a0decoder<span class=\"p\">):</span></td></tr><tr><th id=\"L143\"><a href=\"#L143\">143</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># missing handler or decoder</span></td></tr><tr><th id=\"L144\"><a href=\"#L144\">144</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\">#if DEBUG:</span></td></tr><tr><th id=\"L145\"><a href=\"#L145\">145</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\">#\u00a0 log.msg('MISSING HANDLER/DECODER PAIR FOR: %r' % (dispatch,), debug=True)</span></td></tr><tr><th id=\"L146\"><a href=\"#L146\">146</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"k\">return</span></td></tr><tr><th id=\"L147\"><a href=\"#L147\">147</a></th><td>\u00a0 \u00a0 decoded <span class=\"o\">=</span>\u00a0decoder<span class=\"p\">(</span>message<span class=\"p\">)</span></td></tr><tr><th id=\"L148\"><a href=\"#L148\">148</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0handler<span class=\"p\">(</span><span class=\"o\">*</span>decoded<span class=\"p\">)</span></td></tr><tr><th id=\"L149\"><a href=\"#L149\">149</a></th><td>\u00a0 </td></tr><tr><th id=\"L150\"><a href=\"#L150\">150</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_fix</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L151\"><a href=\"#L151\">151</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">98</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Geodesic Position Status Output should be 55 words total (98 byte message)\"</span></td></tr><tr><th id=\"L152\"><a href=\"#L152\">152</a></th><td>\u00a0 \u00a0 <span class=\"p\">(</span>ticks<span class=\"p\">,</span>\u00a0msgseq<span class=\"p\">,</span>\u00a0satseq<span class=\"p\">,</span>\u00a0navstatus<span class=\"p\">,</span>\u00a0navtype<span class=\"p\">,</span>\u00a0nmeasure<span class=\"p\">,</span>\u00a0polar<span class=\"p\">,</span>\u00a0gpswk<span class=\"p\">,</span>\u00a0gpses<span class=\"p\">,</span>\u00a0gpsns<span class=\"p\">,</span>\u00a0utcdy<span class=\"p\">,</span>\u00a0utcmo<span class=\"p\">,</span>\u00a0utcyr<span class=\"p\">,</span>\u00a0utchr<span class=\"p\">,</span>\u00a0utcmn<span class=\"p\">,</span>\u00a0utcsc<span class=\"p\">,</span>\u00a0utcns<span class=\"p\">,</span>\u00a0latitude<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">,</span>\u00a0height<span class=\"p\">,</span>\u00a0geoidalsep<span class=\"p\">,</span>\u00a0speed<span class=\"p\">,</span>\u00a0course<span class=\"p\">,</span>\u00a0magvar<span class=\"p\">,</span>\u00a0climb<span class=\"p\">,</span>\u00a0mapdatum<span class=\"p\">,</span>\u00a0exhposerr<span class=\"p\">,</span>\u00a0exvposerr<span class=\"p\">,</span>\u00a0extimeerr<span class=\"p\">,</span>\u00a0exphvelerr<span class=\"p\">,</span>\u00a0clkbias<span class=\"p\">,</span>\u00a0clkbiasdev<span class=\"p\">,</span>\u00a0clkdrift<span class=\"p\">,</span>\u00a0clkdriftdev<span class=\"p\">)</span>\u00a0<span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;LhhHHHHHLLHHHHHHLlllhLHhhHLLLHllll'</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">)</span></td></tr><tr><th id=\"L153\"><a href=\"#L153\">153</a></th><td></td></tr><tr><th id=\"L154\"><a href=\"#L154\">154</a></th><td>\u00a0 \u00a0 <span class=\"c\"># there's a lot of shit in here.. </span></td></tr><tr><th id=\"L155\"><a href=\"#L155\">155</a></th><td>\u00a0 \u00a0 <span class=\"c\"># I'll just snag the important stuff and spit it out like my NMEA decoder</span></td></tr><tr><th id=\"L156\"><a href=\"#L156\">156</a></th><td>\u00a0 \u00a0 utc <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span>utchr <span class=\"o\">*</span>\u00a0<span class=\"mf\">3600.0</span><span class=\"p\">)</span>\u00a0<span class=\"o\">+</span>\u00a0<span class=\"p\">(</span>utcmn <span class=\"o\">*</span>\u00a0<span class=\"mf\">60.0</span><span class=\"p\">)</span>\u00a0<span class=\"o\">+</span>\u00a0utcsc <span class=\"o\">+</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">(</span>utcns<span class=\"p\">)</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"mf\">0.000000001</span><span class=\"p\">)</span></td></tr><tr><th id=\"L157\"><a href=\"#L157\">157</a></th><td>\u00a0 \u00a0 </td></tr><tr><th id=\"L158\"><a href=\"#L158\">158</a></th><td>\u00a0 \u00a0 log<span class=\"o\">.</span>msg<span class=\"p\">(</span><span class=\"s\">'utchr, utcmn, utcsc, utcns = '</span>\u00a0<span class=\"o\">+</span>\u00a0<span class=\"nb\">repr</span><span class=\"p\">((</span>utchr<span class=\"p\">,</span>\u00a0utcmn<span class=\"p\">,</span>\u00a0utcsc<span class=\"p\">,</span>\u00a0utcns<span class=\"p\">)),</span>\u00a0debug<span class=\"o\">=</span><span class=\"bp\">True</span><span class=\"p\">)</span></td></tr><tr><th id=\"L159\"><a href=\"#L159\">159</a></th><td>\u00a0 \u00a0 </td></tr><tr><th id=\"L160\"><a href=\"#L160\">160</a></th><td>\u00a0 \u00a0 latitude <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>latitude<span class=\"p\">)</span>\u00a0 \u00a0<span class=\"o\">*</span>\u00a0<span class=\"mf\">0.00000180</span>\u00a0<span class=\"o\">/</span>\u00a0math<span class=\"o\">.</span>pi</td></tr><tr><th id=\"L161\"><a href=\"#L161\">161</a></th><td>\u00a0 \u00a0 longitude <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>longitude<span class=\"p\">)</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"mf\">0.00000180</span>\u00a0<span class=\"o\">/</span>\u00a0math<span class=\"o\">.</span>pi</td></tr><tr><th id=\"L162\"><a href=\"#L162\">162</a></th><td>\u00a0 \u00a0 posfix <span class=\"o\">=</span>\u00a0<span class=\"ow\">not</span>\u00a0<span class=\"p\">(</span>navstatus <span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0x001c</span><span class=\"p\">)</span></td></tr><tr><th id=\"L163\"><a href=\"#L163\">163</a></th><td>\u00a0 \u00a0 satellites <span class=\"o\">=</span>\u00a0nmeasure</td></tr><tr><th id=\"L164\"><a href=\"#L164\">164</a></th><td>\u00a0 \u00a0 hdop <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>exhposerr<span class=\"p\">)</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"mf\">0.01</span></td></tr><tr><th id=\"L165\"><a href=\"#L165\">165</a></th><td>\u00a0 \u00a0 altitude <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>height<span class=\"p\">)</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"mf\">0.01</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'M'</span></td></tr><tr><th id=\"L166\"><a href=\"#L166\">166</a></th><td>\u00a0 \u00a0 geoid <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>geoidalsep<span class=\"p\">)</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"mf\">0.01</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'M'</span></td></tr><tr><th id=\"L167\"><a href=\"#L167\">167</a></th><td>\u00a0 \u00a0 dgps <span class=\"o\">=</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L168\"><a href=\"#L168\">168</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">(</span></td></tr><tr><th id=\"L169\"><a href=\"#L169\">169</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># seconds since 00:00 UTC</span></td></tr><tr><th id=\"L170\"><a href=\"#L170\">170</a></th><td>\u00a0 \u00a0 \u00a0 utc<span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0</td></tr><tr><th id=\"L171\"><a href=\"#L171\">171</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># latitude (degrees)</span></td></tr><tr><th id=\"L172\"><a href=\"#L172\">172</a></th><td>\u00a0 \u00a0 \u00a0 latitude<span class=\"p\">,</span></td></tr><tr><th id=\"L173\"><a href=\"#L173\">173</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># longitude (degrees)</span></td></tr><tr><th id=\"L174\"><a href=\"#L174\">174</a></th><td>\u00a0 \u00a0 \u00a0 longitude<span class=\"p\">,</span></td></tr><tr><th id=\"L175\"><a href=\"#L175\">175</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># position fix status (invalid = False, valid = True)</span></td></tr><tr><th id=\"L176\"><a href=\"#L176\">176</a></th><td>\u00a0 \u00a0 \u00a0 posfix<span class=\"p\">,</span></td></tr><tr><th id=\"L177\"><a href=\"#L177\">177</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># number of satellites [measurements] used for fix 0 &lt;= satellites &lt;= 12 </span></td></tr><tr><th id=\"L178\"><a href=\"#L178\">178</a></th><td>\u00a0 \u00a0 \u00a0 satellites<span class=\"p\">,</span></td></tr><tr><th id=\"L179\"><a href=\"#L179\">179</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># horizontal dilution of precision</span></td></tr><tr><th id=\"L180\"><a href=\"#L180\">180</a></th><td>\u00a0 \u00a0 \u00a0 hdop<span class=\"p\">,</span></td></tr><tr><th id=\"L181\"><a href=\"#L181\">181</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># (altitude according to WGS-84 ellipsoid, units (always 'M' for meters)) </span></td></tr><tr><th id=\"L182\"><a href=\"#L182\">182</a></th><td>\u00a0 \u00a0 \u00a0 altitude<span class=\"p\">,</span></td></tr><tr><th id=\"L183\"><a href=\"#L183\">183</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># (geoid separation according to WGS-84 ellipsoid, units (always 'M' for meters))</span></td></tr><tr><th id=\"L184\"><a href=\"#L184\">184</a></th><td>\u00a0 \u00a0 \u00a0 geoid<span class=\"p\">,</span></td></tr><tr><th id=\"L185\"><a href=\"#L185\">185</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># None, for compatability w/ NMEA code</span></td></tr><tr><th id=\"L186\"><a href=\"#L186\">186</a></th><td>\u00a0 \u00a0 \u00a0 dgps<span class=\"p\">,</span></td></tr><tr><th id=\"L187\"><a href=\"#L187\">187</a></th><td>\u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L188\"><a href=\"#L188\">188</a></th><td></td></tr><tr><th id=\"L189\"><a href=\"#L189\">189</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_id</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L190\"><a href=\"#L190\">190</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">106</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Receiver ID Message should be 59 words total (106 byte message)\"</span></td></tr><tr><th id=\"L191\"><a href=\"#L191\">191</a></th><td>\u00a0 \u00a0 ticks<span class=\"p\">,</span>\u00a0msgseq<span class=\"p\">,</span>\u00a0channels<span class=\"p\">,</span>\u00a0software_version<span class=\"p\">,</span>\u00a0software_date<span class=\"p\">,</span>\u00a0options_list<span class=\"p\">,</span>\u00a0reserved <span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;Lh20s20s20s20s20s'</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">)</span></td></tr><tr><th id=\"L192\"><a href=\"#L192\">192</a></th><td>\u00a0 \u00a0 channels<span class=\"p\">,</span>\u00a0software_version<span class=\"p\">,</span>\u00a0software_date<span class=\"p\">,</span>\u00a0options_list <span class=\"o\">=</span>\u00a0<span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"k\">lambda</span>\u00a0s<span class=\"p\">:</span>\u00a0s<span class=\"o\">.</span>split<span class=\"p\">(</span><span class=\"s\">'</span><span class=\"se\">\\0</span><span class=\"s\">'</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">],</span>\u00a0<span class=\"p\">(</span>channels<span class=\"p\">,</span>\u00a0software_version<span class=\"p\">,</span>\u00a0software_date<span class=\"p\">,</span>\u00a0options_list<span class=\"p\">))</span></td></tr><tr><th id=\"L193\"><a href=\"#L193\">193</a></th><td>\u00a0 \u00a0 software_version <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>software_version<span class=\"p\">)</span></td></tr><tr><th id=\"L194\"><a href=\"#L194\">194</a></th><td>\u00a0 \u00a0 channels <span class=\"o\">=</span>\u00a0<span class=\"nb\">int</span><span class=\"p\">(</span>channels<span class=\"p\">)</span>\u00a0<span class=\"c\"># 0-12 .. but ALWAYS 12, so we ignore.</span></td></tr><tr><th id=\"L195\"><a href=\"#L195\">195</a></th><td>\u00a0 \u00a0 options_list <span class=\"o\">=</span>\u00a0<span class=\"nb\">int</span><span class=\"p\">(</span>options_list<span class=\"p\">[:</span><span class=\"mi\">4</span><span class=\"p\">],</span>\u00a0<span class=\"mi\">16</span><span class=\"p\">)</span>\u00a0<span class=\"c\"># only two bitflags, others are reserved</span></td></tr><tr><th id=\"L196\"><a href=\"#L196\">196</a></th><td>\u00a0 \u00a0 minimize_rom <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span>options_list <span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0x01</span><span class=\"p\">)</span>\u00a0<span class=\"o\">&gt;</span>\u00a0<span class=\"mi\">0</span></td></tr><tr><th id=\"L197\"><a href=\"#L197\">197</a></th><td>\u00a0 \u00a0 minimize_ram <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span>options_list <span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0x02</span><span class=\"p\">)</span>\u00a0<span class=\"o\">&gt;</span>\u00a0<span class=\"mi\">0</span></td></tr><tr><th id=\"L198\"><a href=\"#L198\">198</a></th><td>\u00a0 \u00a0 <span class=\"c\"># (version info), (options info)</span></td></tr><tr><th id=\"L199\"><a href=\"#L199\">199</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">((</span>software_version<span class=\"p\">,</span>\u00a0software_date<span class=\"p\">),</span>\u00a0<span class=\"p\">(</span>minimize_rom<span class=\"p\">,</span>\u00a0minimize_ram<span class=\"p\">))</span></td></tr><tr><th id=\"L200\"><a href=\"#L200\">200</a></th><td></td></tr><tr><th id=\"L201\"><a href=\"#L201\">201</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_channels</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L202\"><a href=\"#L202\">202</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">90</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Channel Summary Message should be 51 words total (90 byte message)\"</span></td></tr><tr><th id=\"L203\"><a href=\"#L203\">203</a></th><td>\u00a0 \u00a0 ticks<span class=\"p\">,</span>\u00a0msgseq<span class=\"p\">,</span>\u00a0satseq<span class=\"p\">,</span>\u00a0gpswk<span class=\"p\">,</span>\u00a0gpsws<span class=\"p\">,</span>\u00a0gpsns <span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;LhhHLL'</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">[:</span><span class=\"mi\">18</span><span class=\"p\">])</span></td></tr><tr><th id=\"L204\"><a href=\"#L204\">204</a></th><td>\u00a0 \u00a0 channels <span class=\"o\">=</span>\u00a0<span class=\"p\">[]</span></td></tr><tr><th id=\"L205\"><a href=\"#L205\">205</a></th><td>\u00a0 \u00a0 message <span class=\"o\">=</span>\u00a0message<span class=\"p\">[</span><span class=\"mi\">18</span><span class=\"p\">:]</span></td></tr><tr><th id=\"L206\"><a href=\"#L206\">206</a></th><td>\u00a0 \u00a0 <span class=\"k\">for</span>\u00a0i <span class=\"ow\">in</span>\u00a0<span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">):</span></td></tr><tr><th id=\"L207\"><a href=\"#L207\">207</a></th><td>\u00a0 \u00a0 \u00a0 flags<span class=\"p\">,</span>\u00a0prn<span class=\"p\">,</span>\u00a0cno <span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;HHH'</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">[</span><span class=\"mi\">6</span>\u00a0<span class=\"o\">*</span>\u00a0i<span class=\"p\">:</span><span class=\"mi\">6</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"p\">(</span>i <span class=\"o\">+</span>\u00a0<span class=\"mi\">1</span><span class=\"p\">)])</span></td></tr><tr><th id=\"L208\"><a href=\"#L208\">208</a></th><td>\u00a0 \u00a0 \u00a0 <span class=\"c\"># measurement used, ephemeris available, measurement valid, dgps corrections available</span></td></tr><tr><th id=\"L209\"><a href=\"#L209\">209</a></th><td>\u00a0 \u00a0 \u00a0 flags <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span>flags <span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0x01</span><span class=\"p\">,</span>\u00a0flags <span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0x02</span><span class=\"p\">,</span>\u00a0flags <span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0x04</span><span class=\"p\">,</span>\u00a0flags <span class=\"o\">&amp;</span>\u00a0<span class=\"mh\">0x08</span><span class=\"p\">)</span></td></tr><tr><th id=\"L210\"><a href=\"#L210\">210</a></th><td>\u00a0 \u00a0 \u00a0 channels<span class=\"o\">.</span>append<span class=\"p\">((</span>flags<span class=\"p\">,</span>\u00a0prn<span class=\"p\">,</span>\u00a0cno<span class=\"p\">))</span></td></tr><tr><th id=\"L211\"><a href=\"#L211\">211</a></th><td>\u00a0 \u00a0 <span class=\"c\"># ((flags, satellite PRN, C/No in dbHz)) for 12 channels</span></td></tr><tr><th id=\"L212\"><a href=\"#L212\">212</a></th><td>\u00a0 \u00a0 <span class=\"c\"># satellite message sequence number</span></td></tr><tr><th id=\"L213\"><a href=\"#L213\">213</a></th><td>\u00a0 \u00a0 <span class=\"c\"># gps week number, gps seconds in week (??), gps nanoseconds from Epoch</span></td></tr><tr><th id=\"L214\"><a href=\"#L214\">214</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">tuple</span><span class=\"p\">(</span>channels<span class=\"p\">),)</span>\u00a0<span class=\"c\">#, satseq, (gpswk, gpsws, gpsns))</span></td></tr><tr><th id=\"L215\"><a href=\"#L215\">215</a></th><td></td></tr><tr><th id=\"L216\"><a href=\"#L216\">216</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_satellites</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L217\"><a href=\"#L217\">217</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">90</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Visible Satellites Message should be 51 words total (90 byte message)\"</span></td></tr><tr><th id=\"L218\"><a href=\"#L218\">218</a></th><td>\u00a0 \u00a0 ticks<span class=\"p\">,</span>\u00a0msgseq<span class=\"p\">,</span>\u00a0gdop<span class=\"p\">,</span>\u00a0pdop<span class=\"p\">,</span>\u00a0hdop<span class=\"p\">,</span>\u00a0vdop<span class=\"p\">,</span>\u00a0tdop<span class=\"p\">,</span>\u00a0numsatellites <span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;LhhhhhhH'</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">[:</span><span class=\"mi\">18</span><span class=\"p\">])</span></td></tr><tr><th id=\"L219\"><a href=\"#L219\">219</a></th><td>\u00a0 \u00a0 gdop<span class=\"p\">,</span>\u00a0pdop<span class=\"p\">,</span>\u00a0hdop<span class=\"p\">,</span>\u00a0vdop<span class=\"p\">,</span>\u00a0tdop <span class=\"o\">=</span>\u00a0<span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"k\">lambda</span>\u00a0n<span class=\"p\">:</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>n<span class=\"p\">)</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"mf\">0.01</span><span class=\"p\">,</span>\u00a0<span class=\"p\">(</span>gdop<span class=\"p\">,</span>\u00a0pdop<span class=\"p\">,</span>\u00a0hdop<span class=\"p\">,</span>\u00a0vdop<span class=\"p\">,</span>\u00a0tdop<span class=\"p\">))</span></td></tr><tr><th id=\"L220\"><a href=\"#L220\">220</a></th><td>\u00a0 \u00a0 satellites <span class=\"o\">=</span>\u00a0<span class=\"p\">[]</span></td></tr><tr><th id=\"L221\"><a href=\"#L221\">221</a></th><td>\u00a0 \u00a0 message <span class=\"o\">=</span>\u00a0message<span class=\"p\">[</span><span class=\"mi\">18</span><span class=\"p\">:]</span></td></tr><tr><th id=\"L222\"><a href=\"#L222\">222</a></th><td>\u00a0 \u00a0 <span class=\"k\">for</span>\u00a0i <span class=\"ow\">in</span>\u00a0<span class=\"nb\">range</span><span class=\"p\">(</span>numsatellites<span class=\"p\">):</span></td></tr><tr><th id=\"L223\"><a href=\"#L223\">223</a></th><td>\u00a0 \u00a0 \u00a0 prn<span class=\"p\">,</span>\u00a0azi<span class=\"p\">,</span>\u00a0elev <span class=\"o\">=</span>\u00a0struct<span class=\"o\">.</span>unpack<span class=\"p\">(</span><span class=\"s\">'&lt;Hhh'</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">[</span><span class=\"mi\">6</span>\u00a0<span class=\"o\">*</span>\u00a0i<span class=\"p\">:</span><span class=\"mi\">6</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"p\">(</span>i <span class=\"o\">+</span>\u00a0<span class=\"mi\">1</span><span class=\"p\">)])</span></td></tr><tr><th id=\"L224\"><a href=\"#L224\">224</a></th><td>\u00a0 \u00a0 \u00a0 azi<span class=\"p\">,</span>\u00a0elev <span class=\"o\">=</span>\u00a0<span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"k\">lambda</span>\u00a0n<span class=\"p\">:</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">(</span>n<span class=\"p\">)</span>\u00a0<span class=\"o\">*</span>\u00a0<span class=\"mf\">0.0180</span>\u00a0<span class=\"o\">/</span>\u00a0math<span class=\"o\">.</span>pi<span class=\"p\">),</span>\u00a0<span class=\"p\">(</span>azi<span class=\"p\">,</span>\u00a0elev<span class=\"p\">))</span></td></tr><tr><th id=\"L225\"><a href=\"#L225\">225</a></th><td>\u00a0 \u00a0 \u00a0 satellites<span class=\"o\">.</span>push<span class=\"p\">((</span>prn<span class=\"p\">,</span>\u00a0azi<span class=\"p\">,</span>\u00a0elev<span class=\"p\">))</span></td></tr><tr><th id=\"L226\"><a href=\"#L226\">226</a></th><td>\u00a0 \u00a0 <span class=\"c\"># ((PRN [0, 32], azimuth +=[0.0, 180.0] deg, elevation +-[0.0, 90.0] deg)) satellite info (0-12)</span></td></tr><tr><th id=\"L227\"><a href=\"#L227\">227</a></th><td>\u00a0 \u00a0 <span class=\"c\"># (geometric, position, horizontal, vertical, time) dilution of precision </span></td></tr><tr><th id=\"L228\"><a href=\"#L228\">228</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">tuple</span><span class=\"p\">(</span>satellites<span class=\"p\">),</span>\u00a0<span class=\"p\">(</span>gdop<span class=\"p\">,</span>\u00a0pdop<span class=\"p\">,</span>\u00a0hdop<span class=\"p\">,</span>\u00a0vdop<span class=\"p\">,</span>\u00a0tdop<span class=\"p\">))</span></td></tr><tr><th id=\"L229\"><a href=\"#L229\">229</a></th><td></td></tr><tr><th id=\"L230\"><a href=\"#L230\">230</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_dgps</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L231\"><a href=\"#L231\">231</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">38</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Differential GPS Status Message should be 25 words total (38 byte message)\"</span></td></tr><tr><th id=\"L232\"><a href=\"#L232\">232</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L233\"><a href=\"#L233\">233</a></th><td></td></tr><tr><th id=\"L234\"><a href=\"#L234\">234</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_ecef</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L235\"><a href=\"#L235\">235</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">96</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"ECEF Position Status Output Message should be 54 words total (96 byte message)\"</span></td></tr><tr><th id=\"L236\"><a href=\"#L236\">236</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L237\"><a href=\"#L237\">237</a></th><td></td></tr><tr><th id=\"L238\"><a href=\"#L238\">238</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_channelmeas</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L239\"><a href=\"#L239\">239</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">296</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Channel Measurement Message should be 154 words total (296 byte message)\"</span></td></tr><tr><th id=\"L240\"><a href=\"#L240\">240</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L241\"><a href=\"#L241\">241</a></th><td></td></tr><tr><th id=\"L242\"><a href=\"#L242\">242</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_usersettings</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L243\"><a href=\"#L243\">243</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">32</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"User-Settings Output Message should be 22 words total (32 byte message)\"</span></td></tr><tr><th id=\"L244\"><a href=\"#L244\">244</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L245\"><a href=\"#L245\">245</a></th><td></td></tr><tr><th id=\"L246\"><a href=\"#L246\">246</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_testresults</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L247\"><a href=\"#L247\">247</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">28</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Built-In Test Results Message should be 20 words total (28 byte message)\"</span></td></tr><tr><th id=\"L248\"><a href=\"#L248\">248</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L249\"><a href=\"#L249\">249</a></th><td></td></tr><tr><th id=\"L250\"><a href=\"#L250\">250</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_meastimemark</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L251\"><a href=\"#L251\">251</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">494</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Measurement Time Mark Message should be 253 words total (494 byte message)\"</span></td></tr><tr><th id=\"L252\"><a href=\"#L252\">252</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L253\"><a href=\"#L253\">253</a></th><td></td></tr><tr><th id=\"L254\"><a href=\"#L254\">254</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_utctimemark</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L255\"><a href=\"#L255\">255</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">28</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"UTC Time Mark Pulse Output Message should be 20 words total (28 byte message)\"</span></td></tr><tr><th id=\"L256\"><a href=\"#L256\">256</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L257\"><a href=\"#L257\">257</a></th><td></td></tr><tr><th id=\"L258\"><a href=\"#L258\">258</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_serial</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L259\"><a href=\"#L259\">259</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">30</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"Serial Port Communication Paramaters In Use Message should be 21 words total (30 byte message)\"</span></td></tr><tr><th id=\"L260\"><a href=\"#L260\">260</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L261\"><a href=\"#L261\">261</a></th><td></td></tr><tr><th id=\"L262\"><a href=\"#L262\">262</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_eepromupdate</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L263\"><a href=\"#L263\">263</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">8</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"EEPROM Update Message should be 10 words total (8 byte message)\"</span></td></tr><tr><th id=\"L264\"><a href=\"#L264\">264</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr><tr><th id=\"L265\"><a href=\"#L265\">265</a></th><td></td></tr><tr><th id=\"L266\"><a href=\"#L266\">266</a></th><td>\u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_eepromstatus</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0message<span class=\"p\">):</span></td></tr><tr><th id=\"L267\"><a href=\"#L267\">267</a></th><td>\u00a0 \u00a0 <span class=\"k\">assert</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>message<span class=\"p\">)</span>\u00a0<span class=\"o\">==</span>\u00a0<span class=\"mi\">24</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"EEPROM Status Message should be 18 words total (24 byte message)\"</span></td></tr><tr><th id=\"L268\"><a href=\"#L268\">268</a></th><td>\u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">NotImplementedError</span></td></tr></tbody></table>\n\n      </div>\n      <div id=\"anydiff\">\n        <form action=\"/LUCICodeRepository/nomaticIM/diff\" method=\"get\">\n          <div class=\"buttons\">\n            <input type=\"hidden\" name=\"new_path\" value=\"/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py\" />\n            <input type=\"hidden\" name=\"old_path\" value=\"/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py\" />\n            <input type=\"hidden\" name=\"new_rev\" />\n            <input type=\"hidden\" name=\"old_rev\" />\n            <input type=\"submit\" value=\"View changes...\" title=\"Select paths and revs for Diff\" />\n          </div>\n        </form>\n      </div>\n      <div id=\"help\"><strong>Note:</strong> See <a href=\"/LUCICodeRepository/nomaticIM/wiki/TracBrowser\">TracBrowser</a>\n        for help on using the repository browser.</div>\n    </div>\n    <div id=\"altlinks\">\n      <h3>Download in other formats:</h3>\n      <ul>\n        <li class=\"first\">\n          <a rel=\"nofollow\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py?format=txt\">Plain Text</a>\n        </li><li class=\"last\">\n          <a rel=\"nofollow\" href=\"/LUCICodeRepository/nomaticIM/export/1312/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/rockwell.py\">Original Format</a>\n        </li>\n      </ul>\n    </div>\n    </div>\n    <div id=\"footer\" lang=\"en\" xml:lang=\"en\"><hr />\n      <a id=\"tracpowered\" href=\"http://trac.edgewall.org/\"><img src=\"/LUCICodeRepository/nomaticIM/chrome/common/trac_logo_mini.png\" height=\"30\" width=\"107\" alt=\"Trac Powered\" /></a>\n      <p class=\"left\">Powered by <a href=\"/LUCICodeRepository/nomaticIM/about\"><strong>Trac 1.0.1</strong></a><br />\n        By <a href=\"http://www.edgewall.org/\">Edgewall Software</a>.</p>\n      <p class=\"right\">All content copyright 2007-2008 by LUCI <br /><a href=\"http://luci.ics.uci.edu/\">http://luci.ics.uci.edu/</a></p>\n    </div>\n\t\t<div id=\"sitefooter\">\n\t\t\t<script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\n\t\t\t</script>\n\t\t\t<script type=\"text/javascript\">\n\t\t\t\t_uacct = \"UA-338915-2\";\n\t\t\t\turchinTracker();\n\t\t\t</script>\n\t\t</div>\n\t</body>\n</html>", "id": 44887.0}