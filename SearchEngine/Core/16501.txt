{"text": "Last Published 2 14 7 14Version 8 6 Documentation Home Documentation Installing and Managing AsterixDB using Managix AsterixDB 1 1 An ADM and AQL Primer AsterixDB Javascript SDK Asterix Data Model ADM Asterix Query Language AQL AQL Functions AQL Allen s Relations Functions AQL Support of Similarity Queries Accessing External Data REST API to AsterixDB Accessing External Data in AsterixDB Table of Contents IntroductionAdapter for an External DatasetCreating an External DatasetWriting Queries against an External Dataset Introduction Back to TOC Data that needs to be processed by ASTERIX could be residing outside ASTERIX storage Examples include data files on a distributed file system such as HDFS or on the local file system of a machine that is part of an ASTERIX cluster For ASTERIX to process such data end user may create a regular dataset in ASTERIX a k a internal dataset and load the dataset with the data ASTERIX supports external datasets so that it is not necessary to load all data prior to using it This also avoids creating multiple copies of data and the need to keep the copies in sync Adapter for an External Dataset Back to TOC External data is accessed using wrappers adapters in ASTERIX that abstract away the mechanism of connecting with an external service receiving data and transforming the data into ADM records that are understood by ASTERIX ASTERIX comes with built in adapters for common storage systems such as HDFS or the local file system Creating an External Dataset Back to TOC As an example we consider the Lineitem dataset from TPCH schema We assume that you have successfully created an ASTERIX instance following the instructions at Installing Asterix Using Managix For constructing an example we assume a single machine setup Similar to a regular dataset an external dataset has an associated datatype We shall first create the datatype associated with each record in Lineitem data Paste the following in the query textbox on the webpage at http 127 1 19 1 and hit Execute create dataverse ExternalFileDemo use dataverse ExternalFileDemo create type LineitemType as closed l orderkey int32 l partkey int32 l suppkey int32 l linenumber int32 l quantity double l extendedprice double l discount double l tax double l returnflag string l linestatus string l shipdate string l commitdate string l receiptdate string l shipinstruct string l shipmode string l comment string We describe here two scenarios 1 Data file resides on the local file system of a host Prerequisite The host is a part of the ASTERIX cluster Earlier we assumed a single machine ASTERIX setup To satisfy the prerequisite log in to the machine running ASTERIX Download the data file to an appropriate location We denote this location by SOURCE PATH ASTERIX provides a built in adapter for data residing on the local file system The adapter is referred by its alias localfs We create an external dataset named Lineitem and use the localfs adapter create external dataset Lineitem LineitemType using localfs Above the definition is not complete as we need to provide a set of parameters that are specific to the source file Parameter Description path A fully qualified path of the form host absolute path Use a comma separated list if there are multiple files E g host1 absolute path host2 absolute path and so forth format The format for the content Use adm for data in ADM ASTERIX Data Model or JSON format Use delimited text if fields are separted by delimiterThe delimiting character in the source file if format is delimited text As we are using a single single machine ASTERIX instance we use 127 1 as host in the path parameter We complete the create dataset statement as follows use dataverse ExternalFileDemo create external dataset Lineitem LineitemType using localfs path 127 1 SOURCE PATH format delimited text delimiter Please substitute SOURCE PATH with the absolute path to the source file on the local file system Common source of error An incorrect value for the path parameter will give the following exception message when the dataset is used in a query edu uci ics hyracks algebricks common exceptions AlgebricksException edu uci ics hyracks api exceptions HyracksDataException edu uci ics hyracks api exceptions HyracksDataException Job failed Verify the correctness of the path parameter provided to the localfs adapter Note that the path parameter must be an absolute path to the data file For e g if you saved your file in your home directory assume it to be home joe then the path value should be 127 1 home joe lineitem tbl In your web browser navigate to 127 1 19 1 and paste the above to the query text box Finally hit Execute Next we move over to the the section Writing Queries against an External Dataset and try a sample query against the external dataset 2 Data file resides on an HDFS instance Pre requisite It is required that the Namenode and atleast one of the HDFS Datanodes are reachable from the hosts that form the ASTERIX cluster ASTERIX provides a built in adapter for data residing on HDFS The HDFS adapter is referred in AQL by its alias hdfs We create an external dataset named Lineitem and associate the HDFS adapter with it create external dataset Lineitem LineitemType using hdfs The above statement is not complete as we need to provide a set of parameters specific to the HDFS instance and the source file These parameters are described below Parameter Description hdfs The HDFS URL path The absolute path to the source HDFS file Use a comma separated list if there are multiple files input format The associated input format Use text input format for textual data or sequence input format for binary data sequence files format The format for the content Use adm for data in ADM ASTERIX Data Model or JSON format and use delimited text for delimited data that has fields separated by a delimiting character delimiter The delimiting character in the source file if format is delimited text Difference between input format and format input format File stored under HDFS have an associated storage format For example TextInputFormat represents plain text files SequenceFileInputFormat indicates binary compressed file The parameter input format is used to distinguish between these two kind of files format The parameter format refers to the type of the data contained in the file For example data contained in a file could be in json ADM format or could be delimited text with fields separated by a delimiting character As an example consider the data file The file is a text file with each line representing a record The fields in each record are separated by the character We assume the HDFS URL to be hdfs host port We further assume that the example data file is copied to the HDFS at a path denoted by HDFS PATH The complete set of parameters for our example file are as follows hdfs HDFS URL path HDFS PATH input format text input format format delimited text delimiter We modify the create external dataset statement as follows create external dataset Lineitem LineitemType using hdfs hdfs HDFS URL path HDFS PATH input format text input format format delimited text delimiter Once you have copied the source data file to your HDFS instance substitute the values of HDFS URL and HDFS PATH in the above statement In your web browser navigate to http 127 1 19 1 and execute the above statement with substituted values You may now run the sample query in next section Writing Queries against an External Dataset Back to TOC You may write AQL queries against an external dataset Following is an example AQL query that applies a filter and returns an ordered result use dataverse ExternalFileDemo for c in dataset Lineitem where c l orderkey 3 order by c l orderkey c l linenumber return c The expected result is l orderkey 1 l partkey 156 l suppkey 4 l linenumber 1 l quantity 17 l extendedprice 17954 55d l discount 4d l tax 2d l returnflag N l linestatus O l shipdate 1996 3 13 l commitdate 1996 2 12 l receiptdate 1996 3 22 l shipinstruct DELIVER IN PERSON l shipmode TRUCK l comment egular courts above the l orderkey 1 l partkey 68 l suppkey 9 l linenumber 2 l quantity 36 l extendedprice 3485 16d l discount 9d l tax 6d l returnflag N l linestatus O l shipdate 1996 4 12 l commitdate 1996 2 28 l receiptdate 1996 4 2 l shipinstruct TAKE BACK RETURN l shipmode MAIL l comment ly final dependencies slyly bold l orderkey 1 l partkey 64 l suppkey 5 l linenumber 3 l quantity 8 l extendedprice 7712 48d l discount 1d l tax 2d l returnflag N l linestatus O l shipdate 1996 1 29 l commitdate 1996 3 5 l receiptdate 1996 1 31 l shipinstruct TAKE BACK RETURN l shipmode REG AIR l comment riously regular express dep l orderkey 1 l partkey 3 l suppkey 6 l linenumber 4 l quantity 28 l extendedprice 25284 d l discount 9d l tax 6d l returnflag N l linestatus O l shipdate 1996 4 21 l commitdate 1996 3 3 l receiptdate 1996 5 16 l shipinstruct NONE l shipmode AIR l comment lites fluffily even de l orderkey 1 l partkey 25 l suppkey 8 l linenumber 5 l quantity 24 l extendedprice 222 48d l discount 1d l tax 4d l returnflag N l linestatus O l shipdate 1996 3 3 l commitdate 1996 3 14 l receiptdate 1996 4 1 l shipinstruct NONE l shipmode FOB l comment pending foxes slyly re l orderkey 1 l partkey 16 l suppkey 3 l linenumber 6 l quantity 32 l extendedprice 29312 32d l discount 7d l tax 2d l returnflag N l linestatus O l shipdate 1996 1 3 l commitdate 1996 2 7 l receiptdate 1996 2 3 l shipinstruct DELIVER IN PERSON l shipmode MAIL l comment arefully slyly ex l orderkey 2 l partkey 1 7 l suppkey 2 l linenumber 1 l quantity 38 l extendedprice 38269 8d l discount d l tax 5d l returnflag N l linestatus O l shipdate 1997 1 28 l commitdate 1997 1 14 l receiptdate 1997 2 2 l shipinstruct TAKE BACK RETURN l shipmode RAIL l comment ven requests deposits breach a l orderkey 3 l partkey 5 l suppkey 2 l linenumber 1 l quantity 45 l extendedprice 4 725 d l discount 6d l tax d l returnflag R l linestatus F l shipdate 1994 2 2 l commitdate 1994 1 4 l receiptdate 1994 2 23 l shipinstruct NONE l shipmode AIR l comment ongside of the furiously brave acco l orderkey 3 l partkey 2 l suppkey 1 l linenumber 2 l quantity 49 l extendedprice 45 8 98d l discount 1d l tax d l returnflag R l linestatus F l shipdate 1993 11 9 l commitdate 1993 12 2 l receiptdate 1993 11 24 l shipinstruct TAKE BACK RETURN l shipmode RAIL l comment unusual accounts eve l orderkey 3 l partkey 129 l suppkey 8 l linenumber 3 l quantity 27 l extendedprice 27786 24d l discount 6d l tax 7d l returnflag A l linestatus F l shipdate 1994 1 16 l commitdate 1993 11 22 l receiptdate 1994 1 23 l shipinstruct DELIVER IN PERSON l shipmode SHIP l comment nal foxes wake l orderkey 3 l partkey 3 l suppkey 5 l linenumber 4 l quantity 2 l extendedprice 186 6d l discount 1d l tax 6d l returnflag A l linestatus F l shipdate 1993 12 4 l commitdate 1994 1 7 l receiptdate 1994 1 1 l shipinstruct NONE l shipmode TRUCK l comment y fluffily pending d l orderkey 3 l partkey 184 l suppkey 5 l linenumber 5 l quantity 28 l extendedprice 3 357 4d l discount 4d l tax d l returnflag R l linestatus F l shipdate 1993 12 14 l commitdate 1994 1 1 l receiptdate 1994 1 1 l shipinstruct TAKE BACK RETURN l shipmode FOB l comment ages nag slyly pending l orderkey 3 l partkey 63 l suppkey 8 l linenumber 6 l quantity 26 l extendedprice 25 39 56d l discount 1d l tax 2d l returnflag A l linestatus F l shipdate 1993 1 29 l commitdate 1993 12 18 l receiptdate 1993 11 4 l shipinstruct TAKE BACK RETURN l shipmode RAIL l comment ges sleep after the caref Copyright 2 14 All Rights Reserved ", "_id": "http://asterix.ics.uci.edu/documentation/aql/externaldata.html", "title": "asterixdb - ", "html": "<!DOCTYPE html>\n<!--\n | Generated by Apache Maven Doxia at 2014-07-14\n | Rendered using Apache Maven Fluido Skin 1.3.0\n-->\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta name=\"Date-Revision-yyyymmdd\" content=\"20140714\" />\n    <meta http-equiv=\"Content-Language\" content=\"en\" />\n    <title>AsterixDB - </title>\n    <link rel=\"stylesheet\" href=\"../css/apache-maven-fluido-1.3.0.min.css\" />\n    <link rel=\"stylesheet\" href=\"../css/site.css\" />\n    <link rel=\"stylesheet\" href=\"../css/print.css\" media=\"print\" />\n\n      \n    <script type=\"text/javascript\" src=\"../js/apache-maven-fluido-1.3.0.min.js\"></script>\n\n                          \n        \n<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n        ga('create', 'UA-41536543-1', 'uci.edu');\n        ga('send', 'pageview');</script>\n          \n            </head>\n        <body class=\"topBarDisabled\">\n          \n                \n                    \n    \n        <div class=\"container-fluid\">\n          <div id=\"banner\">\n        <div class=\"pull-left\">\n                                    <a href=\"http://asterixdb.ics.uci.edu/\" id=\"bannerLeft\">\n                                                                                                <img src=\"../images/asterixlogo.png\"  alt=\"AsterixDB\"/>\n                </a>\n                      </div>\n        <div class=\"pull-right\">  </div>\n        <div class=\"clear\"><hr/></div>\n      </div>\n\n      <div id=\"breadcrumbs\">\n        <ul class=\"breadcrumb\">\n                \n                    \n                  <li id=\"publishDate\">Last Published: 2014-07-14</li>\n                      \n                \n                    \n                 <li id=\"projectVersion\" class=\"pull-right\">Version: 0.8.6</li>\n      \n                                            <li class=\"divider pull-right\">|</li>\n                        \n    <li class=\"pull-right\">              <a href=\"../index.html\" title=\"Documentation Home\">\n        Documentation Home</a>\n  </li>\n\n                        </ul>\n      </div>\n\n            \n      <div class=\"row-fluid\">\n        <div id=\"leftColumn\" class=\"span3\">\n          <div class=\"well sidebar-nav\">\n                \n                    \n                <ul class=\"nav nav-list\">\n                    <li class=\"nav-header\">Documentation</li>\n                                \n      <li>\n    \n                          <a href=\"../install.html\" title=\"Installing and Managing AsterixDB using Managix\">\n          <i class=\"none\"></i>\n        Installing and Managing AsterixDB using Managix</a>\n            </li>\n                  \n      <li>\n    \n                          <a href=\"../aql/primer.html\" title=\"AsterixDB 101: An ADM and AQL Primer\">\n          <i class=\"none\"></i>\n        AsterixDB 101: An ADM and AQL Primer</a>\n            </li>\n                  \n      <li>\n    \n                          <a href=\"../aql/js-sdk.html\" title=\"AsterixDB Javascript SDK\">\n          <i class=\"none\"></i>\n        AsterixDB Javascript SDK</a>\n            </li>\n                  \n      <li>\n    \n                          <a href=\"../aql/datamodel.html\" title=\"Asterix Data Model (ADM)\">\n          <i class=\"none\"></i>\n        Asterix Data Model (ADM)</a>\n            </li>\n                  \n      <li>\n    \n                          <a href=\"../aql/manual.html\" title=\"Asterix Query Language (AQL)\">\n          <i class=\"none\"></i>\n        Asterix Query Language (AQL)</a>\n            </li>\n                  \n      <li>\n    \n                          <a href=\"../aql/functions.html\" title=\"AQL Functions\">\n          <i class=\"none\"></i>\n        AQL Functions</a>\n            </li>\n                  \n      <li>\n    \n                          <a href=\"../aql/allens.html\" title=\"AQL Allen's Relations Functions\">\n          <i class=\"none\"></i>\n        AQL Allen's Relations Functions</a>\n            </li>\n                  \n      <li>\n    \n                          <a href=\"../aql/similarity.html\" title=\"AQL Support of Similarity Queries\">\n          <i class=\"none\"></i>\n        AQL Support of Similarity Queries</a>\n            </li>\n                  \n      <li class=\"active\">\n    \n            <a href=\"#\"><i class=\"none\"></i>Accessing External Data</a>\n          </li>\n                  \n      <li>\n    \n                          <a href=\"../api.html\" title=\"REST API to AsterixDB\">\n          <i class=\"none\"></i>\n        REST API to AsterixDB</a>\n            </li>\n            </ul>\n                \n                    \n                \n          <hr class=\"divider\" />\n\n           <div id=\"poweredBy\">\n                            <div class=\"clear\"></div>\n                            <div class=\"clear\"></div>\n                            <div class=\"clear\"></div>\n                                                                                                                         <a href=\"https://code.google.com/p/hyracks/\" title=\"Hyracks\" class=\"builtBy\">\n        <img class=\"builtBy\"  alt=\"Hyracks\" src=\"../images/hyrax_ts.png\"    />\n      </a>\n                      </div>\n          </div>\n        </div>\n        \n                \n        <div id=\"bodyColumn\"  class=\"span9\" >\n                                  \n            <h1>Accessing External Data in AsterixDB</h1>\n<div class=\"section\">\n<h2><a name=\"toc\" id=\"toc\">Table of Contents</a><a name=\"Table_of_Contents\"></a></h2>\n\n<ul>\n  \n<li><a href=\"#Introduction\">Introduction</a></li>\n  \n<li><a href=\"#IntroductionAdapterForAnExternalDataset\">Adapter for an External Dataset</a></li>\n  \n<li><a href=\"#IntroductionCreatingAnExternalDataset\">Creating an External Dataset</a></li>\n  \n<li><a href=\"#WritingQueriesAgainstAnExternalDataset\">Writing Queries against an External Dataset</a></li>\n</ul></div>\n<div class=\"section\">\n<h2><a name=\"Introduction\" id=\"Introduction\">Introduction</a> <font size=\"4\"><a href=\"#toc\">[Back to TOC]</a></font><a name=\"Introduction_Back_to_TOC\"></a></h2>\n<p>Data that needs to be processed by ASTERIX could be residing outside ASTERIX storage. Examples include data files on a distributed file system such as HDFS or on the local file system of a machine that is part of an ASTERIX cluster. For ASTERIX to process such data, end-user may create a regular dataset in ASTERIX (a.k.a. internal dataset) and load the dataset with the data. ASTERIX supports &#x2018;&#x2018;external datasets&#x2019;&#x2019; so that it is not necessary to &#x201c;load&#x201d; all data prior to using it. This also avoids creating multiple copies of data and the need to keep the copies in sync.</p>\n<div class=\"section\">\n<h3><a name=\"IntroductionAdapterForAnExternalDataset\" id=\"IntroductionAdapterForAnExternalDataset\">Adapter for an External Dataset</a> <font size=\"4\"><a href=\"#toc\">[Back to TOC]</a></font><a name=\"Adapter_for_an_External_Dataset_Back_to_TOC\"></a></h3>\n<p>External data is accessed using wrappers (adapters in ASTERIX) that abstract away the mechanism of connecting with an external service, receiving data and transforming the data into ADM records that are understood by ASTERIX. ASTERIX comes with built-in adapters for common storage systems such as HDFS or the local file system.</p></div>\n<div class=\"section\">\n<h3><a name=\"IntroductionCreatingAnExternalDataset\" id=\"IntroductionCreatingAnExternalDataset\">Creating an External Dataset</a> <font size=\"4\"><a href=\"#toc\">[Back to TOC]</a></font><a name=\"Creating_an_External_Dataset_Back_to_TOC\"></a></h3>\n<p>As an example we consider the Lineitem dataset from <a class=\"externalLink\" href=\"http://www.openlinksw.com/dataspace/doc/dav/wiki/Main/VOSTPCHLinkedData/tpch.sql\">TPCH schema</a>.</p>\n<p>We assume that you have successfully created an ASTERIX instance following the instructions at <a href=\"../install.html\">Installing Asterix Using Managix</a>. <i>For constructing an example, we assume a single machine setup.</i></p>\n<p>Similar to a regular dataset, an external dataset has an associated datatype. We shall first create the datatype associated with each record in Lineitem data. Paste the following in the query textbox on the webpage at <a class=\"externalLink\" href=\"http://127.0.0.1:19001\">http://127.0.0.1:19001</a> and hit &#x2018;Execute&#x2019;.</p>\n\n<div class=\"source\">\n<pre>    create dataverse ExternalFileDemo;\n    use dataverse ExternalFileDemo;\n\n    create type LineitemType as closed {\n      l_orderkey:int32,\n      l_partkey: int32,\n      l_suppkey: int32,\n      l_linenumber: int32,\n      l_quantity: double,\n      l_extendedprice: double,\n      l_discount: double,\n      l_tax: double,\n      l_returnflag: string,\n      l_linestatus: string,\n      l_shipdate: string,\n      l_commitdate: string,\n      l_receiptdate: string,\n      l_shipinstruct: string,\n      l_shipmode: string,\n      l_comment: string}\n</pre></div>\n<p>We describe here two scenarios.</p>\n<div class=\"section\">\n<h4>1) Data file resides on the local file system of a host<a name=\"a1_Data_file_resides_on_the_local_file_system_of_a_host\"></a></h4>\n<p>Prerequisite: The host is a part of the ASTERIX cluster.</p>\n<p>Earlier, we assumed a single machine ASTERIX setup. To satisfy the prerequisite, log-in to the machine running ASTERIX.</p>\n\n<ul>\n  \n<li>Download the <a class=\"externalLink\" href=\"https://code.google.com/p/asterixdb/downloads/detail?name=lineitem.tbl&amp;can=2&amp;q=\">data file</a> to an appropriate location. We denote this location by SOURCE_PATH.</li>\n</ul>\n<p>ASTERIX provides a built-in adapter for data residing on the local file system. The adapter is referred by its alias- &#x2018;localfs&#x2019;. We create an external dataset named Lineitem and use the &#x2018;localfs&#x2019; adapter.</p>\n\n<div class=\"source\">\n<pre>    create external dataset Lineitem(LineitemType)\n    using localfs\n</pre></div>\n<p>Above, the definition is not complete as we need to provide a set of parameters that are specific to the source file.</p>\n\n<table border=\"0\" class=\"table table-striped\">\n\n<tr class=\"a\">\n  \n<td> Parameter </td>\n  \n<td> Description </td>\n</tr>\n\n<tr class=\"b\">\n  \n<td> path </td>\n  \n<td> A fully qualified path of the form <tt>host://&lt;absolute path&gt;</tt>. \n  Use a comma separated list if there are multiple files. \n  E.g. <tt>host1://&lt;absolute path&gt;</tt>, <tt>host2://&lt;absolute path&gt;</tt> and so forth. </td>\n</tr>\n\n<tr class=\"a\">\n  \n<td> format </td>\n  \n<td> The format for the content. Use 'adm' for data in ADM (ASTERIX Data Model) or <a class=\"externalLink\" href=\"http://www.json.org/\">JSON</a> format. Use 'delimited-text' if fields are separted by . </td></tr>\n\n<tr class=\"b\">\n<td>delimiter</td>\n<td>The delimiting character in the source file if format is 'delimited text'</td></tr>\n</table>\n<p>As we are using a single single machine ASTERIX instance, we use 127.0.0.1 as host in the path parameter. We <i>complete the create dataset statement</i> as follows.</p>\n\n<div class=\"source\">\n<pre>    use dataverse ExternalFileDemo;\n\n    create external dataset Lineitem(LineitemType)\n    using localfs\n    ((&quot;path&quot;=&quot;127.0.0.1://SOURCE_PATH&quot;),\n    (&quot;format&quot;=&quot;delimited-text&quot;),\n    (&quot;delimiter&quot;=&quot;|&quot;));\n</pre></div>\n<p>Please substitute SOURCE_PATH with the absolute path to the source file on the local file system.</p></div>\n<div class=\"section\">\n<h4>Common source of error<a name=\"Common_source_of_error\"></a></h4>\n<p>An incorrect value for the path parameter will give the following exception message when the dataset is used in a query.</p>\n\n<div class=\"source\">\n<pre>    edu.uci.ics.hyracks.algebricks.common.exceptions.AlgebricksException: edu.uci.ics.hyracks.api.exceptions.HyracksDataException: edu.uci.ics.hyracks.api.exceptions.HyracksDataException: Job failed.\n</pre></div>\n<p>Verify the correctness of the path parameter provided to the localfs adapter. Note that the path parameter must be an absolute path to the data file. For e.g. if you saved your file in your home directory (assume it to be /home/joe), then the path value should be</p>\n\n<div class=\"source\">\n<pre>    127.0.0.1:///home/joe/lineitem.tbl.\n</pre></div>\n<p>In your web-browser, navigate to 127.0.0.1:19001 and paste the above to the query text box. Finally hit &#x2018;Execute&#x2019;.</p>\n<p>Next we move over to the the section <a href=\"#Writing_Queries_against_an_External_Dataset\">Writing Queries against an External Dataset</a> and try a sample query against the external dataset.</p></div>\n<div class=\"section\">\n<h4>2) Data file resides on an HDFS instance<a name=\"a2_Data_file_resides_on_an_HDFS_instance\"></a></h4>\n<p>Pre-requisite: It is required that the Namenode and atleast one of the HDFS Datanodes are reachable from the hosts that form the ASTERIX cluster. ASTERIX provides a built-in adapter for data residing on HDFS. The HDFS adapter is referred (in AQL) by its alias - &#x2018;hdfs&#x2019;. We create an external dataset named Lineitem and associate the HDFS adapter with it.</p>\n\n<div class=\"source\">\n<pre>    create external dataset Lineitem(LineitemType)\n    using hdfs\n</pre></div>\n<p>The above statement is <i>not complete</i> as we need to provide a set of parameters specific to the HDFS instance and the source file. These parameters are described below.</p>\n\n<table border=\"0\" class=\"table table-striped\">\n\n<tr class=\"a\">\n  \n<td> Parameter </td>\n  \n<td> Description </td>\n</tr>\n\n<tr class=\"b\">\n  \n<td> hdfs </td>\n  \n<td> The HDFS URL </td>\n</tr>\n\n<tr class=\"a\">\n  \n<td> path </td>\n  \n<td> The absolute path to the source HDFS file. Use a comma separated list if there are multiple files. </td></tr>\n\n<tr class=\"b\">\n  \n<td> input-format </td>\n  \n<td> The associated input format. Use 'text-input-format' for textual data or 'sequence-input-format' for binary data (sequence files). </td>\n</tr>\n\n<tr class=\"a\">\n  \n<td> format </td>\n  \n<td> The format for the content. Use 'adm' for data in ADM (ASTERIX Data Model) or \n  <a class=\"externalLink\" href=\"http://www.json.org/\">JSON</a> format and use 'delimited-text' for delimited data \n  that has fields separated by a delimiting character. </td>\n</tr>\n\n<tr class=\"b\">\n  \n<td> delimiter </td>\n  \n<td> The delimiting character in the source file if format is 'delimited text' </td>\n</tr>\n</table>\n<p><i>Difference between &#x2018;input-format&#x2019; and &#x2018;format&#x2019;</i></p>\n<p><i>input-format</i>: File stored under HDFS have an associated storage format For example, TextInputFormat represents plain text files. SequenceFileInputFormat indicates binary compressed file. The parameter &#x2018;input-format&#x2019; is used to distinguish between these two kind of files.</p>\n<p><i>format</i>: The parameter &#x2018;format&#x2019; refers to the type of the data contained in the file. For example data contained in a file could be in json, ADM format or could be delimited-text with fields separated by a delimiting character.</p>\n<p>As an example. consider the <a class=\"externalLink\" href=\"https://code.google.com/p/asterixdb/downloads/detail?name=lineitem.tbl&amp;can=2&amp;q=\">data file</a>. The file is a text file with each line representing a record. The fields in each record are separated by the &#x2018;|&#x2019; character.</p>\n<p>We assume the HDFS URL to be <a class=\"externalLink\" href=\"hdfs://host:port\">hdfs://host:port</a>. We further assume that the example data file is copied to the HDFS at a path denoted by HDFS_PATH.</p>\n<p>The complete set of parameters for our example file are as follows. ((&#x201c;hdfs&#x201d;=&#x201c;HDFS_URL&#x201d;,(&#x201c;path&#x201d;=&#x201c;HDFS_PATH&#x201d;),(&#x201c;input-format&#x201d;=&#x201c;text-input-format&#x201d;),(&#x201c;format&#x201d;=&#x201c;delimited-text&#x201d;),(&#x201c;delimiter&#x201d;=&#x201c;|&#x201d;))</p>\n<p>We modify the create external dataset statement as follows.</p>\n\n<div class=\"source\">\n<pre>    create external dataset Lineitem('LineitemType)\n    using hdfs\n    ((&quot;hdfs&quot;=&quot;HDFS_URL&quot;),(&quot;path&quot;=&quot;HDFS_PATH&quot;),(&quot;input-format&quot;=&quot;text-input-format&quot;),(&quot;format&quot;=&quot;delimited-text&quot;),(&quot;delimiter&quot;=&quot;|&quot;));\n</pre></div>\n<p>Once you have copied the source data file to your HDFS instance, substitute the values of HDFS_URL and HDFS_PATH in the above statement. In your web-browser, navigate to <a class=\"externalLink\" href=\"http://127.0.0.1:19001\">http://127.0.0.1:19001</a> and execute the above statement with substituted values.</p>\n<p>You may now run the sample query in next section.</p></div></div></div>\n<div class=\"section\">\n<h2><a name=\"WritingQueriesAgainstAnExternalDataset\" id=\"WritingQueriesAgainstAnExternalDataset\">Writing Queries against an External Dataset</a> <font size=\"4\"><a href=\"#toc\">[Back to TOC]</a></font><a name=\"Writing_Queries_against_an_External_Dataset_Back_to_TOC\"></a></h2>\n<p>You may write AQL queries against an external dataset. Following is an example AQL query that applies a filter and returns an ordered result.</p>\n\n<div class=\"source\">\n<pre>    use dataverse ExternalFileDemo;\n\n    for $c in dataset('Lineitem')\n    where $c.l_orderkey &lt;= 3\n    order by $c.l_orderkey, $c.l_linenumber\n    return $c\n</pre></div>\n<p>The expected result is:</p>\n\n<div class=\"source\">\n<pre>    { &quot;l_orderkey&quot;: 1, &quot;l_partkey&quot;: 156, &quot;l_suppkey&quot;: 4, &quot;l_linenumber&quot;: 1, &quot;l_quantity&quot;: 17, &quot;l_extendedprice&quot;: 17954.55d, &quot;l_discount&quot;: 0.04d, &quot;l_tax&quot;: 0.02d, &quot;l_returnflag&quot;: &quot;N&quot;, &quot;l_linestatus&quot;: &quot;O&quot;, &quot;l_shipdate&quot;: &quot;1996-03-13&quot;, &quot;l_commitdate&quot;: &quot;1996-02-12&quot;, &quot;l_receiptdate&quot;: &quot;1996-03-22&quot;, &quot;l_shipinstruct&quot;: &quot;DELIVER IN PERSON&quot;, &quot;l_shipmode&quot;: &quot;TRUCK&quot;, &quot;l_comment&quot;: &quot;egular courts above the&quot; }\n    { &quot;l_orderkey&quot;: 1, &quot;l_partkey&quot;: 68, &quot;l_suppkey&quot;: 9, &quot;l_linenumber&quot;: 2, &quot;l_quantity&quot;: 36, &quot;l_extendedprice&quot;: 34850.16d, &quot;l_discount&quot;: 0.09d, &quot;l_tax&quot;: 0.06d, &quot;l_returnflag&quot;: &quot;N&quot;, &quot;l_linestatus&quot;: &quot;O&quot;, &quot;l_shipdate&quot;: &quot;1996-04-12&quot;, &quot;l_commitdate&quot;: &quot;1996-02-28&quot;, &quot;l_receiptdate&quot;: &quot;1996-04-20&quot;, &quot;l_shipinstruct&quot;: &quot;TAKE BACK RETURN&quot;, &quot;l_shipmode&quot;: &quot;MAIL&quot;, &quot;l_comment&quot;: &quot;ly final dependencies: slyly bold &quot; }\n    { &quot;l_orderkey&quot;: 1, &quot;l_partkey&quot;: 64, &quot;l_suppkey&quot;: 5, &quot;l_linenumber&quot;: 3, &quot;l_quantity&quot;: 8, &quot;l_extendedprice&quot;: 7712.48d, &quot;l_discount&quot;: 0.1d, &quot;l_tax&quot;: 0.02d, &quot;l_returnflag&quot;: &quot;N&quot;, &quot;l_linestatus&quot;: &quot;O&quot;, &quot;l_shipdate&quot;: &quot;1996-01-29&quot;, &quot;l_commitdate&quot;: &quot;1996-03-05&quot;, &quot;l_receiptdate&quot;: &quot;1996-01-31&quot;, &quot;l_shipinstruct&quot;: &quot;TAKE BACK RETURN&quot;, &quot;l_shipmode&quot;: &quot;REG AIR&quot;, &quot;l_comment&quot;: &quot;riously. regular, express dep&quot; }\n    { &quot;l_orderkey&quot;: 1, &quot;l_partkey&quot;: 3, &quot;l_suppkey&quot;: 6, &quot;l_linenumber&quot;: 4, &quot;l_quantity&quot;: 28, &quot;l_extendedprice&quot;: 25284.0d, &quot;l_discount&quot;: 0.09d, &quot;l_tax&quot;: 0.06d, &quot;l_returnflag&quot;: &quot;N&quot;, &quot;l_linestatus&quot;: &quot;O&quot;, &quot;l_shipdate&quot;: &quot;1996-04-21&quot;, &quot;l_commitdate&quot;: &quot;1996-03-30&quot;, &quot;l_receiptdate&quot;: &quot;1996-05-16&quot;, &quot;l_shipinstruct&quot;: &quot;NONE&quot;, &quot;l_shipmode&quot;: &quot;AIR&quot;, &quot;l_comment&quot;: &quot;lites. fluffily even de&quot; }\n    { &quot;l_orderkey&quot;: 1, &quot;l_partkey&quot;: 25, &quot;l_suppkey&quot;: 8, &quot;l_linenumber&quot;: 5, &quot;l_quantity&quot;: 24, &quot;l_extendedprice&quot;: 22200.48d, &quot;l_discount&quot;: 0.1d, &quot;l_tax&quot;: 0.04d, &quot;l_returnflag&quot;: &quot;N&quot;, &quot;l_linestatus&quot;: &quot;O&quot;, &quot;l_shipdate&quot;: &quot;1996-03-30&quot;, &quot;l_commitdate&quot;: &quot;1996-03-14&quot;, &quot;l_receiptdate&quot;: &quot;1996-04-01&quot;, &quot;l_shipinstruct&quot;: &quot;NONE&quot;, &quot;l_shipmode&quot;: &quot;FOB&quot;, &quot;l_comment&quot;: &quot; pending foxes. slyly re&quot; }\n    { &quot;l_orderkey&quot;: 1, &quot;l_partkey&quot;: 16, &quot;l_suppkey&quot;: 3, &quot;l_linenumber&quot;: 6, &quot;l_quantity&quot;: 32, &quot;l_extendedprice&quot;: 29312.32d, &quot;l_discount&quot;: 0.07d, &quot;l_tax&quot;: 0.02d, &quot;l_returnflag&quot;: &quot;N&quot;, &quot;l_linestatus&quot;: &quot;O&quot;, &quot;l_shipdate&quot;: &quot;1996-01-30&quot;, &quot;l_commitdate&quot;: &quot;1996-02-07&quot;, &quot;l_receiptdate&quot;: &quot;1996-02-03&quot;, &quot;l_shipinstruct&quot;: &quot;DELIVER IN PERSON&quot;, &quot;l_shipmode&quot;: &quot;MAIL&quot;, &quot;l_comment&quot;: &quot;arefully slyly ex&quot; }\n    { &quot;l_orderkey&quot;: 2, &quot;l_partkey&quot;: 107, &quot;l_suppkey&quot;: 2, &quot;l_linenumber&quot;: 1, &quot;l_quantity&quot;: 38, &quot;l_extendedprice&quot;: 38269.8d, &quot;l_discount&quot;: 0.0d, &quot;l_tax&quot;: 0.05d, &quot;l_returnflag&quot;: &quot;N&quot;, &quot;l_linestatus&quot;: &quot;O&quot;, &quot;l_shipdate&quot;: &quot;1997-01-28&quot;, &quot;l_commitdate&quot;: &quot;1997-01-14&quot;, &quot;l_receiptdate&quot;: &quot;1997-02-02&quot;, &quot;l_shipinstruct&quot;: &quot;TAKE BACK RETURN&quot;, &quot;l_shipmode&quot;: &quot;RAIL&quot;, &quot;l_comment&quot;: &quot;ven requests. deposits breach a&quot; }\n    { &quot;l_orderkey&quot;: 3, &quot;l_partkey&quot;: 5, &quot;l_suppkey&quot;: 2, &quot;l_linenumber&quot;: 1, &quot;l_quantity&quot;: 45, &quot;l_extendedprice&quot;: 40725.0d, &quot;l_discount&quot;: 0.06d, &quot;l_tax&quot;: 0.0d, &quot;l_returnflag&quot;: &quot;R&quot;, &quot;l_linestatus&quot;: &quot;F&quot;, &quot;l_shipdate&quot;: &quot;1994-02-02&quot;, &quot;l_commitdate&quot;: &quot;1994-01-04&quot;, &quot;l_receiptdate&quot;: &quot;1994-02-23&quot;, &quot;l_shipinstruct&quot;: &quot;NONE&quot;, &quot;l_shipmode&quot;: &quot;AIR&quot;, &quot;l_comment&quot;: &quot;ongside of the furiously brave acco&quot; }\n    { &quot;l_orderkey&quot;: 3, &quot;l_partkey&quot;: 20, &quot;l_suppkey&quot;: 10, &quot;l_linenumber&quot;: 2, &quot;l_quantity&quot;: 49, &quot;l_extendedprice&quot;: 45080.98d, &quot;l_discount&quot;: 0.1d, &quot;l_tax&quot;: 0.0d, &quot;l_returnflag&quot;: &quot;R&quot;, &quot;l_linestatus&quot;: &quot;F&quot;, &quot;l_shipdate&quot;: &quot;1993-11-09&quot;, &quot;l_commitdate&quot;: &quot;1993-12-20&quot;, &quot;l_receiptdate&quot;: &quot;1993-11-24&quot;, &quot;l_shipinstruct&quot;: &quot;TAKE BACK RETURN&quot;, &quot;l_shipmode&quot;: &quot;RAIL&quot;, &quot;l_comment&quot;: &quot; unusual accounts. eve&quot; }\n    { &quot;l_orderkey&quot;: 3, &quot;l_partkey&quot;: 129, &quot;l_suppkey&quot;: 8, &quot;l_linenumber&quot;: 3, &quot;l_quantity&quot;: 27, &quot;l_extendedprice&quot;: 27786.24d, &quot;l_discount&quot;: 0.06d, &quot;l_tax&quot;: 0.07d, &quot;l_returnflag&quot;: &quot;A&quot;, &quot;l_linestatus&quot;: &quot;F&quot;, &quot;l_shipdate&quot;: &quot;1994-01-16&quot;, &quot;l_commitdate&quot;: &quot;1993-11-22&quot;, &quot;l_receiptdate&quot;: &quot;1994-01-23&quot;, &quot;l_shipinstruct&quot;: &quot;DELIVER IN PERSON&quot;, &quot;l_shipmode&quot;: &quot;SHIP&quot;, &quot;l_comment&quot;: &quot;nal foxes wake. &quot; }\n    { &quot;l_orderkey&quot;: 3, &quot;l_partkey&quot;: 30, &quot;l_suppkey&quot;: 5, &quot;l_linenumber&quot;: 4, &quot;l_quantity&quot;: 2, &quot;l_extendedprice&quot;: 1860.06d, &quot;l_discount&quot;: 0.01d, &quot;l_tax&quot;: 0.06d, &quot;l_returnflag&quot;: &quot;A&quot;, &quot;l_linestatus&quot;: &quot;F&quot;, &quot;l_shipdate&quot;: &quot;1993-12-04&quot;, &quot;l_commitdate&quot;: &quot;1994-01-07&quot;, &quot;l_receiptdate&quot;: &quot;1994-01-01&quot;, &quot;l_shipinstruct&quot;: &quot;NONE&quot;, &quot;l_shipmode&quot;: &quot;TRUCK&quot;, &quot;l_comment&quot;: &quot;y. fluffily pending d&quot; }\n    { &quot;l_orderkey&quot;: 3, &quot;l_partkey&quot;: 184, &quot;l_suppkey&quot;: 5, &quot;l_linenumber&quot;: 5, &quot;l_quantity&quot;: 28, &quot;l_extendedprice&quot;: 30357.04d, &quot;l_discount&quot;: 0.04d, &quot;l_tax&quot;: 0.0d, &quot;l_returnflag&quot;: &quot;R&quot;, &quot;l_linestatus&quot;: &quot;F&quot;, &quot;l_shipdate&quot;: &quot;1993-12-14&quot;, &quot;l_commitdate&quot;: &quot;1994-01-10&quot;, &quot;l_receiptdate&quot;: &quot;1994-01-01&quot;, &quot;l_shipinstruct&quot;: &quot;TAKE BACK RETURN&quot;, &quot;l_shipmode&quot;: &quot;FOB&quot;, &quot;l_comment&quot;: &quot;ages nag slyly pending&quot; }\n    { &quot;l_orderkey&quot;: 3, &quot;l_partkey&quot;: 63, &quot;l_suppkey&quot;: 8, &quot;l_linenumber&quot;: 6, &quot;l_quantity&quot;: 26, &quot;l_extendedprice&quot;: 25039.56d, &quot;l_discount&quot;: 0.1d, &quot;l_tax&quot;: 0.02d, &quot;l_returnflag&quot;: &quot;A&quot;, &quot;l_linestatus&quot;: &quot;F&quot;, &quot;l_shipdate&quot;: &quot;1993-10-29&quot;, &quot;l_commitdate&quot;: &quot;1993-12-18&quot;, &quot;l_receiptdate&quot;: &quot;1993-11-04&quot;, &quot;l_shipinstruct&quot;: &quot;TAKE BACK RETURN&quot;, &quot;l_shipmode&quot;: &quot;RAIL&quot;, &quot;l_comment&quot;: &quot;ges sleep after the caref&quot; }\n</pre></div></div>\n                  </div>\n            </div>\n          </div>\n\n    <hr/>\n\n    <footer>\n            <div class=\"container-fluid\">\n              <div class=\"row span12\">Copyright &copy;                   2014.\n          All Rights Reserved.      \n                    \n      </div>\n\n                          \n        \n                </div>\n    </footer>\n  </body>\n</html>\n", "id": 16501.0}