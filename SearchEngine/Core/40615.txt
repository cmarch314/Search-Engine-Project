{"text": " Home Trees Indices Help Package CHEM Package CombiCDB Module CanSmiUniqueSet hide private frames no frames Module CanSmiUniqueSet Given a collection of molecules convert them all to canonical SMILES format and output the contents to another file but only those with unique canonical SMILES Separately reports the number of original and number of unique molecules to the application log Note This is actually a very inefficient program requiring huge amounts of memory You re much better off just inserting all the candidate molecules into a database by their canonical SMILES Database indexing is already optimized exactly for finding this kind of information Input sourceFile Molecule file Can be any format understandable by oemolistream assuming a properly named extension For example molecules smi for SMILES format Can take stdin as source by specifying the filename or smi or something similar See documentation of oemolistream for more information Output uniqueFile Unique by canonical SMILES molecule file Output is the unique set of source molecules where uniqueness is determined by their canonical SMILES Note that the order these are output will NOT correspond to the order from the source file especially since some molecules may be removed If the read molecules include additional information such as titles labels coordinates etc these will also be output by standard oemolostream behavior In the case of molecules with redundant canonical SMILES the last one read will have precedence for this output Additional catch If some source molecules are actually multiple molecules e g CCO c1ccccc1 represents ethanol and benzene then each will be separated out to find canonical SMILES Theoretically the resultant unique list could contain more items than the source list as a result Any supplementary information on such molecules coordinates etc cannot be depended on to exist after the separations Titles will be carried over from the parent molecule appended with X where X is the index in the parent of the submolecule Again redirection to stdout possible by specifying the filename or smi etc Further note that by specifying a different file suffix e g mol2 sdf etc the output file does not necessarily have to be in canonical SMILES format That is only used for the purpose of determining uniqueness Although if you do want canonical SMILES formatted output be sure the filename is or ends with the extension cansmi redundantFile Redunandant by canonical SMILES molecule file Optional parameter If specified copies of all of the molecules from the original sourceFile that did not make it into the uniqueFile because they were redundant with another molecule in the sourceFile will be output here Functions hide private main sourceFilename uniqueFilename redundantFilename None separateComposites True Command line main method opens files with respective names and delegates most work to convertUnique convertUnique sourceOEIS uniqueOEOS redundantOEOS None separateComposites True Primary method reads the source file to generate the unique molecule output file addMolecule mol canSmiDict redundantOEOS separateComposites Adds the molecule to the canSmiDict keyed by its canonical SMILES usage Prints usage directions if module called from command line incorrectly Function Details hide private convertUnique sourceOEIS uniqueOEOS redundantOEOS None separateComposites True Primary method reads the source file to generate the unique molecule output file See module documentation for more information Note This method actually takes oemolistream and oemolostream objects not filenames to allow the caller to pass virtual Files for the purpose of testing and interfacing Use the main method to have the module take care of opening files from filenames addMolecule mol canSmiDict redundantOEOS separateComposites Adds the molecule to the canSmiDict keyed by its canonical SMILES If it replaces a molecule already in canSmiDict write out the replaced one to redundantOEOS If separateComposites is True first split the molecule into several if its canonical SMILES contains any indicating multiple molecules Home Trees Indices Help Generated by Epydoc 3 beta1 on Thu Nov 8 17 49 21 2 7 http epydoc sourceforge net", "_id": "http://www.ics.uci.edu/~dock/CHEM_docs/CHEM.CombiCDB.CanSmiUniqueSet-module.html", "title": "chem.combicdb.cansmiuniqueset", "html": "<?xml version=\"1.0\" encoding=\"ascii\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n          \"DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n  <title>CHEM.CombiCDB.CanSmiUniqueSet</title>\n  <link rel=\"stylesheet\" href=\"epydoc.css\" type=\"text/css\" />\n  <script type=\"text/javascript\" src=\"epydoc.js\"></script>\n</head>\n\n<body bgcolor=\"white\" text=\"black\" link=\"blue\" vlink=\"#204080\"\n      alink=\"#204080\">\n<!-- ==================== NAVIGATION BAR ==================== -->\n<table class=\"navbar\" border=\"0\" width=\"100%\" cellpadding=\"0\"\n       bgcolor=\"#a0c0ff\" cellspacing=\"0\">\n  <tr valign=\"middle\">\n  <!-- Home link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"CHEM-module.html\">Home</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Tree link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"module-tree.html\">Trees</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Index link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"identifier-index.html\">Indices</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Help link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"help.html\">Help</a>&nbsp;&nbsp;&nbsp;</th>\n\n      <th class=\"navbar\" width=\"100%\"></th>\n  </tr>\n</table>\n<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n  <tr valign=\"top\">\n    <td width=\"100%\">\n      <span class=\"breadcrumbs\">\n        <a href=\"CHEM-module.html\">Package&nbsp;CHEM</a> ::\n        <a href=\"CHEM.CombiCDB-module.html\">Package&nbsp;CombiCDB</a> ::\n        Module&nbsp;CanSmiUniqueSet\n      </span>\n    </td>\n    <td>\n      <table cellpadding=\"0\" cellspacing=\"0\">\n        <!-- hide/show private -->\n        <tr><td align=\"right\"><span class=\"options\">[<a href=\"javascript:void(0);\" class=\"privatelink\"\n    onclick=\"toggle_private();\">hide&nbsp;private</a>]</span></td></tr>\n        <tr><td align=\"right\"><span class=\"options\"\n            >[<a href=\"frames.html\" target=\"_top\">frames</a\n            >]&nbsp;|&nbsp;<a href=\"CHEM.CombiCDB.CanSmiUniqueSet-module.html\"\n            target=\"_top\">no&nbsp;frames</a>]</span></td></tr>\n      </table>\n    </td>\n  </tr>\n</table>\n<!-- ==================== MODULE DESCRIPTION ==================== -->\n<h1 class=\"epydoc\">Module CanSmiUniqueSet</h1><br /><br />\n<pre class=\"literalblock\">\nGiven a collection of molecules, convert them all to canonical SMILES \nformat and output the contents to another file, but only those with unique \ncanonical SMILES.  Separately reports the number of original and number of \nunique molecules to the application log.\n\nNote:  This is actually a very inefficient program, requiring huge amounts\nof memory.  You're much better off just inserting all the candidate\nmolecules into a database by their canonical SMILES.  Database indexing\nis already optimized exactly for finding this kind of information.\n\nInput: \n- sourceFile:  Molecule file\n    Can be any format understandable by oemolistream, assuming a properly \n    named extension.  For example, &quot;molecules.smi&quot; for SMILES format\n    Can take stdin as source by specifying the filename &quot;-&quot; or &quot;.smi&quot; or \n    something similar.  See documentation of oemolistream for more information.\n\nOutput:\n- uniqueFile:  Unique (by canonical SMILES) molecule file\n    Output is the unique set of source molecules, where uniqueness is\n    determined by their canonical SMILES.  Note that the order these are \n    output will NOT correspond to the order from the source file, \n    especially since some molecules may be removed.\n    \n    If the read molecules include additional information, such as titles / labels,\n    coordinates, etc. these will also be output by standard oemolostream\n    behavior.  In the case of molecules with redundant canonical SMILES, the\n    last one read will have precedence for this output.\n    \n    Additional catch.  If some source molecules are actually multiple molecules\n    (e.g. &quot;CCO.c1ccccc1&quot; represents ethanol and benzene), then each will be\n    separated out to find canonical SMILES.  Theoretically, the resultant unique\n    list could contain more items than the source list as a result.  Any supplementary\n    information on such molecules (coordinates, etc.) cannot be depended\n    on to exist after the separations.  Titles will be carried over from the parent\n    molecule, appended with &quot;.X&quot; where X is the index in the parent of the submolecule.\n    \n    Again, redirection to stdout possible by specifying the filename &quot;-&quot; or &quot;.smi&quot;\n    etc.  Further note that by specifying a different file suffix, \n    (e.g. &quot;.mol2&quot;,&quot;.sdf&quot;,etc.), the output file does not necessarily have to be\n    in canonical SMILES format.  That is only used for the purpose of\n    determining uniqueness.  Although, if you do want canonical SMILES formatted\n    output, be sure the filename is or ends with the extension &quot;.cansmi&quot;\n\n- redundantFile:    Redunandant (by canonical SMILES) molecule file\n    Optional parameter.  If specified, copies of all of the molecules from the\n    original sourceFile that did not make it into the uniqueFile (because they\n    were redundant with another molecule in the sourceFile) will be output here.\n    \n\n</pre><br /><br />\n\n<!-- ==================== FUNCTIONS ==================== -->\n<a name=\"section-Functions\"></a>\n<table class=\"summary\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr bgcolor=\"#70b0f0\" class=\"table-header\">\n  <td colspan=\"2\" class=\"table-header\">\n    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n      <tr valign=\"top\">\n        <td align=\"left\"><span class=\"table-header\">Functions</span></td>\n        <td align=\"right\" valign=\"top\"\n         ><span class=\"options\">[<a href=\"#section-Functions\"\n         class=\"privatelink\" onclick=\"toggle_private();\"\n         >hide private</a>]</span></td>\n      </tr>\n    </table>\n  </td>\n</tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"main\"></a><span class=\"summary-sig-name\">main</span>(<span class=\"summary-sig-arg\">sourceFilename</span>,\n        <span class=\"summary-sig-arg\">uniqueFilename</span>,\n        <span class=\"summary-sig-arg\">redundantFilename</span>=<span class=\"summary-sig-default\">None</span>,\n        <span class=\"summary-sig-arg\">separateComposites</span>=<span class=\"summary-sig-default\">True</span>)</span><br />\n      Command-line main method, opens files with respective names and \n      delegates most work to &quot;convertUnique&quot;</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a href=\"CHEM.CombiCDB.CanSmiUniqueSet-module.html#convertUnique\" class=\"summary-sig-name\">convertUnique</a>(<span class=\"summary-sig-arg\">sourceOEIS</span>,\n        <span class=\"summary-sig-arg\">uniqueOEOS</span>,\n        <span class=\"summary-sig-arg\">redundantOEOS</span>=<span class=\"summary-sig-default\">None</span>,\n        <span class=\"summary-sig-arg\">separateComposites</span>=<span class=\"summary-sig-default\">True</span>)</span><br />\n      Primary method, reads the source file to generate the unique \n      molecule output file.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a href=\"CHEM.CombiCDB.CanSmiUniqueSet-module.html#addMolecule\" class=\"summary-sig-name\">addMolecule</a>(<span class=\"summary-sig-arg\">mol</span>,\n        <span class=\"summary-sig-arg\">canSmiDict</span>,\n        <span class=\"summary-sig-arg\">redundantOEOS</span>,\n        <span class=\"summary-sig-arg\">separateComposites</span>)</span><br />\n      Adds the molecule to the canSmiDict, keyed by its canonical \n      SMILES.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"usage\"></a><span class=\"summary-sig-name\">usage</span>()</span><br />\n      Prints usage directions if module called from command-line \n      incorrectly</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n</table>\n<!-- ==================== FUNCTION DETAILS ==================== -->\n<a name=\"section-FunctionDetails\"></a>\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr bgcolor=\"#70b0f0\" class=\"table-header\">\n  <td colspan=\"2\" class=\"table-header\">\n    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n      <tr valign=\"top\">\n        <td align=\"left\"><span class=\"table-header\">Function Details</span></td>\n        <td align=\"right\" valign=\"top\"\n         ><span class=\"options\">[<a href=\"#section-FunctionDetails\"\n         class=\"privatelink\" onclick=\"toggle_private();\"\n         >hide private</a>]</span></td>\n      </tr>\n    </table>\n  </td>\n</tr>\n</table>\n<a name=\"convertUnique\"></a>\n<div>\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr><td>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n  <tr valign=\"top\"><td>\n  <h3 class=\"epydoc\"><span class=\"sig\"><span class=\"sig-name\">convertUnique</span>(<span class=\"sig-arg\">sourceOEIS</span>,\n        <span class=\"sig-arg\">uniqueOEOS</span>,\n        <span class=\"sig-arg\">redundantOEOS</span>=<span class=\"sig-default\">None</span>,\n        <span class=\"sig-arg\">separateComposites</span>=<span class=\"sig-default\">True</span>)</span>\n  </h3>\n  </td><td align=\"right\" valign=\"top\"\n    >&nbsp;\n    </td>\n  </table>\n  \n  <p>Primary method, reads the source file to generate the unique molecule \n  output file.  See module documentation for more information.</p>\n  Note:  This method actually takes oemolistream and oemolostream \n  objects, not filenames, to allow the caller to pass &quot;virtual \n  Files&quot; for the purpose of testing and interfacing. Use the \n  &quot;main&quot; method to have the module take care of opening files \n  from filenames.\n  <dl class=\"fields\">\n  </dl>\n</td></tr></table>\n</div>\n<a name=\"addMolecule\"></a>\n<div>\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr><td>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n  <tr valign=\"top\"><td>\n  <h3 class=\"epydoc\"><span class=\"sig\"><span class=\"sig-name\">addMolecule</span>(<span class=\"sig-arg\">mol</span>,\n        <span class=\"sig-arg\">canSmiDict</span>,\n        <span class=\"sig-arg\">redundantOEOS</span>,\n        <span class=\"sig-arg\">separateComposites</span>)</span>\n  </h3>\n  </td><td align=\"right\" valign=\"top\"\n    >&nbsp;\n    </td>\n  </table>\n  \n  Adds the molecule to the canSmiDict, keyed by its canonical SMILES. If\n  it replaces a molecule already in canSmiDict, write out the replaced one \n  to redundantOEOS. If separateComposites is True, first split the molecule\n  into several if its canonical SMILES contains any &quot;.&quot; \n  indicating multiple molecules.\n  <dl class=\"fields\">\n  </dl>\n</td></tr></table>\n</div>\n<br />\n<!-- ==================== NAVIGATION BAR ==================== -->\n<table class=\"navbar\" border=\"0\" width=\"100%\" cellpadding=\"0\"\n       bgcolor=\"#a0c0ff\" cellspacing=\"0\">\n  <tr valign=\"middle\">\n  <!-- Home link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"CHEM-module.html\">Home</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Tree link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"module-tree.html\">Trees</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Index link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"identifier-index.html\">Indices</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Help link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"help.html\">Help</a>&nbsp;&nbsp;&nbsp;</th>\n\n      <th class=\"navbar\" width=\"100%\"></th>\n  </tr>\n</table>\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%%\">\n  <tr>\n    <td align=\"left\" class=\"footer\">\n    Generated by Epydoc 3.0beta1 on Thu Nov  8 17:49:21 2007\n    </td>\n    <td align=\"right\" class=\"footer\">\n      <a href=\"http://epydoc.sourceforge.net\">http://epydoc.sourceforge.net</a>\n    </td>\n  </tr>\n</table>\n\n<script type=\"text/javascript\">\n  <!--\n  // Private objects are initially displayed (because if\n  // javascript is turned off then we want them to be\n  // visible); but by default, we want to hide them.  So hide\n  // them unless we have a cookie that says to show them.\n  checkCookie()\n  // -->\n</script>\n  \n</body>\n</html>\n", "id": 40615.0}