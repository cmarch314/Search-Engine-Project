{"text": "Search LoginPreferencesHelp GuideAbout Trac WikiTimelineRoadmapBrowse SourceView TicketsSearch Context Navigation BlameRevision Log source nomatic tags NomaticIM 3 buddy bots src twisted python plugin py View diff against View revision Visit trunk Last change on this file was 712 checked in by cbaker 7 years ago First draft of nomatic buddy bots oscar bot is functional if you give it good authentication credentials jabber bot is just an example from the web File size 12 KB Line 1 Copyright c 2 1 2 4 Twisted Matrix Laboratories 2 See LICENSE for details 345from future import nested scopes67 System Imports8import sys9import os1 import errno11import types12import warnings1314 Twisted imports15from twisted python import util1617 Sibling Imports18from reflect import namedModule192 try 21 from os path import realpath as cacheTransform22except ImportError 23 from os path import abspath as cacheTransform2425class PlugIn 26 I am a Python module registered in a plugins tml file 27 28 def init self name module kw 29 self name name3 self module module31 for key value in kw items 32 setattr self key value 3334 def isLoaded self 35 Check to see if the module for this plugin has been imported yet 3637 rtype C int 38 return A true value if the module for this plugin has been loaded 39 false otherwise 4 41 return sys modules has key self module 4243 def load self 44 Load the module for this plugin 4546 rtype C ModuleType 47 return The module object that is loaded 48 49 return namedModule self module 5 51 def repr self 52 if self isLoaded 53 loaded loaded 54 else 55 loaded 56 return Plugin s s s repr self name self module loaded 5758class DropIn 59 I am a Python package containing plugins tml 6 61 def init self name 62 self name name63 self plugins 6465 def register self name module kw 66 Register a new plug in 67 68 warnings warn The twisted python plugin system is deprecated 69 See twisted plugin for the revised edition 7 DeprecationWarning 2 71 self plugins append PlugIn name module kw 7273 def repr self 74 return Package s s self name self plugins 757677def prepCallbacks debug progress 78 if debug 79 try 8 debug Looking for plugin tml files 81 except 82 debug lambda x sys stdout write x n 83 debug Looking for plugin tml files 84 else 85 debug lambda x None86 if progress 87 try 88 progress 89 except 9 pb util makeStatusBar 76 91 progress lambda x pb pb sys stdout write pb x r 92 progress 93 else 94 progress lambda x None95 return debug progress9697def getPluginFileList debugInspection None showProgress None 98 Find plugin tml files in subdirectories of paths in C sys path 991 type debugInspection C None or a callable taking one argument1 1 param debugInspection If not None this is invoked with strings containing1 2 debug information about the loading process If it is any other true value 1 3 this debug information is written to stdout This behavior is deprecated 1 41 5 type showProgress C None or a callable taking one argument 1 6 param showProgress If not None this is invoked with floating point1 7 values between and 1 describing the progress of the loading process 1 8 If it is any other true value this progress information is written to1 9 stdout This behavior is deprecated 11 111 rtype C list of C str 112 return A list of the plugin tml files found 113 114 if isinstance debugInspection types IntType 115 warnings warn 116 int parameter for debugInspection is deprecated pass None or 117 a function that takes a single argument instead 118 DeprecationWarning 2119 12 if isinstance showProgress types IntType 121 warnings warn 122 int parameter for showProgress is deprecated pass None or 123 a function that takes a single argument instead 124 DeprecationWarning 2125 126 debugInspection showProgress prepCallbacks debugInspection showProgress 127 exists os path exists128 join os sep join129 result 13 loaded 131 seenNames 132133 XXX Some people claim to have found non strings in sys path an empty134 list in particular Instead of tracking down the cause for their135 presence they decided it was better to discard them unconditionally136 without further investigation At some point someone should track137 down where non strings are coming from and do something about them 138 paths cacheTransform p for p in sys path139 if isinstance p str and os path isdir p 14 141 special case for commonly used directories we know shouldn t be checked142 and really slow down mktap and such like in real installations143 for p in usr bin usr local bin 144 try 145 paths remove p 146 except ValueError 147 pass148 progress 149 increments 1 len paths 15 151 for index d in zip range len paths paths 152 showProgress progress 153 if loaded has key d 154 debugInspection Already saw d 155 continue156 else 157 debugInspection Recursing through d 158 try 159 subDirs os listdir d 16 except OSError err s 161 Permission denied carry on162 if err errno EACCES 163 debugInspection Permission denied on d 164 else 165 raise166 else 167 filter out files we obviously don t need to check ones with in them168 subDirs s for s in subDirs if not in s 169 if not subDirs 17 continue171 incr increments 1 len subDirs 172 for plugindir in subDirs 173 if seenNames has key plugindir 174 debugInspection Seen s already plugindir 175 continue176 tmlname join d plugindir plugins tml 177 if isAModule join d plugindir 178 seenNames plugindir 1179 if exists tmlname 18 result append tmlname 181 debugInspection Found tmlname 182 else 183 debugInspection Failed tmlname 184 else 185 debugInspection Not a module tmlname 186 progress progress incr187 showProgress progress 188189 showProgress 1 19 return result191192def loadPlugins plugInType fileList debugInspection None showProgress None 193 Traverse the given list of files and attempt to load plugins from them 194195 type plugInType C str 196 param plugInType The type of plugin to search for This is tested197 against the C type argument to the C register function in the198 plugin tml files 1992 type fileList C list of C str 2 1 param fileList A list of the files to attempt to load plugin2 2 information from One name is put in their scope the C register 2 3 function 2 42 5 type debugInspection C None or a callable taking one argument2 6 param debugInspection If not None this is invoked with strings containing2 7 debug information about the loading process If it is any other true value 2 8 this debug information is written to stdout This behavior is deprecated 2 921 type showProgress C None or a callable taking one argument 211 param showProgress If not None this is invoked with floating point212 values between and 1 describing the progress of the loading process 213 If it is any other true value this progress information is written to214 stdout This behavior is deprecated 215216 rtype C list 217 return A list of the C PlugIn objects found 218 219 if isinstance debugInspection types IntType 22 warnings warn 221 int parameter for debugInspection is deprecated pass None or 222 a function that takes a single argument instead 223 DeprecationWarning 4224 225 if isinstance showProgress types IntType 226 warnings warn 227 int parameter for showProgress is deprecated pass None or 228 a function that takes a single argument instead 229 DeprecationWarning 423 231 result 232 debugInspection showProgress prepCallbacks debugInspection showProgress 233234 if not fileList 235 raise ValueError No plugins passed to loadPlugins 236237 increments 1 len fileList 238 progress 23924 for index tmlFile in zip range len fileList fileList 241 showProgress progress 242 debugInspection Loading from tmlFile 243 pname os path split os path abspath tmlFile 2 244 dropin DropIn pname 245 ns register dropin register file tmlFile 246 try 247 execfile tmlFile ns 248 except IOError OSError e 249 guess we don t have permissions for that25 debugInspection Error loading s e 251 continue252253 ldp len dropin plugins or 1 254 incr increments 1 ldp 255 for plugin in dropin plugins 256 if plugInType plugin type 257 result append plugin 258 debugInspection Found r plugin 259 else 26 debugInspection Disqualified r plugin 261 progress progress incr262 showProgress progress 263 debugInspection Finished loading from s tmlFile 264265 showProgress 1 266 debugInspection Returning r result 267 return result268269def getPlugIns plugInType debugInspection None showProgress None 27 Helper function to get all the plugins of a particular type 271272 type plugInType C str 273 param plugInType The type of plugin to search for This is tested274 against the C type argument to the C register function in the275 plugin tml files 276277 type debugInspection C None or a callable taking one argument278 param debugInspection If not None this is invoked with strings containing279 debug information about the loading process If it is any other true value 28 this debug information is written to stdout This behavior is deprecated 281282 type showProgress C None or a callable taking one argument 283 param showProgress If not None this is invoked with floating point284 values between and 1 describing the progress of the loading process 285 If it is any other true value this progress information is written to286 stdout This behavior is deprecated 287288 rtype C list 289 return A list of C PlugIn objects that were found 29 291 warnings warn The twisted python plugin system is deprecated 292 See twisted plugin for the revised edition 293 DeprecationWarning 2 294 return getPlugIns plugInType debugInspection showProgress 295296def getPlugIns plugInType debugInspection None showProgress None 297 if isinstance debugInspection types IntType 298 warnings warn 299 int parameter for debugInspection is deprecated pass None or 3 a function that takes a single argument instead 3 1 DeprecationWarning 33 2 3 3 if isinstance showProgress types IntType 3 4 warnings warn 3 5 int parameter for showProgress is deprecated pass None or 3 6 a function that takes a single argument instead 3 7 DeprecationWarning 33 8 3 9 debugInspection showProgress prepCallbacks debugInspection showProgress 31 311 firstHalf secondHalf lambda x None312 if showProgress 313 firstHalf lambda x showProgress x 2 314 secondHalf lambda x showProgress x 2 5 315316 tmlFiles getPluginFileList debugInspection firstHalf 317 if not tmlFiles 318 return 319 return loadPlugins plugInType tmlFiles debugInspection secondHalf 32 321def isAModule d 322 This function checks the directory for init files 323 324 suffixes py pyc pyo so pyd dll 325 exists os path exists326 join os sep join327 for s in suffixes bad algorithm but probably works328 if exists join d init s s 329 return 133 return 331332 all PlugIn DropIn getPluginFileList loadPlugins getPlugIns Note See TracBrowser for help on using the repository browser Download in other formats Plain Text Original Format Powered by Trac 1 1 By Edgewall Software All content copyright 2 7 2 8 by LUCI http luci ics uci edu ", "_id": "http://djp3-pc2.ics.uci.edu/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py", "title": "\n      plugin.py in nomatic/tags/nomaticim-0.0.3/buddy_bots/src/twisted/python\n     \u2013 nomatic*im\n    ", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n  \n  \n\n  \n\n\n  <head>\n\t\t<title>\n      plugin.py in nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python\n     \u2013 Nomatic*IM\n    </title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><link rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search\" /><link rel=\"help\" href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\" /><link rel=\"alternate\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py?format=txt\" type=\"text/plain\" title=\"Plain Text\" /><link rel=\"alternate\" href=\"/LUCICodeRepository/nomaticIM/export/1312/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py\" type=\"application/x-python; charset=iso-8859-15\" title=\"Original Format\" /><link rel=\"start\" href=\"/LUCICodeRepository/nomaticIM/wiki\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/code.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/pygments/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/browser.css\" type=\"text/css\" /><link rel=\"shortcut icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link rel=\"icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link type=\"application/opensearchdescription+xml\" rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search/opensearch\" title=\"Search Nomatic*IM\" /><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/jquery.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/babel.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/messages/en_US.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/trac.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/search.js\"></script><script type=\"text/javascript\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/folding.js\"></script><script type=\"text/javascript\">\n      jQuery(document).ready(function($) {\n        $(\".trac-toggledeleted\").show().click(function() {\n                  $(this).siblings().find(\".trac-deleted\").toggle();\n                  return false;\n        }).click();\n        $(\"#jumploc input\").hide();\n        $(\"#jumploc select\").change(function () {\n          this.parentNode.parentNode.submit();\n        });\n          $('#preview table.code').enableCollapsibleColumns($('#preview table.code thead th.content'));\n      });\n    </script>\n\t</head>\n  <body>\n    <div id=\"banner\">\n      <div id=\"header\">\n        <a id=\"logo\" href=\"http://luci.ics.uci.edu/#code\"><img src=\"http://luci.ics.uci.edu/blog/archives/LUCIhorzTight.jpg\" alt=\"LUCI Code Repository\" /></a>\n      </div>\n      <form id=\"search\" action=\"/LUCICodeRepository/nomaticIM/search\" method=\"get\">\n        <div>\n          <label for=\"proj-search\">Search:</label>\n          <input type=\"text\" id=\"proj-search\" name=\"q\" size=\"18\" value=\"\" />\n          <input type=\"submit\" value=\"Search\" />\n        </div>\n      </form>\n      <div id=\"metanav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/login\">Login</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/prefs\">Preferences</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\">Help/Guide</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/about\">About Trac</a></li>\n    </ul>\n  </div>\n    </div>\n    <div id=\"mainnav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/wiki\">Wiki</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/timeline\">Timeline</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/roadmap\">Roadmap</a></li><li class=\"active\"><a href=\"/LUCICodeRepository/nomaticIM/browser\">Browse Source</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/report\">View Tickets</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/search\">Search</a></li>\n    </ul>\n  </div>\n    <div id=\"main\">\n      <div id=\"ctxtnav\" class=\"nav\">\n        <h2>Context Navigation</h2>\n        <ul>\n          <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/twisted/python/plugin.py?annotate=blame\" title=\"Annotate each line with the last changed revision (this can be time consuming...)\">Blame</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/log/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py\">Revision Log</a></li>\n        </ul>\n        <hr />\n      </div>\n    <div id=\"content\" class=\"browser\">\n        <h1>\n          \n<a class=\"pathentry first\" href=\"/LUCICodeRepository/nomaticIM/browser?order=name\" title=\"Go to repository root\">source:</a>\n<a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic?order=name\" title=\"View nomatic\">nomatic</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags?order=name\" title=\"View tags\">tags</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3?order=name\" title=\"View NomaticIM-0.0.3\">NomaticIM-0.0.3</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3/buddy_bots?order=name\" title=\"View buddy_bots\">buddy_bots</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src?order=name\" title=\"View src\">src</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted?order=name\" title=\"View twisted\">twisted</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python?order=name\" title=\"View python\">python</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py?order=name\" title=\"View plugin.py\">plugin.py</a>\n<br style=\"clear: both\" />\n\n        </h1>\n        <div id=\"diffrev\">\n          <form action=\"/LUCICodeRepository/nomaticIM/changeset\" method=\"get\">\n            <div>\n              <label title=\"Show the diff against a specific revision\">\n                View diff against: <input type=\"text\" name=\"old\" size=\"6\" />\n                <input type=\"hidden\" name=\"old_path\" value=\"nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py\" />\n                <input type=\"hidden\" name=\"new\" />\n                <input type=\"hidden\" name=\"new_path\" value=\"nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py\" />\n              </label>\n            </div>\n          </form>\n        </div>\n        <div id=\"jumprev\">\n          <form action=\"\" method=\"get\">\n            <div>\n              <label for=\"rev\">\n                View revision:</label>\n              <input type=\"text\" id=\"rev\" name=\"rev\" size=\"6\" />\n            </div>\n          </form>\n        </div>\n        <div id=\"jumploc\">\n          <form action=\"\" method=\"get\">\n            <div class=\"buttons\">\n              <label for=\"preselected\">Visit:</label>\n              <select id=\"preselected\" name=\"preselected\">\n                <option selected=\"selected\"></option>\n                <optgroup label=\"branches\">\n                  <option value=\"/LUCICodeRepository/nomaticIM/browser/trunk\">trunk</option>\n                </optgroup>\n              </select>\n              <input type=\"submit\" value=\"Go!\" title=\"Jump to the chosen preselected path\" />\n            </div>\n          </form>\n        </div>\n        <div class=\"trac-tags\">\n        </div>\n      <table id=\"info\" summary=\"Revision info\">\n        <tr>\n          <th>\n                <a href=\"/LUCICodeRepository/nomaticIM/changeset/712/nomatic/trunk/buddy_bots/twisted/python/plugin.py\" title=\"View differences\">Last change</a>\n                  on this file was\n                  <a href=\"/LUCICodeRepository/nomaticIM/changeset/712/\" title=\"View changeset 712\">712</a>,\n                  checked in by cbaker, <a class=\"timeline\" href=\"/LUCICodeRepository/nomaticIM/timeline?from=2008-02-16T08%3A16%3A53-08%3A00&amp;precision=second\" title=\"See timeline at Feb 16, 2008, 8:16:53 AM\">7 years ago</a>\n          </th>\n        </tr>\n        <tr>\n          <td class=\"message searchable\">\n              <p>\nFirst draft of nomatic buddy bots. oscar_bot is functional if you give it good authentication credentials, jabber_bot is just an example from the web <br />\n</p>\n          </td>\n        </tr>\n        <tr><td colspan=\"2\">\n            <strong>File size:</strong>\n            <span title=\"12304 bytes\">12.0 KB</span>\n          </td></tr>\n      </table>\n      <div id=\"preview\" class=\"searchable\">\n        \n  <table class=\"code\"><thead><tr><th class=\"lineno\" title=\"Line numbers\">Line</th><th class=\"content\">\u00a0</th></tr></thead><tbody><tr><th id=\"L1\"><a href=\"#L1\">1</a></th><td><span class=\"c\"># Copyright (c) 2001-2004 Twisted Matrix Laboratories.</span></td></tr><tr><th id=\"L2\"><a href=\"#L2\">2</a></th><td><span class=\"c\"># See LICENSE for details.</span></td></tr><tr><th id=\"L3\"><a href=\"#L3\">3</a></th><td></td></tr><tr><th id=\"L4\"><a href=\"#L4\">4</a></th><td></td></tr><tr><th id=\"L5\"><a href=\"#L5\">5</a></th><td><span class=\"kn\">from</span>\u00a0<span class=\"nn\">__future__</span>\u00a0<span class=\"kn\">import</span>\u00a0nested_scopes</td></tr><tr><th id=\"L6\"><a href=\"#L6\">6</a></th><td></td></tr><tr><th id=\"L7\"><a href=\"#L7\">7</a></th><td><span class=\"c\"># System Imports</span></td></tr><tr><th id=\"L8\"><a href=\"#L8\">8</a></th><td><span class=\"kn\">import</span>\u00a0<span class=\"nn\">sys</span></td></tr><tr><th id=\"L9\"><a href=\"#L9\">9</a></th><td><span class=\"kn\">import</span>\u00a0<span class=\"nn\">os</span></td></tr><tr><th id=\"L10\"><a href=\"#L10\">10</a></th><td><span class=\"kn\">import</span>\u00a0<span class=\"nn\">errno</span></td></tr><tr><th id=\"L11\"><a href=\"#L11\">11</a></th><td><span class=\"kn\">import</span>\u00a0<span class=\"nn\">types</span></td></tr><tr><th id=\"L12\"><a href=\"#L12\">12</a></th><td><span class=\"kn\">import</span>\u00a0<span class=\"nn\">warnings</span></td></tr><tr><th id=\"L13\"><a href=\"#L13\">13</a></th><td></td></tr><tr><th id=\"L14\"><a href=\"#L14\">14</a></th><td><span class=\"c\"># Twisted imports</span></td></tr><tr><th id=\"L15\"><a href=\"#L15\">15</a></th><td><span class=\"kn\">from</span>\u00a0<span class=\"nn\">twisted.python</span>\u00a0<span class=\"kn\">import</span>\u00a0util</td></tr><tr><th id=\"L16\"><a href=\"#L16\">16</a></th><td></td></tr><tr><th id=\"L17\"><a href=\"#L17\">17</a></th><td><span class=\"c\"># Sibling Imports</span></td></tr><tr><th id=\"L18\"><a href=\"#L18\">18</a></th><td><span class=\"kn\">from</span>\u00a0<span class=\"nn\">reflect</span>\u00a0<span class=\"kn\">import</span>\u00a0namedModule</td></tr><tr><th id=\"L19\"><a href=\"#L19\">19</a></th><td></td></tr><tr><th id=\"L20\"><a href=\"#L20\">20</a></th><td><span class=\"k\">try</span><span class=\"p\">:</span></td></tr><tr><th id=\"L21\"><a href=\"#L21\">21</a></th><td>\u00a0 \u00a0 <span class=\"kn\">from</span>\u00a0<span class=\"nn\">os.path</span>\u00a0<span class=\"kn\">import</span>\u00a0realpath <span class=\"k\">as</span>\u00a0cacheTransform</td></tr><tr><th id=\"L22\"><a href=\"#L22\">22</a></th><td><span class=\"k\">except</span>\u00a0<span class=\"ne\">ImportError</span><span class=\"p\">:</span></td></tr><tr><th id=\"L23\"><a href=\"#L23\">23</a></th><td>\u00a0 \u00a0 <span class=\"kn\">from</span>\u00a0<span class=\"nn\">os.path</span>\u00a0<span class=\"kn\">import</span>\u00a0abspath <span class=\"k\">as</span>\u00a0cacheTransform</td></tr><tr><th id=\"L24\"><a href=\"#L24\">24</a></th><td></td></tr><tr><th id=\"L25\"><a href=\"#L25\">25</a></th><td><span class=\"k\">class</span>\u00a0<span class=\"nc\">PlugIn</span><span class=\"p\">:</span></td></tr><tr><th id=\"L26\"><a href=\"#L26\">26</a></th><td>\u00a0 \u00a0 <span class=\"sd\">\"\"\"I am a Python module registered in a plugins.tml file.</span></td></tr><tr><th id=\"L27\"><a href=\"#L27\">27</a></th><td><span class=\"sd\">\u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L28\"><a href=\"#L28\">28</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0name<span class=\"p\">,</span>\u00a0module<span class=\"p\">,</span>\u00a0<span class=\"o\">**</span>kw<span class=\"p\">):</span></td></tr><tr><th id=\"L29\"><a href=\"#L29\">29</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>name <span class=\"o\">=</span>\u00a0name</td></tr><tr><th id=\"L30\"><a href=\"#L30\">30</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>module <span class=\"o\">=</span>\u00a0module</td></tr><tr><th id=\"L31\"><a href=\"#L31\">31</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">for</span>\u00a0key<span class=\"p\">,</span>\u00a0value <span class=\"ow\">in</span>\u00a0kw<span class=\"o\">.</span>items<span class=\"p\">():</span></td></tr><tr><th id=\"L32\"><a href=\"#L32\">32</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"nb\">setattr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0key<span class=\"p\">,</span>\u00a0value<span class=\"p\">)</span></td></tr><tr><th id=\"L33\"><a href=\"#L33\">33</a></th><td></td></tr><tr><th id=\"L34\"><a href=\"#L34\">34</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">isLoaded</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span></td></tr><tr><th id=\"L35\"><a href=\"#L35\">35</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"sd\">\"\"\"Check to see if the module for this plugin has been imported yet.</span></td></tr><tr><th id=\"L36\"><a href=\"#L36\">36</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L37\"><a href=\"#L37\">37</a></th><td><span class=\"sd\">\u00a0 \u00a0 \u00a0 \u00a0 @rtype: C{int}</span></td></tr><tr><th id=\"L38\"><a href=\"#L38\">38</a></th><td><span class=\"sd\">\u00a0 \u00a0 \u00a0 \u00a0 @return: A true value if the module for this plugin has been loaded,</span></td></tr><tr><th id=\"L39\"><a href=\"#L39\">39</a></th><td><span class=\"sd\">\u00a0 \u00a0 \u00a0 \u00a0 false otherwise.</span></td></tr><tr><th id=\"L40\"><a href=\"#L40\">40</a></th><td><span class=\"sd\">\u00a0 \u00a0 \u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L41\"><a href=\"#L41\">41</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0sys<span class=\"o\">.</span>modules<span class=\"o\">.</span>has_key<span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span>module<span class=\"p\">)</span></td></tr><tr><th id=\"L42\"><a href=\"#L42\">42</a></th><td></td></tr><tr><th id=\"L43\"><a href=\"#L43\">43</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">load</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span></td></tr><tr><th id=\"L44\"><a href=\"#L44\">44</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"sd\">\"\"\"Load the module for this plugin.</span></td></tr><tr><th id=\"L45\"><a href=\"#L45\">45</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L46\"><a href=\"#L46\">46</a></th><td><span class=\"sd\">\u00a0 \u00a0 \u00a0 \u00a0 @rtype: C{ModuleType}</span></td></tr><tr><th id=\"L47\"><a href=\"#L47\">47</a></th><td><span class=\"sd\">\u00a0 \u00a0 \u00a0 \u00a0 @return: The module object that is loaded.</span></td></tr><tr><th id=\"L48\"><a href=\"#L48\">48</a></th><td><span class=\"sd\">\u00a0 \u00a0 \u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L49\"><a href=\"#L49\">49</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0namedModule<span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span>module<span class=\"p\">)</span></td></tr><tr><th id=\"L50\"><a href=\"#L50\">50</a></th><td></td></tr><tr><th id=\"L51\"><a href=\"#L51\">51</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">__repr__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span></td></tr><tr><th id=\"L52\"><a href=\"#L52\">52</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>isLoaded<span class=\"p\">():</span></td></tr><tr><th id=\"L53\"><a href=\"#L53\">53</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 loaded <span class=\"o\">=</span>\u00a0<span class=\"s\">' loaded'</span></td></tr><tr><th id=\"L54\"><a href=\"#L54\">54</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L55\"><a href=\"#L55\">55</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 loaded <span class=\"o\">=</span>\u00a0<span class=\"s\">''</span></td></tr><tr><th id=\"L56\"><a href=\"#L56\">56</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"s\">\"&lt;Plugin </span><span class=\"si\">%s</span><span class=\"s\">\u00a0</span><span class=\"si\">%s%s</span><span class=\"s\">&gt;\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">repr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span>name<span class=\"p\">),</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>module<span class=\"p\">,</span>\u00a0loaded<span class=\"p\">)</span></td></tr><tr><th id=\"L57\"><a href=\"#L57\">57</a></th><td></td></tr><tr><th id=\"L58\"><a href=\"#L58\">58</a></th><td><span class=\"k\">class</span>\u00a0<span class=\"nc\">DropIn</span><span class=\"p\">:</span></td></tr><tr><th id=\"L59\"><a href=\"#L59\">59</a></th><td>\u00a0 \u00a0 <span class=\"sd\">\"\"\"I am a Python package containing plugins.tml.</span></td></tr><tr><th id=\"L60\"><a href=\"#L60\">60</a></th><td><span class=\"sd\">\u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L61\"><a href=\"#L61\">61</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0name<span class=\"p\">):</span></td></tr><tr><th id=\"L62\"><a href=\"#L62\">62</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>name <span class=\"o\">=</span>\u00a0name</td></tr><tr><th id=\"L63\"><a href=\"#L63\">63</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>plugins <span class=\"o\">=</span>\u00a0<span class=\"p\">[]</span></td></tr><tr><th id=\"L64\"><a href=\"#L64\">64</a></th><td></td></tr><tr><th id=\"L65\"><a href=\"#L65\">65</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">register</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0name<span class=\"p\">,</span>\u00a0module<span class=\"p\">,</span>\u00a0<span class=\"o\">**</span>kw<span class=\"p\">):</span></td></tr><tr><th id=\"L66\"><a href=\"#L66\">66</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"sd\">\"\"\"Register a new plug-in.</span></td></tr><tr><th id=\"L67\"><a href=\"#L67\">67</a></th><td><span class=\"sd\">\u00a0 \u00a0 \u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L68\"><a href=\"#L68\">68</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 warnings<span class=\"o\">.</span>warn<span class=\"p\">(</span><span class=\"s\">\"The twisted.python.plugin system is deprecated.\u00a0 \"</span></td></tr><tr><th id=\"L69\"><a href=\"#L69\">69</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"See twisted.plugin for the revised edition.\"</span><span class=\"p\">,</span></td></tr><tr><th id=\"L70\"><a href=\"#L70\">70</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"ne\">DeprecationWarning</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">2</span><span class=\"p\">)</span></td></tr><tr><th id=\"L71\"><a href=\"#L71\">71</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"bp\">self</span><span class=\"o\">.</span>plugins<span class=\"o\">.</span>append<span class=\"p\">(</span>PlugIn<span class=\"p\">(</span>name<span class=\"p\">,</span>\u00a0module<span class=\"p\">,</span>\u00a0<span class=\"o\">**</span>kw<span class=\"p\">))</span></td></tr><tr><th id=\"L72\"><a href=\"#L72\">72</a></th><td></td></tr><tr><th id=\"L73\"><a href=\"#L73\">73</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">__repr__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span></td></tr><tr><th id=\"L74\"><a href=\"#L74\">74</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"s\">\"&lt;Package </span><span class=\"si\">%s</span><span class=\"s\">\u00a0</span><span class=\"si\">%s</span><span class=\"s\">&gt;\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span>name<span class=\"p\">,</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>plugins<span class=\"p\">)</span></td></tr><tr><th id=\"L75\"><a href=\"#L75\">75</a></th><td></td></tr><tr><th id=\"L76\"><a href=\"#L76\">76</a></th><td></td></tr><tr><th id=\"L77\"><a href=\"#L77\">77</a></th><td><span class=\"k\">def</span>\u00a0<span class=\"nf\">_prepCallbacks</span><span class=\"p\">(</span>debug<span class=\"p\">,</span>\u00a0progress<span class=\"p\">):</span></td></tr><tr><th id=\"L78\"><a href=\"#L78\">78</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0debug<span class=\"p\">:</span></td></tr><tr><th id=\"L79\"><a href=\"#L79\">79</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">try</span><span class=\"p\">:</span></td></tr><tr><th id=\"L80\"><a href=\"#L80\">80</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debug<span class=\"p\">(</span><span class=\"s\">'Looking for plugin.tml files'</span><span class=\"p\">)</span></td></tr><tr><th id=\"L81\"><a href=\"#L81\">81</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">except</span><span class=\"p\">:</span></td></tr><tr><th id=\"L82\"><a href=\"#L82\">82</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debug <span class=\"o\">=</span>\u00a0<span class=\"k\">lambda</span>\u00a0x<span class=\"p\">:</span>\u00a0sys<span class=\"o\">.</span>stdout<span class=\"o\">.</span>write<span class=\"p\">(</span>x <span class=\"o\">+</span>\u00a0<span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">)</span></td></tr><tr><th id=\"L83\"><a href=\"#L83\">83</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debug<span class=\"p\">(</span><span class=\"s\">'Looking for plugin.tml files'</span><span class=\"p\">)</span></td></tr><tr><th id=\"L84\"><a href=\"#L84\">84</a></th><td>\u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L85\"><a href=\"#L85\">85</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 debug <span class=\"o\">=</span>\u00a0<span class=\"k\">lambda</span>\u00a0x<span class=\"p\">:</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L86\"><a href=\"#L86\">86</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0progress<span class=\"p\">:</span></td></tr><tr><th id=\"L87\"><a href=\"#L87\">87</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">try</span><span class=\"p\">:</span></td></tr><tr><th id=\"L88\"><a href=\"#L88\">88</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 progress<span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">)</span></td></tr><tr><th id=\"L89\"><a href=\"#L89\">89</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">except</span><span class=\"p\">:</span></td></tr><tr><th id=\"L90\"><a href=\"#L90\">90</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pb <span class=\"o\">=</span>\u00a0util<span class=\"o\">.</span>makeStatusBar<span class=\"p\">(</span><span class=\"mi\">76</span><span class=\"p\">)</span></td></tr><tr><th id=\"L91\"><a href=\"#L91\">91</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 progress <span class=\"o\">=</span>\u00a0<span class=\"k\">lambda</span>\u00a0x<span class=\"p\">,</span>\u00a0pb<span class=\"o\">=</span>pb<span class=\"p\">:</span>\u00a0sys<span class=\"o\">.</span>stdout<span class=\"o\">.</span>write<span class=\"p\">(</span>pb<span class=\"p\">(</span>x<span class=\"p\">)</span>\u00a0<span class=\"o\">+</span>\u00a0<span class=\"s\">'</span><span class=\"se\">\\r</span><span class=\"s\">'</span><span class=\"p\">)</span></td></tr><tr><th id=\"L92\"><a href=\"#L92\">92</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 progress<span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">)</span></td></tr><tr><th id=\"L93\"><a href=\"#L93\">93</a></th><td>\u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L94\"><a href=\"#L94\">94</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 progress <span class=\"o\">=</span>\u00a0<span class=\"k\">lambda</span>\u00a0x<span class=\"p\">:</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L95\"><a href=\"#L95\">95</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0debug<span class=\"p\">,</span>\u00a0progress</td></tr><tr><th id=\"L96\"><a href=\"#L96\">96</a></th><td></td></tr><tr><th id=\"L97\"><a href=\"#L97\">97</a></th><td><span class=\"k\">def</span>\u00a0<span class=\"nf\">getPluginFileList</span><span class=\"p\">(</span>debugInspection<span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">,</span>\u00a0showProgress<span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">):</span></td></tr><tr><th id=\"L98\"><a href=\"#L98\">98</a></th><td>\u00a0 \u00a0 <span class=\"sd\">\"\"\"Find plugin.tml files in subdirectories of paths in C{sys.path}</span></td></tr><tr><th id=\"L99\"><a href=\"#L99\">99</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L100\"><a href=\"#L100\">100</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type debugInspection: C{None} or a callable taking one argument</span></td></tr><tr><th id=\"L101\"><a href=\"#L101\">101</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param debugInspection: If not None, this is invoked with strings containing</span></td></tr><tr><th id=\"L102\"><a href=\"#L102\">102</a></th><td><span class=\"sd\">\u00a0 \u00a0 debug information about the loading process.\u00a0 If it is any other true value,</span></td></tr><tr><th id=\"L103\"><a href=\"#L103\">103</a></th><td><span class=\"sd\">\u00a0 \u00a0 this debug information is written to stdout (This behavior is deprecated).</span></td></tr><tr><th id=\"L104\"><a href=\"#L104\">104</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L105\"><a href=\"#L105\">105</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type showProgress: C{None} or a callable taking one argument.</span></td></tr><tr><th id=\"L106\"><a href=\"#L106\">106</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param showProgress: If not None, this is invoked with floating point</span></td></tr><tr><th id=\"L107\"><a href=\"#L107\">107</a></th><td><span class=\"sd\">\u00a0 \u00a0 values between 0 and 1 describing the progress of the loading process.</span></td></tr><tr><th id=\"L108\"><a href=\"#L108\">108</a></th><td><span class=\"sd\">\u00a0 \u00a0 If it is any other true value, this progress information is written to</span></td></tr><tr><th id=\"L109\"><a href=\"#L109\">109</a></th><td><span class=\"sd\">\u00a0 \u00a0 stdout.\u00a0 (This behavior is deprecated).</span></td></tr><tr><th id=\"L110\"><a href=\"#L110\">110</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L111\"><a href=\"#L111\">111</a></th><td><span class=\"sd\">\u00a0 \u00a0 @rtype: C{list} of C{str}</span></td></tr><tr><th id=\"L112\"><a href=\"#L112\">112</a></th><td><span class=\"sd\">\u00a0 \u00a0 @return: A list of the plugin.tml files found.</span></td></tr><tr><th id=\"L113\"><a href=\"#L113\">113</a></th><td><span class=\"sd\">\u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L114\"><a href=\"#L114\">114</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"nb\">isinstance</span><span class=\"p\">(</span>debugInspection<span class=\"p\">,</span>\u00a0types<span class=\"o\">.</span>IntType<span class=\"p\">):</span></td></tr><tr><th id=\"L115\"><a href=\"#L115\">115</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 warnings<span class=\"o\">.</span>warn<span class=\"p\">(</span></td></tr><tr><th id=\"L116\"><a href=\"#L116\">116</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"int parameter for debugInspection is deprecated, pass None or \"</span></td></tr><tr><th id=\"L117\"><a href=\"#L117\">117</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"a function that takes a single argument instead.\"</span><span class=\"p\">,</span></td></tr><tr><th id=\"L118\"><a href=\"#L118\">118</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"ne\">DeprecationWarning</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">2</span></td></tr><tr><th id=\"L119\"><a href=\"#L119\">119</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L120\"><a href=\"#L120\">120</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"nb\">isinstance</span><span class=\"p\">(</span>showProgress<span class=\"p\">,</span>\u00a0types<span class=\"o\">.</span>IntType<span class=\"p\">):</span></td></tr><tr><th id=\"L121\"><a href=\"#L121\">121</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 warnings<span class=\"o\">.</span>warn<span class=\"p\">(</span></td></tr><tr><th id=\"L122\"><a href=\"#L122\">122</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"int parameter for showProgress is deprecated, pass None or \"</span></td></tr><tr><th id=\"L123\"><a href=\"#L123\">123</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"a function that takes a single argument instead.\"</span><span class=\"p\">,</span></td></tr><tr><th id=\"L124\"><a href=\"#L124\">124</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"ne\">DeprecationWarning</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">2</span></td></tr><tr><th id=\"L125\"><a href=\"#L125\">125</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L126\"><a href=\"#L126\">126</a></th><td>\u00a0 \u00a0 debugInspection<span class=\"p\">,</span>\u00a0showProgress <span class=\"o\">=</span>\u00a0_prepCallbacks<span class=\"p\">(</span>debugInspection<span class=\"p\">,</span>\u00a0showProgress<span class=\"p\">)</span></td></tr><tr><th id=\"L127\"><a href=\"#L127\">127</a></th><td>\u00a0 \u00a0 exists <span class=\"o\">=</span>\u00a0os<span class=\"o\">.</span>path<span class=\"o\">.</span>exists</td></tr><tr><th id=\"L128\"><a href=\"#L128\">128</a></th><td>\u00a0 \u00a0 join <span class=\"o\">=</span>\u00a0os<span class=\"o\">.</span>sep<span class=\"o\">.</span>join</td></tr><tr><th id=\"L129\"><a href=\"#L129\">129</a></th><td>\u00a0 \u00a0 result <span class=\"o\">=</span>\u00a0<span class=\"p\">[]</span></td></tr><tr><th id=\"L130\"><a href=\"#L130\">130</a></th><td>\u00a0 \u00a0 loaded <span class=\"o\">=</span>\u00a0<span class=\"p\">{}</span></td></tr><tr><th id=\"L131\"><a href=\"#L131\">131</a></th><td>\u00a0 \u00a0 seenNames <span class=\"o\">=</span>\u00a0<span class=\"p\">{}</span></td></tr><tr><th id=\"L132\"><a href=\"#L132\">132</a></th><td></td></tr><tr><th id=\"L133\"><a href=\"#L133\">133</a></th><td>\u00a0 \u00a0 <span class=\"c\"># XXX Some people claim to have found non-strings in sys.path (an empty</span></td></tr><tr><th id=\"L134\"><a href=\"#L134\">134</a></th><td>\u00a0 \u00a0 <span class=\"c\"># list, in particular).\u00a0 Instead of tracking down the cause for their</span></td></tr><tr><th id=\"L135\"><a href=\"#L135\">135</a></th><td>\u00a0 \u00a0 <span class=\"c\"># presence, they decided it was better to discard them unconditionally</span></td></tr><tr><th id=\"L136\"><a href=\"#L136\">136</a></th><td>\u00a0 \u00a0 <span class=\"c\"># without further investigation.\u00a0 At some point, someone should track</span></td></tr><tr><th id=\"L137\"><a href=\"#L137\">137</a></th><td>\u00a0 \u00a0 <span class=\"c\"># down where non-strings are coming from and do something about them.</span></td></tr><tr><th id=\"L138\"><a href=\"#L138\">138</a></th><td>\u00a0 \u00a0 paths <span class=\"o\">=</span>\u00a0<span class=\"p\">[</span>cacheTransform<span class=\"p\">(</span>p<span class=\"p\">)</span>\u00a0<span class=\"k\">for</span>\u00a0p <span class=\"ow\">in</span>\u00a0sys<span class=\"o\">.</span>path</td></tr><tr><th id=\"L139\"><a href=\"#L139\">139</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0<span class=\"k\">if</span>\u00a0<span class=\"nb\">isinstance</span><span class=\"p\">(</span>p<span class=\"p\">,</span>\u00a0<span class=\"nb\">str</span><span class=\"p\">)</span>\u00a0<span class=\"ow\">and</span>\u00a0os<span class=\"o\">.</span>path<span class=\"o\">.</span>isdir<span class=\"p\">(</span>p<span class=\"p\">)]</span></td></tr><tr><th id=\"L140\"><a href=\"#L140\">140</a></th><td></td></tr><tr><th id=\"L141\"><a href=\"#L141\">141</a></th><td>\u00a0 \u00a0 <span class=\"c\"># special case for commonly used directories we *know* shouldn't be checked</span></td></tr><tr><th id=\"L142\"><a href=\"#L142\">142</a></th><td>\u00a0 \u00a0 <span class=\"c\"># and really slow down mktap and such-like in real installations</span></td></tr><tr><th id=\"L143\"><a href=\"#L143\">143</a></th><td>\u00a0 \u00a0 <span class=\"k\">for</span>\u00a0p <span class=\"ow\">in</span>\u00a0<span class=\"p\">(</span><span class=\"s\">\"/usr/bin\"</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"/usr/local/bin\"</span><span class=\"p\">):</span></td></tr><tr><th id=\"L144\"><a href=\"#L144\">144</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">try</span><span class=\"p\">:</span></td></tr><tr><th id=\"L145\"><a href=\"#L145\">145</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 paths<span class=\"o\">.</span>remove<span class=\"p\">(</span>p<span class=\"p\">)</span></td></tr><tr><th id=\"L146\"><a href=\"#L146\">146</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">except</span>\u00a0<span class=\"ne\">ValueError</span><span class=\"p\">:</span></td></tr><tr><th id=\"L147\"><a href=\"#L147\">147</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">pass</span></td></tr><tr><th id=\"L148\"><a href=\"#L148\">148</a></th><td>\u00a0 \u00a0 progress <span class=\"o\">=</span>\u00a0<span class=\"mf\">0.0</span></td></tr><tr><th id=\"L149\"><a href=\"#L149\">149</a></th><td>\u00a0 \u00a0 increments <span class=\"o\">=</span>\u00a0<span class=\"mf\">1.0</span>\u00a0<span class=\"o\">/</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>paths<span class=\"p\">)</span></td></tr><tr><th id=\"L150\"><a href=\"#L150\">150</a></th><td></td></tr><tr><th id=\"L151\"><a href=\"#L151\">151</a></th><td>\u00a0 \u00a0 <span class=\"k\">for</span>\u00a0<span class=\"p\">(</span>index<span class=\"p\">,</span>\u00a0d<span class=\"p\">)</span>\u00a0<span class=\"ow\">in</span>\u00a0<span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span>paths<span class=\"p\">)),</span>\u00a0paths<span class=\"p\">):</span></td></tr><tr><th id=\"L152\"><a href=\"#L152\">152</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 showProgress<span class=\"p\">(</span>progress<span class=\"p\">)</span></td></tr><tr><th id=\"L153\"><a href=\"#L153\">153</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0loaded<span class=\"o\">.</span>has_key<span class=\"p\">(</span>d<span class=\"p\">):</span></td></tr><tr><th id=\"L154\"><a href=\"#L154\">154</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">'Already saw '</span>\u00a0<span class=\"o\">+</span>\u00a0d<span class=\"p\">)</span></td></tr><tr><th id=\"L155\"><a href=\"#L155\">155</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">continue</span></td></tr><tr><th id=\"L156\"><a href=\"#L156\">156</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L157\"><a href=\"#L157\">157</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">'Recursing through '</span>\u00a0<span class=\"o\">+</span>\u00a0d<span class=\"p\">)</span></td></tr><tr><th id=\"L158\"><a href=\"#L158\">158</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">try</span><span class=\"p\">:</span></td></tr><tr><th id=\"L159\"><a href=\"#L159\">159</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 subDirs <span class=\"o\">=</span>\u00a0os<span class=\"o\">.</span>listdir<span class=\"p\">(</span>d<span class=\"p\">)</span></td></tr><tr><th id=\"L160\"><a href=\"#L160\">160</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">except</span>\u00a0<span class=\"ne\">OSError</span><span class=\"p\">,</span>\u00a0<span class=\"p\">(</span>err<span class=\"p\">,</span>\u00a0s<span class=\"p\">):</span></td></tr><tr><th id=\"L161\"><a href=\"#L161\">161</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># Permission denied, carry on</span></td></tr><tr><th id=\"L162\"><a href=\"#L162\">162</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0err <span class=\"o\">==</span>\u00a0errno<span class=\"o\">.</span>EACCES<span class=\"p\">:</span></td></tr><tr><th id=\"L163\"><a href=\"#L163\">163</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">'Permission denied on '</span>\u00a0<span class=\"o\">+</span>\u00a0d<span class=\"p\">)</span></td></tr><tr><th id=\"L164\"><a href=\"#L164\">164</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L165\"><a href=\"#L165\">165</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span></td></tr><tr><th id=\"L166\"><a href=\"#L166\">166</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L167\"><a href=\"#L167\">167</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># filter out files we obviously don't need to check - ones with '.' in them</span></td></tr><tr><th id=\"L168\"><a href=\"#L168\">168</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 subDirs <span class=\"o\">=</span>\u00a0<span class=\"p\">[</span>s <span class=\"k\">for</span>\u00a0s <span class=\"ow\">in</span>\u00a0subDirs <span class=\"k\">if</span>\u00a0<span class=\"s\">\".\"</span>\u00a0<span class=\"ow\">not</span>\u00a0<span class=\"ow\">in</span>\u00a0s<span class=\"p\">]</span></td></tr><tr><th id=\"L169\"><a href=\"#L169\">169</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"ow\">not</span>\u00a0subDirs<span class=\"p\">:</span></td></tr><tr><th id=\"L170\"><a href=\"#L170\">170</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">continue</span></td></tr><tr><th id=\"L171\"><a href=\"#L171\">171</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 incr <span class=\"o\">=</span>\u00a0increments <span class=\"o\">*</span>\u00a0<span class=\"p\">(</span><span class=\"mf\">1.0</span>\u00a0<span class=\"o\">/</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>subDirs<span class=\"p\">))</span></td></tr><tr><th id=\"L172\"><a href=\"#L172\">172</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">for</span>\u00a0plugindir <span class=\"ow\">in</span>\u00a0subDirs<span class=\"p\">:</span></td></tr><tr><th id=\"L173\"><a href=\"#L173\">173</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0seenNames<span class=\"o\">.</span>has_key<span class=\"p\">(</span>plugindir<span class=\"p\">):</span></td></tr><tr><th id=\"L174\"><a href=\"#L174\">174</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">'Seen </span><span class=\"si\">%s</span><span class=\"s\">\u00a0already'</span>\u00a0<span class=\"o\">%</span>\u00a0plugindir<span class=\"p\">)</span></td></tr><tr><th id=\"L175\"><a href=\"#L175\">175</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">continue</span></td></tr><tr><th id=\"L176\"><a href=\"#L176\">176</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 tmlname <span class=\"o\">=</span>\u00a0join<span class=\"p\">((</span>d<span class=\"p\">,</span>\u00a0plugindir<span class=\"p\">,</span>\u00a0<span class=\"s\">\"plugins.tml\"</span><span class=\"p\">))</span></td></tr><tr><th id=\"L177\"><a href=\"#L177\">177</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0isAModule<span class=\"p\">(</span>join<span class=\"p\">((</span>d<span class=\"p\">,</span>plugindir<span class=\"p\">))):</span></td></tr><tr><th id=\"L178\"><a href=\"#L178\">178</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 seenNames<span class=\"p\">[</span>plugindir<span class=\"p\">]</span>\u00a0<span class=\"o\">=</span>\u00a0<span class=\"mi\">1</span></td></tr><tr><th id=\"L179\"><a href=\"#L179\">179</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0exists<span class=\"p\">(</span>tmlname<span class=\"p\">):</span></td></tr><tr><th id=\"L180\"><a href=\"#L180\">180</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 result<span class=\"o\">.</span>append<span class=\"p\">(</span>tmlname<span class=\"p\">)</span></td></tr><tr><th id=\"L181\"><a href=\"#L181\">181</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">'Found '</span>\u00a0<span class=\"o\">+</span>\u00a0tmlname<span class=\"p\">)</span></td></tr><tr><th id=\"L182\"><a href=\"#L182\">182</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L183\"><a href=\"#L183\">183</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">'Failed '</span>\u00a0<span class=\"o\">+</span>\u00a0tmlname<span class=\"p\">)</span></td></tr><tr><th id=\"L184\"><a href=\"#L184\">184</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L185\"><a href=\"#L185\">185</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">'Not a module '</span>\u00a0<span class=\"o\">+</span>\u00a0tmlname<span class=\"p\">)</span></td></tr><tr><th id=\"L186\"><a href=\"#L186\">186</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 progress <span class=\"o\">=</span>\u00a0progress <span class=\"o\">+</span>\u00a0incr</td></tr><tr><th id=\"L187\"><a href=\"#L187\">187</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 showProgress<span class=\"p\">(</span>progress<span class=\"p\">)</span></td></tr><tr><th id=\"L188\"><a href=\"#L188\">188</a></th><td></td></tr><tr><th id=\"L189\"><a href=\"#L189\">189</a></th><td>\u00a0 \u00a0 showProgress<span class=\"p\">(</span><span class=\"mf\">1.0</span><span class=\"p\">)</span></td></tr><tr><th id=\"L190\"><a href=\"#L190\">190</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0result</td></tr><tr><th id=\"L191\"><a href=\"#L191\">191</a></th><td></td></tr><tr><th id=\"L192\"><a href=\"#L192\">192</a></th><td><span class=\"k\">def</span>\u00a0<span class=\"nf\">loadPlugins</span><span class=\"p\">(</span>plugInType<span class=\"p\">,</span>\u00a0fileList<span class=\"p\">,</span>\u00a0debugInspection<span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">,</span>\u00a0showProgress<span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">):</span></td></tr><tr><th id=\"L193\"><a href=\"#L193\">193</a></th><td>\u00a0 \u00a0 <span class=\"sd\">\"\"\"Traverse the given list of files and attempt to load plugins from them.</span></td></tr><tr><th id=\"L194\"><a href=\"#L194\">194</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L195\"><a href=\"#L195\">195</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type plugInType: C{str}</span></td></tr><tr><th id=\"L196\"><a href=\"#L196\">196</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param plugInType: The type of plugin to search for.\u00a0 This is tested</span></td></tr><tr><th id=\"L197\"><a href=\"#L197\">197</a></th><td><span class=\"sd\">\u00a0 \u00a0 against the C{type} argument to the C{register} function in the</span></td></tr><tr><th id=\"L198\"><a href=\"#L198\">198</a></th><td><span class=\"sd\">\u00a0 \u00a0 plugin.tml files.</span></td></tr><tr><th id=\"L199\"><a href=\"#L199\">199</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L200\"><a href=\"#L200\">200</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type fileList: C{list} of C{str}</span></td></tr><tr><th id=\"L201\"><a href=\"#L201\">201</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param fileList: A list of the files to attempt to load plugin</span></td></tr><tr><th id=\"L202\"><a href=\"#L202\">202</a></th><td><span class=\"sd\">\u00a0 \u00a0 information from.\u00a0 One name is put in their scope, the C{register}</span></td></tr><tr><th id=\"L203\"><a href=\"#L203\">203</a></th><td><span class=\"sd\">\u00a0 \u00a0 function.</span></td></tr><tr><th id=\"L204\"><a href=\"#L204\">204</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L205\"><a href=\"#L205\">205</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type debugInspection: C{None} or a callable taking one argument</span></td></tr><tr><th id=\"L206\"><a href=\"#L206\">206</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param debugInspection: If not None, this is invoked with strings containing</span></td></tr><tr><th id=\"L207\"><a href=\"#L207\">207</a></th><td><span class=\"sd\">\u00a0 \u00a0 debug information about the loading process.\u00a0 If it is any other true value,</span></td></tr><tr><th id=\"L208\"><a href=\"#L208\">208</a></th><td><span class=\"sd\">\u00a0 \u00a0 this debug information is written to stdout (This behavior is deprecated).</span></td></tr><tr><th id=\"L209\"><a href=\"#L209\">209</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L210\"><a href=\"#L210\">210</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type showProgress: C{None} or a callable taking one argument.</span></td></tr><tr><th id=\"L211\"><a href=\"#L211\">211</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param showProgress: If not None, this is invoked with floating point</span></td></tr><tr><th id=\"L212\"><a href=\"#L212\">212</a></th><td><span class=\"sd\">\u00a0 \u00a0 values between 0 and 1 describing the progress of the loading process.</span></td></tr><tr><th id=\"L213\"><a href=\"#L213\">213</a></th><td><span class=\"sd\">\u00a0 \u00a0 If it is any other true value, this progress information is written to</span></td></tr><tr><th id=\"L214\"><a href=\"#L214\">214</a></th><td><span class=\"sd\">\u00a0 \u00a0 stdout.\u00a0 (This behavior is deprecated).</span></td></tr><tr><th id=\"L215\"><a href=\"#L215\">215</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L216\"><a href=\"#L216\">216</a></th><td><span class=\"sd\">\u00a0 \u00a0 @rtype: C{list}</span></td></tr><tr><th id=\"L217\"><a href=\"#L217\">217</a></th><td><span class=\"sd\">\u00a0 \u00a0 @return: A list of the C{PlugIn} objects found.</span></td></tr><tr><th id=\"L218\"><a href=\"#L218\">218</a></th><td><span class=\"sd\">\u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L219\"><a href=\"#L219\">219</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"nb\">isinstance</span><span class=\"p\">(</span>debugInspection<span class=\"p\">,</span>\u00a0types<span class=\"o\">.</span>IntType<span class=\"p\">):</span></td></tr><tr><th id=\"L220\"><a href=\"#L220\">220</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 warnings<span class=\"o\">.</span>warn<span class=\"p\">(</span></td></tr><tr><th id=\"L221\"><a href=\"#L221\">221</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"int parameter for debugInspection is deprecated, pass None or \"</span></td></tr><tr><th id=\"L222\"><a href=\"#L222\">222</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"a function that takes a single argument instead.\"</span><span class=\"p\">,</span></td></tr><tr><th id=\"L223\"><a href=\"#L223\">223</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"ne\">DeprecationWarning</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">4</span></td></tr><tr><th id=\"L224\"><a href=\"#L224\">224</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L225\"><a href=\"#L225\">225</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"nb\">isinstance</span><span class=\"p\">(</span>showProgress<span class=\"p\">,</span>\u00a0types<span class=\"o\">.</span>IntType<span class=\"p\">):</span></td></tr><tr><th id=\"L226\"><a href=\"#L226\">226</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 warnings<span class=\"o\">.</span>warn<span class=\"p\">(</span></td></tr><tr><th id=\"L227\"><a href=\"#L227\">227</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"int parameter for showProgress is deprecated, pass None or \"</span></td></tr><tr><th id=\"L228\"><a href=\"#L228\">228</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"a function that takes a single argument instead.\"</span><span class=\"p\">,</span></td></tr><tr><th id=\"L229\"><a href=\"#L229\">229</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"ne\">DeprecationWarning</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">4</span></td></tr><tr><th id=\"L230\"><a href=\"#L230\">230</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L231\"><a href=\"#L231\">231</a></th><td>\u00a0 \u00a0 result <span class=\"o\">=</span>\u00a0<span class=\"p\">[]</span></td></tr><tr><th id=\"L232\"><a href=\"#L232\">232</a></th><td>\u00a0 \u00a0 debugInspection<span class=\"p\">,</span>\u00a0showProgress <span class=\"o\">=</span>\u00a0_prepCallbacks<span class=\"p\">(</span>debugInspection<span class=\"p\">,</span>\u00a0showProgress<span class=\"p\">)</span></td></tr><tr><th id=\"L233\"><a href=\"#L233\">233</a></th><td></td></tr><tr><th id=\"L234\"><a href=\"#L234\">234</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"ow\">not</span>\u00a0fileList<span class=\"p\">:</span></td></tr><tr><th id=\"L235\"><a href=\"#L235\">235</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0<span class=\"ne\">ValueError</span><span class=\"p\">(</span><span class=\"s\">\"No plugins passed to loadPlugins\"</span><span class=\"p\">)</span></td></tr><tr><th id=\"L236\"><a href=\"#L236\">236</a></th><td></td></tr><tr><th id=\"L237\"><a href=\"#L237\">237</a></th><td>\u00a0 \u00a0 increments <span class=\"o\">=</span>\u00a0<span class=\"mf\">1.0</span>\u00a0<span class=\"o\">/</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>fileList<span class=\"p\">)</span></td></tr><tr><th id=\"L238\"><a href=\"#L238\">238</a></th><td>\u00a0 \u00a0 progress <span class=\"o\">=</span>\u00a0<span class=\"mf\">0.0</span></td></tr><tr><th id=\"L239\"><a href=\"#L239\">239</a></th><td></td></tr><tr><th id=\"L240\"><a href=\"#L240\">240</a></th><td>\u00a0 \u00a0 <span class=\"k\">for</span>\u00a0<span class=\"p\">(</span>index<span class=\"p\">,</span>\u00a0tmlFile<span class=\"p\">)</span>\u00a0<span class=\"ow\">in</span>\u00a0<span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span>fileList<span class=\"p\">)),</span>\u00a0fileList<span class=\"p\">):</span></td></tr><tr><th id=\"L241\"><a href=\"#L241\">241</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 showProgress<span class=\"p\">(</span>progress<span class=\"p\">)</span></td></tr><tr><th id=\"L242\"><a href=\"#L242\">242</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">\"Loading from \"</span>\u00a0<span class=\"o\">+</span>\u00a0tmlFile<span class=\"p\">)</span></td></tr><tr><th id=\"L243\"><a href=\"#L243\">243</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 pname <span class=\"o\">=</span>\u00a0os<span class=\"o\">.</span>path<span class=\"o\">.</span>split<span class=\"p\">(</span>os<span class=\"o\">.</span>path<span class=\"o\">.</span>abspath<span class=\"p\">(</span>tmlFile<span class=\"p\">))[</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"p\">]</span></td></tr><tr><th id=\"L244\"><a href=\"#L244\">244</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 dropin <span class=\"o\">=</span>\u00a0DropIn<span class=\"p\">(</span>pname<span class=\"p\">)</span></td></tr><tr><th id=\"L245\"><a href=\"#L245\">245</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 ns <span class=\"o\">=</span>\u00a0<span class=\"p\">{</span><span class=\"s\">'register'</span><span class=\"p\">:</span>\u00a0dropin<span class=\"o\">.</span>register<span class=\"p\">,</span>\u00a0<span class=\"s\">'__file__'</span><span class=\"p\">:</span>\u00a0tmlFile<span class=\"p\">}</span></td></tr><tr><th id=\"L246\"><a href=\"#L246\">246</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">try</span><span class=\"p\">:</span></td></tr><tr><th id=\"L247\"><a href=\"#L247\">247</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"nb\">execfile</span><span class=\"p\">(</span>tmlFile<span class=\"p\">,</span>\u00a0ns<span class=\"p\">)</span></td></tr><tr><th id=\"L248\"><a href=\"#L248\">248</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">except</span>\u00a0<span class=\"p\">(</span><span class=\"ne\">IOError</span><span class=\"p\">,</span>\u00a0<span class=\"ne\">OSError</span><span class=\"p\">),</span>\u00a0e<span class=\"p\">:</span></td></tr><tr><th id=\"L249\"><a href=\"#L249\">249</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># guess we don't have permissions for that</span></td></tr><tr><th id=\"L250\"><a href=\"#L250\">250</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">\"Error loading: </span><span class=\"si\">%s</span><span class=\"s\">\"</span>\u00a0<span class=\"o\">%</span>\u00a0e<span class=\"p\">)</span></td></tr><tr><th id=\"L251\"><a href=\"#L251\">251</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">continue</span></td></tr><tr><th id=\"L252\"><a href=\"#L252\">252</a></th><td></td></tr><tr><th id=\"L253\"><a href=\"#L253\">253</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 ldp <span class=\"o\">=</span>\u00a0<span class=\"nb\">len</span><span class=\"p\">(</span>dropin<span class=\"o\">.</span>plugins<span class=\"p\">)</span>\u00a0<span class=\"ow\">or</span>\u00a0<span class=\"mf\">1.0</span></td></tr><tr><th id=\"L254\"><a href=\"#L254\">254</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 incr <span class=\"o\">=</span>\u00a0increments <span class=\"o\">*</span>\u00a0<span class=\"p\">(</span><span class=\"mf\">1.0</span>\u00a0<span class=\"o\">/</span>\u00a0ldp<span class=\"p\">)</span></td></tr><tr><th id=\"L255\"><a href=\"#L255\">255</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">for</span>\u00a0plugin <span class=\"ow\">in</span>\u00a0dropin<span class=\"o\">.</span>plugins<span class=\"p\">:</span></td></tr><tr><th id=\"L256\"><a href=\"#L256\">256</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0plugInType <span class=\"o\">==</span>\u00a0plugin<span class=\"o\">.</span>type<span class=\"p\">:</span></td></tr><tr><th id=\"L257\"><a href=\"#L257\">257</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 result<span class=\"o\">.</span>append<span class=\"p\">(</span>plugin<span class=\"p\">)</span></td></tr><tr><th id=\"L258\"><a href=\"#L258\">258</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">\"Found </span><span class=\"si\">%r</span><span class=\"s\">\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>plugin<span class=\"p\">,))</span></td></tr><tr><th id=\"L259\"><a href=\"#L259\">259</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L260\"><a href=\"#L260\">260</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">\"Disqualified </span><span class=\"si\">%r</span><span class=\"s\">\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>plugin<span class=\"p\">,))</span></td></tr><tr><th id=\"L261\"><a href=\"#L261\">261</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 progress <span class=\"o\">=</span>\u00a0progress <span class=\"o\">+</span>\u00a0incr</td></tr><tr><th id=\"L262\"><a href=\"#L262\">262</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 showProgress<span class=\"p\">(</span>progress<span class=\"p\">)</span></td></tr><tr><th id=\"L263\"><a href=\"#L263\">263</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">\"Finished loading from </span><span class=\"si\">%s</span><span class=\"s\">!\"</span>\u00a0<span class=\"o\">%</span>\u00a0tmlFile<span class=\"p\">)</span></td></tr><tr><th id=\"L264\"><a href=\"#L264\">264</a></th><td></td></tr><tr><th id=\"L265\"><a href=\"#L265\">265</a></th><td>\u00a0 \u00a0 showProgress<span class=\"p\">(</span><span class=\"mf\">1.0</span><span class=\"p\">)</span></td></tr><tr><th id=\"L266\"><a href=\"#L266\">266</a></th><td>\u00a0 \u00a0 debugInspection<span class=\"p\">(</span><span class=\"s\">\"Returning </span><span class=\"si\">%r</span><span class=\"s\">\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>result<span class=\"p\">,))</span></td></tr><tr><th id=\"L267\"><a href=\"#L267\">267</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0result</td></tr><tr><th id=\"L268\"><a href=\"#L268\">268</a></th><td></td></tr><tr><th id=\"L269\"><a href=\"#L269\">269</a></th><td><span class=\"k\">def</span>\u00a0<span class=\"nf\">getPlugIns</span><span class=\"p\">(</span>plugInType<span class=\"p\">,</span>\u00a0debugInspection<span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">,</span>\u00a0showProgress<span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">):</span></td></tr><tr><th id=\"L270\"><a href=\"#L270\">270</a></th><td>\u00a0 \u00a0 <span class=\"sd\">\"\"\"Helper function to get all the plugins of a particular type.</span></td></tr><tr><th id=\"L271\"><a href=\"#L271\">271</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L272\"><a href=\"#L272\">272</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type plugInType: C{str}</span></td></tr><tr><th id=\"L273\"><a href=\"#L273\">273</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param plugInType: The type of plugin to search for.\u00a0 This is tested</span></td></tr><tr><th id=\"L274\"><a href=\"#L274\">274</a></th><td><span class=\"sd\">\u00a0 \u00a0 against the C{type} argument to the C{register} function in the</span></td></tr><tr><th id=\"L275\"><a href=\"#L275\">275</a></th><td><span class=\"sd\">\u00a0 \u00a0 plugin.tml files.</span></td></tr><tr><th id=\"L276\"><a href=\"#L276\">276</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L277\"><a href=\"#L277\">277</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type debugInspection: C{None} or a callable taking one argument</span></td></tr><tr><th id=\"L278\"><a href=\"#L278\">278</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param debugInspection: If not None, this is invoked with strings containing</span></td></tr><tr><th id=\"L279\"><a href=\"#L279\">279</a></th><td><span class=\"sd\">\u00a0 \u00a0 debug information about the loading process.\u00a0 If it is any other true value,</span></td></tr><tr><th id=\"L280\"><a href=\"#L280\">280</a></th><td><span class=\"sd\">\u00a0 \u00a0 this debug information is written to stdout (This behavior is deprecated).</span></td></tr><tr><th id=\"L281\"><a href=\"#L281\">281</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L282\"><a href=\"#L282\">282</a></th><td><span class=\"sd\">\u00a0 \u00a0 @type showProgress: C{None} or a callable taking one argument.</span></td></tr><tr><th id=\"L283\"><a href=\"#L283\">283</a></th><td><span class=\"sd\">\u00a0 \u00a0 @param showProgress: If not None, this is invoked with floating point</span></td></tr><tr><th id=\"L284\"><a href=\"#L284\">284</a></th><td><span class=\"sd\">\u00a0 \u00a0 values between 0 and 1 describing the progress of the loading process.</span></td></tr><tr><th id=\"L285\"><a href=\"#L285\">285</a></th><td><span class=\"sd\">\u00a0 \u00a0 If it is any other true value, this progress information is written to</span></td></tr><tr><th id=\"L286\"><a href=\"#L286\">286</a></th><td><span class=\"sd\">\u00a0 \u00a0 stdout.\u00a0 (This behavior is deprecated).</span></td></tr><tr><th id=\"L287\"><a href=\"#L287\">287</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L288\"><a href=\"#L288\">288</a></th><td><span class=\"sd\">\u00a0 \u00a0 @rtype: C{list}</span></td></tr><tr><th id=\"L289\"><a href=\"#L289\">289</a></th><td><span class=\"sd\">\u00a0 \u00a0 @return: A list of C{PlugIn} objects that were found.</span></td></tr><tr><th id=\"L290\"><a href=\"#L290\">290</a></th><td><span class=\"sd\">\u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L291\"><a href=\"#L291\">291</a></th><td>\u00a0 \u00a0 warnings<span class=\"o\">.</span>warn<span class=\"p\">(</span><span class=\"s\">\"The twisted.python.plugin system is deprecated.\u00a0 \"</span></td></tr><tr><th id=\"L292\"><a href=\"#L292\">292</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"See twisted.plugin for the revised edition.\"</span><span class=\"p\">,</span></td></tr><tr><th id=\"L293\"><a href=\"#L293\">293</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"ne\">DeprecationWarning</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">2</span><span class=\"p\">)</span></td></tr><tr><th id=\"L294\"><a href=\"#L294\">294</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0_getPlugIns<span class=\"p\">(</span>plugInType<span class=\"p\">,</span>\u00a0debugInspection<span class=\"p\">,</span>\u00a0showProgress<span class=\"p\">)</span></td></tr><tr><th id=\"L295\"><a href=\"#L295\">295</a></th><td></td></tr><tr><th id=\"L296\"><a href=\"#L296\">296</a></th><td><span class=\"k\">def</span>\u00a0<span class=\"nf\">_getPlugIns</span><span class=\"p\">(</span>plugInType<span class=\"p\">,</span>\u00a0debugInspection<span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">,</span>\u00a0showProgress<span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">):</span></td></tr><tr><th id=\"L297\"><a href=\"#L297\">297</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"nb\">isinstance</span><span class=\"p\">(</span>debugInspection<span class=\"p\">,</span>\u00a0types<span class=\"o\">.</span>IntType<span class=\"p\">):</span></td></tr><tr><th id=\"L298\"><a href=\"#L298\">298</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 warnings<span class=\"o\">.</span>warn<span class=\"p\">(</span></td></tr><tr><th id=\"L299\"><a href=\"#L299\">299</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"int parameter for debugInspection is deprecated, pass None or \"</span></td></tr><tr><th id=\"L300\"><a href=\"#L300\">300</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"a function that takes a single argument instead.\"</span><span class=\"p\">,</span></td></tr><tr><th id=\"L301\"><a href=\"#L301\">301</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"ne\">DeprecationWarning</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">3</span></td></tr><tr><th id=\"L302\"><a href=\"#L302\">302</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L303\"><a href=\"#L303\">303</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"nb\">isinstance</span><span class=\"p\">(</span>showProgress<span class=\"p\">,</span>\u00a0types<span class=\"o\">.</span>IntType<span class=\"p\">):</span></td></tr><tr><th id=\"L304\"><a href=\"#L304\">304</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 warnings<span class=\"o\">.</span>warn<span class=\"p\">(</span></td></tr><tr><th id=\"L305\"><a href=\"#L305\">305</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"int parameter for showProgress is deprecated, pass None or \"</span></td></tr><tr><th id=\"L306\"><a href=\"#L306\">306</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">\"a function that takes a single argument instead.\"</span><span class=\"p\">,</span></td></tr><tr><th id=\"L307\"><a href=\"#L307\">307</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"ne\">DeprecationWarning</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">3</span></td></tr><tr><th id=\"L308\"><a href=\"#L308\">308</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L309\"><a href=\"#L309\">309</a></th><td>\u00a0 \u00a0 debugInspection<span class=\"p\">,</span>\u00a0showProgress <span class=\"o\">=</span>\u00a0_prepCallbacks<span class=\"p\">(</span>debugInspection<span class=\"p\">,</span>\u00a0showProgress<span class=\"p\">)</span></td></tr><tr><th id=\"L310\"><a href=\"#L310\">310</a></th><td></td></tr><tr><th id=\"L311\"><a href=\"#L311\">311</a></th><td>\u00a0 \u00a0 firstHalf <span class=\"o\">=</span>\u00a0secondHalf <span class=\"o\">=</span>\u00a0<span class=\"k\">lambda</span>\u00a0x<span class=\"p\">:</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L312\"><a href=\"#L312\">312</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0showProgress<span class=\"p\">:</span></td></tr><tr><th id=\"L313\"><a href=\"#L313\">313</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 firstHalf <span class=\"o\">=</span>\u00a0<span class=\"k\">lambda</span>\u00a0x<span class=\"p\">:</span>\u00a0showProgress<span class=\"p\">(</span>x <span class=\"o\">/</span>\u00a0<span class=\"mf\">2.0</span><span class=\"p\">)</span></td></tr><tr><th id=\"L314\"><a href=\"#L314\">314</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 secondHalf <span class=\"o\">=</span>\u00a0<span class=\"k\">lambda</span>\u00a0x<span class=\"p\">:</span>\u00a0showProgress<span class=\"p\">(</span>x <span class=\"o\">/</span>\u00a0<span class=\"mf\">2.0</span>\u00a0<span class=\"o\">+</span>\u00a0<span class=\"mf\">0.5</span><span class=\"p\">)</span></td></tr><tr><th id=\"L315\"><a href=\"#L315\">315</a></th><td></td></tr><tr><th id=\"L316\"><a href=\"#L316\">316</a></th><td>\u00a0 \u00a0 tmlFiles <span class=\"o\">=</span>\u00a0getPluginFileList<span class=\"p\">(</span>debugInspection<span class=\"p\">,</span>\u00a0firstHalf<span class=\"p\">)</span></td></tr><tr><th id=\"L317\"><a href=\"#L317\">317</a></th><td>\u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"ow\">not</span>\u00a0tmlFiles<span class=\"p\">:</span></td></tr><tr><th id=\"L318\"><a href=\"#L318\">318</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">[]</span></td></tr><tr><th id=\"L319\"><a href=\"#L319\">319</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0loadPlugins<span class=\"p\">(</span>plugInType<span class=\"p\">,</span>\u00a0tmlFiles<span class=\"p\">,</span>\u00a0debugInspection<span class=\"p\">,</span>\u00a0secondHalf<span class=\"p\">)</span></td></tr><tr><th id=\"L320\"><a href=\"#L320\">320</a></th><td></td></tr><tr><th id=\"L321\"><a href=\"#L321\">321</a></th><td><span class=\"k\">def</span>\u00a0<span class=\"nf\">isAModule</span><span class=\"p\">(</span>d<span class=\"p\">):</span></td></tr><tr><th id=\"L322\"><a href=\"#L322\">322</a></th><td>\u00a0 \u00a0 <span class=\"sd\">\"\"\"This function checks the directory for __init__ files.</span></td></tr><tr><th id=\"L323\"><a href=\"#L323\">323</a></th><td><span class=\"sd\">\u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L324\"><a href=\"#L324\">324</a></th><td>\u00a0 \u00a0 suffixes <span class=\"o\">=</span>\u00a0<span class=\"p\">[</span><span class=\"s\">'py'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'pyc'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'pyo'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'so'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'pyd'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'dll'</span><span class=\"p\">]</span></td></tr><tr><th id=\"L325\"><a href=\"#L325\">325</a></th><td>\u00a0 \u00a0 exists <span class=\"o\">=</span>\u00a0os<span class=\"o\">.</span>path<span class=\"o\">.</span>exists</td></tr><tr><th id=\"L326\"><a href=\"#L326\">326</a></th><td>\u00a0 \u00a0 join <span class=\"o\">=</span>\u00a0os<span class=\"o\">.</span>sep<span class=\"o\">.</span>join</td></tr><tr><th id=\"L327\"><a href=\"#L327\">327</a></th><td>\u00a0 \u00a0 <span class=\"k\">for</span>\u00a0s <span class=\"ow\">in</span>\u00a0suffixes<span class=\"p\">:</span>\u00a0<span class=\"c\"># bad algorithm, but probably works</span></td></tr><tr><th id=\"L328\"><a href=\"#L328\">328</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0exists<span class=\"p\">(</span>join<span class=\"p\">((</span>d<span class=\"p\">,</span><span class=\"s\">'__init__.</span><span class=\"si\">%s</span><span class=\"s\">'</span>\u00a0<span class=\"o\">%</span>\u00a0s<span class=\"p\">))):</span></td></tr><tr><th id=\"L329\"><a href=\"#L329\">329</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"mi\">1</span></td></tr><tr><th id=\"L330\"><a href=\"#L330\">330</a></th><td>\u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"mi\">0</span></td></tr><tr><th id=\"L331\"><a href=\"#L331\">331</a></th><td></td></tr><tr><th id=\"L332\"><a href=\"#L332\">332</a></th><td>__all__ <span class=\"o\">=</span>\u00a0<span class=\"p\">[</span><span class=\"s\">'PlugIn'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'DropIn'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'getPluginFileList'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'loadPlugins'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'getPlugIns'</span><span class=\"p\">]</span></td></tr></tbody></table>\n\n      </div>\n      <div id=\"anydiff\">\n        <form action=\"/LUCICodeRepository/nomaticIM/diff\" method=\"get\">\n          <div class=\"buttons\">\n            <input type=\"hidden\" name=\"new_path\" value=\"/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py\" />\n            <input type=\"hidden\" name=\"old_path\" value=\"/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py\" />\n            <input type=\"hidden\" name=\"new_rev\" />\n            <input type=\"hidden\" name=\"old_rev\" />\n            <input type=\"submit\" value=\"View changes...\" title=\"Select paths and revs for Diff\" />\n          </div>\n        </form>\n      </div>\n      <div id=\"help\"><strong>Note:</strong> See <a href=\"/LUCICodeRepository/nomaticIM/wiki/TracBrowser\">TracBrowser</a>\n        for help on using the repository browser.</div>\n    </div>\n    <div id=\"altlinks\">\n      <h3>Download in other formats:</h3>\n      <ul>\n        <li class=\"first\">\n          <a rel=\"nofollow\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py?format=txt\">Plain Text</a>\n        </li><li class=\"last\">\n          <a rel=\"nofollow\" href=\"/LUCICodeRepository/nomaticIM/export/1312/nomatic/tags/NomaticIM-0.0.3/buddy_bots/src/twisted/python/plugin.py\">Original Format</a>\n        </li>\n      </ul>\n    </div>\n    </div>\n    <div id=\"footer\" lang=\"en\" xml:lang=\"en\"><hr />\n      <a id=\"tracpowered\" href=\"http://trac.edgewall.org/\"><img src=\"/LUCICodeRepository/nomaticIM/chrome/common/trac_logo_mini.png\" height=\"30\" width=\"107\" alt=\"Trac Powered\" /></a>\n      <p class=\"left\">Powered by <a href=\"/LUCICodeRepository/nomaticIM/about\"><strong>Trac 1.0.1</strong></a><br />\n        By <a href=\"http://www.edgewall.org/\">Edgewall Software</a>.</p>\n      <p class=\"right\">All content copyright 2007-2008 by LUCI <br /><a href=\"http://luci.ics.uci.edu/\">http://luci.ics.uci.edu/</a></p>\n    </div>\n\t\t<div id=\"sitefooter\">\n\t\t\t<script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\n\t\t\t</script>\n\t\t\t<script type=\"text/javascript\">\n\t\t\t\t_uacct = \"UA-338915-2\";\n\t\t\t\turchinTracker();\n\t\t\t</script>\n\t\t</div>\n\t</body>\n</html>", "id": 44621.0}