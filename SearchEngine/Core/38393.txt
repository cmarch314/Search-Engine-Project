{"text": "OEChem C Theory Manual Version 1 3 1 Previous 17 1 Substructure Search Up 17 Pattern Matching Next 17 3 Clique Search 17 2 Maximum Common Substructure Search The maximum substructure common to two molecular graphs can be identified using the OEMCSSearch class The following example demonstrates how to initialize an OEMCSSearch instance and to perform a maximum common substructure search with another molecule include oechem h include iostream using namespace std using namespace OEChem using namespace OESystem int main OEGraphMol m1 m2 OEParseSmiles m1 c1cc O c O cc1CCN OEParseSmiles m2 c1c O c O c Cl cc1CCCBr OEMCSSearch mcss m1 OEExprOpts DefaultAtoms OEExprOpts DefaultBonds unsigned int count OEIter OEMatchBase match for count 1 match mcss Match m2 match match count OEIter OEMatchPair OEAtomBase apr cout Match count endl cout pattern atoms for apr match GetAtoms apr apr cout apr pattern GetIdx cout endl cout target atoms for apr match GetAtoms apr apr cout apr target GetIdx cout endl OEGraphMol m3 OESubsetMol m3 match true string smi OECreateSmiString smi m3 cout match smiles smi endl return Download as text The first molecule m1 in the example is dopamine and the second molecule m2 is a dopamine analog The OEMCSSearch instance is initialized with dopamine and arguments which control how node and edge expressions are built for the maximum common substructure query Please refer to section 17 4 for an explanation of expression options and the OEExprOpts namespace The OEMCSSearch Match method returns an iterator over the maximum common substructure s that can be passed as an argument to the OESubsetMol function and subsequently converted into a smiles string Using the standard OEMatchBase GetAtoms interface the atom correspondences are also printed out by the example program OEChem C Theory Manual Version 1 3 1 Previous 17 1 Substructure Search Up 17 Pattern Matching Next 17 3 Clique Search Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/cplusprog/node154.html", "title": "17.2 maximum common substructure search", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>17.2 Maximum Common Substructure Search</title>\n<META NAME=\"description\" CONTENT=\"17.2 Maximum Common Substructure Search\">\n<META NAME=\"keywords\" CONTENT=\"cplusprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"cplusprog.css\">\n<link rel=\"first\" href=\"cplusprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"next\" HREF=\"node155.html\">\n<LINK REL=\"previous\" HREF=\"node153.html\">\n<LINK REL=\"up\" HREF=\"node152.html\">\n<LINK REL=\"next\" HREF=\"node155.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node153.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node152.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node155.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node153.html\">17.1 Substructure Search</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node152.html\">17. Pattern Matching</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node155.html\">17.3 Clique Search</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION0020200000000000000000\">\n17.2 Maximum Common Substructure Search</A>\n</H1>\n\n<P>\nThe maximum substructure common to two molecular graphs can be\nidentified using the <code>OEMCSSearch</code> class.  The following example\ndemonstrates how to initialize an <code>OEMCSSearch</code> instance, and to\nperform a maximum common substructure search with another molecule.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#include \"oechem.h\"\n\n#include &lt;iostream&gt;\n\nusing namespace std;\nusing namespace OEChem;\nusing namespace OESystem;\n\nint main()\n{\n  OEGraphMol m1,m2;\n\n  OEParseSmiles(m1, \"c1cc(O)c(O)cc1CCN\");\n  OEParseSmiles(m2, \"c1c(O)c(O)c(Cl)cc1CCCBr\");\n\n  OEMCSSearch mcss(m1,OEExprOpts::DefaultAtoms,OEExprOpts::DefaultBonds);\n\n  unsigned int count;\n  OEIter&lt;OEMatchBase&gt; match;\n  for (count=1,match = mcss.Match(m2);match;++match,count++)\n  {\n    OEIter&lt;OEMatchPair&lt;OEAtomBase&gt; &gt; apr;\n\n    cout &lt;&#60; \"Match \" &lt;&#60; count &lt;&#60; ':' &lt;&#60; endl;\n    cout &lt;&#60; \"pattern atoms: \";\n    for (apr = match-&gt;GetAtoms();apr;++apr)\n      cout &lt;&#60; apr-&gt;pattern-&gt;GetIdx() &lt;&#60; ' ';\n    cout &lt;&#60; endl;\n\n    cout &lt;&#60; \"target atoms:  \";\n    for (apr = match-&gt;GetAtoms();apr;++apr)\n      cout &lt;&#60; apr-&gt;target-&gt;GetIdx() &lt;&#60; ' ';\n    cout &lt;&#60; endl;\n\n    OEGraphMol m3;\n    OESubsetMol(m3,match,true);\n    string smi;\n    OECreateSmiString(smi,m3);\n    cout &lt;&#60; \"match smiles = \" &lt;&#60; smi &lt;&#60; endl;\n  }\n\n  return 0;\n}\n</pre>\n<div class=\"verbatiminput-footer\">\n<a href=\"ch17-3.txt\" type=\"text/plain\">Download as text.</a>\n</div>\n</dd></dl>\n\n<P>\nThe first molecule 'm1' in the example is dopamine, and the second\nmolecule 'm2' is a dopamine analog.  The <code>OEMCSSearch</code> instance\nis initialized with dopamine, and arguments which control how node and\nedge expressions are built for the maximum common substructure query.\nPlease refer to section&nbsp;<A href=\"OEExprOpts.html#OEExprOpts\">17.4</A> for an explanation of\nexpression options and the <code>OEExprOpts</code> namespace.  The\n<code>OEMCSSearch::Match</code> method returns an iterator over the maximum\ncommon substructure(s), that can be passed as an argument to the\n<code>OESubsetMol</code> function, and subsequently converted into a smiles\nstring.  Using the standard <code>OEMatchBase::GetAtoms</code> interface,\nthe atom correspondences are also printed out by the example program.\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node153.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node152.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node155.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node153.html\">17.1 Substructure Search</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node152.html\">17. Pattern Matching</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node155.html\">17.3 Clique Search</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 38393.0}