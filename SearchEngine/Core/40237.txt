{"text": "Search LoginPreferencesHelp GuideAbout Trac WikiTimelineRoadmapBrowse SourceView TicketsSearch Context Navigation Previous ChangesetNext Changeset Changeset 745 View differences inlineside by side Show lines around each change Show the changes in full context Ignore Blank lines Case changes White space changes Timestamp Feb 18 2 8 4 15 25 PM 7 years ago Author cbakerMessage restructured buddy bot package structure jabber bot can sign on off subversion doesn t support moving files so this will be a big commit sorry Location nomatic trunk buddy bots src Files 28 added1 edited4 moved added jabber bot moved moved from nomatic trunk buddy bots jabber bot jabber bot nomatic jabber bot py modified 1 diff oscar bot moved moved from nomatic trunk buddy bots oscar bot twisted moved moved from nomatic trunk buddy bots twisted twisted names added twisted names init py added twisted names version py added twisted names authority py added twisted names cache py added twisted names client py added twisted names common py added twisted names dns py added twisted names error py added twisted names hosts py added twisted names resolve py added twisted names root py added twisted names secondary py added twisted names server py added twisted names srvconnect py added twisted names tap py added twisted names test added twisted names test init py added twisted names test test cache py added twisted names test test client py added twisted names test test dns py added twisted names test test names py added twisted names test test rootresolve py added twisted names topfiles added twisted names topfiles NEWS added twisted names topfiles README added twisted names topfiles setup py added zope moved moved from nomatic trunk buddy bots zope Legend UnmodifiedAddedRemoved nomatic trunk buddy bots src jabber bot nomatic jabber bot py r712 r745 1 2 Example of a twisted jabber client from 3 http www butterfat net wiki Documentation TwistedJabberComponentExample 4 1 Copyright c 2 1 2 6 Twisted Matrix Laboratories 2 See LICENSE for details 3 4import sys 5from twisted internet import reactor 6from twisted names srvconnect import SRVConnector 7from twisted words xish import domish 8from twisted words protocols jabber import xmlstream client jid 9 1 11class XMPPClientConnector SRVConnector 12 def init self reactor domain factory 13 SRVConnector init self reactor xmpp client domain factory 14 15 16 def pickServer self 17 host port SRVConnector pickServer self 18 19 if not self servers and not self orderedServers 2 no SRV record fall back 21 port 5222 22 23 return host port 524 625 726 27class Client object 28 def init self client jid secret 29 f client XMPPClientFactory client jid secret 3 f addBootstrap xmlstream STREAM CONNECTED EVENT self connected 31 f addBootstrap xmlstream STREAM END EVENT self disconnected 32 f addBootstrap xmlstream STREAM AUTHD EVENT self authenticated 33 f addBootstrap xmlstream INIT FAILED EVENT self init failed 34 connector XMPPClientConnector reactor client jid host f 35 connector connect 836 9 1 Example component service 11 12 import time 13 from twisted words protocols jabber import jid xmlstream 14 from twisted application import internet service 15 from twisted internet import interfaces defer reactor protocol 16 from twisted python import log 17 from twisted words xish import domish 18 from twisted words protocols jabber ijabber import IService 19 from twisted words protocols jabber import component 2 21 from zope interface import Interface implements 22 23 PRESENCE presence this is an global xpath query to use in an observer 24 MESSAGE message message xpath 25 IQ iq iq xpath 26 27 def create reply elem 28 switch the to and from attributes to reply to this element 29 NOTE see domish Element class to view more methods 3 frm elem from 31 elem from elem to 32 elem to frm 33 return elem 34 35 class LogService component Service 36 37 A service to log incoming and outgoing xml to and from our XMPP component 38 39 4 def transportConnected self xmlstream 41 xmlstream rawDataInFn self rawDataIn 42 xmlstream rawDataOutFn self rawDataOut 4337 4438 def rawDataIn self buf 45 log msg s RECV s str time time unicode buf utf 8 encode ascii replace 39 print RECV s unicode buf utf 8 encode ascii replace 4 4641 4742 def rawDataOut self buf 48 log msg s SEND s str time time unicode buf utf 8 encode ascii replace 43 print SEND s unicode buf utf 8 encode ascii replace 4944 5 45 51 class ExampleService component Service 52 53 Example XMPP component service using twisted words 54 Basic Echo We return the xml that is sent us 55 56 implements IService 46 def connected self xs 47 print Connected 5748 58 59 def componentConnected self xmlstream 6 61 This method is called when the componentConnected event gets called 62 That event gets called when we have connected and authenticated with the XMPP server 63 64 65 self jabberId xmlstream authenticator otherHost 66 self xmlstream xmlstream set the xmlstream so we can reuse it 67 68 xmlstream addObserver PRESENCE self onPresence 1 69 xmlstream addObserver IQ self onIq 1 7 xmlstream addObserver MESSAGE self onMessage 1 49 self xmlstream xs 715 72 def onMessage self msg 73 74 Act on the message stanza that has just been received 75 76 return to sender 77 msg create reply msg 78 self xmlstream send msg send the modified domish Element 79 8 81 def onIq self iq 82 83 Act on the iq stanza that has just been received 84 85 iq create reply iq 86 self xmlstream send iq 87 88 89 def onPresence self prs 9 91 Act on the presence stanza that has just been received 92 93 prs create reply prs 94 self xmlstream send prs 95 96 97 if name main 98 99 pass 1 1 1 1 2 1 3 1 4 1 5 1 6 51 Log all traffic 52 xs rawDataInFn self rawDataIn 53 xs rawDataOutFn self rawDataOut 54 55 56 def disconnected self xs 57 print Disconnected 58 59 reactor stop 6 61 62 def authenticated self xs 63 print Authenticated 64 65 presence domish Element None presence 66 xs send presence 67 68 wait 5 seconds then sign off 69 reactor callLater 5 xs sendFooter 7 71 72 def init failed self failure 73 print Initialization failed 74 print failure 75 76 self xmlstream sendFooter 77 78 79USERNAME nomaticbot1 gmail com 8 PASSWORD nomaticim321 81 82client jid jid JID USERNAME 83secret PASSWORD 84c Client client jid secret 85 86reactor run Note See TracChangeset for help on using the changeset viewer Download in other formats Unified Diff Zip Archive Powered by Trac 1 1 By Edgewall Software All content copyright 2 7 2 8 by LUCI http luci ics uci edu ", "_id": "http://djp3-pc2.ics.uci.edu/LUCICodeRepository/nomaticIM/changeset/745/", "title": "\n      changeset 745 \u2013 nomatic*im\n    ", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n  \n  \n\n  \n\n\n  <head>\n\t\t<title>\n      Changeset 745 \u2013 Nomatic*IM\n    </title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><link rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search\" /><link rel=\"prev\" href=\"/LUCICodeRepository/nomaticIM/changeset/744\" title=\"Changeset 744\" /><link rel=\"last\" href=\"/LUCICodeRepository/nomaticIM/changeset/1312\" title=\"Changeset 1312\" /><link rel=\"help\" href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\" /><link rel=\"alternate\" href=\"?format=diff&amp;new=745\" type=\"text/plain\" class=\"diff\" title=\"Unified Diff\" /><link rel=\"alternate\" href=\"?format=zip&amp;new=745\" type=\"application/zip\" class=\"zip\" title=\"Zip Archive\" /><link rel=\"next\" href=\"/LUCICodeRepository/nomaticIM/changeset/746\" title=\"Changeset 746\" /><link rel=\"start\" href=\"/LUCICodeRepository/nomaticIM/wiki\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/changeset.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/diff.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/code.css\" type=\"text/css\" /><link rel=\"first\" href=\"/LUCICodeRepository/nomaticIM/changeset/1\" title=\"Changeset 1\" /><link rel=\"shortcut icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link rel=\"icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link type=\"application/opensearchdescription+xml\" rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search/opensearch\" title=\"Search Nomatic*IM\" /><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/jquery.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/babel.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/messages/en_US.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/trac.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/search.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/diff.js\"></script><script type=\"text/javascript\">\n      jQuery(document).ready(function($) {\n        $(\".trac-toggledeleted\").show().click(function() {\n                  $(this).siblings().find(\".trac-deleted\").toggle();\n                  return false;\n        }).click();\n        $(\"#content\").find(\"li.entry h2 a\").parent().addAnchor(_(\"Link to this diff\"));\n      });\n    </script>\n\t</head>\n  <body>\n    <div id=\"banner\">\n      <div id=\"header\">\n        <a id=\"logo\" href=\"http://luci.ics.uci.edu/#code\"><img src=\"http://luci.ics.uci.edu/blog/archives/LUCIhorzTight.jpg\" alt=\"LUCI Code Repository\" /></a>\n      </div>\n      <form id=\"search\" action=\"/LUCICodeRepository/nomaticIM/search\" method=\"get\">\n        <div>\n          <label for=\"proj-search\">Search:</label>\n          <input type=\"text\" id=\"proj-search\" name=\"q\" size=\"18\" value=\"\" />\n          <input type=\"submit\" value=\"Search\" />\n        </div>\n      </form>\n      <div id=\"metanav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/login\">Login</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/prefs\">Preferences</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\">Help/Guide</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/about\">About Trac</a></li>\n    </ul>\n  </div>\n    </div>\n    <div id=\"mainnav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/wiki\">Wiki</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/timeline\">Timeline</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/roadmap\">Roadmap</a></li><li class=\"active\"><a href=\"/LUCICodeRepository/nomaticIM/browser\">Browse Source</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/report\">View Tickets</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/search\">Search</a></li>\n    </ul>\n  </div>\n    <div id=\"main\">\n      <div id=\"ctxtnav\" class=\"nav\">\n        <h2>Context Navigation</h2>\n        <ul>\n          <li class=\"first\"><span>&larr; <a class=\"prev\" href=\"/LUCICodeRepository/nomaticIM/changeset/744\" title=\"Changeset 744\">Previous Changeset</a></span></li><li class=\"last\"><span><a class=\"next\" href=\"/LUCICodeRepository/nomaticIM/changeset/746\" title=\"Changeset 746\">Next Changeset</a> &rarr;</span></li>\n        </ul>\n        <hr />\n      </div>\n    <div id=\"content\" class=\"changeset\">\n      <div id=\"title\">\n            <h1>Changeset 745</h1>\n      </div>\n      <form id=\"prefs\" action=\"\">\n        <div>\n          \n  <label for=\"style\">View differences</label>\n  <select id=\"style\" name=\"style\">\n    <option selected=\"selected\" value=\"inline\">inline</option>\n    <option value=\"sidebyside\">side by side</option>\n  </select>\n  <div class=\"field\">\n    <label><input type=\"radio\" name=\"contextall\" value=\"0\" checked=\"checked\" />\n             Show</label>\n      <label><input type=\"text\" name=\"contextlines\" id=\"contextlines\" size=\"2\" maxlength=\"3\" value=\"2\" />\n             lines around each change</label><br />\n    <label><input type=\"radio\" name=\"contextall\" value=\"1\" />\n           Show the changes in full context</label>\n  </div>\n  <fieldset id=\"ignore\">\n    <legend>Ignore:</legend>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignoreblanklines\" name=\"ignoreblanklines\" />\n      <label for=\"ignoreblanklines\">Blank lines</label>\n    </div>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignorecase\" name=\"ignorecase\" />\n      <label for=\"ignorecase\">Case changes</label>\n    </div>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignorewhitespace\" name=\"ignorewhitespace\" />\n      <label for=\"ignorewhitespace\">White space changes</label>\n    </div>\n  </fieldset>\n  <div class=\"buttons\">\n    <input type=\"submit\" name=\"update\" value=\"Update\" />\n  </div>\n\n        </div>\n      </form>\n      <dl id=\"overview\">\n          <dt class=\"property time\">Timestamp:</dt>\n          <dd class=\"time\">\n             Feb 18, 2008, 4:15:25 PM\n             (<a class=\"timeline\" href=\"/LUCICodeRepository/nomaticIM/timeline?from=2008-02-18T16%3A15%3A25-08%3A00&amp;precision=second\" title=\"See timeline at Feb 18, 2008, 4:15:25 PM\">7 years</a> ago)\n          </dd>\n          <dt class=\"property author\">Author:</dt>\n          <dd class=\"author\">cbaker</dd>\n          <dt class=\"property message\">Message:</dt>\n          <dd class=\"message searchable\">\n            \n            \n              <p>\nrestructured buddy bot package structure. jabber bot can sign on/off. subversion doesn't support moving files so this will be a big commit, sorry<br />\n</p>\n\n            \n            \n          </dd>\n          <dt class=\"property location\">Location:</dt>\n          <dd class=\"searchable\"><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src?rev=745\">nomatic/trunk/buddy_bots/src</a></dd>\n        <dt class=\"property files\">\n          Files:\n        </dt>\n        <dd class=\"files\">\n          <div class=\"legend\" id=\"file-legend\">\n            <dl>\n              <dt class=\"add\"></dt><dd>28 added</dd>\n              <dt class=\"mod\"></dt><dd>1 edited</dd>\n              <dt class=\"mv\"></dt><dd>4 moved</dd>\n            </dl>\n          </div>\n          <br />\n          <ul>\n            <li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src?rev=745\">\n              .\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"mv\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot?rev=745\">\n              jabber_bot\n            </a>\n          <span class=\"comment\">(moved)</span>\n            <small><em>(moved from <a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/jabber_bot?rev=712\" title=\"Show original file (revision 744)\">\n                nomatic/trunk/buddy_bots/jabber_bot</a>)</em></small>\n            </li><li>\n          <div class=\"mod\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=745\">\n              jabber_bot/nomatic_jabber_bot.py\n            </a>\n          <span class=\"comment\">(modified)</span>\n              (<a title=\"Show differences\" href=\"#file2\">1 diff</a>)\n            </li><li>\n          <div class=\"mv\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/oscar_bot?rev=745\">\n              oscar_bot\n            </a>\n          <span class=\"comment\">(moved)</span>\n            <small><em>(moved from <a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/oscar_bot?rev=712\" title=\"Show original file (revision 744)\">\n                nomatic/trunk/buddy_bots/oscar_bot</a>)</em></small>\n            </li><li>\n          <div class=\"mv\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted?rev=745\">\n              twisted\n            </a>\n          <span class=\"comment\">(moved)</span>\n            <small><em>(moved from <a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/twisted?rev=712\" title=\"Show original file (revision 744)\">\n                nomatic/trunk/buddy_bots/twisted</a>)</em></small>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names?rev=745\">\n              twisted/names\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/__init__.py?rev=745\">\n              twisted/names/__init__.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/_version.py?rev=745\">\n              twisted/names/_version.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/authority.py?rev=745\">\n              twisted/names/authority.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/cache.py?rev=745\">\n              twisted/names/cache.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/client.py?rev=745\">\n              twisted/names/client.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/common.py?rev=745\">\n              twisted/names/common.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/dns.py?rev=745\">\n              twisted/names/dns.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/error.py?rev=745\">\n              twisted/names/error.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/hosts.py?rev=745\">\n              twisted/names/hosts.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/resolve.py?rev=745\">\n              twisted/names/resolve.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/root.py?rev=745\">\n              twisted/names/root.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/secondary.py?rev=745\">\n              twisted/names/secondary.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/server.py?rev=745\">\n              twisted/names/server.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/srvconnect.py?rev=745\">\n              twisted/names/srvconnect.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/tap.py?rev=745\">\n              twisted/names/tap.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/test?rev=745\">\n              twisted/names/test\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/test/__init__.py?rev=745\">\n              twisted/names/test/__init__.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/test/test_cache.py?rev=745\">\n              twisted/names/test/test_cache.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/test/test_client.py?rev=745\">\n              twisted/names/test/test_client.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/test/test_dns.py?rev=745\">\n              twisted/names/test/test_dns.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/test/test_names.py?rev=745\">\n              twisted/names/test/test_names.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/test/test_rootresolve.py?rev=745\">\n              twisted/names/test/test_rootresolve.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/topfiles?rev=745\">\n              twisted/names/topfiles\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/topfiles/NEWS?rev=745\">\n              twisted/names/topfiles/NEWS\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/topfiles/README?rev=745\">\n              twisted/names/topfiles/README\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"add\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/twisted/names/topfiles/setup.py?rev=745\">\n              twisted/names/topfiles/setup.py\n            </a>\n          <span class=\"comment\">(added)</span>\n            </li><li>\n          <div class=\"mv\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/zope?rev=745\">\n              zope\n            </a>\n          <span class=\"comment\">(moved)</span>\n            <small><em>(moved from <a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/zope?rev=712\" title=\"Show original file (revision 744)\">\n                nomatic/trunk/buddy_bots/zope</a>)</em></small>\n            </li>\n          </ul>\n        </dd>\n      </dl>\n      <div class=\"diff\">\n        <div class=\"legend\" id=\"diff-legend\">\n          <h3>Legend:</h3>\n          <dl>\n            <dt class=\"unmod\"></dt><dd>Unmodified</dd>\n            <dt class=\"add\"></dt><dd>Added</dd>\n            <dt class=\"rem\"></dt><dd>Removed</dd>\n          </dl>\n        </div>\n        <div class=\"diff\">\n  <ul class=\"entries\">\n      <li class=\"entry\">\n        <h2 id=\"file2\">\n          <a href=\"/LUCICodeRepository/nomaticIM/changeset/745/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\" title=\"Show the changeset 745 restricted to nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py\">nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py</a>\n        </h2>\n        <table class=\"trac-diff inline\" summary=\"Differences\" cellspacing=\"0\">\n              <colgroup><col class=\"lineno\" /><col class=\"lineno\" /><col class=\"content\" /></colgroup>\n              <thead>\n                <tr>\n                  <th title=\"Revision 712\">\n                    <a title=\"Show revision 712 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/jabber_bot/nomatic_jabber_bot.py?rev=712#L1\">\n                      r712</a>\n                  </th>\n                  <th title=\"Revision 745\">\n                    <a title=\"Show revision 745 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/src/jabber_bot/nomatic_jabber_bot.py?rev=745#L1\">\n                      r745</a>\n                  </th>\n                  <td>\u00a0</td>\n                </tr>\n              </thead>\n            <tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>1</th><th>\u00a0</th><td class=\"l\"><span>\"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>2</th><th>\u00a0</th><td class=\"l\"><span>Example of a twisted jabber client from</span>\u00a0</td>\n                      </tr><tr>\n                        <th>3</th><th>\u00a0</th><td class=\"l\"><span>http://www.butterfat.net/wiki/Documentation/TwistedJabberComponentExample</span>\u00a0</td>\n                      </tr><tr>\n                        <th>4</th><th>\u00a0</th><td class=\"l\"><span>\"\"\"</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>1</th><td class=\"r\"><span># Copyright (c) 2001-2006 Twisted Matrix Laboratories.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>2</th><td class=\"r\"><span># See LICENSE for details.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>3</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>4</th><td class=\"r\"><span>import sys</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>5</th><td class=\"r\"><span>from twisted.internet import reactor</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>6</th><td class=\"r\"><span>from twisted.names.srvconnect import SRVConnector</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>7</th><td class=\"r\"><span>from twisted.words.xish import domish</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>8</th><td class=\"r\"><span>from twisted.words.protocols.jabber import xmlstream, client, jid</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>9</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>10</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>11</th><td class=\"r\"><span>class XMPPClientConnector(SRVConnector):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>12</th><td class=\"r\"><span>&nbsp; &nbsp; def __init__(self, reactor, domain, factory):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>13</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; SRVConnector.__init__(self, reactor, 'xmpp-client', domain, factory)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>14</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>15</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>16</th><td class=\"r\"><span>&nbsp; &nbsp; def pickServer(self):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>17</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; host, port = SRVConnector.pickServer(self)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>18</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>19</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if not self.servers and not self.orderedServers:</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>20</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # no SRV record, fall back..</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>21</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; port = 5222</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>22</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>23</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return host, port</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>5</th><th>24</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>6</th><th>25</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>7</th><th>26</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"first\">\n                          <th>\u00a0</th><th>27</th><td class=\"r\"><ins>class Client(object):</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>28</th><td class=\"r\"><ins>&nbsp; &nbsp; def __init__(self, client_jid, secret):</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>29</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; f = client.XMPPClientFactory(client_jid, secret)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>30</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; f.addBootstrap(xmlstream.STREAM_CONNECTED_EVENT, self.connected)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>31</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; f.addBootstrap(xmlstream.STREAM_END_EVENT, self.disconnected)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>32</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; f.addBootstrap(xmlstream.STREAM_AUTHD_EVENT, self.authenticated)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>33</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; f.addBootstrap(xmlstream.INIT_FAILED_EVENT, self.init_failed)</ins>\u00a0</td>\n                  </tr><tr>\n                          <th>\u00a0</th><th>34</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; connector = XMPPClientConnector(reactor, client_jid.host, f)</ins>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>\u00a0</th><th>35</th><td class=\"r\"><ins>&nbsp; &nbsp; &nbsp; &nbsp; connector.connect()</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>8</th><th>36</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"first\">\n                          <th>9</th><th>\u00a0</th><td class=\"l\"><del>\"\"\"</del>\u00a0</td>\n                  </tr><tr>\n                          <th>10</th><th>\u00a0</th><td class=\"l\"><del>&nbsp;Example component service.</del>\u00a0</td>\n                  </tr><tr>\n                          <th>11</th><th>\u00a0</th><td class=\"l\"><del>\"\"\"</del>\u00a0</td>\n                  </tr><tr>\n                          <th>12</th><th>\u00a0</th><td class=\"l\"><del>import time</del>\u00a0</td>\n                  </tr><tr>\n                          <th>13</th><th>\u00a0</th><td class=\"l\"><del>from twisted.words.protocols.jabber import jid, xmlstream</del>\u00a0</td>\n                  </tr><tr>\n                          <th>14</th><th>\u00a0</th><td class=\"l\"><del>from twisted.application import internet, service</del>\u00a0</td>\n                  </tr><tr>\n                          <th>15</th><th>\u00a0</th><td class=\"l\"><del>from twisted.internet import interfaces, defer, reactor, protocol</del>\u00a0</td>\n                  </tr><tr>\n                          <th>16</th><th>\u00a0</th><td class=\"l\"><del>from twisted.python import log</del>\u00a0</td>\n                  </tr><tr>\n                          <th>17</th><th>\u00a0</th><td class=\"l\"><del>from twisted.words.xish import domish</del>\u00a0</td>\n                  </tr><tr>\n                          <th>18</th><th>\u00a0</th><td class=\"l\"><del>from twisted.words.protocols.jabber.ijabber import IService</del>\u00a0</td>\n                  </tr><tr>\n                          <th>19</th><th>\u00a0</th><td class=\"l\"><del>from twisted.words.protocols.jabber import component</del>\u00a0</td>\n                  </tr><tr>\n                          <th>20</th><th>\u00a0</th><td class=\"l\"><del></del>\u00a0</td>\n                  </tr><tr>\n                          <th>21</th><th>\u00a0</th><td class=\"l\"><del>from zope.interface import Interface, implements</del>\u00a0</td>\n                  </tr><tr>\n                          <th>22</th><th>\u00a0</th><td class=\"l\"><del></del>\u00a0</td>\n                  </tr><tr>\n                          <th>23</th><th>\u00a0</th><td class=\"l\"><del>PRESENCE = '/presence' # this is an global xpath query to use in an observer</del>\u00a0</td>\n                  </tr><tr>\n                          <th>24</th><th>\u00a0</th><td class=\"l\"><del>MESSAGE&nbsp; = '/message'&nbsp; # message xpath </del>\u00a0</td>\n                  </tr><tr>\n                          <th>25</th><th>\u00a0</th><td class=\"l\"><del>IQ&nbsp; &nbsp; &nbsp; &nbsp;= '/iq'&nbsp; &nbsp; &nbsp; &nbsp;# iq xpath</del>\u00a0</td>\n                  </tr><tr>\n                          <th>26</th><th>\u00a0</th><td class=\"l\"><del></del>\u00a0</td>\n                  </tr><tr>\n                          <th>27</th><th>\u00a0</th><td class=\"l\"><del>def create_reply(elem):</del>\u00a0</td>\n                  </tr><tr>\n                          <th>28</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; \"\"\" switch the 'to' and 'from' attributes to reply to this element \"\"\"</del>\u00a0</td>\n                  </tr><tr>\n                          <th>29</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; # NOTE - see domish.Element class to view more methods </del>\u00a0</td>\n                  </tr><tr>\n                          <th>30</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; frm = elem['from']</del>\u00a0</td>\n                  </tr><tr>\n                          <th>31</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; elem['from'] = elem['to']</del>\u00a0</td>\n                  </tr><tr>\n                          <th>32</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; elem['to']&nbsp; &nbsp;= frm</del>\u00a0</td>\n                  </tr><tr>\n                          <th>33</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; return elem</del>\u00a0</td>\n                  </tr><tr>\n                          <th>34</th><th>\u00a0</th><td class=\"l\"><del></del>\u00a0</td>\n                  </tr><tr>\n                          <th>35</th><th>\u00a0</th><td class=\"l\"><del>class LogService(component.Service):</del>\u00a0</td>\n                  </tr><tr>\n                          <th>36</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; \"\"\"</del>\u00a0</td>\n                  </tr><tr>\n                          <th>37</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; A service to log incoming and outgoing xml to and from our XMPP component.</del>\u00a0</td>\n                  </tr><tr>\n                          <th>38</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; \"\"\"</del>\u00a0</td>\n                  </tr><tr>\n                          <th>39</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; </del>\u00a0</td>\n                  </tr><tr>\n                          <th>40</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; def transportConnected(self, xmlstream):</del>\u00a0</td>\n                  </tr><tr>\n                          <th>41</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; xmlstream.rawDataInFn = self.rawDataIn</del>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>42</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; xmlstream.rawDataOutFn = self.rawDataOut</del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>43</th><th>37</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>44</th><th>38</th><td class=\"l\"><span>&nbsp; &nbsp; def rawDataIn(self, buf):</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>45</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; log.msg(\"%s - RECV: %s\" % (str(time.time()), unicode(buf, 'utf-8').encode('ascii', 'replace')))</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>39</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print \"RECV: %s\" % unicode(buf, 'utf-8').encode('ascii', 'replace')</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>40</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>46</th><th>41</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>47</th><th>42</th><td class=\"l\"><span>&nbsp; &nbsp; def rawDataOut(self, buf):</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>48</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; <del>log.msg(\"%s - SEND: %s\" % (str(time.time()), unicode(buf, 'utf-8').encode('ascii', 'replace'))</del>)</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>43</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; <ins>print \"SEND: %s\" % unicode(buf, 'utf-8').encode('ascii', 'replace'</ins>)</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>49</th><th>44</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>50</th><th>45</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>51</th><th>\u00a0</th><td class=\"l\"><span>class ExampleService(component.Service):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>52</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>53</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; Example XMPP component service using twisted words.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>54</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; Basic Echo - We return the xml that is sent us.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>55</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>56</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; implements(IService)</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>46</th><td class=\"r\"><span>&nbsp; &nbsp; def connected(self, xs):</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>47</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print 'Connected.'</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>57</th><th>48</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>58</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>59</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; def componentConnected(self, xmlstream):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>60</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>61</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; This method is called when the componentConnected event gets called.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>62</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; That event gets called when we have connected and authenticated with the XMPP server.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>63</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>64</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>65</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self.jabberId = xmlstream.authenticator.otherHost</span>\u00a0</td>\n                      </tr><tr>\n                        <th>66</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self.xmlstream = xmlstream # set the xmlstream so we can reuse it</span>\u00a0</td>\n                      </tr><tr>\n                        <th>67</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>68</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xmlstream.addObserver(PRESENCE, self.onPresence, 1)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>69</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xmlstream.addObserver(IQ, self.onIq, 1)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>70</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xmlstream.addObserver(MESSAGE, self.onMessage, 1)</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>49</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self.xmlstream = xs</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>71</th><th>50</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>72</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; def onMessage(self, msg):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>73</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>74</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; Act on the message stanza that has just been received.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>75</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>76</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; # return to sender</span>\u00a0</td>\n                      </tr><tr>\n                        <th>77</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; msg = create_reply(msg)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>78</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self.xmlstream.send(msg) # send the modified domish.Element </span>\u00a0</td>\n                      </tr><tr>\n                        <th>79</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>80</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>81</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; def onIq(self, iq):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>82</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>83</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; Act on the iq stanza that has just been received.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>84</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>85</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; iq = create_reply(iq)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>86</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self.xmlstream.send(iq)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>87</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>88</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>89</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; def onPresence(self, prs):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>90</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>91</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; Act on the presence stanza that has just been received.</span>\u00a0</td>\n                      </tr><tr>\n                        <th>92</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; \"\"\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>93</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; prs = create_reply(prs)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>94</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self.xmlstream.send(prs)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>95</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>96</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>97</th><th>\u00a0</th><td class=\"l\"><span>if __name__ == '__main__': </span>\u00a0</td>\n                      </tr><tr>\n                        <th>98</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>99</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; pass</span>\u00a0</td>\n                      </tr><tr>\n                        <th>100</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>101</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>102</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>103</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>104</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>105</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>106</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; </span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>51</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; # Log all traffic</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>52</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xs.rawDataInFn = self.rawDataIn</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>53</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xs.rawDataOutFn = self.rawDataOut</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>54</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>55</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>56</th><td class=\"r\"><span>&nbsp; &nbsp; def disconnected(self, xs):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>57</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print 'Disconnected.'</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>58</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>59</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; reactor.stop()</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>60</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>61</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>62</th><td class=\"r\"><span>&nbsp; &nbsp; def authenticated(self, xs):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>63</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print \"Authenticated.\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>64</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>65</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; presence = domish.Element((None, 'presence'))</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>66</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; xs.send(presence)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>67</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>68</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; # wait 5 seconds, then sign off</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>69</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; reactor.callLater(5, xs.sendFooter)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>70</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>71</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>72</th><td class=\"r\"><span>&nbsp; &nbsp; def init_failed(self, failure):</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>73</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print \"Initialization failed.\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>74</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; print failure</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>75</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>76</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; self.xmlstream.sendFooter()</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>77</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>78</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>79</th><td class=\"r\"><span>USERNAME = \"nomaticbot1@gmail.com\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>80</th><td class=\"r\"><span>PASSWORD = \"nomaticim321\"</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>81</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>82</th><td class=\"r\"><span>client_jid = jid.JID(USERNAME)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>83</th><td class=\"r\"><span>secret = PASSWORD</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>84</th><td class=\"r\"><span>c = Client(client_jid, secret)</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>85</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>86</th><td class=\"r\"><span>reactor.run()</span>\u00a0</td>\n                      </tr>\n            </tbody>\n        </table>\n      </li>\n  </ul>\n</div>\n        <div id=\"help\"><strong>Note:</strong> See <a href=\"/LUCICodeRepository/nomaticIM/wiki/TracChangeset\">TracChangeset</a>\n          for help on using the changeset viewer.</div>\n      </div>\n    </div>\n    <div id=\"altlinks\">\n      <h3>Download in other formats:</h3>\n      <ul>\n        <li class=\"first\">\n          <a rel=\"nofollow\" href=\"?format=diff&amp;new=745\" class=\"diff\">Unified Diff</a>\n        </li><li class=\"last\">\n          <a rel=\"nofollow\" href=\"?format=zip&amp;new=745\" class=\"zip\">Zip Archive</a>\n        </li>\n      </ul>\n    </div>\n    </div>\n    <div id=\"footer\" lang=\"en\" xml:lang=\"en\"><hr />\n      <a id=\"tracpowered\" href=\"http://trac.edgewall.org/\"><img src=\"/LUCICodeRepository/nomaticIM/chrome/common/trac_logo_mini.png\" height=\"30\" width=\"107\" alt=\"Trac Powered\" /></a>\n      <p class=\"left\">Powered by <a href=\"/LUCICodeRepository/nomaticIM/about\"><strong>Trac 1.0.1</strong></a><br />\n        By <a href=\"http://www.edgewall.org/\">Edgewall Software</a>.</p>\n      <p class=\"right\">All content copyright 2007-2008 by LUCI <br /><a href=\"http://luci.ics.uci.edu/\">http://luci.ics.uci.edu/</a></p>\n    </div>\n\t\t<div id=\"sitefooter\">\n\t\t\t<script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\n\t\t\t</script>\n\t\t\t<script type=\"text/javascript\">\n\t\t\t\t_uacct = \"UA-338915-2\";\n\t\t\t\turchinTracker();\n\t\t\t</script>\n\t\t</div>\n\t</body>\n</html>", "id": 40237.0}