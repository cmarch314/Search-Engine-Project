{"text": "1 package swirl workspace 2 3 import junit framework Test 4 import junit framework TestSuite 5 6 import org apache commons httpclient HttpClient 7 import org apache commons httpclient HttpMethod 8 import org apache commons httpclient methods DeleteMethod 9 import org apache commons logging Log 1 import org apache commons logging LogFactory 11 import org apache webdav lib methods LockMethod 12 import org apache webdav lib methods UnlockMethod 13 14 15 TODO 16 17 author author 18 version Revision 1 3 19 2 public class UnlockCommandTest extends CommandTest 21 22 TODO 23 public static final String FILE lock file 24 25 TODO 26 public static String fileLockToken 27 28 TODO 29 private Log log 3 31 TODO 32 private String owner LockTest 33 34 TODO 35 private int depth LockMethod DEPTH INFINITY 36 37 TODO 38 private int scope LockMethod SCOPE EXCLUSIVE 39 4 TODO 41 private int timeout LockMethod TIMEOUT INFINITY 42 43 44 Creates a new UnlockCommandTest object 45 46 param name TODO 47 48 throws Exception TODO 49 5 public UnlockCommandTest String name throws Exception 51 52 super name 53 log LogFactory getLog this getClass 54 55 56 57 TODO 58 59 return TODO 6 61 public static Test suite 62 63 TestSuite suite new TestSuite 64 65 suite addTestSuite UnlockCommandTest class 66 67 suite addTest new LockCommandTest testGoodExclusiveUnlock 68 suite addTest new LockCommandTest testGoodSharedUnlock 69 suite addTest new LockCommandTest testGoodUnockCollection 7 return wrapSuite suite 71 72 73 74 TODO 75 76 public void tearDown 77 78 HttpClient client new HttpClient 79 8 try 81 82 DeleteMethod method new DeleteMethod SlideTestSetup LOCALHOST 83 SlideTestSetup SLIDE 84 FILE 85 int retVal client executeMethod method 86 87 if log isDebugEnabled 88 89 log debug method retVal method getStatusText 9 91 92 catch Exception ex 93 94 log error attempting to tearDown LockCommand test fixture ex 95 96 97 98 good tests 99 public void testGoodExclusiveUnlock throws Exception 1 1 1 String uri SlideTestSetup LOCALHOST SlideTestSetup SWIRL FILE 1 2 1 3 create a file 1 4 PutCommandTest put new PutCommandTest testPut 1 5 1 6 put go uri 2 1 1 7 1 8 lock the file 1 9 HttpClient client new HttpClient 11 LockMethod lockMethod new LockMethod uri 111 String lockinfo LockCommandTest getLockInfo scope owner 112 113 lockMethod setDepth depth 114 lockMethod setTimeout timeout 115 lockMethod setRequestBody lockinfo 116 117 int retVal client executeMethod lockMethod 118 119 fileLockToken lockMethod getLockToken 12 121 if log isDebugEnabled 122 123 log debug Lock Token is fileLockToken 124 125 126 assertNotNull fileLockToken 127 128 unlock the file 129 go uri 2 13 131 132 133 TODO 134 135 throws Exception TODO 136 137 public void testGoodSharedUnlock throws Exception 138 139 String uri SlideTestSetup LOCALHOST SlideTestSetup SWIRL FILE 14 141 create a file 142 PutCommandTest put new PutCommandTest testPut 143 144 put go uri 2 1 145 146 lock the file 147 HttpClient client new HttpClient 148 LockMethod lockMethod new LockMethod uri 149 15 scope LockMethod SCOPE SHARED 151 152 String lockinfo LockCommandTest getLockInfo scope owner 153 154 lockMethod setDepth depth 155 lockMethod setTimeout timeout 156 lockMethod setRequestBody lockinfo 157 158 int retVal client executeMethod lockMethod 159 16 fileLockToken lockMethod getLockToken 161 162 if log isDebugEnabled 163 164 log debug Lock Token is fileLockToken 165 166 167 assertNotNull fileLockToken 168 169 unlock the file 17 go uri 2 171 172 173 174 TODO 175 176 param uri TODO 177 178 return TODO 179 18 protected HttpMethod createMethod String uri 181 182 UnlockMethod unlockMethod new UnlockMethod uri 183 184 unlockMethod setLockToken fileLockToken 185 186 return unlockMethod 187 188 This page was automatically generated by Maven", "_id": "http://drzaius.ics.uci.edu/~swirl/impromptu-0.20/xref-test/swirl/workspace/UnlockCommandTest.html", "title": "unlockcommandtest xref", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=ISO-8859-1\" /><title>UnlockCommandTest xref</title>\n<link type=\"text/css\" rel=\"stylesheet\" href=\"../../stylesheet.css\" />\n</head>\n<body>\n<pre>\n\n<a name=\"1\" href=\"#1\">1</a>   <strong>package</strong> <a href=\"../../swirl/workspace/package-summary.html\">swirl.workspace</a>;\n<a name=\"2\" href=\"#2\">2</a>   \n<a name=\"3\" href=\"#3\">3</a>   <strong>import</strong> junit.framework.Test;\n<a name=\"4\" href=\"#4\">4</a>   <strong>import</strong> junit.framework.TestSuite;\n<a name=\"5\" href=\"#5\">5</a>   \n<a name=\"6\" href=\"#6\">6</a>   <strong>import</strong> org.apache.commons.httpclient.HttpClient;\n<a name=\"7\" href=\"#7\">7</a>   <strong>import</strong> org.apache.commons.httpclient.HttpMethod;\n<a name=\"8\" href=\"#8\">8</a>   <strong>import</strong> org.apache.commons.httpclient.methods.DeleteMethod;\n<a name=\"9\" href=\"#9\">9</a>   <strong>import</strong> org.apache.commons.logging.Log;\n<a name=\"10\" href=\"#10\">10</a>  <strong>import</strong> org.apache.commons.logging.LogFactory;\n<a name=\"11\" href=\"#11\">11</a>  <strong>import</strong> org.apache.webdav.lib.methods.LockMethod;\n<a name=\"12\" href=\"#12\">12</a>  <strong>import</strong> org.apache.webdav.lib.methods.UnlockMethod;\n<a name=\"13\" href=\"#13\">13</a>  \n<a name=\"14\" href=\"#14\">14</a>  <em>/**<em>*</em></em>\n<a name=\"15\" href=\"#15\">15</a>  <em> * TODO</em>\n<a name=\"16\" href=\"#16\">16</a>  <em> *</em>\n<a name=\"17\" href=\"#17\">17</a>  <em> * @author $author$</em>\n<a name=\"18\" href=\"#18\">18</a>  <em> * @version $Revision: 1.3 $</em>\n<a name=\"19\" href=\"#19\">19</a>  <em> */</em>\n<a name=\"20\" href=\"#20\">20</a>  <strong>public</strong> <strong>class</strong> <a href=\"../../swirl/workspace/UnlockCommandTest.html\">UnlockCommandTest</a> <strong>extends</strong> <a href=\"../../swirl/workspace/CommandTest.html\">CommandTest</a>\n<a name=\"21\" href=\"#21\">21</a>  {\n<a name=\"22\" href=\"#22\">22</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"23\" href=\"#23\">23</a>      <strong>public</strong> <strong>static</strong> <strong>final</strong> String FILE = <span class=\"string\">\"lock-file\"</span>;\n<a name=\"24\" href=\"#24\">24</a>  \n<a name=\"25\" href=\"#25\">25</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"26\" href=\"#26\">26</a>      <strong>public</strong> <strong>static</strong> String fileLockToken;\n<a name=\"27\" href=\"#27\">27</a>  \n<a name=\"28\" href=\"#28\">28</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"29\" href=\"#29\">29</a>      <strong>private</strong> Log log;\n<a name=\"30\" href=\"#30\">30</a>  \n<a name=\"31\" href=\"#31\">31</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"32\" href=\"#32\">32</a>      <strong>private</strong> String owner = <span class=\"string\">\"LockTest\"</span>;\n<a name=\"33\" href=\"#33\">33</a>  \n<a name=\"34\" href=\"#34\">34</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"35\" href=\"#35\">35</a>      <strong>private</strong> <strong>int</strong> depth = LockMethod.DEPTH_INFINITY;\n<a name=\"36\" href=\"#36\">36</a>  \n<a name=\"37\" href=\"#37\">37</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"38\" href=\"#38\">38</a>      <strong>private</strong> <strong>int</strong> scope = LockMethod.SCOPE_EXCLUSIVE;\n<a name=\"39\" href=\"#39\">39</a>  \n<a name=\"40\" href=\"#40\">40</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"41\" href=\"#41\">41</a>      <strong>private</strong> <strong>int</strong> timeout = LockMethod.TIMEOUT_INFINITY;\n<a name=\"42\" href=\"#42\">42</a>  \n<a name=\"43\" href=\"#43\">43</a>      <em>/**<em>*</em></em>\n<a name=\"44\" href=\"#44\">44</a>  <em>     * Creates a new UnlockCommandTest object.</em>\n<a name=\"45\" href=\"#45\">45</a>  <em>     *</em>\n<a name=\"46\" href=\"#46\">46</a>  <em>     * @param name TODO</em>\n<a name=\"47\" href=\"#47\">47</a>  <em>     *</em>\n<a name=\"48\" href=\"#48\">48</a>  <em>     * @throws Exception TODO</em>\n<a name=\"49\" href=\"#49\">49</a>  <em>     */</em>\n<a name=\"50\" href=\"#50\">50</a>      <strong>public</strong> <a href=\"../../swirl/workspace/UnlockCommandTest.html\">UnlockCommandTest</a>(String name) throws Exception\n<a name=\"51\" href=\"#51\">51</a>      {\n<a name=\"52\" href=\"#52\">52</a>          <strong>super</strong>(name);\n<a name=\"53\" href=\"#53\">53</a>          log = LogFactory.getLog(<strong>this</strong>.getClass());\n<a name=\"54\" href=\"#54\">54</a>      }\n<a name=\"55\" href=\"#55\">55</a>  \n<a name=\"56\" href=\"#56\">56</a>      <em>/**<em>*</em></em>\n<a name=\"57\" href=\"#57\">57</a>  <em>     * TODO</em>\n<a name=\"58\" href=\"#58\">58</a>  <em>     *</em>\n<a name=\"59\" href=\"#59\">59</a>  <em>     * @return TODO</em>\n<a name=\"60\" href=\"#60\">60</a>  <em>     */</em>\n<a name=\"61\" href=\"#61\">61</a>      <strong>public</strong> <strong>static</strong> Test suite()\n<a name=\"62\" href=\"#62\">62</a>      {\n<a name=\"63\" href=\"#63\">63</a>          TestSuite suite = <strong>new</strong> TestSuite();\n<a name=\"64\" href=\"#64\">64</a>  \n<a name=\"65\" href=\"#65\">65</a>          suite.addTestSuite(UnlockCommandTest.<strong>class</strong>);\n<a name=\"66\" href=\"#66\">66</a>  \n<a name=\"67\" href=\"#67\">67</a>          <em class=\"comment\">//suite.addTest(new LockCommandTest(\"testGoodExclusiveUnlock\"));</em>\n<a name=\"68\" href=\"#68\">68</a>          <em class=\"comment\">//suite.addTest(new LockCommandTest(\"testGoodSharedUnlock\"));</em>\n<a name=\"69\" href=\"#69\">69</a>          <em class=\"comment\">//suite.addTest(new LockCommandTest(\"testGoodUnockCollection\"));\t\t\t</em>\n<a name=\"70\" href=\"#70\">70</a>          <strong>return</strong> wrapSuite(suite);\n<a name=\"71\" href=\"#71\">71</a>      }\n<a name=\"72\" href=\"#72\">72</a>  \n<a name=\"73\" href=\"#73\">73</a>      <em>/**<em>*</em></em>\n<a name=\"74\" href=\"#74\">74</a>  <em>     * TODO</em>\n<a name=\"75\" href=\"#75\">75</a>  <em>     */</em>\n<a name=\"76\" href=\"#76\">76</a>      <strong>public</strong> <strong>void</strong> tearDown()\n<a name=\"77\" href=\"#77\">77</a>      {\n<a name=\"78\" href=\"#78\">78</a>          HttpClient client = <strong>new</strong> HttpClient();\n<a name=\"79\" href=\"#79\">79</a>  \n<a name=\"80\" href=\"#80\">80</a>          <strong>try</strong>\n<a name=\"81\" href=\"#81\">81</a>          {\n<a name=\"82\" href=\"#82\">82</a>              DeleteMethod method = <strong>new</strong> DeleteMethod(SlideTestSetup.LOCALHOST\n<a name=\"83\" href=\"#83\">83</a>                                                     + SlideTestSetup.SLIDE\n<a name=\"84\" href=\"#84\">84</a>                                                     + FILE);\n<a name=\"85\" href=\"#85\">85</a>              <strong>int</strong> retVal = client.executeMethod(method);\n<a name=\"86\" href=\"#86\">86</a>  \n<a name=\"87\" href=\"#87\">87</a>              <strong>if</strong>(log.isDebugEnabled())\n<a name=\"88\" href=\"#88\">88</a>              {\n<a name=\"89\" href=\"#89\">89</a>                  log.debug(<span class=\"string\">\"method: \"</span> + retVal + method.getStatusText());\n<a name=\"90\" href=\"#90\">90</a>              }\n<a name=\"91\" href=\"#91\">91</a>          }\n<a name=\"92\" href=\"#92\">92</a>          <strong>catch</strong>(Exception ex)\n<a name=\"93\" href=\"#93\">93</a>          {\n<a name=\"94\" href=\"#94\">94</a>              log.error(<span class=\"string\">\"attempting to tearDown LockCommand test fixture\"</span>, ex);\n<a name=\"95\" href=\"#95\">95</a>          }\n<a name=\"96\" href=\"#96\">96</a>      }\n<a name=\"97\" href=\"#97\">97</a>  \n<a name=\"98\" href=\"#98\">98</a>      <em class=\"comment\">// good tests</em>\n<a name=\"99\" href=\"#99\">99</a>      <strong>public</strong> <strong>void</strong> testGoodExclusiveUnlock() throws Exception\n<a name=\"100\" href=\"#100\">100</a>     {\n<a name=\"101\" href=\"#101\">101</a>         String uri = SlideTestSetup.LOCALHOST + SlideTestSetup.SWIRL + FILE;\n<a name=\"102\" href=\"#102\">102</a> \n<a name=\"103\" href=\"#103\">103</a>         <em class=\"comment\">// create a file</em>\n<a name=\"104\" href=\"#104\">104</a>         <a href=\"../../swirl/workspace/PutCommandTest.html\">PutCommandTest</a> put = <strong>new</strong> <a href=\"../../swirl/workspace/PutCommandTest.html\">PutCommandTest</a>(<span class=\"string\">\"testPut\"</span>);\n<a name=\"105\" href=\"#105\">105</a> \n<a name=\"106\" href=\"#106\">106</a>         put.go(uri, 201);\n<a name=\"107\" href=\"#107\">107</a> \n<a name=\"108\" href=\"#108\">108</a>         <em class=\"comment\">// lock the file</em>\n<a name=\"109\" href=\"#109\">109</a>         HttpClient client = <strong>new</strong> HttpClient();\n<a name=\"110\" href=\"#110\">110</a>         LockMethod lockMethod = <strong>new</strong> LockMethod(uri);\n<a name=\"111\" href=\"#111\">111</a>         String lockinfo = LockCommandTest.getLockInfo(scope, owner);\n<a name=\"112\" href=\"#112\">112</a> \n<a name=\"113\" href=\"#113\">113</a>         lockMethod.setDepth(depth);\n<a name=\"114\" href=\"#114\">114</a>         lockMethod.setTimeout(timeout);\n<a name=\"115\" href=\"#115\">115</a>         lockMethod.setRequestBody(lockinfo);\n<a name=\"116\" href=\"#116\">116</a> \n<a name=\"117\" href=\"#117\">117</a>         <strong>int</strong> retVal = client.executeMethod(lockMethod);\n<a name=\"118\" href=\"#118\">118</a> \n<a name=\"119\" href=\"#119\">119</a>         fileLockToken = lockMethod.getLockToken();\n<a name=\"120\" href=\"#120\">120</a> \n<a name=\"121\" href=\"#121\">121</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"122\" href=\"#122\">122</a>         {\n<a name=\"123\" href=\"#123\">123</a>             log.debug(<span class=\"string\">\"Lock Token is: \"</span> + fileLockToken);\n<a name=\"124\" href=\"#124\">124</a>         }\n<a name=\"125\" href=\"#125\">125</a> \n<a name=\"126\" href=\"#126\">126</a>         assertNotNull(fileLockToken);\n<a name=\"127\" href=\"#127\">127</a> \n<a name=\"128\" href=\"#128\">128</a>         <em class=\"comment\">// unlock the file</em>\n<a name=\"129\" href=\"#129\">129</a>         go(uri, 200);\n<a name=\"130\" href=\"#130\">130</a>     }\n<a name=\"131\" href=\"#131\">131</a> \n<a name=\"132\" href=\"#132\">132</a>     <em>/**<em>*</em></em>\n<a name=\"133\" href=\"#133\">133</a> <em>     * TODO</em>\n<a name=\"134\" href=\"#134\">134</a> <em>     *</em>\n<a name=\"135\" href=\"#135\">135</a> <em>     * @throws Exception TODO</em>\n<a name=\"136\" href=\"#136\">136</a> <em>     */</em>\n<a name=\"137\" href=\"#137\">137</a>     <strong>public</strong> <strong>void</strong> testGoodSharedUnlock() throws Exception\n<a name=\"138\" href=\"#138\">138</a>     {\n<a name=\"139\" href=\"#139\">139</a>         String uri = SlideTestSetup.LOCALHOST + SlideTestSetup.SWIRL + FILE;\n<a name=\"140\" href=\"#140\">140</a> \n<a name=\"141\" href=\"#141\">141</a>         <em class=\"comment\">// create a file</em>\n<a name=\"142\" href=\"#142\">142</a>         <a href=\"../../swirl/workspace/PutCommandTest.html\">PutCommandTest</a> put = <strong>new</strong> <a href=\"../../swirl/workspace/PutCommandTest.html\">PutCommandTest</a>(<span class=\"string\">\"testPut\"</span>);\n<a name=\"143\" href=\"#143\">143</a> \n<a name=\"144\" href=\"#144\">144</a>         put.go(uri, 201);\n<a name=\"145\" href=\"#145\">145</a> \n<a name=\"146\" href=\"#146\">146</a>         <em class=\"comment\">// lock the file</em>\n<a name=\"147\" href=\"#147\">147</a>         HttpClient client = <strong>new</strong> HttpClient();\n<a name=\"148\" href=\"#148\">148</a>         LockMethod lockMethod = <strong>new</strong> LockMethod(uri);\n<a name=\"149\" href=\"#149\">149</a> \n<a name=\"150\" href=\"#150\">150</a>         scope = LockMethod.SCOPE_SHARED;\n<a name=\"151\" href=\"#151\">151</a> \n<a name=\"152\" href=\"#152\">152</a>         String lockinfo = LockCommandTest.getLockInfo(scope, owner);\n<a name=\"153\" href=\"#153\">153</a> \n<a name=\"154\" href=\"#154\">154</a>         lockMethod.setDepth(depth);\n<a name=\"155\" href=\"#155\">155</a>         lockMethod.setTimeout(timeout);\n<a name=\"156\" href=\"#156\">156</a>         lockMethod.setRequestBody(lockinfo);\n<a name=\"157\" href=\"#157\">157</a> \n<a name=\"158\" href=\"#158\">158</a>         <strong>int</strong> retVal = client.executeMethod(lockMethod);\n<a name=\"159\" href=\"#159\">159</a> \n<a name=\"160\" href=\"#160\">160</a>         fileLockToken = lockMethod.getLockToken();\n<a name=\"161\" href=\"#161\">161</a> \n<a name=\"162\" href=\"#162\">162</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"163\" href=\"#163\">163</a>         {\n<a name=\"164\" href=\"#164\">164</a>             log.debug(<span class=\"string\">\"Lock Token is: \"</span> + fileLockToken);\n<a name=\"165\" href=\"#165\">165</a>         }\n<a name=\"166\" href=\"#166\">166</a> \n<a name=\"167\" href=\"#167\">167</a>         assertNotNull(fileLockToken);\n<a name=\"168\" href=\"#168\">168</a> \n<a name=\"169\" href=\"#169\">169</a>         <em class=\"comment\">// unlock the file</em>\n<a name=\"170\" href=\"#170\">170</a>         go(uri, 200);\n<a name=\"171\" href=\"#171\">171</a>     }\n<a name=\"172\" href=\"#172\">172</a> \n<a name=\"173\" href=\"#173\">173</a>     <em>/**<em>*</em></em>\n<a name=\"174\" href=\"#174\">174</a> <em>     * TODO</em>\n<a name=\"175\" href=\"#175\">175</a> <em>     *</em>\n<a name=\"176\" href=\"#176\">176</a> <em>     * @param uri TODO</em>\n<a name=\"177\" href=\"#177\">177</a> <em>     *</em>\n<a name=\"178\" href=\"#178\">178</a> <em>     * @return TODO</em>\n<a name=\"179\" href=\"#179\">179</a> <em>     */</em>\n<a name=\"180\" href=\"#180\">180</a>     <strong>protected</strong> HttpMethod createMethod(String uri)\n<a name=\"181\" href=\"#181\">181</a>     {\n<a name=\"182\" href=\"#182\">182</a>         UnlockMethod unlockMethod = <strong>new</strong> UnlockMethod(uri);\n<a name=\"183\" href=\"#183\">183</a> \n<a name=\"184\" href=\"#184\">184</a>         unlockMethod.setLockToken(fileLockToken);\n<a name=\"185\" href=\"#185\">185</a> \n<a name=\"186\" href=\"#186\">186</a>         <strong>return</strong> unlockMethod;\n<a name=\"187\" href=\"#187\">187</a>     }\n<a name=\"188\" href=\"#188\">188</a> }\n</pre>\n<hr/><div id=\"footer\">This page was automatically generated by <a href=\"http://maven.apache.org/\">Maven</a></div></body>\n</html>\n\n", "id": 34329.0}