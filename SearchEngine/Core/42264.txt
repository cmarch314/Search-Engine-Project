{"text": "Main Page Modules Data Structures File List Data Fields Globals Related Pages Vfetk classFEtk master class interface between FEtk and APBS More Filesfile vfetk h Contains declarations for class Vfetk Data Structuresstruct sVfetk Contains public data members for Vfetk class module More struct sVfetk LocalVar Vfetk LocalVar subclass Contains variables used when solving the PDE with FEtk More Typedefs typedef enum eVfetk LsolvType Vfetk LsolvType Declare FEMparm LsolvType type typedef enum eVfetk NsolvType Vfetk NsolvType Declare FEMparm NsolvType type typedef enum eVfetk GuessType Vfetk GuessType Declare FEMparm GuessType type typedef enum eVfetk PrecType Vfetk PrecType Declare FEMparm GuessType type typedef sVfetk LocalVar Vfetk LocalVar Declaration of the Vfetk LocalVar subclass as the Vfetk LocalVar structure typedef sVfetk Vfetk Declaration of the Vfetk class as the Vfetk structure Enumerationsenum eVfetk LsolvType VLT SLU VLT MG 1 VLT CG 2 VLT BCG 3 Linear solver type More enum eVfetk NsolvType VNT NEW VNT INC 1 VNT ARC 2 Non linear solver type More enum eVfetk GuessType VGT ZERO VGT DIRI 1 VGT PREV 2 Initial guess type More enum eVfetk PrecType VPT IDEN VPT DIAG 1 VPT MG 2 Preconditioner type More FunctionsGem Vfetk getGem Vfetk thee Get a pointer to the Gem grid manager object AM Vfetk getAM Vfetk thee Get a pointer to the AM algebra manager object Vpbe Vfetk getVpbe Vfetk thee Get a pointer to the Vpbe PBE manager object Vcsm Vfetk getVcsm Vfetk thee Get a pointer to the Vcsm charge simplex map object int Vfetk getAtomColor Vfetk thee int iatom Get the partition information for a particular atom Vfetk Vfetk ctor Vpbe pbe Vhal PBEType type Constructor for Vfetk object int Vfetk ctor2 Vfetk thee Vpbe pbe Vhal PBEType type FORTRAN stub constructor for Vfetk object void Vfetk dtor Vfetk thee Object destructor void Vfetk dtor2 Vfetk thee FORTRAN stub object destructor double Vfetk getSolution Vfetk thee int length Create an array containing the solution electrostatic potential in units of at the finest mesh level void Vfetk setParameters Vfetk thee PBEparm pbeparm FEMparm feparm Set the parameter objects double Vfetk energy Vfetk thee int color int nonlin Return the total electrostatic energy double Vfetk dqmEnergy Vfetk thee int color Get the mobile charge and polarization contributions to the electrostatic energy double Vfetk qfEnergy Vfetk thee int color Get the fixed charge contribution to the electrostatic energy unsigned long int Vfetk memChk Vfetk thee Return the memory used by this structure and its contents in bytes void Vfetk setAtomColors Vfetk thee Transfer color partition ID information frmo a partitioned mesh to the atoms void Bmat printHB Bmat thee char fname Writes a Bmat to disk in Harwell Boeing sparse matrix format int Vfetk genCube Vfetk thee double center VAPBS DIM double length VAPBS DIM Generates a simple cubic tetrahedral mesh PDE Vfetk PDE ctor Vfetk fetk Constructs the FEtk PDE object int Vfetk PDE ctor2 PDE thee Vfetk fetk Intializes the FEtk PDE object void Vfetk PDE dtor PDE thee Destroys FEtk PDE object void Vfetk PDE dtor2 PDE thee FORTRAN stub destroys FEtk PDE object void Vfetk PDE initAssemble PDE thee int ip double rp Do once per assembly initialization void Vfetk PDE initElement PDE thee int elementType int chart double tvx VAPBS DIM void data Do once per element initialization void Vfetk PDE initFace PDE thee int faceType int chart double tnvec Do once per face initialization void Vfetk PDE initPoint PDE thee int pointType int chart double txq double tU double tdU VAPBS DIM Do once per point initialization void Vfetk PDE Fu PDE thee int key double F Evaluate strong form of PBE For interior points this is where is the possibly nonlinear mobile ion term and is the source charge distribution term for PBE or the induced surface charge distribution for RPBE For an interior boundary simplex face point this is where is the normal to the simplex face and the term represents the jump in dielectric displacement across the face There is no outer boundary contribution for this problem double Vfetk PDE Fu v PDE thee int key double V double dV VAPBS DIM This is the weak form of the PBE i e the strong form integrated with a test function to give where denotes the mobile ion term double Vfetk PDE DFu wv PDE thee int key double W double dW VAPBS DIM double V double dV VAPBS DIM This is the linearization of the weak form of the PBE e g for use in a Newton iteration This is the functional linearization of the strong form integrated with a test function to give where denotes the functional derivation of the mobile ion term void Vfetk PDE delta PDE thee int type int chart double txq void user double F Evaluate a discretized delta function source term at the given point void Vfetk PDE u D PDE thee int type int chart double txq double F Evaluate the Dirichlet boundary condition at the given point void Vfetk PDE u T PDE thee int type int chart double txq double F Evaluate the true solution at the given point for comparison with the numerical solution void Vfetk PDE bisectEdge int dim int dimII int edgeType int chart double vx VAPBS DIM Define the way manifold edges are bisected void Vfetk PDE mapBoundary int dim int dimII int vertexType int chart double vx VAPBS DIM Map a boundary point to some pre defined shape int Vfetk PDE markSimplex int dim int dimII int simplexType int faceType VAPBS NVS int vertexType VAPBS NVS int chart double vx VAPBS DIM void simplex User defined error estimator in our case a geometry based refinement method forcing simplex refinement at the dielectric boundary and for non regularized PBE the charges void Vfetk PDE oneChart int dim int dimII int objType int chart double vx VAPBS DIM int dimV Unify the chart for different coordinate systems a no op for us double Vfetk PDE Ju PDE thee int key Energy functional This returns the energy less delta function terms in the form for a 1 1 electrolyte where is the output from Vpbe getZmagic void Vfetk externalUpdateFunction SS simps int num External hook to simplex subdivision routines in Gem Called each time a simplex is subdivided we use it to update the charge simplex map int Vfetk PDE simplexBasisInit int key int dim int comp int ndof int dof Initialize the bases for the trial or the test space for a particular component of the system at all quadrature points on the master simplex element void Vfetk PDE simplexBasisForm int key int dim int comp int pdkey double xq double basis Evaluate the bases for the trial or test space for a particular component of the system at all quadrature points on the master simplex element void Vfetk readMesh Vfetk thee int skey Vio sock Read in mesh and initialize associated internal structures void Vfetk dumpLocalVar Debugging routine to print out local variables used by PDE object int Vfetk fillArray Vfetk thee Bvec vec Vdata Type type Fill an array with the specified data int Vfetk write Vfetk thee const char iodev const char iofmt const char thost const char fname Bvec vec Vdata Format format Write out data Detailed Description FEtk master class interface between FEtk and APBS Enumeration Type Documentation enum eVfetk GuessType Initial guess type Note Do not change these values they correspond to settings in FEtk Enumeration values VGT ZERO Zero initial guess VGT DIRI Dirichlet boundary condition initial guess VGT PREV Previous level initial guess enum eVfetk LsolvType Linear solver type Note Do not change these values they correspond to settings in FEtk Enumeration values VLT SLU SuperLU direct solve VLT MG Multigrid VLT CG Conjugate gradient VLT BCG BiCGStab enum eVfetk NsolvType Non linear solver type Note Do not change these values they correspond to settings in FEtk Enumeration values VNT NEW Newton solver VNT INC Incremental VNT ARC Psuedo arclength enum eVfetk PrecType Preconditioner type Note Do not change these values they correspond to settings in FEtk Enumeration values VPT IDEN Identity matrix VPT DIAG Diagonal scaling VPT MG Multigrid Function Documentation void Bmat printHB Bmat thee char fname Writes a Bmat to disk in Harwell Boeing sparse matrix format Author Stephen Bond Note This is a friend function of Bmat Bug Hardwired to only handle the single block symmetric case Parameters fname The matrix to write Filename for output Vfetk Vfetk ctor Vpbe pbe Vhal PBEType type Constructor for Vfetk object Author Nathan Baker Returns Pointer to newly allocated Vfetk object Note This sets up the Gem AM and Aprx FEtk objects but does not create a mesh The easiest way to create a mesh is to then call Vfetk genCube Parameters type Vpbe PBE manager object Version of PBE to solve int Vfetk ctor2 Vfetk thee Vpbe pbe Vhal PBEType type FORTRAN stub constructor for Vfetk object Author Nathan Baker Returns 1 if successful otherwise Note This sets up the Gem AM and Aprx FEtk objects but does not create a mesh The easiest way to create a mesh is to then call Vfetk genCube Parameters pbe Vfetk object memory type PBE manager object Version of PBE to solve double Vfetk dqmEnergy Vfetk thee int color Get the mobile charge and polarization contributions to the electrostatic energy Using the solution at the finest mesh level get the electrostatic energy due to the interaction of the mobile charges with the potential and polarization of the dielectric medium for the NPBE and for the LPBE Here denotes the counterion species is the bulk ionic strength is the modified Debye Huckel parameter is the concentration of species is the charge of species is the dielectric function and is the dimensionless electrostatic potential The energy is scaled to units of Author Nathan Baker Parameters thee Vfetk object color Partition restriction for energy evaluation only used if non negative Returns The mobile charge and polarization contributions to the electrostatic energy in units of Parameters color The Vfetk object Partition restriction for energy calculation if non negative energy calculation is restricted to the specified partition indexed by simplex and atom colors void Vfetk dtor Vfetk thee Object destructor Author Nathan Baker Parameters thee Pointer to memory location of Vfetk object void Vfetk dtor2 Vfetk thee FORTRAN stub object destructor Author Nathan Baker Parameters thee Pointer to Vfetk object to be destroyed void Vfetk dumpLocalVar Debugging routine to print out local variables used by PDE object Author Nathan Baker Bug This function is not thread safe double Vfetk energy Vfetk thee int color int nonlin Return the total electrostatic energy Using the solution at the finest mesh level get the electrostatic energy using the free energy functional for the Poisson Boltzmann equation without removing any self interaction terms i e removing the reference state of isolated charges present in an infinite dielectric continuum with the same relative permittivity as the interior of the protein and return the result in units of The argument color allows the user to control the partition on which this energy is calculated if color 1 no restrictions are used The solution is obtained from the finest level of the passed AM object but atomic data from the Vfetk object is used to calculate the energy Author Nathan Baker Returns Total electrostatic energy in units of Parameters color THe Vfetk object nonlin Partition restriction for energy calculation if non negative energy calculation is restricted to the specified partition indexed by simplex and atom colors If 1 the NPBE energy functional is used otherwise the LPBE energy functional is used void Vfetk externalUpdateFunction SS simps int num External hook to simplex subdivision routines in Gem Called each time a simplex is subdivided we use it to update the charge simplex map Author Nathan Baker Bug This function is not thread safe Parameters num List of parent simps and children remainder simplices Number of simplices in list int Vfetk fillArray Vfetk thee Bvec vec Vdata Type type Fill an array with the specified data Author Nathan Baker Note This function is thread safe Bug Several values of type are not implemented Returns 1 if successful otherwise Parameters vec The Vfetk object with the data type The vector to hold the data THe type of data to write int Vfetk genCube Vfetk thee double center VAPBS DIM double length VAPBS DIM Generates a simple cubic tetrahedral mesh Author Nathan Baker based on Mike Holst s Gem makeCube code Returns 1 if successful otherwise Parameters center The Vfetk object length Desired mesh center in Desired mesh length in AM Vfetk getAM Vfetk thee Get a pointer to the AM algebra manager object Author Nathan Baker Returns Pointer to the AM algebra manager object Parameters thee The Vfetk object int Vfetk getAtomColor Vfetk thee int iatom Get the partition information for a particular atom Author Nathan Baker Note Friend function of Vatom Parameters thee Vfetk object iatom Valist atom ID Returns Partition ID Parameters iatom The Vfetk object Valist atom index Gem Vfetk getGem Vfetk thee Get a pointer to the Gem grid manager object Author Nathan Baker Returns Pointer to the Gem grid manager object Parameters thee Vfetk object double Vfetk getSolution Vfetk thee int length Create an array containing the solution electrostatic potential in units of at the finest mesh level Author Nathan Baker and Michael Holst Note The user is responsible for destroying the newly created array Returns Newly created array of length length see above the user is responsible for destruction Parameters length Vfetk object with solution Ste to length of the newly created solution array Vcsm Vfetk getVcsm Vfetk thee Get a pointer to the Vcsm charge simplex map object Author Nathan Baker Returns Pointer to the Vcsm charge simplex map object Parameters thee The Vfetk object Vpbe Vfetk getVpbe Vfetk thee Get a pointer to the Vpbe PBE manager object Author Nathan Baker Returns Pointer to the Vpbe PBE manager object Parameters thee The Vfetk object unsigned long int Vfetk memChk Vfetk thee Return the memory used by this structure and its contents in bytes Author Nathan Baker Returns The memory used by this structure and its contents in bytes Parameters thee THe Vfetk object void Vfetk PDE bisectEdge int dim int dimII int edgeType int chart double vx VAPBS DIM Define the way manifold edges are bisected Author Nathan Baker and Mike Holst Note This function is thread safe Parameters dimII Intrinsic dimension of manifold edgeType Embedding dimension of manifold chart Type of edge being refined vx Chart for edge vertices used here as accessibility bitfields Edge vertex coordindates PDE Vfetk PDE ctor Vfetk fetk Constructs the FEtk PDE object Author Nathan Baker Returns Newly allocated PDE object Bug Not thread safe Parameters fetk The Vfetk object int Vfetk PDE ctor2 PDE thee Vfetk fetk Intializes the FEtk PDE object Author Nathan Baker with code by Mike Holst Returns 1 if successful otherwise Bug Not thread safe Parameters fetk The newly allocated PDE object The parent Vfetk object void Vfetk PDE delta PDE thee int type int chart double txq void user double F Evaluate a discretized delta function source term at the given point Author Nathan Baker Bug This function is not thread safe Parameters type PDE object chart Vertex type txq Chart for point coordinates user Point coordinates F Vertex object pointer Set to delta function value double Vfetk PDE DFu wv PDE thee int key double W double dW VAPBS DIM double V double dV VAPBS DIM This is the linearization of the weak form of the PBE e g for use in a Newton iteration This is the functional linearization of the strong form integrated with a test function to give where denotes the functional derivation of the mobile ion term Author Nathan Baker and Mike Holst Returns Integrand value Bug This function is not thread safe Parameters key The PDE object W Integrand to evaluate interior weak form 1 boundary weak form dW Trial function value at current point V Trial function gradient at current point dV Test function value at current point Test function gradient void Vfetk PDE dtor PDE thee Destroys FEtk PDE object Author Nathan Baker Note Thread safe Parameters thee Pointer to PDE object memory void Vfetk PDE dtor2 PDE thee FORTRAN stub destroys FEtk PDE object Author Nathan Baker Note Thread safe Parameters thee PDE object memory void Vfetk PDE Fu PDE thee int key double F Evaluate strong form of PBE For interior points this is where is the possibly nonlinear mobile ion term and is the source charge distribution term for PBE or the induced surface charge distribution for RPBE For an interior boundary simplex face point this is where is the normal to the simplex face and the term represents the jump in dielectric displacement across the face There is no outer boundary contribution for this problem Author Nathan Baker Bug This function is not thread safe This function is not implemented sets error to zero Parameters key The PDE object F Type of point interior 1 boundary 2 interior boundary Set to value of residual double Vfetk PDE Fu v PDE thee int key double V double dV VAPBS DIM This is the weak form of the PBE i e the strong form integrated with a test function to give where denotes the mobile ion term Author Nathan Baker and Mike Holst Returns Integrand value Bug This function is not thread safe Parameters key The PDE object V Integrand to evaluate interior weak form 1 boundary weak form dV Test function at current point Test function derivative at current point void Vfetk PDE initAssemble PDE thee int ip double rp Do once per assembly initialization Author Nathan Baker and Mike Holst Note Thread safe Parameters ip PDE object rp Integer parameter array not used Double parameter array not used void Vfetk PDE initElement PDE thee int elementType int chart double tvx VAPBS DIM void data Do once per element initialization Author Nathan Baker and Mike Holst Todo Jump term is not implemented Bug This function is not thread safe Parameters elementType PDE object chart Material type not used tvx Chart in which the vertex coordinates are provided used here as a bitfield to store molecular accessibility data Vertex coordinates Simplex pointer hack void Vfetk PDE initFace PDE thee int faceType int chart double tnvec Do once per face initialization Author Nathan Baker and Mike Holst Bug This function is not thread safe Parameters faceType THe PDE object chart Simplex face type interior or various boundary types tnvec Chart in which the vertex coordinates are provided used here as a bitfield for molecular accessibility Coordinates of outward normal vector for face void Vfetk PDE initPoint PDE thee int pointType int chart double txq double tU double tdU VAPBS DIM Do once per point initialization Author Nathan Baker Bug This function is not thread safe This function uses pre defined boudnary definitions for the molecular surface Parameters pointType The PDE object chart The type of point interior or various faces txq The chart in which the point coordinates are provided used here as bitfield for molecular accessibility tU Point coordinates tdU Solution value at point Solution derivative at point double Vfetk PDE Ju PDE thee int key Energy functional This returns the energy less delta function terms in the form for a 1 1 electrolyte where is the output from Vpbe getZmagic Author Nathan Baker Returns Energy value in kT Bug This function is not thread safe Parameters key The PDE object What to evluate interior or boundary 1 void Vfetk PDE mapBoundary int dim int dimII int vertexType int chart double vx VAPBS DIM Map a boundary point to some pre defined shape Author Nathan Baker and Mike Holst Note This function is thread safe and is a no op Parameters dimII Intrinsic dimension of manifold vertexType Embedding dimension of manifold chart Type of vertex vx Chart for vertex coordinates Vertex coordinates int Vfetk PDE markSimplex int dim int dimII int simplexType int faceType VAPBS NVS int vertexType VAPBS NVS int chart double vx VAPBS DIM void simplex User defined error estimator in our case a geometry based refinement method forcing simplex refinement at the dielectric boundary and for non regularized PBE the charges Author Nathan Baker Returns 1 if mark simplex for refinement otherwise Bug This function is not thread safe Parameters dimII Intrinsic manifold dimension simplexType Embedding manifold dimension faceType Type of simplex being refined vertexType Types of faces in simplex chart Types of vertices in simplex vx Charts for vertex coordinates simplex Vertex coordinates Simplex pointer void Vfetk PDE oneChart int dim int dimII int objType int chart double vx VAPBS DIM int dimV Unify the chart for different coordinate systems a no op for us Author Nathan Baker Note Thread safe a no op Parameters dimII Intrinsic manifold dimension objType Embedding manifold dimension chart vx Charts of vertices coordinates dimV Vertices coordinates Number of vertices void Vfetk PDE simplexBasisForm int key int dim int comp int pdkey double xq double basis Evaluate the bases for the trial or test space for a particular component of the system at all quadrature points on the master simplex element Author Mike Holst Parameters dim Basis type to evaluate trial 1 test 2 trialB 3 testB comp Spatial dimension Which component of elliptic system to produce basis for xq Basis partial differential equation evaluation key evaluate basis x y z 1 evaluate basis x x y z 2 evaluate basis y x y z 3 evaluate basis z x y z 4 evaluate basis xx x y z 5 evaluate basis yy x y z 6 evaluate basis zz x y z 7 etc basis Set to quad pt coordinate Set to all basis functions evaluated at all quadrature pts int Vfetk PDE simplexBasisInit int key int dim int comp int ndof int dof Initialize the bases for the trial or the test space for a particular component of the system at all quadrature points on the master simplex element Author Mike Holst Note The basis ordering is important For a fixed quadrature point iq you must follow the following ordering in p iq based on how you specify the degrees of freedom in dof v vDF v 1 vDF v nv vDF v vDF 1 v 1 vDF 1 v nv vDF 1 v vDF nvDF v vDF nvDF v nv vDF nvDF e eDF e 1 eDF e ne eDF e eDF 1 e 1 eDF 1 e ne eDF 1 e eDF neDF e 1 eDF neDF e ne eDF neDF f fDF f 1 fDF f nf fDF f fDF 1 f 1 fDF 1 f nf fDF 1 f fDF nfDF f 1 fDF nfDF f nf fDF nfDF s sDF s 1 sDF s ns sDF s sDF 1 s 1 sDF 1 s ns sDF 1 s sDF nsDF s 1 sDF nsDF s ns sDF nsDF For example linear elements in R 3 with one degree of freedom at each vertex would use the following ordering v vDF v 1 vDF v 2 vDF v 3 vDF Quadratic elements in R 2 with one degree of freedom at each vertex and edge would use the following ordering v vDF v 1 vDF v 2 vDF e eDF e 1 eDF e 2 eDF You can use different trial and test spaces for each component of the elliptic system thereby allowing for the use of Petrov Galerkin methods You MUST then tag the bilinear form symmetry entries as nonsymmetric in your PDE constructor to reflect that DF u w v will be different from DF u v w even if your form acts symmetrically when the same basis is used for w and v You can also use different trial spaces for each component of the elliptic system and different test spaces for each component of the elliptic system This allows you to e g use a basis which is vertex based for one component and a basis which is edge based for another This is useful in fluid mechanics eletromagnetics or simply to play around with different elements This function is called by MC to build new master elements whenever it reads in a new mesh Therefore this function does not have to be all that fast and e g could involve symbolic computation Parameters dim Basis type to evaluate trial 1 test 2 trialB 3 testB comp Spatial dimension ndof Which component of elliptic system to produce basis for dof Set to the number of degrees of freedom Set to degree of freedom per v e f s void Vfetk PDE u D PDE thee int type int chart double txq double F Evaluate the Dirichlet boundary condition at the given point Author Nathan Baker Bug This function is hard coded to call only multiple sphere Debye H functions This function is not thread safe Parameters type PDE object chart Vertex boundary type txq Chart for point coordinates F Point coordinates Set to boundary values void Vfetk PDE u T PDE thee int type int chart double txq double F Evaluate the true solution at the given point for comparison with the numerical solution Author Nathan Baker Note This function only returns zero Bug This function is not thread safe Parameters type PDE object chart Point type txq Chart for point coordinates F Point coordinates Set to value at point double Vfetk qfEnergy Vfetk thee int color Get the fixed charge contribution to the electrostatic energy Using the solution at the finest mesh level get the electrostatic energy due to the interaction of the fixed charges with the potential and return the result in units of Clearly no self interaction terms are removed A factor a 1 2 has to be included to convert this to a real energy Author Nathan Baker Parameters thee Vfetk object color Partition restriction for energy evaluation only used if non negative Returns The fixed charge electrostatic energy in units of Parameters color The Vfetk object Partition restriction for energy evaluation only used if non negative void Vfetk readMesh Vfetk thee int skey Vio sock Read in mesh and initialize associated internal structures Author Nathan Baker Note See also Vfetk genCube Parameters skey THe Vfetk object sock The sock format key MCSF simplex format Socket object ready for reading void Vfetk setAtomColors Vfetk thee Transfer color partition ID information frmo a partitioned mesh to the atoms Transfer color information from partitioned mesh to the atoms In the case that a charge is shared between two partitions the partition color of the first simplex is selected Due to the arbitrary nature of this selection THIS METHOD SHOULD ONLY BE USED IMMEDIATELY AFTER PARTITIONING Warning This function should only be used immediately after mesh partitioning Author Nathan Baker Note This is a friend function of Vcsm Parameters thee THe Vfetk object void Vfetk setParameters Vfetk thee PBEparm pbeparm FEMparm feparm Set the parameter objects Author Nathan Baker Parameters pbeparm The Vfetk object feparm Parameters for solution of the PBE FEM speecific solution parameters int Vfetk write Vfetk thee const char iodev const char iofmt const char thost const char fname Bvec vec Vdata Format format Write out data Author Nathan Baker Parameters thee Vfetk object vec FEtk Bvec vector to use format Format for data iodev Output device type FILE BUFF UNIX INET iofmt Output device format ASCII XDR thost Output hostname for sockets fname Output FILE BUFF UNIX INET name Note This function is thread safe Bug Some values of format are not implemented Returns 1 if successful otherwise Parameters iodev The Vfetk object iofmt Output device type FILE file BUFF buffer UNIX unix pipe INET network socket thost Output device format ASCII ascii plaintext XDR xdr fname Output hostname for sockets vec Output filename for other format Data vector Data format Generated on Tue Dec 6 1 5 59 2 5 for APBS by 1 3 5", "_id": "http://www.ics.uci.edu/~dock/manuals/apbs/html/programmer/group__Vfetk.html", "title": "apbs: vfetk class", "html": "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\">\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html;charset=iso-8859-1\">\n<title>APBS: Vfetk class</title>\n<link href=\"apbs.css\" rel=\"stylesheet\" type=\"text/css\">\n</head><body>\n<!-- Generated by Doxygen 1.3.5 -->\n<div class=\"qindex\"><a class=\"qindex\" href=\"index.html\">Main&nbsp;Page</a> | <a class=\"qindex\" href=\"modules.html\">Modules</a> | <a class=\"qindex\" href=\"annotated.html\">Data&nbsp;Structures</a> | <a class=\"qindex\" href=\"files.html\">File&nbsp;List</a> | <a class=\"qindex\" href=\"functions.html\">Data&nbsp;Fields</a> | <a class=\"qindex\" href=\"globals.html\">Globals</a> | <a class=\"qindex\" href=\"pages.html\">Related&nbsp;Pages</a></div>\n<h1>Vfetk class</h1>FEtk master class (interface between FEtk and APBS).  \n<a href=\"#_details\">More...</a><table border=0 cellpadding=0 cellspacing=0>\n<tr><td></td></tr>\n<tr><td colspan=2><br><h2>Files</h2></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>file &nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"vfetk_8h.html\">vfetk.h</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Contains declarations for class Vfetk. <br><br></td></tr>\n\n<p>\n<tr><td colspan=2><br><h2>Data Structures</h2></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>struct &nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"structsVfetk.html\">sVfetk</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Contains public data members for Vfetk class/module. </em> <a href=\"structsVfetk.html#_details\">More...</a><em><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>struct &nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"structsVfetk__LocalVar.html\">sVfetk_LocalVar</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Vfetk LocalVar subclass Contains variables used when solving the PDE with FEtk. </em> <a href=\"structsVfetk__LocalVar.html#_details\">More...</a><em><br><br></td></tr>\n<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"anchor\" name=\"ga0\" doxytag=\"Vfetk::Vfetk_LsolvType\" ></a>\ntypedef enum <a class=\"el\" href=\"group__Vfetk.html#ga49\">eVfetk_LsolvType</a>&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga0\">Vfetk_LsolvType</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Declare FEMparm_LsolvType type. <br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"anchor\" name=\"ga1\" doxytag=\"Vfetk::Vfetk_NsolvType\" ></a>\ntypedef enum <a class=\"el\" href=\"group__Vfetk.html#ga50\">eVfetk_NsolvType</a>&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga1\">Vfetk_NsolvType</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Declare FEMparm_NsolvType type. <br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"anchor\" name=\"ga2\" doxytag=\"Vfetk::Vfetk_GuessType\" ></a>\ntypedef enum <a class=\"el\" href=\"group__Vfetk.html#ga51\">eVfetk_GuessType</a>&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga2\">Vfetk_GuessType</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Declare FEMparm_GuessType type. <br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"anchor\" name=\"ga3\" doxytag=\"Vfetk::Vfetk_PrecType\" ></a>\ntypedef enum <a class=\"el\" href=\"group__Vfetk.html#ga52\">eVfetk_PrecType</a>&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga3\">Vfetk_PrecType</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Declare FEMparm_GuessType type. <br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"anchor\" name=\"ga4\" doxytag=\"Vfetk::Vfetk_LocalVar\" ></a>\ntypedef <a class=\"el\" href=\"structsVfetk__LocalVar.html\">sVfetk_LocalVar</a>&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga4\">Vfetk_LocalVar</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Declaration of the Vfetk_LocalVar subclass as the Vfetk_LocalVar structure. <br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"anchor\" name=\"ga53\" doxytag=\"Vfetk::Vfetk\" ></a>\ntypedef <a class=\"el\" href=\"structsVfetk.html\">sVfetk</a>&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga53\">Vfetk</a></td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Declaration of the Vfetk class as the Vfetk structure. <br><br></td></tr>\n<tr><td colspan=2><br><h2>Enumerations</h2></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>enum &nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga49\">eVfetk_LsolvType</a> { <br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga49a6\">VLT_SLU</a> = 0, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga49a7\">VLT_MG</a> = 1, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga49a8\">VLT_CG</a> = 2, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga49a9\">VLT_BCG</a> = 3\n<br>\n }</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Linear solver type.  <a href=\"#ga49\">More...</a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>enum &nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga50\">eVfetk_NsolvType</a> { <br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga50a10\">VNT_NEW</a> = 0, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga50a11\">VNT_INC</a> = 1, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga50a12\">VNT_ARC</a> = 2\n<br>\n }</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Non-linear solver type.  <a href=\"#ga50\">More...</a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>enum &nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga51\">eVfetk_GuessType</a> { <br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga51a13\">VGT_ZERO</a> = 0, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga51a14\">VGT_DIRI</a> = 1, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga51a15\">VGT_PREV</a> = 2\n<br>\n }</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Initial guess type.  <a href=\"#ga51\">More...</a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>enum &nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga52\">eVfetk_PrecType</a> { <br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga52a16\">VPT_IDEN</a> = 0, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga52a17\">VPT_DIAG</a> = 1, \n<br>\n&nbsp;&nbsp;<a class=\"el\" href=\"group__Vfetk.html#gga52a18\">VPT_MG</a> = 2\n<br>\n }</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Preconditioner type.  <a href=\"#ga52\">More...</a><br><br></td></tr>\n<tr><td colspan=2><br><h2>Functions</h2></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>Gem *&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga5\">Vfetk_getGem</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Get a pointer to the Gem (grid manager) object.  <a href=\"#ga5\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>AM *&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga6\">Vfetk_getAM</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Get a pointer to the AM (algebra manager) object.  <a href=\"#ga6\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"el\" href=\"structsVpbe.html\">Vpbe</a> *&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga7\">Vfetk_getVpbe</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Get a pointer to the Vpbe (PBE manager) object.  <a href=\"#ga7\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"el\" href=\"structsVcsm.html\">Vcsm</a> *&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga8\">Vfetk_getVcsm</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Get a pointer to the Vcsm (charge-simplex map) object.  <a href=\"#ga8\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga9\">Vfetk_getAtomColor</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, int iatom)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Get the partition information for a particular atom.  <a href=\"#ga9\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga10\">Vfetk_ctor</a> (<a class=\"el\" href=\"structsVpbe.html\">Vpbe</a> *pbe, <a class=\"el\" href=\"group__Vhal.html#ga0\">Vhal_PBEType</a> type)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Constructor for Vfetk object.  <a href=\"#ga10\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga11\">Vfetk_ctor2</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, <a class=\"el\" href=\"structsVpbe.html\">Vpbe</a> *pbe, <a class=\"el\" href=\"group__Vhal.html#ga0\">Vhal_PBEType</a> type)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">FORTRAN stub constructor for Vfetk object.  <a href=\"#ga11\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga12\">Vfetk_dtor</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> **thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Object destructor.  <a href=\"#ga12\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga13\">Vfetk_dtor2</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">FORTRAN stub object destructor.  <a href=\"#ga13\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>double *&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga14\">Vfetk_getSolution</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, int *length)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Create an array containing the solution (electrostatic potential in units of <img class=formulaInl alt=\"$k_B T/e$\" src=\"form_58.png\">) at the finest mesh level.  <a href=\"#ga14\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga15\">Vfetk_setParameters</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, <a class=\"el\" href=\"structsPBEparm.html\">PBEparm</a> *pbeparm, <a class=\"el\" href=\"structsFEMparm.html\">FEMparm</a> *feparm)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Set the parameter objects.  <a href=\"#ga15\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>double&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga16\">Vfetk_energy</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, int color, int nonlin)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Return the total electrostatic energy.  <a href=\"#ga16\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>double&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga17\">Vfetk_dqmEnergy</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, int color)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Get the \"mobile charge\" and \"polarization\" contributions to the electrostatic energy.  <a href=\"#ga17\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>double&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga18\">Vfetk_qfEnergy</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, int color)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Get the \"fixed charge\" contribution to the electrostatic energy.  <a href=\"#ga18\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>unsigned long int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga19\">Vfetk_memChk</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Return the memory used by this structure (and its contents) in bytes.  <a href=\"#ga19\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga20\">Vfetk_setAtomColors</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Transfer color (partition ID) information frmo a partitioned mesh to the atoms.  <a href=\"#ga20\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga21\">Bmat_printHB</a> (Bmat *thee, char *fname)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Writes a Bmat to disk in Harwell-Boeing sparse matrix format.  <a href=\"#ga21\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga22\">Vfetk_genCube</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, double center[VAPBS_DIM], double length[VAPBS_DIM])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Generates a simple cubic tetrahedral mesh.  <a href=\"#ga22\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>PDE *&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga23\">Vfetk_PDE_ctor</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *fetk)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Constructs the FEtk PDE object.  <a href=\"#ga23\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga24\">Vfetk_PDE_ctor2</a> (PDE *thee, <a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *fetk)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Intializes the FEtk PDE object.  <a href=\"#ga24\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga25\">Vfetk_PDE_dtor</a> (PDE **thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Destroys FEtk PDE object.  <a href=\"#ga25\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga26\">Vfetk_PDE_dtor2</a> (PDE *thee)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">FORTRAN stub: destroys FEtk PDE object.  <a href=\"#ga26\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga27\">Vfetk_PDE_initAssemble</a> (PDE *thee, int ip[], double rp[])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Do once-per-assembly initialization.  <a href=\"#ga27\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga28\">Vfetk_PDE_initElement</a> (PDE *thee, int elementType, int chart, double tvx[][VAPBS_DIM], void *data)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Do once-per-element initialization.  <a href=\"#ga28\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga29\">Vfetk_PDE_initFace</a> (PDE *thee, int faceType, int chart, double tnvec[])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Do once-per-face initialization.  <a href=\"#ga29\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga30\">Vfetk_PDE_initPoint</a> (PDE *thee, int pointType, int chart, double txq[], double tU[], double tdU[][VAPBS_DIM])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Do once-per-point initialization.  <a href=\"#ga30\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga31\">Vfetk_PDE_Fu</a> (PDE *thee, int key, double F[])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Evaluate strong form of PBE. For interior points, this is: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ -\\nabla \\cdot \\epsilon \\nabla u + b(u) - f \\]\" src=\"form_61.png\">\n<p>\n where <img class=formulaInl alt=\"$b(u)$\" src=\"form_62.png\"> is the (possibly nonlinear) mobile ion term and <img class=formulaInl alt=\"$f$\" src=\"form_63.png\"> is the source charge distribution term (for PBE) or the induced surface charge distribution (for RPBE). For an interior-boundary (simplex face) point, this is: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ [\\epsilon(x) \\nabla u(x) \\cdot n(x)]_{x=0^+} - [\\epsilon(x) \\nabla u(x) \\cdot n(x)]_{x=0^-} \\]\" src=\"form_64.png\">\n<p>\n where <img class=formulaInl alt=\"$n(x)$\" src=\"form_65.png\"> is the normal to the simplex face and the term represents the jump in dielectric displacement across the face. There is no outer-boundary contribution for this problem.  <a href=\"#ga31\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>double&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga32\">Vfetk_PDE_Fu_v</a> (PDE *thee, int key, double V[], double dV[][VAPBS_DIM])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">This is the weak form of the PBE; i.e. the strong form integrated with a test function to give: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ \\int_\\Omega \\left[ \\epsilon \\nabla u \\cdot \\nabla v + b(u) v - f v \\right] dx \\]\" src=\"form_66.png\">\n<p>\n where <img class=formulaInl alt=\"$b(u)$\" src=\"form_62.png\"> denotes the mobile ion term.  <a href=\"#ga32\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>double&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga33\">Vfetk_PDE_DFu_wv</a> (PDE *thee, int key, double W[], double dW[][VAPBS_DIM], double V[], double dV[][VAPBS_DIM])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">This is the linearization of the weak form of the PBE; e.g., for use in a Newton iteration. This is the functional linearization of the strong form integrated with a test function to give: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ \\int_\\Omega \\left[ \\epsilon \\nabla w \\cdot \\nabla v + b'(u) w v - f v \\right] dx \\]\" src=\"form_67.png\">\n<p>\n where <img class=formulaInl alt=\"$b'(u)$\" src=\"form_68.png\"> denotes the functional derivation of the mobile ion term.  <a href=\"#ga33\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga34\">Vfetk_PDE_delta</a> (PDE *thee, int type, int chart, double txq[], void *user, double F[])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Evaluate a (discretized) delta function source term at the given point.  <a href=\"#ga34\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga35\">Vfetk_PDE_u_D</a> (PDE *thee, int type, int chart, double txq[], double F[])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Evaluate the Dirichlet boundary condition at the given point.  <a href=\"#ga35\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga36\">Vfetk_PDE_u_T</a> (PDE *thee, int type, int chart, double txq[], double F[])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Evaluate the \"true solution\" at the given point for comparison with the numerical solution.  <a href=\"#ga36\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga37\">Vfetk_PDE_bisectEdge</a> (int dim, int dimII, int edgeType, int chart[], double vx[][VAPBS_DIM])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Define the way manifold edges are bisected.  <a href=\"#ga37\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga38\">Vfetk_PDE_mapBoundary</a> (int dim, int dimII, int vertexType, int chart, double vx[VAPBS_DIM])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Map a boundary point to some pre-defined shape.  <a href=\"#ga38\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga39\">Vfetk_PDE_markSimplex</a> (int dim, int dimII, int simplexType, int faceType[VAPBS_NVS], int vertexType[VAPBS_NVS], int chart[], double vx[][VAPBS_DIM], void *simplex)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">User-defined error estimator -- in our case, a geometry-based refinement method; forcing simplex refinement at the dielectric boundary and (for non-regularized PBE) the charges.  <a href=\"#ga39\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga40\">Vfetk_PDE_oneChart</a> (int dim, int dimII, int objType, int chart[], double vx[][VAPBS_DIM], int dimV)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Unify the chart for different coordinate systems -- a no-op for us.  <a href=\"#ga40\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>double&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga41\">Vfetk_PDE_Ju</a> (PDE *thee, int key)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Energy functional. This returns the energy (less delta function terms) in the form: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ c^{-1}/2 \\int (\\epsilon (\\nabla u)^2 + \\kappa^2 (cosh u - 1)) dx \\]\" src=\"form_69.png\">\n<p>\n for a 1:1 electrolyte where <img class=formulaInl alt=\"$c$\" src=\"form_70.png\"> is the output from Vpbe_getZmagic.  <a href=\"#ga41\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga42\">Vfetk_externalUpdateFunction</a> (SS **simps, int num)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">External hook to simplex subdivision routines in Gem. Called each time a simplex is subdivided (we use it to update the charge-simplex map).  <a href=\"#ga42\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga43\">Vfetk_PDE_simplexBasisInit</a> (int key, int dim, int comp, int *ndof, int dof[])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Initialize the bases for the trial or the test space, for a particular component of the system, at all quadrature points on the master simplex element.  <a href=\"#ga43\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga44\">Vfetk_PDE_simplexBasisForm</a> (int key, int dim, int comp, int pdkey, double xq[], double basis[])</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Evaluate the bases for the trial or test space, for a particular component of the system, at all quadrature points on the master simplex element.  <a href=\"#ga44\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga45\">Vfetk_readMesh</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, int skey, Vio *sock)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Read in mesh and initialize associated internal structures.  <a href=\"#ga45\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>void&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga46\">Vfetk_dumpLocalVar</a> ()</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Debugging routine to print out local variables used by PDE object.  <a href=\"#ga46\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga47\">Vfetk_fillArray</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, Bvec *vec, <a class=\"el\" href=\"group__Vhal.html#ga34\">Vdata_Type</a> type)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Fill an array with the specified data.  <a href=\"#ga47\"></a><br><br></td></tr>\n<tr><td class=\"memItemLeft\" nowrap align=right valign=top>int&nbsp;</td><td class=\"memItemRight\" valign=bottom><a class=\"el\" href=\"group__Vfetk.html#ga48\">Vfetk_write</a> (<a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *thee, const char *iodev, const char *iofmt, const char *thost, const char *fname, Bvec *vec, <a class=\"el\" href=\"group__Vhal.html#ga35\">Vdata_Format</a> format)</td></tr>\n\n<tr><td class=\"mdescLeft\">&nbsp;</td><td class=\"mdescRight\">Write out data.  <a href=\"#ga48\"></a><br><br></td></tr>\n</table>\n<hr><a name=\"_details\"></a><h2>Detailed Description</h2>\nFEtk master class (interface between FEtk and APBS). \n<p>\n<hr><h2>Enumeration Type Documentation</h2>\n<a class=\"anchor\" name=\"ga51\" doxytag=\"vfetk.h::eVfetk_GuessType\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> enum <a class=\"el\" href=\"group__Vfetk.html#ga51\">eVfetk_GuessType</a>\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nInitial guess type. \n<p>\n<dl compact><dt><b>Note:</b></dt><dd>Do not change these values; they correspond to settings in FEtk </dd></dl>\n<dl compact><dt><b>Enumeration values: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga51a13\" doxytag=\"VGT_ZERO\" ></a>VGT_ZERO</em>&nbsp;</td><td>\nZero initial guess </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga51a14\" doxytag=\"VGT_DIRI\" ></a>VGT_DIRI</em>&nbsp;</td><td>\nDirichlet boundary condition initial guess </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga51a15\" doxytag=\"VGT_PREV\" ></a>VGT_PREV</em>&nbsp;</td><td>\nPrevious level initial guess </td></tr>\n</table>\n</dl>\n    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga49\" doxytag=\"vfetk.h::eVfetk_LsolvType\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> enum <a class=\"el\" href=\"group__Vfetk.html#ga49\">eVfetk_LsolvType</a>\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nLinear solver type. \n<p>\n<dl compact><dt><b>Note:</b></dt><dd>Do not change these values; they correspond to settings in FEtk </dd></dl>\n<dl compact><dt><b>Enumeration values: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga49a6\" doxytag=\"VLT_SLU\" ></a>VLT_SLU</em>&nbsp;</td><td>\nSuperLU direct solve </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga49a7\" doxytag=\"VLT_MG\" ></a>VLT_MG</em>&nbsp;</td><td>\nMultigrid </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga49a8\" doxytag=\"VLT_CG\" ></a>VLT_CG</em>&nbsp;</td><td>\nConjugate gradient </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga49a9\" doxytag=\"VLT_BCG\" ></a>VLT_BCG</em>&nbsp;</td><td>\nBiCGStab </td></tr>\n</table>\n</dl>\n    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga50\" doxytag=\"vfetk.h::eVfetk_NsolvType\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> enum <a class=\"el\" href=\"group__Vfetk.html#ga50\">eVfetk_NsolvType</a>\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nNon-linear solver type. \n<p>\n<dl compact><dt><b>Note:</b></dt><dd>Do not change these values; they correspond to settings in FEtk </dd></dl>\n<dl compact><dt><b>Enumeration values: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga50a10\" doxytag=\"VNT_NEW\" ></a>VNT_NEW</em>&nbsp;</td><td>\nNewton solver </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga50a11\" doxytag=\"VNT_INC\" ></a>VNT_INC</em>&nbsp;</td><td>\nIncremental </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga50a12\" doxytag=\"VNT_ARC\" ></a>VNT_ARC</em>&nbsp;</td><td>\nPsuedo-arclength </td></tr>\n</table>\n</dl>\n    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga52\" doxytag=\"vfetk.h::eVfetk_PrecType\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> enum <a class=\"el\" href=\"group__Vfetk.html#ga52\">eVfetk_PrecType</a>\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nPreconditioner type. \n<p>\n<dl compact><dt><b>Note:</b></dt><dd>Do not change these values; they correspond to settings in FEtk </dd></dl>\n<dl compact><dt><b>Enumeration values: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga52a16\" doxytag=\"VPT_IDEN\" ></a>VPT_IDEN</em>&nbsp;</td><td>\nIdentity matrix </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga52a17\" doxytag=\"VPT_DIAG\" ></a>VPT_DIAG</em>&nbsp;</td><td>\nDiagonal scaling </td></tr>\n<tr><td valign=top><em><a class=\"anchor\" name=\"gga52a18\" doxytag=\"VPT_MG\" ></a>VPT_MG</em>&nbsp;</td><td>\nMultigrid </td></tr>\n</table>\n</dl>\n    </td>\n  </tr>\n</table>\n<hr><h2>Function Documentation</h2>\n<a class=\"anchor\" name=\"ga21\" doxytag=\"vfetk.h::Bmat_printHB\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Bmat_printHB </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">Bmat *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>char *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>fname</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nWrites a Bmat to disk in Harwell-Boeing sparse matrix format. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Stephen Bond </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>This is a friend function of Bmat </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000008\">Bug:</a></b></dt><dd>Hardwired to only handle the single block symmetric case. </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>fname</em>&nbsp;</td><td>\nThe matrix to write Filename for output </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga10\" doxytag=\"vfetk.h::Vfetk_ctor\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> <a class=\"el\" href=\"structsVfetk.html\">Vfetk</a>* Vfetk_ctor </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVpbe.html\">Vpbe</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>pbe</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap><a class=\"el\" href=\"group__Vhal.html#ga0\">Vhal_PBEType</a>&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>type</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nConstructor for Vfetk object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Pointer to newly allocated Vfetk object </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>This sets up the Gem, AM, and Aprx FEtk objects but does not create a mesh. The easiest way to create a mesh is to then call Vfetk_genCube </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>type</em>&nbsp;</td><td>\nVpbe (PBE manager object) Version of PBE to solve </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga11\" doxytag=\"vfetk.h::Vfetk_ctor2\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> int Vfetk_ctor2 </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap><a class=\"el\" href=\"structsVpbe.html\">Vpbe</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>pbe</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap><a class=\"el\" href=\"group__Vhal.html#ga0\">Vhal_PBEType</a>&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>type</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nFORTRAN stub constructor for Vfetk object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>This sets up the Gem, AM, and Aprx FEtk objects but does not create a mesh. The easiest way to create a mesh is to then call Vfetk_genCube </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>pbe</em>&nbsp;</td><td>\nVfetk object memory </td></tr>\n<tr><td valign=top><em>type</em>&nbsp;</td><td>\nPBE manager object Version of PBE to solve </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga17\" doxytag=\"vfetk.h::Vfetk_dqmEnergy\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> double Vfetk_dqmEnergy </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>color</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nGet the \"mobile charge\" and \"polarization\" contributions to the electrostatic energy. \n<p>\nUsing the solution at the finest mesh level, get the electrostatic energy due to the interaction of the mobile charges with the potential and polarization of the dielectric medium: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ G = \\frac{1}{4 I_s} \\sum_i c_i q_i^2 \\int \\overline{\\kappa}^2(x) e^{-q_i u(x)} dx + \\frac{1}{2} \\int \\epsilon ( \\nabla u )^2 dx \\]\" src=\"form_59.png\">\n<p>\n for the NPBE and <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ G = \\frac{1}{2} \\int \\overline{\\kappa}^2(x) u^2(x) dx + \\frac{1}{2} \\int \\epsilon ( \\nabla u )^2 dx \\]\" src=\"form_60.png\">\n<p>\n for the LPBE. Here <img class=formulaInl alt=\"$i$\" src=\"form_17.png\"> denotes the counterion species, <img class=formulaInl alt=\"$I_s$\" src=\"form_18.png\"> is the bulk ionic strength, <img class=formulaInl alt=\"$\\overline{\\kappa}^2(x)$\" src=\"form_19.png\"> is the modified Debye-Huckel parameter, <img class=formulaInl alt=\"$c_i$\" src=\"form_20.png\"> is the concentration of species <img class=formulaInl alt=\"$i$\" src=\"form_17.png\">, <img class=formulaInl alt=\"$q_i$\" src=\"form_21.png\"> is the charge of species <img class=formulaInl alt=\"$i$\" src=\"form_17.png\">, <img class=formulaInl alt=\"$\\epsilon$\" src=\"form_25.png\"> is the dielectric function, and <img class=formulaInl alt=\"$u(x)$\" src=\"form_22.png\"> is the dimensionless electrostatic potential. The energy is scaled to units of <img class=formulaInl alt=\"$k_b T$\" src=\"form_23.png\">.<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Parameters:</b></dt><dd>\n  <table border=\"0\" cellspacing=\"2\" cellpadding=\"0\">\n    <tr><td valign=top><em>thee</em>&nbsp;</td><td>Vfetk object </td></tr>\n    <tr><td valign=top><em>color</em>&nbsp;</td><td>Partition restriction for energy evaluation, only used if non-negative </td></tr>\n  </table>\n</dl>\n<dl compact><dt><b>Returns:</b></dt><dd>The \"mobile charge\" and \"polarization\" contributions to the electrostatic energy in units of <img class=formulaInl alt=\"$k_B T$\" src=\"form_10.png\">. </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>color</em>&nbsp;</td><td>\nThe Vfetk object Partition restriction for energy calculation; if non-negative, energy calculation is restricted to the specified partition (indexed by simplex and atom colors </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga12\" doxytag=\"vfetk.h::Vfetk_dtor\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_dtor </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> **&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nObject destructor. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nPointer to memory location of Vfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga13\" doxytag=\"vfetk.h::Vfetk_dtor2\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_dtor2 </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nFORTRAN stub object destructor. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nPointer to Vfetk object to be destroyed </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga46\" doxytag=\"vfetk.h::Vfetk_dumpLocalVar\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_dumpLocalVar </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nDebugging routine to print out local variables used by PDE object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000023\">Bug:</a></b></dt><dd>This function is not thread-safe</dd></dl>\n    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga16\" doxytag=\"vfetk.h::Vfetk_energy\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> double Vfetk_energy </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>color</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>nonlin</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nReturn the total electrostatic energy. \n<p>\nUsing the solution at the finest mesh level, get the electrostatic energy using the free energy functional for the Poisson-Boltzmann equation without removing any self-interaction terms (i.e., removing the reference state of isolated charges present in an infinite dielectric continuum with the same relative permittivity as the interior of the protein) and return the result in units of <img class=formulaInl alt=\"$k_B T$\" src=\"form_10.png\">. The argument color allows the user to control the partition on which this energy is calculated; if (color == -1) no restrictions are used. The solution is obtained from the finest level of the passed AM object, but atomic data from the Vfetk object is used to calculate the energy.<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Total electrostatic energy in units of <img class=formulaInl alt=\"$k_B T$\" src=\"form_10.png\">. </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>color</em>&nbsp;</td><td>\nTHe Vfetk object </td></tr>\n<tr><td valign=top><em>nonlin</em>&nbsp;</td><td>\nPartition restriction for energy calculation; if non-negative, energy calculation is restricted to the specified partition (indexed by simplex and atom colors If 1, the NPBE energy functional is used; otherwise, the LPBE energy functional is used. </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga42\" doxytag=\"vfetk.h::Vfetk_externalUpdateFunction\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_externalUpdateFunction </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">SS **&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>simps</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>num</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nExternal hook to simplex subdivision routines in Gem. Called each time a simplex is subdivided (we use it to update the charge-simplex map). \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000022\">Bug:</a></b></dt><dd>This function is not thread-safe. </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>num</em>&nbsp;</td><td>\nList of parent (simps[0]) and children (remainder) simplices Number of simplices in list </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga47\" doxytag=\"vfetk.h::Vfetk_fillArray\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> int Vfetk_fillArray </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>Bvec *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>vec</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap><a class=\"el\" href=\"group__Vhal.html#ga34\">Vdata_Type</a>&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>type</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nFill an array with the specified data. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>This function is thread-safe </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000024\">Bug:</a></b></dt><dd>Several values of type are not implemented</dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>vec</em>&nbsp;</td><td>\nThe Vfetk object with the data </td></tr>\n<tr><td valign=top><em>type</em>&nbsp;</td><td>\nThe vector to hold the data THe type of data to write </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga22\" doxytag=\"vfetk.h::Vfetk_genCube\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> int Vfetk_genCube </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>center</em>[VAPBS_DIM], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>length</em>[VAPBS_DIM]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nGenerates a simple cubic tetrahedral mesh. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker (based on Mike Holst's Gem_makeCube code) </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>center</em>&nbsp;</td><td>\nThe Vfetk object </td></tr>\n<tr><td valign=top><em>length</em>&nbsp;</td><td>\nDesired mesh center (in &Aring;) Desired mesh length (in &Aring;) </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga6\" doxytag=\"vfetk.h::Vfetk_getAM\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> AM* Vfetk_getAM </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nGet a pointer to the AM (algebra manager) object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the AM (algebra manager) object </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nThe Vfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga9\" doxytag=\"vfetk.h::Vfetk_getAtomColor\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> int Vfetk_getAtomColor </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>iatom</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nGet the partition information for a particular atom. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>Friend function of Vatom </dd></dl>\n<dl compact><dt><b>Parameters:</b></dt><dd>\n  <table border=\"0\" cellspacing=\"2\" cellpadding=\"0\">\n    <tr><td valign=top><em>thee</em>&nbsp;</td><td>Vfetk object </td></tr>\n    <tr><td valign=top><em>iatom</em>&nbsp;</td><td>Valist atom ID </td></tr>\n  </table>\n</dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Partition ID </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>iatom</em>&nbsp;</td><td>\nThe Vfetk object Valist atom index </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga5\" doxytag=\"vfetk.h::Vfetk_getGem\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> Gem* Vfetk_getGem </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nGet a pointer to the Gem (grid manager) object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the Gem (grid manager) object </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nVfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga14\" doxytag=\"vfetk.h::Vfetk_getSolution\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> double* Vfetk_getSolution </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>length</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nCreate an array containing the solution (electrostatic potential in units of <img class=formulaInl alt=\"$k_B T/e$\" src=\"form_58.png\">) at the finest mesh level. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Michael Holst </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>The user is responsible for destroying the newly created array </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Newly created array of length \"length\" (see above); the user is responsible for destruction </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>length</em>&nbsp;</td><td>\nVfetk object with solution Ste to length of the newly created solution array </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga8\" doxytag=\"vfetk.h::Vfetk_getVcsm\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> <a class=\"el\" href=\"structsVcsm.html\">Vcsm</a>* Vfetk_getVcsm </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nGet a pointer to the Vcsm (charge-simplex map) object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the Vcsm (charge-simplex map) object </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nThe Vfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga7\" doxytag=\"vfetk.h::Vfetk_getVpbe\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> <a class=\"el\" href=\"structsVpbe.html\">Vpbe</a>* Vfetk_getVpbe </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nGet a pointer to the Vpbe (PBE manager) object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the Vpbe (PBE manager) object </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nThe Vfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga19\" doxytag=\"vfetk.h::Vfetk_memChk\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> unsigned long int Vfetk_memChk </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nReturn the memory used by this structure (and its contents) in bytes. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>The memory used by this structure and its contents in bytes </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nTHe Vfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga37\" doxytag=\"vfetk.h::Vfetk_PDE_bisectEdge\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_bisectEdge </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dim</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dimII</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>edgeType</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>vx</em>[][VAPBS_DIM]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nDefine the way manifold edges are bisected. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>This function is thread-safe. </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>dimII</em>&nbsp;</td><td>\nIntrinsic dimension of manifold </td></tr>\n<tr><td valign=top><em>edgeType</em>&nbsp;</td><td>\nEmbedding dimension of manifold </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nType of edge being refined </td></tr>\n<tr><td valign=top><em>vx</em>&nbsp;</td><td>\nChart for edge vertices, used here as accessibility bitfields Edge vertex coordindates </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga23\" doxytag=\"vfetk.h::Vfetk_PDE_ctor\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> PDE* Vfetk_PDE_ctor </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>fetk</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nConstructs the FEtk PDE object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Newly-allocated PDE object </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000009\">Bug:</a></b></dt><dd>Not thread-safe</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>fetk</em>&nbsp;</td><td>\nThe Vfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga24\" doxytag=\"vfetk.h::Vfetk_PDE_ctor2\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> int Vfetk_PDE_ctor2 </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>fetk</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nIntializes the FEtk PDE object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker (with code by Mike Holst) </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000010\">Bug:</a></b></dt><dd>Not thread-safe</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>fetk</em>&nbsp;</td><td>\nThe newly-allocated PDE object The parent Vfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga34\" doxytag=\"vfetk.h::Vfetk_PDE_delta\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_delta </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>type</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>txq</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>void *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>user</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>F</em>[]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nEvaluate a (discretized) delta function source term at the given point. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000017\">Bug:</a></b></dt><dd>This function is not thread-safe</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>type</em>&nbsp;</td><td>\nPDE object </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nVertex type </td></tr>\n<tr><td valign=top><em>txq</em>&nbsp;</td><td>\nChart for point coordinates </td></tr>\n<tr><td valign=top><em>user</em>&nbsp;</td><td>\nPoint coordinates </td></tr>\n<tr><td valign=top><em>F</em>&nbsp;</td><td>\nVertex object pointer Set to delta function value </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga33\" doxytag=\"vfetk.h::Vfetk_PDE_DFu_wv\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> double Vfetk_PDE_DFu_wv </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>key</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>W</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dW</em>[][VAPBS_DIM], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>V</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dV</em>[][VAPBS_DIM]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nThis is the linearization of the weak form of the PBE; e.g., for use in a Newton iteration. This is the functional linearization of the strong form integrated with a test function to give: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ \\int_\\Omega \\left[ \\epsilon \\nabla w \\cdot \\nabla v + b'(u) w v - f v \\right] dx \\]\" src=\"form_67.png\">\n<p>\n where <img class=formulaInl alt=\"$b'(u)$\" src=\"form_68.png\"> denotes the functional derivation of the mobile ion term. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Integrand value </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000016\">Bug:</a></b></dt><dd>This function is not thread-safe</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>key</em>&nbsp;</td><td>\nThe PDE object </td></tr>\n<tr><td valign=top><em>W</em>&nbsp;</td><td>\nIntegrand to evaluate (0 = interior weak form, 1 = boundary weak form) </td></tr>\n<tr><td valign=top><em>dW</em>&nbsp;</td><td>\nTrial function value at current point </td></tr>\n<tr><td valign=top><em>V</em>&nbsp;</td><td>\nTrial function gradient at current point </td></tr>\n<tr><td valign=top><em>dV</em>&nbsp;</td><td>\nTest function value at current point Test function gradient </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga25\" doxytag=\"vfetk.h::Vfetk_PDE_dtor\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_dtor </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE **&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nDestroys FEtk PDE object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nPointer to PDE object memory </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga26\" doxytag=\"vfetk.h::Vfetk_PDE_dtor2\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_dtor2 </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nFORTRAN stub: destroys FEtk PDE object. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nPDE object memory </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga31\" doxytag=\"vfetk.h::Vfetk_PDE_Fu\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_Fu </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>key</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>F</em>[]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nEvaluate strong form of PBE. For interior points, this is: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ -\\nabla \\cdot \\epsilon \\nabla u + b(u) - f \\]\" src=\"form_61.png\">\n<p>\n where <img class=formulaInl alt=\"$b(u)$\" src=\"form_62.png\"> is the (possibly nonlinear) mobile ion term and <img class=formulaInl alt=\"$f$\" src=\"form_63.png\"> is the source charge distribution term (for PBE) or the induced surface charge distribution (for RPBE). For an interior-boundary (simplex face) point, this is: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ [\\epsilon(x) \\nabla u(x) \\cdot n(x)]_{x=0^+} - [\\epsilon(x) \\nabla u(x) \\cdot n(x)]_{x=0^-} \\]\" src=\"form_64.png\">\n<p>\n where <img class=formulaInl alt=\"$n(x)$\" src=\"form_65.png\"> is the normal to the simplex face and the term represents the jump in dielectric displacement across the face. There is no outer-boundary contribution for this problem. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000014\">Bug:</a></b></dt><dd>This function is not thread-safe <p>\nThis function is not implemented (sets error to zero) </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>key</em>&nbsp;</td><td>\nThe PDE object </td></tr>\n<tr><td valign=top><em>F</em>&nbsp;</td><td>\nType of point (0 = interior, 1 = boundary, 2 = interior boundary Set to value of residual </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga32\" doxytag=\"vfetk.h::Vfetk_PDE_Fu_v\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> double Vfetk_PDE_Fu_v </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>key</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>V</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dV</em>[][VAPBS_DIM]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nThis is the weak form of the PBE; i.e. the strong form integrated with a test function to give: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ \\int_\\Omega \\left[ \\epsilon \\nabla u \\cdot \\nabla v + b(u) v - f v \\right] dx \\]\" src=\"form_66.png\">\n<p>\n where <img class=formulaInl alt=\"$b(u)$\" src=\"form_62.png\"> denotes the mobile ion term. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Integrand value </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000015\">Bug:</a></b></dt><dd>This function is not thread-safe</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>key</em>&nbsp;</td><td>\nThe PDE object </td></tr>\n<tr><td valign=top><em>V</em>&nbsp;</td><td>\nIntegrand to evaluate (0 = interior weak form, 1 = boundary weak form </td></tr>\n<tr><td valign=top><em>dV</em>&nbsp;</td><td>\nTest function at current point Test function derivative at current point </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga27\" doxytag=\"vfetk.h::Vfetk_PDE_initAssemble\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_initAssemble </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>ip</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>rp</em>[]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nDo once-per-assembly initialization. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>ip</em>&nbsp;</td><td>\nPDE object </td></tr>\n<tr><td valign=top><em>rp</em>&nbsp;</td><td>\nInteger parameter array (not used) Double parameter array (not used) </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga28\" doxytag=\"vfetk.h::Vfetk_PDE_initElement\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_initElement </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>elementType</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>tvx</em>[][VAPBS_DIM], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>void *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>data</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nDo once-per-element initialization. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"todo.html#_todo000001\">Todo:</a></b></dt><dd>Jump term is not implemented</dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000011\">Bug:</a></b></dt><dd>This function is not thread-safe</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>elementType</em>&nbsp;</td><td>\nPDE object </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nMaterial type (not used) </td></tr>\n<tr><td valign=top><em>tvx</em>&nbsp;</td><td>\nChart in which the vertex coordinates are provided, used here as a bitfield to store molecular accessibility </td></tr>\n<tr><td valign=top><em>data</em>&nbsp;</td><td>\nVertex coordinates Simplex pointer (hack) </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga29\" doxytag=\"vfetk.h::Vfetk_PDE_initFace\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_initFace </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>faceType</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>tnvec</em>[]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nDo once-per-face initialization. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000012\">Bug:</a></b></dt><dd>This function is not thread-safe</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>faceType</em>&nbsp;</td><td>\nTHe PDE object </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nSimplex face type (interior or various boundary types) </td></tr>\n<tr><td valign=top><em>tnvec</em>&nbsp;</td><td>\nChart in which the vertex coordinates are provided, used here as a bitfield for molecular accessibility Coordinates of outward normal vector for face </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga30\" doxytag=\"vfetk.h::Vfetk_PDE_initPoint\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_initPoint </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>pointType</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>txq</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>tU</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>tdU</em>[][VAPBS_DIM]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nDo once-per-point initialization. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000013\">Bug:</a></b></dt><dd>This function is not thread-safe <p>\nThis function uses pre-defined boudnary definitions for the molecular surface.</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>pointType</em>&nbsp;</td><td>\nThe PDE object </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nThe type of point -- interior or various faces </td></tr>\n<tr><td valign=top><em>txq</em>&nbsp;</td><td>\nThe chart in which the point coordinates are provided, used here as bitfield for molecular accessibility </td></tr>\n<tr><td valign=top><em>tU</em>&nbsp;</td><td>\nPoint coordinates </td></tr>\n<tr><td valign=top><em>tdU</em>&nbsp;</td><td>\nSolution value at point Solution derivative at point </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga41\" doxytag=\"vfetk.h::Vfetk_PDE_Ju\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> double Vfetk_PDE_Ju </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>key</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nEnergy functional. This returns the energy (less delta function terms) in the form: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ c^{-1}/2 \\int (\\epsilon (\\nabla u)^2 + \\kappa^2 (cosh u - 1)) dx \\]\" src=\"form_69.png\">\n<p>\n for a 1:1 electrolyte where <img class=formulaInl alt=\"$c$\" src=\"form_70.png\"> is the output from Vpbe_getZmagic. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>Energy value (in kT) </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000021\">Bug:</a></b></dt><dd>This function is not thread-safe.</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>key</em>&nbsp;</td><td>\nThe PDE object What to evluate: interior (0) or boundary (1)? </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga38\" doxytag=\"vfetk.h::Vfetk_PDE_mapBoundary\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_mapBoundary </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dim</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dimII</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>vertexType</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>vx</em>[VAPBS_DIM]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nMap a boundary point to some pre-defined shape. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>This function is thread-safe and is a no-op </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>dimII</em>&nbsp;</td><td>\nIntrinsic dimension of manifold </td></tr>\n<tr><td valign=top><em>vertexType</em>&nbsp;</td><td>\nEmbedding dimension of manifold </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nType of vertex </td></tr>\n<tr><td valign=top><em>vx</em>&nbsp;</td><td>\nChart for vertex coordinates Vertex coordinates </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga39\" doxytag=\"vfetk.h::Vfetk_PDE_markSimplex\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> int Vfetk_PDE_markSimplex </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dim</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dimII</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>simplexType</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>faceType</em>[VAPBS_NVS], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>vertexType</em>[VAPBS_NVS], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>vx</em>[][VAPBS_DIM], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>void *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>simplex</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nUser-defined error estimator -- in our case, a geometry-based refinement method; forcing simplex refinement at the dielectric boundary and (for non-regularized PBE) the charges. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>1 if mark simplex for refinement, 0 otherwise </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000020\">Bug:</a></b></dt><dd>This function is not thread-safe</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>dimII</em>&nbsp;</td><td>\nIntrinsic manifold dimension </td></tr>\n<tr><td valign=top><em>simplexType</em>&nbsp;</td><td>\nEmbedding manifold dimension </td></tr>\n<tr><td valign=top><em>faceType</em>&nbsp;</td><td>\nType of simplex being refined </td></tr>\n<tr><td valign=top><em>vertexType</em>&nbsp;</td><td>\nTypes of faces in simplex </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nTypes of vertices in simplex </td></tr>\n<tr><td valign=top><em>vx</em>&nbsp;</td><td>\nCharts for vertex coordinates </td></tr>\n<tr><td valign=top><em>simplex</em>&nbsp;</td><td>\nVertex coordinates Simplex pointer </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga40\" doxytag=\"vfetk.h::Vfetk_PDE_oneChart\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_oneChart </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dim</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dimII</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>objType</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>vx</em>[][VAPBS_DIM], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dimV</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nUnify the chart for different coordinate systems -- a no-op for us. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>Thread-safe; a no-op </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>dimII</em>&nbsp;</td><td>\nIntrinsic manifold dimension </td></tr>\n<tr><td valign=top><em>objType</em>&nbsp;</td><td>\nEmbedding manifold dimension </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\n??? </td></tr>\n<tr><td valign=top><em>vx</em>&nbsp;</td><td>\nCharts of vertices' coordinates </td></tr>\n<tr><td valign=top><em>dimV</em>&nbsp;</td><td>\nVertices' coordinates Number of vertices </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga44\" doxytag=\"vfetk.h::Vfetk_PDE_simplexBasisForm\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_simplexBasisForm </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>key</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dim</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>comp</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>pdkey</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>xq</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>basis</em>[]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nEvaluate the bases for the trial or test space, for a particular component of the system, at all quadrature points on the master simplex element. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Mike Holst </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>dim</em>&nbsp;</td><td>\nBasis type to evaluate (0 = trial, 1 = test, 2 = trialB, 3 = testB) </td></tr>\n<tr><td valign=top><em>comp</em>&nbsp;</td><td>\nSpatial dimension Which component of elliptic system to produce basis for </td></tr>\n<tr><td valign=top><em>xq</em>&nbsp;</td><td>\nBasis partial differential equation evaluation key: <ul>\n<li>0 = evaluate basis(x,y,z) </li>\n<li>1 = evaluate basis_x(x,y,z) </li>\n<li>2 = evaluate basis_y(x,y,z) </li>\n<li>3 = evaluate basis_z(x,y,z) </li>\n<li>4 = evaluate basis_xx(x,y,z) </li>\n<li>5 = evaluate basis_yy(x,y,z) </li>\n<li>6 = evaluate basis_zz(x,y,z) </li>\n<li>7 = etc... </li>\n</ul>\n</td></tr>\n<tr><td valign=top><em>basis</em>&nbsp;</td><td>\nSet to quad pt coordinate Set to all basis functions evaluated at all quadrature pts </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga43\" doxytag=\"vfetk.h::Vfetk_PDE_simplexBasisInit\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> int Vfetk_PDE_simplexBasisInit </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>key</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dim</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>comp</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>ndof</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>dof</em>[]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nInitialize the bases for the trial or the test space, for a particular component of the system, at all quadrature points on the master simplex element. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Mike Holst </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd><div class=\"fragment\"><pre>\n *   The basis ordering is important.  For a fixed quadrature\n *   point iq, you must follow the following ordering in p[iq][],\n *   based on how you specify the degrees of freedom in dof[]:\n *   \n *   &lt;v_0 vDF_0&gt;,      &lt;v_1 vDF_0&gt;,      ..., &lt;v_{nv} vDF_0&gt;\n *   &lt;v_0 vDF_1&gt;,      &lt;v_1 vDF_1&gt;,      ..., &lt;v_{nv} vDF_1&gt;\n *                           ...\n *   &lt;v_0 vDF_{nvDF}&gt;, &lt;v_0 vDF_{nvDF}&gt;, ..., &lt;v_{nv} vDF_{nvDF}&gt;\n *   \n *   &lt;e_0 eDF_0&gt;,      &lt;e_1 eDF_0&gt;,      ..., &lt;e_{ne} eDF_0&gt;\n *   &lt;e_0 eDF_1&gt;,      &lt;e_1 eDF_1&gt;,      ..., &lt;e_{ne} eDF_1&gt;\n *                           ...\n *   &lt;e_0 eDF_{neDF}&gt;, &lt;e_1 eDF_{neDF}&gt;, ..., &lt;e_{ne} eDF_{neDF}&gt;\n *\n *   &lt;f_0 fDF_0&gt;,      &lt;f_1 fDF_0&gt;,      ..., &lt;f_{nf} fDF_0&gt;\n *   &lt;f_0 fDF_1&gt;,      &lt;f_1 fDF_1&gt;,      ..., &lt;f_{nf} fDF_1&gt;\n *                           ...\n *   &lt;f_0 fDF_{nfDF}&gt;, &lt;f_1 fDF_{nfDF}&gt;, ..., &lt;f_{nf} fDF_{nfDF}&gt;\n *\n *   &lt;s_0 sDF_0&gt;,      &lt;s_1 sDF_0&gt;,      ..., &lt;s_{ns} sDF_0&gt;\n *   &lt;s_0 sDF_1&gt;,      &lt;s_1 sDF_1&gt;,      ..., &lt;s_{ns} sDF_1&gt;\n *                           ...\n *   &lt;s_0 sDF_{nsDF}&gt;, &lt;s_1 sDF_{nsDF}&gt;, ..., &lt;s_{ns} sDF_{nsDF}&gt;\n *\n *   For example, linear elements in R^3, with one degree of freedom at each *\n *   vertex, would use the following ordering: \n *\n *     &lt;v_0 vDF_0&gt;, &lt;v_1 vDF_0&gt;, &lt;v_2 vDF_0&gt;, &lt;v_3 vDF_0&gt; \n *\n *   Quadratic elements in R^2, with one degree of freedom at each vertex and\n *   edge, would use the following ordering: \n * \n *     &lt;v_0 vDF_0&gt;, &lt;v_1 vDF_0&gt;, &lt;v_2 vDF_0&gt; \n *     &lt;e_0 eDF_0&gt;, &lt;e_1 eDF_0&gt;, &lt;e_2 eDF_0&gt; \n *\n *   You can use different trial and test spaces for each component of the\n *   elliptic system, thereby allowing for the use of Petrov-Galerkin methods.\n *   You MUST then tag the bilinear form symmetry entries as nonsymmetric in\n *   your PDE constructor to reflect that DF(u)(w,v) will be different from\n *   DF(u)(v,w), even if your form acts symmetrically when the same basis is\n *   used for w and v.\n * \n *   You can also use different trial spaces for each component of the elliptic\n *   system, and different test spaces for each component of the elliptic\n *   system.  This allows you to e.g.  use a basis which is vertex-based for \n *   one component, and a basis which is edge-based for another.  This is\n *   useful in fluid mechanics, eletromagnetics, or simply to play around with\n *   different elements.  \n *   \n *   This function is called by MC to build new master elements whenever it\n *   reads in a new mesh.  Therefore, this function does not have to be all\n *   that fast, and e.g.  could involve symbolic computation.\n *   </pre></div></dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>dim</em>&nbsp;</td><td>\nBasis type to evaluate (0 = trial, 1 = test, 2 = trialB, 3 = testB) </td></tr>\n<tr><td valign=top><em>comp</em>&nbsp;</td><td>\nSpatial dimension </td></tr>\n<tr><td valign=top><em>ndof</em>&nbsp;</td><td>\nWhich component of elliptic system to produce basis for? </td></tr>\n<tr><td valign=top><em>dof</em>&nbsp;</td><td>\nSet to the number of degrees of freedom Set to degree of freedom per v/e/f/s </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga35\" doxytag=\"vfetk.h::Vfetk_PDE_u_D\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_u_D </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>type</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>txq</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>F</em>[]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nEvaluate the Dirichlet boundary condition at the given point. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<p>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000018\">Bug:</a></b></dt><dd>This function is hard-coded to call only multiple-sphere Debye-H&uuml; functions. <p>\nThis function is not thread-safe.</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>type</em>&nbsp;</td><td>\nPDE object </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nVertex boundary type </td></tr>\n<tr><td valign=top><em>txq</em>&nbsp;</td><td>\nChart for point coordinates </td></tr>\n<tr><td valign=top><em>F</em>&nbsp;</td><td>\nPoint coordinates Set to boundary values </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga36\" doxytag=\"vfetk.h::Vfetk_PDE_u_T\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_PDE_u_T </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\">PDE *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>type</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>chart</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>txq</em>[], </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>double&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>F</em>[]</td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nEvaluate the \"true solution\" at the given point for comparison with the numerical solution. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>This function only returns zero. </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000019\">Bug:</a></b></dt><dd>This function is not thread-safe.</dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>type</em>&nbsp;</td><td>\nPDE object </td></tr>\n<tr><td valign=top><em>chart</em>&nbsp;</td><td>\nPoint type </td></tr>\n<tr><td valign=top><em>txq</em>&nbsp;</td><td>\nChart for point coordinates </td></tr>\n<tr><td valign=top><em>F</em>&nbsp;</td><td>\nPoint coordinates Set to value at point </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga18\" doxytag=\"vfetk.h::Vfetk_qfEnergy\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> double Vfetk_qfEnergy </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>color</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nGet the \"fixed charge\" contribution to the electrostatic energy. \n<p>\nUsing the solution at the finest mesh level, get the electrostatic energy due to the interaction of the fixed charges with the potential: <p class=formulaDsp>\n<img class=formulaDsp alt=\"\\[ G = \\sum_i q_i u(r_i) \\]\" src=\"form_11.png\">\n<p>\n and return the result in units of <img class=formulaInl alt=\"$k_B T$\" src=\"form_10.png\">. Clearly, no self-interaction terms are removed. A factor a 1/2 has to be included to convert this to a real energy.<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Parameters:</b></dt><dd>\n  <table border=\"0\" cellspacing=\"2\" cellpadding=\"0\">\n    <tr><td valign=top><em>thee</em>&nbsp;</td><td>Vfetk object </td></tr>\n    <tr><td valign=top><em>color</em>&nbsp;</td><td>Partition restriction for energy evaluation, only used if non-negative </td></tr>\n  </table>\n</dl>\n<dl compact><dt><b>Returns:</b></dt><dd>The fixed charge electrostatic energy in units of <img class=formulaInl alt=\"$k_B T$\" src=\"form_10.png\">. </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>color</em>&nbsp;</td><td>\nThe Vfetk object Partition restriction for energy evaluation, only used if non-negative </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga45\" doxytag=\"vfetk.h::Vfetk_readMesh\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_readMesh </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>int&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>skey</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>Vio *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>sock</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nRead in mesh and initialize associated internal structures. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd></dd></dl>\n<dl compact><dt><b>See also:</b></dt><dd><a class=\"el\" href=\"group__Vfetk.html#ga22\">Vfetk_genCube</a> </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>skey</em>&nbsp;</td><td>\nTHe Vfetk object </td></tr>\n<tr><td valign=top><em>sock</em>&nbsp;</td><td>\nThe sock format key (0 = MCSF simplex format) Socket object ready for reading </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga20\" doxytag=\"vfetk.h::Vfetk_setAtomColors\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_setAtomColors </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname1\" valign=\"top\" nowrap> <em>thee</em>          </td>\n          <td class=\"md\" valign=\"top\">&nbsp;)&nbsp;</td>\n          <td class=\"md\" nowrap></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nTransfer color (partition ID) information frmo a partitioned mesh to the atoms. \n<p>\nTransfer color information from partitioned mesh to the atoms. In the case that a charge is shared between two partitions, the partition color of the first simplex is selected. Due to the arbitrary nature of this selection, THIS METHOD SHOULD ONLY BE USED IMMEDIATELY AFTER PARTITIONING!!! <dl compact><dt><b>Warning:</b></dt><dd>This function should only be used immediately after mesh partitioning </dd></dl>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Note:</b></dt><dd>This is a friend function of Vcsm </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>thee</em>&nbsp;</td><td>\nTHe Vfetk object </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga15\" doxytag=\"vfetk.h::Vfetk_setParameters\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> void Vfetk_setParameters </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap><a class=\"el\" href=\"structsPBEparm.html\">PBEparm</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>pbeparm</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap><a class=\"el\" href=\"structsFEMparm.html\">FEMparm</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>feparm</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nSet the parameter objects. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>pbeparm</em>&nbsp;</td><td>\nThe Vfetk object </td></tr>\n<tr><td valign=top><em>feparm</em>&nbsp;</td><td>\nParameters for solution of the PBE FEM-speecific solution parameters </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<a class=\"anchor\" name=\"ga48\" doxytag=\"vfetk.h::Vfetk_write\" ></a><p>\n<table class=\"mdTable\" width=\"100%\" cellpadding=\"2\" cellspacing=\"0\">\n  <tr>\n    <td class=\"mdRow\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td class=\"md\" nowrap valign=\"top\"> int Vfetk_write </td>\n          <td class=\"md\" valign=\"top\">(&nbsp;</td>\n          <td class=\"md\" nowrap valign=\"top\"><a class=\"el\" href=\"structsVfetk.html\">Vfetk</a> *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thee</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>const char *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>iodev</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>const char *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>iofmt</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>const char *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>thost</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>const char *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>fname</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap>Bvec *&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>vec</em>, </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td class=\"md\" nowrap><a class=\"el\" href=\"group__Vhal.html#ga35\">Vdata_Format</a>&nbsp;</td>\n          <td class=\"mdname\" nowrap> <em>format</em></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td class=\"md\">)&nbsp;</td>\n          <td class=\"md\" colspan=\"2\"></td>\n        </tr>\n\n      </table>\n    </td>\n  </tr>\n</table>\n<table cellspacing=5 cellpadding=0 border=0>\n  <tr>\n    <td>\n      &nbsp;\n    </td>\n    <td>\n\n<p>\nWrite out data. \n<p>\n<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>\n<dl compact><dt><b>Parameters:</b></dt><dd>\n  <table border=\"0\" cellspacing=\"2\" cellpadding=\"0\">\n    <tr><td valign=top><em>thee</em>&nbsp;</td><td>Vfetk object </td></tr>\n    <tr><td valign=top><em>vec</em>&nbsp;</td><td>FEtk Bvec vector to use </td></tr>\n    <tr><td valign=top><em>format</em>&nbsp;</td><td>Format for data </td></tr>\n    <tr><td valign=top><em>iodev</em>&nbsp;</td><td>Output device type (FILE/BUFF/UNIX/INET) </td></tr>\n    <tr><td valign=top><em>iofmt</em>&nbsp;</td><td>Output device format (ASCII/XDR) </td></tr>\n    <tr><td valign=top><em>thost</em>&nbsp;</td><td>Output hostname (for sockets) </td></tr>\n    <tr><td valign=top><em>fname</em>&nbsp;</td><td>Output FILE/BUFF/UNIX/INET name </td></tr>\n  </table>\n</dl>\n<dl compact><dt><b>Note:</b></dt><dd>This function is thread-safe </dd></dl>\n<dl compact><dt><b><a class=\"el\" href=\"bug.html#_bug000025\">Bug:</a></b></dt><dd>Some values of format are not implemented</dd></dl>\n<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>\n<dl compact><dt><b>Parameters: </b></dt><dd>\n<table border=0 cellspacing=2 cellpadding=0>\n<tr><td valign=top><em>iodev</em>&nbsp;</td><td>\nThe Vfetk object </td></tr>\n<tr><td valign=top><em>iofmt</em>&nbsp;</td><td>\nOutput device type (FILE = file, BUFF = buffer, UNIX = unix pipe, INET = network socket) </td></tr>\n<tr><td valign=top><em>thost</em>&nbsp;</td><td>\nOutput device format (ASCII = ascii/plaintext, XDR = xdr) </td></tr>\n<tr><td valign=top><em>fname</em>&nbsp;</td><td>\nOutput hostname for sockets </td></tr>\n<tr><td valign=top><em>vec</em>&nbsp;</td><td>\nOutput filename for other </td></tr>\n<tr><td valign=top><em>format</em>&nbsp;</td><td>\nData vector Data format </td></tr>\n</table>\n</dl>    </td>\n  </tr>\n</table>\n<hr size=\"1\"><address style=\"align: right;\"><small>Generated on Tue Dec 6 10:05:59 2005 for APBS by\n<a href=\"http://www.doxygen.org/index.html\">\n<img src=\"doxygen.png\" alt=\"doxygen\" align=\"middle\" border=0 > \n</a>1.3.5 </small></address>\n</body>\n</html>\n", "id": 42264.0}