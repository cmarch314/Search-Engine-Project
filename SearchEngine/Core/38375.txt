{"text": "OEChem C Theory Manual Version 1 3 1 Previous 5 4 Looping over the Up 5 Traversing the Atoms Next 5 6 Looping over the 5 5 Looping over the Neighbors of an Atom Often it is not the bonds around the atom that you wish to loop over but the neighboring atoms One way to do this would be to use a OEBondBase iterator and then use the OEBondBase method GetNbr which takes an OEAtomBase as input and returns the OEAtomBase of the atom across the bond from the input atom include oechem h include iostream using namespace OESystem using namespace OEChem using namespace std void ShowNeighbors OEAtomBase atm OEIter OEBondBase bond OEAtomBase nbor cerr Neighbors for bond atm GetBonds bond bond nbor bond GetNbr atm cerr nbor GetIdx cerr endl int main OEMol mol OEParseSmiles mol c1ccccc1 OEIter OEAtomBase atom for atom mol GetAtoms atom atom cerr Atom atom GetIdx ShowNeighbors atom return Download as text However this can be done even more conveniently using the OEAtomBase GetAtoms method which returns the iterator of neighboring atoms to an atom include oechem h include iostream using namespace OESystem using namespace OEChem using namespace std void ShowNeighbors OEAtomBase atm OEIter OEAtomBase nbor cerr Neighbors for nbor atm GetAtoms nbor nbor cerr nbor GetIdx cerr endl int main OEMol mol OEParseSmiles mol c1ccccc1 OEIter OEAtomBase atom for atom mol GetAtoms atom atom cerr Atom atom GetIdx ShowNeighbors atom return Download as text OEChem C Theory Manual Version 1 3 1 Previous 5 4 Looping over the Up 5 Traversing the Atoms Next 5 6 Looping over the Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/cplusprog/node47.html", "title": "5.5 looping over the neighbors of an atom", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>5.5 Looping over the Neighbors of an Atom</title>\n<META NAME=\"description\" CONTENT=\"5.5 Looping over the Neighbors of an Atom\">\n<META NAME=\"keywords\" CONTENT=\"cplusprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"cplusprog.css\">\n<link rel=\"first\" href=\"cplusprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"next\" HREF=\"node48.html\">\n<LINK REL=\"previous\" HREF=\"node46.html\">\n<LINK REL=\"up\" HREF=\"node42.html\">\n<LINK REL=\"next\" HREF=\"node48.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node46.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node42.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node48.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node46.html\">5.4 Looping over the</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node42.html\">5. Traversing the Atoms,</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node48.html\">5.6 Looping over the</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION008500000000000000000\">\n5.5 Looping over the Neighbors of an Atom</A>\n</H1>\n\n<P>\nOften it is not the bonds around the atom that you wish to loop over but\nthe neighboring atoms.  One way to do this would be to use a\nOEBondBase iterator, and then use the OEBondBase method GetNbr which\ntakes an OEAtomBase* as input, and returns the OEAtomBase* of the atom\nacross the bond from the input atom.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#include \"oechem.h\"\n#include &lt;iostream&gt;\n\nusing namespace OESystem;\nusing namespace OEChem;\nusing namespace std;\n\nvoid ShowNeighbors(OEAtomBase *atm)\n{\n  OEIter&lt;OEBondBase&gt; bond;\n  OEAtomBase *nbor;\n\n  cerr &lt;&#60; \"Neighbors: \";\n  for (bond = atm-&gt;GetBonds(); bond; ++bond)\n  {\n    nbor = bond-&gt;GetNbr(atm);\n    cerr &lt;&#60; nbor-&gt;GetIdx() &lt;&#60; \" \";\n  }\n  cerr &lt;&#60; endl;\n}\n\nint main()\n{\n  OEMol mol;\n  OEParseSmiles(mol, \"c1ccccc1\");\n\n  OEIter&lt;OEAtomBase&gt; atom;\n  for (atom=mol.GetAtoms();atom;++atom)\n  {\n    cerr &lt;&#60; \"Atom: \" &lt;&#60; atom-&gt;GetIdx() &lt;&#60; \" \";\n    ShowNeighbors(atom);\n  }\n  return 0;\n}\n</pre>\n<div class=\"verbatiminput-footer\">\n<a href=\"ch6-5.txt\" type=\"text/plain\">Download as text.</a>\n</div>\n</dd></dl>\n\n<P>\nHowever, this can be done even more conveniently using the OEAtomBase\nGetAtoms method, which returns the iterator of neighboring atoms to an\natom.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#include \"oechem.h\"\n#include &lt;iostream&gt;\n\nusing namespace OESystem;\nusing namespace OEChem;\nusing namespace std;\n\nvoid ShowNeighbors(OEAtomBase *atm)\n{\n  OEIter&lt;OEAtomBase&gt; nbor;\n\n  cerr &lt;&#60; \"Neighbors: \";\n  for (nbor = atm-&gt;GetAtoms(); nbor; ++nbor)\n  {\n    cerr &lt;&#60; nbor-&gt;GetIdx() &lt;&#60; \" \";\n  }\n  cerr &lt;&#60; endl;\n}\n\nint main()\n{\n  OEMol mol;\n  OEParseSmiles(mol, \"c1ccccc1\");\n\n  OEIter&lt;OEAtomBase&gt; atom;\n  for (atom=mol.GetAtoms();atom;++atom)\n  {\n    cerr &lt;&#60; \"Atom: \" &lt;&#60; atom-&gt;GetIdx() &lt;&#60; \" \";\n    ShowNeighbors(atom);\n  }\n  return 0;\n}\n</pre>\n<div class=\"verbatiminput-footer\">\n<a href=\"ch6-6.txt\" type=\"text/plain\">Download as text.</a>\n</div>\n</dd></dl>\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node46.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node42.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node48.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node46.html\">5.4 Looping over the</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node42.html\">5. Traversing the Atoms,</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node48.html\">5.6 Looping over the</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 38375.0}