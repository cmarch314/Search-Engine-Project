{"text": "OEChem C Theory Manual Version 1 3 1 Previous 2 4 2 OEGetIsotopicWeight Up 2 Periodic Table Functions Next 21 OEQMols and Queries 2 5 Calculating Molecular Weight of a Compound The following example demonstrates how to use OEChem s periodic table functions to perform the common task of determining the molecular weight of a compound Average molecular weight is commonly used in filtering Lipinski s Rules and as a descriptor in QSAR The use of inaccurate values for molecular weight in these applications may help explain their limited success include oechem h include iostream using namespace OEChem using namespace OESystem using namespace std double CalculateMolecularWeight const OEMolBase mol bool isotopic false OEIter OEAtomBase atom unsigned int elemno unsigned int isotope unsigned int impH double result if isotopic for atom mol GetAtoms atom atom elemno atom GetAtomicNum isotope atom GetIsotope impH atom GetImplicitHCount if elemno isotope OEIsCommonIsotope elemno isotope result OEGetIsotopicWeight elemno isotope else result OEGetAverageWeight elemno else non isotopic for atom mol GetAtoms atom atom elemno atom GetAtomicNum impH atom GetImplicitHCount result OEGetAverageWeight elemno result impH OEGetAverageWeight 1 return result int main oemolistream ims OEIter OEMolBase mol for mol ims GetMolBases mol mol cerr mol GetTitle mw CalculateMolecularWeight mol true endl return Download as text OEChem C Theory Manual Version 1 3 1 Previous 2 4 2 OEGetIsotopicWeight Up 2 Periodic Table Functions Next 21 OEQMols and Queries Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/cplusprog/node169.html", "title": "20.5 calculating molecular weight of a compound", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>20.5 Calculating Molecular Weight of a Compound</title>\n<META NAME=\"description\" CONTENT=\"20.5 Calculating Molecular Weight of a Compound\">\n<META NAME=\"keywords\" CONTENT=\"cplusprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"cplusprog.css\">\n<link rel=\"first\" href=\"cplusprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"previous\" HREF=\"node166.html\">\n<LINK REL=\"up\" HREF=\"node159.html\">\n<LINK REL=\"next\" HREF=\"node170.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node168.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node159.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node170.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node168.html\">20.4.2 OEGetIsotopicWeight</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node159.html\">20. Periodic Table Functions</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node170.html\">21. OEQMols and Queries</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION0023500000000000000000\">\n20.5 Calculating Molecular Weight of a Compound</A>\n</H1>\n\n<P>\nThe following example demonstrates how to use OEChem's periodic table\nfunctions to perform the common task of determining the molecular\nweight of a compound.  Average molecular weight is commonly used in\nfiltering (Lipinski's Rules) and as a descriptor in QSAR.  The use of\ninaccurate values for molecular weight in these applications may help\nexplain their limited success.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#include \"oechem.h\"\n#include &lt;iostream&gt;\n\nusing namespace OEChem;\nusing namespace OESystem;\nusing namespace std;\n\ndouble CalculateMolecularWeight(const OEMolBase &amp;mol,bool isotopic=false)\n{\n  OEIter&lt;OEAtomBase&gt; atom;\n  unsigned int elemno = 0;\n  unsigned int isotope = 0;\n  unsigned int impH = 0;\n  double result = 0.0;\n\n  if(isotopic)\n  {\n    for (atom=mol.GetAtoms(); atom; ++atom)\n    {\n      elemno = atom-&gt;GetAtomicNum();\n      isotope = atom-&gt;GetIsotope();\n      impH += atom-&gt;GetImplicitHCount();\n      if ((elemno!=0) &amp;&amp; (isotope!=0) &amp;&amp; OEIsCommonIsotope(elemno,isotope))\n      {\n        result += OEGetIsotopicWeight(elemno,isotope);\n      }\n      else result += OEGetAverageWeight(elemno);\n    }\n  }\n  else //non-isotopic\n  {\n    for(atom = mol.GetAtoms();atom; ++atom)\n    {\n      elemno = atom-&gt;GetAtomicNum();\n      impH += atom-&gt;GetImplicitHCount();\n      result += OEGetAverageWeight(elemno);\n    }\n  }\n  result += (impH * OEGetAverageWeight(1));\n  return result;\n}\n\nint main()\n{\n  oemolistream ims;\n\n  OEIter&lt;OEMolBase&gt; mol;\n  for (mol = ims.GetMolBases();mol;++mol)\n  {\n    cerr &lt;&#60; mol-&gt;GetTitle() &lt;&#60; \"  mw= \"\n         &lt;&#60; CalculateMolecularWeight(mol,true) &lt;&#60; endl;\n  }\n  return 0;\n}\n</pre>\n<div class=\"verbatiminput-footer\">\n<a href=\"ch20-2.txt\" type=\"text/plain\">Download as text.</a>\n</div>\n</dd></dl>\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node168.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node159.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node170.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - C++ Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><img src=\"../icons/blank_4.gif\"\n  border=\"0\" alt=\"\"></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node168.html\">20.4.2 OEGetIsotopicWeight</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node159.html\">20. Periodic Table Functions</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node170.html\">21. OEQMols and Queries</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 38737.0}