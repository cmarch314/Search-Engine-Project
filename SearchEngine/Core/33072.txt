{"text": "View Javadoc 1 package swirl workspace messages 2 3 import java rmi Naming 4 import java rmi RMISecurityManager 5 6 import org apache commons logging Log 7 import org apache commons logging LogFactory 8 import org picocontainer Startable 9 1 11 import edu uci isr yancees server rmi RemoteYanceesImplementation 12 13 14 DOCUMENT ME 15 16 author bpillet 17 18 public class YanceesServer implements Startable 19 2 TODO 21 RemoteYanceesImplementation yanceesServer 22 23 TODO 24 String name 25 26 TODO 27 YanceesConfig config 28 29 common logging logger 3 private Log log LogFactory getLog this getClass 31 32 33 Creates a new YanceesServer object 34 35 param config TODO 36 param registry TODO 37 38 public YanceesServer YanceesConfig config RMIRegistry registry 39 4 this config config 41 42 if log isDebugEnabled 43 44 log debug java endorsed dirs 45 System getProperty java endorsed dirs 46 47 48 if System getSecurityManager null 49 5 System setSecurityManager new RMISecurityManager 51 52 53 String hostname localhost 54 55 we use the peer manager algorithm to get the right interface address 56 in case there are two active interfaces at a time 57 hostname swirl workspace PeerManager getLocalAddress getHostAddress 58 59 6 try 61 62 hostname InetAddress getLocalHost getCanonicalHostName 63 hostname InetAddress getLocalHost getHostAddress 64 65 66 catch UnknownHostException e 67 68 log error Could not get local address e 69 7 71 72 the name under which this remote interface will be registered with the rmiregistry 73 name hostname 74 RemoteYanceesImplementation RMI LOOKUP NAME 75 76 77 78 TODO 79 8 public void start 81 82 try 83 84 if log isDebugEnabled 85 86 log debug starting 87 88 89 if log isDebugEnabled 9 91 log debug creating Yancees instance 92 93 94 yanceesServer new RemoteYanceesImplementation config getConfig 95 96 if log isDebugEnabled 97 98 log debug registering remote interface with rmiregistry 99 1 1 1 Naming rebind name yanceesServer 1 2 1 3 if log isDebugEnabled 1 4 1 5 log debug bound and registered as name 1 6 1 7 1 8 if log isDebugEnabled 1 9 11 log debug started 111 112 113 catch Exception e 114 115 log error Error starting yancees e 116 117 118 119 12 TODO 121 122 public void stop 123 124 if log isDebugEnabled 125 126 log debug stopping 127 128 129 try 13 131 yanceesServer shutdownYancees 132 133 catch Exception ex 134 135 log info trouble shutting down yancees server yancees needs to implement shutdown 136 ex 137 138 139 if log isDebugEnabled 14 141 log debug stopped 142 143 144 This page was automatically generated by Maven", "_id": "http://drzaius.ics.uci.edu/~swirl/impromptu-0.20/xref/swirl/workspace/messages/YanceesServer.html", "title": "yanceesserver xref", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=ISO-8859-1\" /><title>YanceesServer xref</title>\n<link type=\"text/css\" rel=\"stylesheet\" href=\"../../../stylesheet.css\" />\n</head>\n<body>\n<div id=\"overview\"><a href=\"../../../../apidocs/swirl/workspace/messages/YanceesServer.html\">View Javadoc</a></div><pre>\n\n<a name=\"1\" href=\"#1\">1</a>   <strong>package</strong> <a href=\"../../../swirl/workspace/messages/package-summary.html\">swirl.workspace.messages</a>;\n<a name=\"2\" href=\"#2\">2</a>   \n<a name=\"3\" href=\"#3\">3</a>   <strong>import</strong> java.rmi.Naming;\n<a name=\"4\" href=\"#4\">4</a>   <strong>import</strong> java.rmi.RMISecurityManager;\n<a name=\"5\" href=\"#5\">5</a>   \n<a name=\"6\" href=\"#6\">6</a>   <strong>import</strong> org.apache.commons.logging.Log;\n<a name=\"7\" href=\"#7\">7</a>   <strong>import</strong> org.apache.commons.logging.LogFactory;\n<a name=\"8\" href=\"#8\">8</a>   <strong>import</strong> org.picocontainer.Startable;\n<a name=\"9\" href=\"#9\">9</a>   \n<a name=\"10\" href=\"#10\">10</a>  \n<a name=\"11\" href=\"#11\">11</a>  <strong>import</strong> edu.uci.isr.yancees.server.rmi.RemoteYanceesImplementation;\n<a name=\"12\" href=\"#12\">12</a>  \n<a name=\"13\" href=\"#13\">13</a>  <em>/**<em>*</em></em>\n<a name=\"14\" href=\"#14\">14</a>  <em> * DOCUMENT ME!</em>\n<a name=\"15\" href=\"#15\">15</a>  <em> *</em>\n<a name=\"16\" href=\"#16\">16</a>  <em> * @author bpillet</em>\n<a name=\"17\" href=\"#17\">17</a>  <em> */</em>\n<a name=\"18\" href=\"#18\">18</a>  <strong>public</strong> <strong>class</strong> <a href=\"../../../swirl/workspace/messages/YanceesServer.html\">YanceesServer</a> implements Startable\n<a name=\"19\" href=\"#19\">19</a>  {\n<a name=\"20\" href=\"#20\">20</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"21\" href=\"#21\">21</a>      RemoteYanceesImplementation yanceesServer;\n<a name=\"22\" href=\"#22\">22</a>  \n<a name=\"23\" href=\"#23\">23</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"24\" href=\"#24\">24</a>      String name;\n<a name=\"25\" href=\"#25\">25</a>  \n<a name=\"26\" href=\"#26\">26</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"27\" href=\"#27\">27</a>      <a href=\"../../../swirl/workspace/messages/YanceesConfig.html\">YanceesConfig</a> config;\n<a name=\"28\" href=\"#28\">28</a>  \n<a name=\"29\" href=\"#29\">29</a>      <em>/**<em>* common-logging logger */</em></em>\n<a name=\"30\" href=\"#30\">30</a>      <strong>private</strong> Log log = LogFactory.getLog(<strong>this</strong>.getClass());\n<a name=\"31\" href=\"#31\">31</a>  \n<a name=\"32\" href=\"#32\">32</a>      <em>/**<em>*</em></em>\n<a name=\"33\" href=\"#33\">33</a>  <em>     * Creates a new YanceesServer object.</em>\n<a name=\"34\" href=\"#34\">34</a>  <em>     *</em>\n<a name=\"35\" href=\"#35\">35</a>  <em>     * @param config TODO</em>\n<a name=\"36\" href=\"#36\">36</a>  <em>     * @param registry TODO</em>\n<a name=\"37\" href=\"#37\">37</a>  <em>     */</em>\n<a name=\"38\" href=\"#38\">38</a>      <strong>public</strong> <a href=\"../../../swirl/workspace/messages/YanceesServer.html\">YanceesServer</a>(<a href=\"../../../swirl/workspace/messages/YanceesConfig.html\">YanceesConfig</a> config, <a href=\"../../../swirl/workspace/messages/RMIRegistry.html\">RMIRegistry</a> registry)\n<a name=\"39\" href=\"#39\">39</a>      {\n<a name=\"40\" href=\"#40\">40</a>          <strong>this</strong>.config = config;\n<a name=\"41\" href=\"#41\">41</a>  \n<a name=\"42\" href=\"#42\">42</a>          <strong>if</strong>(log.isDebugEnabled())\n<a name=\"43\" href=\"#43\">43</a>          {\n<a name=\"44\" href=\"#44\">44</a>              log.debug(<span class=\"string\">\"java.endorsed.dirs: \"</span>\n<a name=\"45\" href=\"#45\">45</a>                        + System.getProperty(<span class=\"string\">\"java.endorsed.dirs\"</span>));\n<a name=\"46\" href=\"#46\">46</a>          }\n<a name=\"47\" href=\"#47\">47</a>  \n<a name=\"48\" href=\"#48\">48</a>          <strong>if</strong>(System.getSecurityManager() == <strong>null</strong>)\n<a name=\"49\" href=\"#49\">49</a>          {\n<a name=\"50\" href=\"#50\">50</a>              System.setSecurityManager(<strong>new</strong> RMISecurityManager());\n<a name=\"51\" href=\"#51\">51</a>          }\n<a name=\"52\" href=\"#52\">52</a>  \n<a name=\"53\" href=\"#53\">53</a>          String hostname = <span class=\"string\">\"localhost\"</span>;\n<a name=\"54\" href=\"#54\">54</a>  \n<a name=\"55\" href=\"#55\">55</a>          <em class=\"comment\">// we use the peer manager algorithm to get the right interface address</em>\n<a name=\"56\" href=\"#56\">56</a>          <em class=\"comment\">// in case there are two active interfaces at a time.</em>\n<a name=\"57\" href=\"#57\">57</a>          hostname = swirl.workspace.PeerManager.getLocalAddress().getHostAddress();\n<a name=\"58\" href=\"#58\">58</a>          \n<a name=\"59\" href=\"#59\">59</a>          <em class=\"comment\">/*</em>\n<a name=\"60\" href=\"#60\">60</a>  <em class=\"comment\">        try</em>\n<a name=\"61\" href=\"#61\">61</a>  <em class=\"comment\">        {</em>\n<a name=\"62\" href=\"#62\">62</a>  <em class=\"comment\">            //hostname = InetAddress.getLocalHost().getCanonicalHostName();</em>\n<a name=\"63\" href=\"#63\">63</a>  <em class=\"comment\">            hostname = InetAddress.getLocalHost().getHostAddress();</em>\n<a name=\"64\" href=\"#64\">64</a>  <em class=\"comment\">        \t</em>\n<a name=\"65\" href=\"#65\">65</a>  <em class=\"comment\">        }</em>\n<a name=\"66\" href=\"#66\">66</a>  <em class=\"comment\">        catch(UnknownHostException e)</em>\n<a name=\"67\" href=\"#67\">67</a>  <em class=\"comment\">        {</em>\n<a name=\"68\" href=\"#68\">68</a>  <em class=\"comment\">            log.error(\"Could not get local address\", e);</em>\n<a name=\"69\" href=\"#69\">69</a>  <em class=\"comment\">        }</em>\n<a name=\"70\" href=\"#70\">70</a>  <em class=\"comment\">        */</em>\n<a name=\"71\" href=\"#71\">71</a>          \n<a name=\"72\" href=\"#72\">72</a>          <em class=\"comment\">// the name under which this remote interface will be registered with the rmiregistry</em>\n<a name=\"73\" href=\"#73\">73</a>          name = <span class=\"string\">\"//\"</span> + hostname + <span class=\"string\">\"/\"</span>\n<a name=\"74\" href=\"#74\">74</a>                 + RemoteYanceesImplementation.RMI_LOOKUP_NAME;\n<a name=\"75\" href=\"#75\">75</a>      }\n<a name=\"76\" href=\"#76\">76</a>  \n<a name=\"77\" href=\"#77\">77</a>      <em>/**<em>*</em></em>\n<a name=\"78\" href=\"#78\">78</a>  <em>     * TODO</em>\n<a name=\"79\" href=\"#79\">79</a>  <em>     */</em>\n<a name=\"80\" href=\"#80\">80</a>      <strong>public</strong> <strong>void</strong> start()\n<a name=\"81\" href=\"#81\">81</a>      {\n<a name=\"82\" href=\"#82\">82</a>          <strong>try</strong>\n<a name=\"83\" href=\"#83\">83</a>          {\n<a name=\"84\" href=\"#84\">84</a>              <strong>if</strong>(log.isDebugEnabled())\n<a name=\"85\" href=\"#85\">85</a>              {\n<a name=\"86\" href=\"#86\">86</a>                  log.debug(<span class=\"string\">\"starting\"</span>);\n<a name=\"87\" href=\"#87\">87</a>              }\n<a name=\"88\" href=\"#88\">88</a>  \n<a name=\"89\" href=\"#89\">89</a>              <strong>if</strong>(log.isDebugEnabled())\n<a name=\"90\" href=\"#90\">90</a>              {\n<a name=\"91\" href=\"#91\">91</a>                  log.debug(<span class=\"string\">\"creating Yancees instance...\"</span>);\n<a name=\"92\" href=\"#92\">92</a>              }\n<a name=\"93\" href=\"#93\">93</a>  \n<a name=\"94\" href=\"#94\">94</a>              yanceesServer = <strong>new</strong> RemoteYanceesImplementation(config.getConfig());\n<a name=\"95\" href=\"#95\">95</a>  \n<a name=\"96\" href=\"#96\">96</a>              <strong>if</strong>(log.isDebugEnabled())\n<a name=\"97\" href=\"#97\">97</a>              {\n<a name=\"98\" href=\"#98\">98</a>                  log.debug(<span class=\"string\">\"registering remote interface with rmiregistry...\"</span>);\n<a name=\"99\" href=\"#99\">99</a>              }\n<a name=\"100\" href=\"#100\">100</a> \n<a name=\"101\" href=\"#101\">101</a>             Naming.rebind(name, yanceesServer);\n<a name=\"102\" href=\"#102\">102</a> \n<a name=\"103\" href=\"#103\">103</a>             <strong>if</strong>(log.isDebugEnabled())\n<a name=\"104\" href=\"#104\">104</a>             {\n<a name=\"105\" href=\"#105\">105</a>                 log.debug(<span class=\"string\">\"bound and registered as \"</span> + name);\n<a name=\"106\" href=\"#106\">106</a>             }\n<a name=\"107\" href=\"#107\">107</a> \n<a name=\"108\" href=\"#108\">108</a>             <strong>if</strong>(log.isDebugEnabled())\n<a name=\"109\" href=\"#109\">109</a>             {\n<a name=\"110\" href=\"#110\">110</a>                 log.debug(<span class=\"string\">\"started\"</span>);\n<a name=\"111\" href=\"#111\">111</a>             }\n<a name=\"112\" href=\"#112\">112</a>         }\n<a name=\"113\" href=\"#113\">113</a>         <strong>catch</strong>(Exception e)\n<a name=\"114\" href=\"#114\">114</a>         {\n<a name=\"115\" href=\"#115\">115</a>             log.error(<span class=\"string\">\"Error starting yancees\"</span>, e);\n<a name=\"116\" href=\"#116\">116</a>         }\n<a name=\"117\" href=\"#117\">117</a>     }\n<a name=\"118\" href=\"#118\">118</a> \n<a name=\"119\" href=\"#119\">119</a>     <em>/**<em>*</em></em>\n<a name=\"120\" href=\"#120\">120</a> <em>     * TODO</em>\n<a name=\"121\" href=\"#121\">121</a> <em>     */</em>\n<a name=\"122\" href=\"#122\">122</a>     <strong>public</strong> <strong>void</strong> stop()\n<a name=\"123\" href=\"#123\">123</a>     {\n<a name=\"124\" href=\"#124\">124</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"125\" href=\"#125\">125</a>         {\n<a name=\"126\" href=\"#126\">126</a>             log.debug(<span class=\"string\">\"stopping\"</span>);\n<a name=\"127\" href=\"#127\">127</a>         }\n<a name=\"128\" href=\"#128\">128</a> \n<a name=\"129\" href=\"#129\">129</a>         <strong>try</strong>\n<a name=\"130\" href=\"#130\">130</a>         {\n<a name=\"131\" href=\"#131\">131</a>             yanceesServer.shutdownYancees();\n<a name=\"132\" href=\"#132\">132</a>         }\n<a name=\"133\" href=\"#133\">133</a>         <strong>catch</strong>(Exception ex)\n<a name=\"134\" href=\"#134\">134</a>         {\n<a name=\"135\" href=\"#135\">135</a>             log.info(<span class=\"string\">\"trouble shutting down yancees server.  yancees needs to implement shutdown\"</span>,\n<a name=\"136\" href=\"#136\">136</a>                      ex);\n<a name=\"137\" href=\"#137\">137</a>         }\n<a name=\"138\" href=\"#138\">138</a> \n<a name=\"139\" href=\"#139\">139</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"140\" href=\"#140\">140</a>         {\n<a name=\"141\" href=\"#141\">141</a>             log.debug(<span class=\"string\">\"stopped\"</span>);\n<a name=\"142\" href=\"#142\">142</a>         }\n<a name=\"143\" href=\"#143\">143</a>     }\n<a name=\"144\" href=\"#144\">144</a> }\n</pre>\n<hr/><div id=\"footer\">This page was automatically generated by <a href=\"http://maven.apache.org/\">Maven</a></div></body>\n</html>\n\n", "id": 33072.0}