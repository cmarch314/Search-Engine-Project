{"text": "View Javadoc 1 package swirl workspace viz 2 3 import java awt BorderLayout 4 import java awt Color 5 import java awt event ActionEvent 6 import java net InetAddress 7 import java net ServerSocket 8 import java util HashMap 9 import java util Hashtable 1 import java util Iterator 11 import java util Map 12 import java util Set 13 14 import javax jmdns JmDNS 15 import javax jmdns ServiceInfo 16 import javax jmdns ServiceListener 17 import javax jmdns ServiceTypeListener 18 import javax swing SwingUtilities 19 2 import org apache commons logging Log 21 import org apache commons logging LogFactory 22 23 import swirl workspace Peer 24 import swirl workspace viz pie FileElement 25 import edu uci ics jung graph Graph 26 import edu uci ics jung graph Vertex 27 import edu uci ics jung graph decorators StringLabeller 28 import edu uci ics jung graph impl UndirectedSparseEdge 29 import edu uci ics jung graph impl UndirectedSparseGraph 3 import edu uci ics jung graph impl UndirectedSparseVertex 31 import edu uci ics jung utils UserData 32 import edu uci ics jung visualization GraphDraw 33 import edu uci ics jung visualization LayoutMutable 34 import edu uci ics jung visualization VisualizationViewer 35 import edu uci ics jung visualization graphdraw SettableRenderer 36 import edu uci ics jung visualization graphdraw VertexColorFunction 37 38 39 SwirlNeighbor visualization This class displays the Swirl Neighbors and 4 non Swirl Neighbors Neighbors are discovered through JmDNS Display is 41 done through JUNG 42 43 public class SwirlNeighbor extends BaseVisualizer implements ServiceListener 44 ServiceTypeListener 45 Controller 46 47 TODO 48 private static final long serialVersionUID 1L 49 5 our own service type 51 52 TODO 53 private static String swirlType webdav tcp local 54 55 TODO 56 protected Log log LogFactory getLog this getClass 57 58 TODO 59 private Graph g 6 61 TODO 62 private GraphDraw gd 63 64 TODO 65 private JmDNS rendezvous 66 67 TODO 68 private LayoutMutable layout 69 7 TODO 71 private Map hosts new HashMap 72 73 TODO 74 private ServiceInfo myInfo 75 76 TODO 77 private StringLabeller sl 78 79 TODO 8 private Thread serverThread 81 82 TODO 83 private VisualizationViewer vv 84 85 TODO 86 private boolean selfRegister 87 88 89 Creates a new SwirlNeighbor object 9 91 param rendezvous TODO 92 93 public SwirlNeighbor JmDNS rendezvous 94 95 selfRegister false 96 this rendezvous rendezvous 97 init Swirl 98 99 1 1 1 Creates a new SwirlNeighbor object 1 2 1 3 param rendezvous TODO 1 4 param name TODO 1 5 1 6 public SwirlNeighbor JmDNS rendezvous String name 1 7 1 8 selfRegister true 1 9 this rendezvous rendezvous 11 init name 111 112 113 114 TODO 115 116 return TODO 117 118 public Controller getController 119 12 return this 121 122 123 124 TODO 125 126 return TODO 127 128 public Model getModel 129 13 return null 131 132 133 134 TODO 135 136 return TODO 137 138 public String getName 139 14 return Zeroconf Network 141 142 143 144 TODO 145 146 return TODO 147 148 public View getView 149 15 return this 151 152 153 154 TODO 155 156 param e TODO 157 158 public void actionPerformed ActionEvent e 159 16 if log isDebugEnabled 161 162 log debug actionPerformed e e 163 164 165 166 167 TODO 168 169 param jmdns TODO 17 param type TODO 171 param name TODO 172 173 public void addService JmDNS jmdns String type String name 174 175 final JmDNS jmdns jmdns 176 final String type type 177 final String name name 178 ServiceInfo si null 179 18 if log isDebugEnabled 181 182 log debug addService type name 183 184 185 try 186 187 si jmdns getServiceInfo type name 188 189 catch IllegalArgumentException e 19 191 final ServiceInfo si si 192 193 if hosts containsKey name 194 195 SwingUtilities invokeLater new Runnable 196 197 public void run 198 199 vv suspend 2 2 1 addVertex jmdns type name si 2 2 2 3 synchronized gd 2 4 2 5 layout update 2 6 2 7 2 8 if vv isVisRunnerRunning 2 9 21 vv init 211 212 else 213 214 vv unsuspend 215 216 217 vv repaint 218 gd repaint 219 22 221 222 223 224 225 TODO 226 227 param jmdns TODO 228 param type TODO 229 23 public void addServiceType JmDNS jmdns String type 231 232 jmdns addServiceListener type this 233 234 235 236 TODO 237 238 param msg TODO 239 24 public void processMessage Map msg 241 242 243 TODO 244 245 param jmdns TODO 246 param type TODO 247 param name TODO 248 249 public void removeService JmDNS jmdns String type String name 25 251 final JmDNS jmdns jmdns 252 final String type type 253 final String name name 254 ServiceInfo si null 255 256 try 257 258 si jmdns getServiceInfo type name 259 26 catch IllegalArgumentException e 261 262 final ServiceInfo si si 263 264 if hosts containsKey name 265 266 SwingUtilities invokeLater new Runnable 267 268 public void run 269 27 vv suspend 271 272 removeVertex jmdns type name si 273 274 synchronized gd 275 276 layout update 277 278 279 if vv isVisRunnerRunning 28 281 vv init 282 283 else 284 285 vv unsuspend 286 287 288 vv repaint 289 gd repaint 29 291 292 293 294 295 296 TODO 297 298 param jmdns TODO 299 param type TODO 3 param name TODO 3 1 3 2 public void resolveService JmDNS jmdns String type String name 3 3 3 4 if log isDebugEnabled 3 5 3 6 log debug Resolved name 3 7 3 8 3 9 31 311 TODO 312 313 param jmdns TODO 314 param type TODO 315 param name TODO 316 param info TODO 317 318 public void resolveService JmDNS jmdns String type String name 319 ServiceInfo info 32 321 if 322 log isDebugEnabled 323 324 System out println Resolved with props info 325 log debug Resolved with props info 326 327 328 329 33 TODO 331 332 public void start 333 334 try 335 336 rendezvous addServiceTypeListener this 337 rendezvous addServiceListener swirlType this 338 339 catch Exception ex 34 341 log error problem adding SwirlNeighbor to jmdns listeners ex 342 343 344 345 346 TODO 347 348 public void stop 349 35 if selfRegister 351 352 rendezvous unregisterService myInfo 353 354 355 rendezvous removeServiceListener SwirlNeighbor this 356 rendezvous removeServiceTypeListener SwirlNeighbor this 357 358 359 36 TODO 361 362 param peer TODO 363 364 public void userJoined Peer peer 365 366 367 TODO 368 369 param jmdns TODO 37 param type TODO 371 param name TODO 372 param si TODO 373 374 private void addVertex JmDNS jmdns String type String name 375 ServiceInfo si 376 377 if log isDebugEnabled 378 379 log debug addVertex type name 38 381 382 String name name 383 384 if type indexOf swirlType 1 385 386 name si getURL 387 388 389 if hosts containsKey name 39 391 return 392 393 394 hosts put name name 395 396 add a node 397 Vertex v new UndirectedSparseVertex 398 399 g addVertex v 4 4 1 if log isDebugEnabled 4 2 4 3 log debug called g addVertex v 4 4 4 5 4 6 associate a type 4 7 if type equals swirlType 4 8 4 9 v setUserDatum swirlType swirlType UserData CLONE 41 411 412 set a label 413 try 414 415 sl setLabel v name 416 417 catch Exception e 418 419 e printStackTrace 42 421 422 423 let s connect to a random vertex too 424 Indexer i Indexer getAndUpdateIndexer g 425 int rand int Math random g numVertices 426 Vertex v rand Vertex i getVertex rand 427 g addEdge new UndirectedSparseEdge v v rand 428 429 43 connect to every node in the same class 431 synchronized g 432 433 Set vs g getVertices 434 435 for Iterator i vs iterator i hasNext 436 437 Vertex vToConnect Vertex i next 438 439 if v equals vToConnect 44 v getUserDatum swirlType vToConnect getUserDatum swirlType 441 442 g addEdge new UndirectedSparseEdge v vToConnect 443 444 445 446 447 448 449 TODO 45 451 param name TODO 452 453 private void init String name 454 455 create a server socket and bind it to an available port 456 457 ServerSocket serv null 458 boolean done false 459 46 for int i 1 25 i 1 4 done i 461 462 try 463 464 serv new ServerSocket i 465 serverThread new Thread new ListenerThread serv 466 serverThread start 467 done true 468 469 catch Exception ex 47 471 if log isDebugEnabled 472 473 log debug problem starting neighbor server socket on port 474 i Trying next port 475 476 477 478 479 String serviceName 48 481 try 482 483 advertise ourselves via rendezvous 484 Hashtable serviceProperties new Hashtable 485 486 serviceProperties put path local 487 serviceProperties put aggregator swirl 488 489 int serviceWeight 1 49 int servicePriority 1 491 492 String hostName InetAddress getLocalHost getCanonicalHostName 493 494 listen for other non Swirl services 495 if selfRegister 496 497 rendezvous registerServiceType swirlType 498 499 5 serviceName name hostName swirlType 5 1 myInfo new ServiceInfo swirlType serviceName 5 2 serv getLocalPort serviceWeight 5 3 servicePriority serviceProperties 5 4 5 5 if selfRegister 5 6 5 7 rendezvous registerService myInfo 5 8 5 9 51 create an initial graph with one vertex for the announced service 511 otherwise the graphDraw will result in null pointer 512 g new UndirectedSparseGraph 513 sl StringLabeller getLabeller g 514 515 if selfRegister 516 517 addVertex rendezvous swirlType serviceName myInfo 518 519 52 gd new GraphDraw g 521 layout new edu uci ics jung visualization SpringLayout g 522 gd setGraphLayout layout 523 vv gd getVisualizationViewer 524 525 SettableRenderer sr gd getRender 526 527 sr setEdgeColor new Color f 528 sr setVertexColorFunction new VertexColorFunction 529 53 public Color getForeColor Vertex v 531 532 return Color blue 533 534 535 public Color getBackColor Vertex v 536 537 if v getUserDatum swirlType null 538 539 return Color green 54 541 else 542 543 return Color red 544 545 546 547 548 catch Exception ex 549 55 log error som problem ex 551 552 553 setLayout new BorderLayout 554 add gd BorderLayout CENTER 555 556 add vv BorderLayout CENTER 557 558 559 56 TODO 561 562 param jmdns TODO 563 param type TODO 564 param name TODO 565 param si TODO 566 567 private void removeVertex JmDNS jmdns String type String name 568 ServiceInfo si 569 57 String name String hosts remove name 571 572 g removeVertex sl getVertex name 573 sl removeLabel name 574 575 576 non Javadoc 577 see swirl workspace viz ModelListener flashIt swirl workspace viz pie FileElement java lang String 578 579 public void flashIt FileElement fe String uColor 58 TODO Auto generated method stub 581 582 583 584 non Javadoc 585 see swirl workspace viz ModelListener backupPromotedToPersistent swirl workspace viz pie FileElement 586 587 public void backupPromotedToPersistent FileElement file 588 TODO Auto generated method stub 589 59 591 592 non Javadoc 593 see swirl workspace viz ModelListener fileUpdated swirl workspace viz pie FileElement 594 595 public void fileUpdated FileElement file 596 TODO Auto generated method stub 597 598 599 6 6 1 6 2 6 3 6 4 TODO 6 5 6 6 author author 6 7 version Revision 1 19 6 8 6 9 class ListenerThread implements Runnable 61 611 TODO 612 ServerSocket sock 613 614 615 Creates a new ListenerThread object 616 617 param sock TODO 618 619 public ListenerThread ServerSocket sock 62 621 super 622 this sock sock 623 624 625 626 TODO 627 628 public void run 629 63 try 631 632 while sock accept null 633 634 System out println Accepting connection but ignoring it 635 636 637 catch Exception ex 638 639 ex printStackTrace 64 641 642 This page was automatically generated by Maven", "_id": "http://drzaius.ics.uci.edu/~swirl/impromptu-0.20/xref/swirl/workspace/viz/SwirlNeighbor.html", "title": "swirlneighbor xref", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=ISO-8859-1\" /><title>SwirlNeighbor xref</title>\n<link type=\"text/css\" rel=\"stylesheet\" href=\"../../../stylesheet.css\" />\n</head>\n<body>\n<div id=\"overview\"><a href=\"../../../../apidocs/swirl/workspace/viz/SwirlNeighbor.html\">View Javadoc</a></div><pre>\n\n<a name=\"1\" href=\"#1\">1</a>   <strong>package</strong> <a href=\"../../../swirl/workspace/viz/package-summary.html\">swirl.workspace.viz</a>;\n<a name=\"2\" href=\"#2\">2</a>   \n<a name=\"3\" href=\"#3\">3</a>   <strong>import</strong> java.awt.BorderLayout;\n<a name=\"4\" href=\"#4\">4</a>   <strong>import</strong> java.awt.Color;\n<a name=\"5\" href=\"#5\">5</a>   <strong>import</strong> java.awt.event.ActionEvent;\n<a name=\"6\" href=\"#6\">6</a>   <strong>import</strong> java.net.InetAddress;\n<a name=\"7\" href=\"#7\">7</a>   <strong>import</strong> java.net.ServerSocket;\n<a name=\"8\" href=\"#8\">8</a>   <strong>import</strong> java.util.HashMap;\n<a name=\"9\" href=\"#9\">9</a>   <strong>import</strong> java.util.Hashtable;\n<a name=\"10\" href=\"#10\">10</a>  <strong>import</strong> java.util.Iterator;\n<a name=\"11\" href=\"#11\">11</a>  <strong>import</strong> java.util.Map;\n<a name=\"12\" href=\"#12\">12</a>  <strong>import</strong> java.util.Set;\n<a name=\"13\" href=\"#13\">13</a>  \n<a name=\"14\" href=\"#14\">14</a>  <strong>import</strong> javax.jmdns.JmDNS;\n<a name=\"15\" href=\"#15\">15</a>  <strong>import</strong> javax.jmdns.ServiceInfo;\n<a name=\"16\" href=\"#16\">16</a>  <strong>import</strong> javax.jmdns.ServiceListener;\n<a name=\"17\" href=\"#17\">17</a>  <strong>import</strong> javax.jmdns.ServiceTypeListener;\n<a name=\"18\" href=\"#18\">18</a>  <strong>import</strong> javax.swing.SwingUtilities;\n<a name=\"19\" href=\"#19\">19</a>  \n<a name=\"20\" href=\"#20\">20</a>  <strong>import</strong> org.apache.commons.logging.Log;\n<a name=\"21\" href=\"#21\">21</a>  <strong>import</strong> org.apache.commons.logging.LogFactory;\n<a name=\"22\" href=\"#22\">22</a>  \n<a name=\"23\" href=\"#23\">23</a>  <strong>import</strong> swirl.workspace.Peer;\n<a name=\"24\" href=\"#24\">24</a>  <strong>import</strong> swirl.workspace.viz.pie.FileElement;\n<a name=\"25\" href=\"#25\">25</a>  <strong>import</strong> edu.uci.ics.jung.graph.Graph;\n<a name=\"26\" href=\"#26\">26</a>  <strong>import</strong> edu.uci.ics.jung.graph.Vertex;\n<a name=\"27\" href=\"#27\">27</a>  <strong>import</strong> edu.uci.ics.jung.graph.decorators.StringLabeller;\n<a name=\"28\" href=\"#28\">28</a>  <strong>import</strong> edu.uci.ics.jung.graph.impl.UndirectedSparseEdge;\n<a name=\"29\" href=\"#29\">29</a>  <strong>import</strong> edu.uci.ics.jung.graph.impl.UndirectedSparseGraph;\n<a name=\"30\" href=\"#30\">30</a>  <strong>import</strong> edu.uci.ics.jung.graph.impl.UndirectedSparseVertex;\n<a name=\"31\" href=\"#31\">31</a>  <strong>import</strong> edu.uci.ics.jung.utils.UserData;\n<a name=\"32\" href=\"#32\">32</a>  <strong>import</strong> edu.uci.ics.jung.visualization.GraphDraw;\n<a name=\"33\" href=\"#33\">33</a>  <strong>import</strong> edu.uci.ics.jung.visualization.LayoutMutable;\n<a name=\"34\" href=\"#34\">34</a>  <strong>import</strong> edu.uci.ics.jung.visualization.VisualizationViewer;\n<a name=\"35\" href=\"#35\">35</a>  <strong>import</strong> edu.uci.ics.jung.visualization.graphdraw.SettableRenderer;\n<a name=\"36\" href=\"#36\">36</a>  <strong>import</strong> edu.uci.ics.jung.visualization.graphdraw.VertexColorFunction;\n<a name=\"37\" href=\"#37\">37</a>  \n<a name=\"38\" href=\"#38\">38</a>  <em>/**<em>*</em></em>\n<a name=\"39\" href=\"#39\">39</a>  <em> * SwirlNeighbor visualization. This class displays the Swirl Neighbors and</em>\n<a name=\"40\" href=\"#40\">40</a>  <em> * non-Swirl Neighbors. Neighbors are discovered through JmDNS. Display is</em>\n<a name=\"41\" href=\"#41\">41</a>  <em> * done through JUNG.</em>\n<a name=\"42\" href=\"#42\">42</a>  <em> */</em>\n<a name=\"43\" href=\"#43\">43</a>  <strong>public</strong> <strong>class</strong> <a href=\"../../../swirl/workspace/viz/SwirlNeighbor.html\">SwirlNeighbor</a> <strong>extends</strong> <a href=\"../../../swirl/workspace/viz/BaseVisualizer.html\">BaseVisualizer</a> implements ServiceListener,\n<a name=\"44\" href=\"#44\">44</a>                                                               ServiceTypeListener,\n<a name=\"45\" href=\"#45\">45</a>                                                               <a href=\"../../../swirl/workspace/viz/Controller.html\">Controller</a>\n<a name=\"46\" href=\"#46\">46</a>  {\n<a name=\"47\" href=\"#47\">47</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"48\" href=\"#48\">48</a>      <strong>private</strong> <strong>static</strong> <strong>final</strong> <strong>long</strong> serialVersionUID = 1L;\n<a name=\"49\" href=\"#49\">49</a>  \n<a name=\"50\" href=\"#50\">50</a>      <em class=\"comment\">// our own service type</em>\n<a name=\"51\" href=\"#51\">51</a>  \n<a name=\"52\" href=\"#52\">52</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"53\" href=\"#53\">53</a>      <strong>private</strong> <strong>static</strong> String swirlType = <span class=\"string\">\"_webdav._tcp.local.\"</span>;\n<a name=\"54\" href=\"#54\">54</a>  \n<a name=\"55\" href=\"#55\">55</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"56\" href=\"#56\">56</a>      <strong>protected</strong> Log log = LogFactory.getLog(<strong>this</strong>.getClass());\n<a name=\"57\" href=\"#57\">57</a>  \n<a name=\"58\" href=\"#58\">58</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"59\" href=\"#59\">59</a>      <strong>private</strong> Graph g;\n<a name=\"60\" href=\"#60\">60</a>  \n<a name=\"61\" href=\"#61\">61</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"62\" href=\"#62\">62</a>      <strong>private</strong> GraphDraw gd;\n<a name=\"63\" href=\"#63\">63</a>  \n<a name=\"64\" href=\"#64\">64</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"65\" href=\"#65\">65</a>      <strong>private</strong> <a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> rendezvous;\n<a name=\"66\" href=\"#66\">66</a>  \n<a name=\"67\" href=\"#67\">67</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"68\" href=\"#68\">68</a>      <strong>private</strong> LayoutMutable layout;\n<a name=\"69\" href=\"#69\">69</a>  \n<a name=\"70\" href=\"#70\">70</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"71\" href=\"#71\">71</a>      <strong>private</strong> Map hosts = <strong>new</strong> HashMap();\n<a name=\"72\" href=\"#72\">72</a>  \n<a name=\"73\" href=\"#73\">73</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"74\" href=\"#74\">74</a>      <strong>private</strong> <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a> myInfo;\n<a name=\"75\" href=\"#75\">75</a>  \n<a name=\"76\" href=\"#76\">76</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"77\" href=\"#77\">77</a>      <strong>private</strong> StringLabeller sl;\n<a name=\"78\" href=\"#78\">78</a>  \n<a name=\"79\" href=\"#79\">79</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"80\" href=\"#80\">80</a>      <strong>private</strong> Thread serverThread;\n<a name=\"81\" href=\"#81\">81</a>  \n<a name=\"82\" href=\"#82\">82</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"83\" href=\"#83\">83</a>      <strong>private</strong> VisualizationViewer vv;\n<a name=\"84\" href=\"#84\">84</a>  \n<a name=\"85\" href=\"#85\">85</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"86\" href=\"#86\">86</a>      <strong>private</strong> <strong>boolean</strong> selfRegister;\n<a name=\"87\" href=\"#87\">87</a>  \n<a name=\"88\" href=\"#88\">88</a>      <em>/**<em>*</em></em>\n<a name=\"89\" href=\"#89\">89</a>  <em>     * Creates a new SwirlNeighbor object.</em>\n<a name=\"90\" href=\"#90\">90</a>  <em>     *</em>\n<a name=\"91\" href=\"#91\">91</a>  <em>     * @param rendezvous TODO</em>\n<a name=\"92\" href=\"#92\">92</a>  <em>     */</em>\n<a name=\"93\" href=\"#93\">93</a>      <strong>public</strong> <a href=\"../../../swirl/workspace/viz/SwirlNeighbor.html\">SwirlNeighbor</a>(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> rendezvous)\n<a name=\"94\" href=\"#94\">94</a>      {\n<a name=\"95\" href=\"#95\">95</a>          selfRegister = false;\n<a name=\"96\" href=\"#96\">96</a>          <strong>this</strong>.rendezvous = rendezvous;\n<a name=\"97\" href=\"#97\">97</a>          init(<span class=\"string\">\"Swirl\"</span>);\n<a name=\"98\" href=\"#98\">98</a>      }\n<a name=\"99\" href=\"#99\">99</a>  \n<a name=\"100\" href=\"#100\">100</a>     <em>/**<em>*</em></em>\n<a name=\"101\" href=\"#101\">101</a> <em>     * Creates a new SwirlNeighbor object.</em>\n<a name=\"102\" href=\"#102\">102</a> <em>     *</em>\n<a name=\"103\" href=\"#103\">103</a> <em>     * @param rendezvous TODO</em>\n<a name=\"104\" href=\"#104\">104</a> <em>     * @param name TODO</em>\n<a name=\"105\" href=\"#105\">105</a> <em>     */</em>\n<a name=\"106\" href=\"#106\">106</a>     <strong>public</strong> <a href=\"../../../swirl/workspace/viz/SwirlNeighbor.html\">SwirlNeighbor</a>(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> rendezvous, String name)\n<a name=\"107\" href=\"#107\">107</a>     {\n<a name=\"108\" href=\"#108\">108</a>         selfRegister = <strong>true</strong>;\n<a name=\"109\" href=\"#109\">109</a>         <strong>this</strong>.rendezvous = rendezvous;\n<a name=\"110\" href=\"#110\">110</a>         init(name);\n<a name=\"111\" href=\"#111\">111</a>     }\n<a name=\"112\" href=\"#112\">112</a> \n<a name=\"113\" href=\"#113\">113</a>     <em>/**<em>*</em></em>\n<a name=\"114\" href=\"#114\">114</a> <em>     * TODO</em>\n<a name=\"115\" href=\"#115\">115</a> <em>     *</em>\n<a name=\"116\" href=\"#116\">116</a> <em>     * @return TODO</em>\n<a name=\"117\" href=\"#117\">117</a> <em>     */</em>\n<a name=\"118\" href=\"#118\">118</a>     <strong>public</strong> <a href=\"../../../swirl/workspace/viz/Controller.html\">Controller</a> getController()\n<a name=\"119\" href=\"#119\">119</a>     {\n<a name=\"120\" href=\"#120\">120</a>         <strong>return</strong> <strong>this</strong>;\n<a name=\"121\" href=\"#121\">121</a>     }\n<a name=\"122\" href=\"#122\">122</a> \n<a name=\"123\" href=\"#123\">123</a>     <em>/**<em>*</em></em>\n<a name=\"124\" href=\"#124\">124</a> <em>     * TODO</em>\n<a name=\"125\" href=\"#125\">125</a> <em>     *</em>\n<a name=\"126\" href=\"#126\">126</a> <em>     * @return TODO</em>\n<a name=\"127\" href=\"#127\">127</a> <em>     */</em>\n<a name=\"128\" href=\"#128\">128</a>     <strong>public</strong> <a href=\"../../../swirl/workspace/viz/Model.html\">Model</a> getModel()\n<a name=\"129\" href=\"#129\">129</a>     {\n<a name=\"130\" href=\"#130\">130</a>         <strong>return</strong> <strong>null</strong>;\n<a name=\"131\" href=\"#131\">131</a>     }\n<a name=\"132\" href=\"#132\">132</a> \n<a name=\"133\" href=\"#133\">133</a>     <em>/**<em>*</em></em>\n<a name=\"134\" href=\"#134\">134</a> <em>     * TODO</em>\n<a name=\"135\" href=\"#135\">135</a> <em>     *</em>\n<a name=\"136\" href=\"#136\">136</a> <em>     * @return TODO</em>\n<a name=\"137\" href=\"#137\">137</a> <em>     */</em>\n<a name=\"138\" href=\"#138\">138</a>     <strong>public</strong> String getName()\n<a name=\"139\" href=\"#139\">139</a>     {\n<a name=\"140\" href=\"#140\">140</a>         <strong>return</strong> <span class=\"string\">\"Zeroconf Network\"</span>;\n<a name=\"141\" href=\"#141\">141</a>     }\n<a name=\"142\" href=\"#142\">142</a> \n<a name=\"143\" href=\"#143\">143</a>     <em>/**<em>*</em></em>\n<a name=\"144\" href=\"#144\">144</a> <em>     * TODO</em>\n<a name=\"145\" href=\"#145\">145</a> <em>     *</em>\n<a name=\"146\" href=\"#146\">146</a> <em>     * @return TODO</em>\n<a name=\"147\" href=\"#147\">147</a> <em>     */</em>\n<a name=\"148\" href=\"#148\">148</a>     <strong>public</strong> <a href=\"../../../swirl/workspace/viz/View.html\">View</a> getView()\n<a name=\"149\" href=\"#149\">149</a>     {\n<a name=\"150\" href=\"#150\">150</a>         <strong>return</strong> <strong>this</strong>;\n<a name=\"151\" href=\"#151\">151</a>     }\n<a name=\"152\" href=\"#152\">152</a> \n<a name=\"153\" href=\"#153\">153</a>     <em>/**<em>*</em></em>\n<a name=\"154\" href=\"#154\">154</a> <em>     * TODO</em>\n<a name=\"155\" href=\"#155\">155</a> <em>     *</em>\n<a name=\"156\" href=\"#156\">156</a> <em>     * @param e TODO</em>\n<a name=\"157\" href=\"#157\">157</a> <em>     */</em>\n<a name=\"158\" href=\"#158\">158</a>     <strong>public</strong> <strong>void</strong> actionPerformed(ActionEvent e)\n<a name=\"159\" href=\"#159\">159</a>     {\n<a name=\"160\" href=\"#160\">160</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"161\" href=\"#161\">161</a>         {\n<a name=\"162\" href=\"#162\">162</a>             log.debug(<span class=\"string\">\"actionPerformed() e: \"</span> + e);\n<a name=\"163\" href=\"#163\">163</a>         }\n<a name=\"164\" href=\"#164\">164</a>     }\n<a name=\"165\" href=\"#165\">165</a> \n<a name=\"166\" href=\"#166\">166</a>     <em>/**<em>*</em></em>\n<a name=\"167\" href=\"#167\">167</a> <em>     * TODO</em>\n<a name=\"168\" href=\"#168\">168</a> <em>     *</em>\n<a name=\"169\" href=\"#169\">169</a> <em>     * @param _jmdns TODO</em>\n<a name=\"170\" href=\"#170\">170</a> <em>     * @param _type TODO</em>\n<a name=\"171\" href=\"#171\">171</a> <em>     * @param _name TODO</em>\n<a name=\"172\" href=\"#172\">172</a> <em>     */</em>\n<a name=\"173\" href=\"#173\">173</a>     <strong>public</strong> <strong>void</strong> addService(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> _jmdns, String _type, String _name)\n<a name=\"174\" href=\"#174\">174</a>     {\n<a name=\"175\" href=\"#175\">175</a>         <strong>final</strong> <a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> jmdns = _jmdns;\n<a name=\"176\" href=\"#176\">176</a>         <strong>final</strong> String type = _type;\n<a name=\"177\" href=\"#177\">177</a>         <strong>final</strong> String name = _name;\n<a name=\"178\" href=\"#178\">178</a>         <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a> _si = <strong>null</strong>;\n<a name=\"179\" href=\"#179\">179</a> \n<a name=\"180\" href=\"#180\">180</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"181\" href=\"#181\">181</a>         {\n<a name=\"182\" href=\"#182\">182</a>             log.debug(<span class=\"string\">\"addService \"</span> + _type + <span class=\"string\">\"  \"</span> + _name);\n<a name=\"183\" href=\"#183\">183</a>         }\n<a name=\"184\" href=\"#184\">184</a> \n<a name=\"185\" href=\"#185\">185</a>         <strong>try</strong>\n<a name=\"186\" href=\"#186\">186</a>         {\n<a name=\"187\" href=\"#187\">187</a>             _si = jmdns.getServiceInfo(type, name);\n<a name=\"188\" href=\"#188\">188</a>         }\n<a name=\"189\" href=\"#189\">189</a>         <strong>catch</strong>(IllegalArgumentException e){}\n<a name=\"190\" href=\"#190\">190</a> \n<a name=\"191\" href=\"#191\">191</a>         <strong>final</strong> <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a> si = _si;\n<a name=\"192\" href=\"#192\">192</a> \n<a name=\"193\" href=\"#193\">193</a>         <strong>if</strong>(!hosts.containsKey(_name))\n<a name=\"194\" href=\"#194\">194</a>         {\n<a name=\"195\" href=\"#195\">195</a>             SwingUtilities.invokeLater(<strong>new</strong> Runnable()\n<a name=\"196\" href=\"#196\">196</a>                 {\n<a name=\"197\" href=\"#197\">197</a>                     <strong>public</strong> <strong>void</strong> run()\n<a name=\"198\" href=\"#198\">198</a>                     {\n<a name=\"199\" href=\"#199\">199</a>                         vv.suspend();\n<a name=\"200\" href=\"#200\">200</a> \n<a name=\"201\" href=\"#201\">201</a>                         addVertex(jmdns, type, name, si);\n<a name=\"202\" href=\"#202\">202</a> \n<a name=\"203\" href=\"#203\">203</a>                         <strong>synchronized</strong>(gd)\n<a name=\"204\" href=\"#204\">204</a>                         {\n<a name=\"205\" href=\"#205\">205</a>                             layout.update();\n<a name=\"206\" href=\"#206\">206</a>                         }\n<a name=\"207\" href=\"#207\">207</a> \n<a name=\"208\" href=\"#208\">208</a>                         <strong>if</strong>(!vv.isVisRunnerRunning())\n<a name=\"209\" href=\"#209\">209</a>                         {\n<a name=\"210\" href=\"#210\">210</a>                             vv.init();\n<a name=\"211\" href=\"#211\">211</a>                         }\n<a name=\"212\" href=\"#212\">212</a>                         <strong>else</strong>\n<a name=\"213\" href=\"#213\">213</a>                         {\n<a name=\"214\" href=\"#214\">214</a>                             vv.unsuspend();\n<a name=\"215\" href=\"#215\">215</a>                         }\n<a name=\"216\" href=\"#216\">216</a> \n<a name=\"217\" href=\"#217\">217</a>                         vv.repaint();\n<a name=\"218\" href=\"#218\">218</a>                         gd.repaint();\n<a name=\"219\" href=\"#219\">219</a>                     }\n<a name=\"220\" href=\"#220\">220</a>                 });\n<a name=\"221\" href=\"#221\">221</a>         }\n<a name=\"222\" href=\"#222\">222</a>     }\n<a name=\"223\" href=\"#223\">223</a> \n<a name=\"224\" href=\"#224\">224</a>     <em>/**<em>*</em></em>\n<a name=\"225\" href=\"#225\">225</a> <em>     * TODO</em>\n<a name=\"226\" href=\"#226\">226</a> <em>     *</em>\n<a name=\"227\" href=\"#227\">227</a> <em>     * @param jmdns TODO</em>\n<a name=\"228\" href=\"#228\">228</a> <em>     * @param type TODO</em>\n<a name=\"229\" href=\"#229\">229</a> <em>     */</em>\n<a name=\"230\" href=\"#230\">230</a>     <strong>public</strong> <strong>void</strong> addServiceType(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> jmdns, String type)\n<a name=\"231\" href=\"#231\">231</a>     {\n<a name=\"232\" href=\"#232\">232</a>         jmdns.addServiceListener(type, <strong>this</strong>);\n<a name=\"233\" href=\"#233\">233</a>     }\n<a name=\"234\" href=\"#234\">234</a> \n<a name=\"235\" href=\"#235\">235</a>     <em>/**<em>*</em></em>\n<a name=\"236\" href=\"#236\">236</a> <em>     * TODO</em>\n<a name=\"237\" href=\"#237\">237</a> <em>     *</em>\n<a name=\"238\" href=\"#238\">238</a> <em>     * @param msg TODO</em>\n<a name=\"239\" href=\"#239\">239</a> <em>     */</em>\n<a name=\"240\" href=\"#240\">240</a>     <strong>public</strong> <strong>void</strong> processMessage(Map msg){}\n<a name=\"241\" href=\"#241\">241</a> \n<a name=\"242\" href=\"#242\">242</a>     <em>/**<em>*</em></em>\n<a name=\"243\" href=\"#243\">243</a> <em>     * TODO</em>\n<a name=\"244\" href=\"#244\">244</a> <em>     *</em>\n<a name=\"245\" href=\"#245\">245</a> <em>     * @param _jmdns TODO</em>\n<a name=\"246\" href=\"#246\">246</a> <em>     * @param _type TODO</em>\n<a name=\"247\" href=\"#247\">247</a> <em>     * @param _name TODO</em>\n<a name=\"248\" href=\"#248\">248</a> <em>     */</em>\n<a name=\"249\" href=\"#249\">249</a>     <strong>public</strong> <strong>void</strong> removeService(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> _jmdns, String _type, String _name)\n<a name=\"250\" href=\"#250\">250</a>     {\n<a name=\"251\" href=\"#251\">251</a>         <strong>final</strong> <a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> jmdns = _jmdns;\n<a name=\"252\" href=\"#252\">252</a>         <strong>final</strong> String type = _type;\n<a name=\"253\" href=\"#253\">253</a>         <strong>final</strong> String name = _name;\n<a name=\"254\" href=\"#254\">254</a>         <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a> _si = <strong>null</strong>;\n<a name=\"255\" href=\"#255\">255</a> \n<a name=\"256\" href=\"#256\">256</a>         <strong>try</strong>\n<a name=\"257\" href=\"#257\">257</a>         {\n<a name=\"258\" href=\"#258\">258</a>             _si = jmdns.getServiceInfo(type, name);\n<a name=\"259\" href=\"#259\">259</a>         }\n<a name=\"260\" href=\"#260\">260</a>         <strong>catch</strong>(IllegalArgumentException e){}\n<a name=\"261\" href=\"#261\">261</a> \n<a name=\"262\" href=\"#262\">262</a>         <strong>final</strong> <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a> si = _si;\n<a name=\"263\" href=\"#263\">263</a> \n<a name=\"264\" href=\"#264\">264</a>         <strong>if</strong>(hosts.containsKey(_name))\n<a name=\"265\" href=\"#265\">265</a>         {\n<a name=\"266\" href=\"#266\">266</a>             SwingUtilities.invokeLater(<strong>new</strong> Runnable()\n<a name=\"267\" href=\"#267\">267</a>                 {\n<a name=\"268\" href=\"#268\">268</a>                     <strong>public</strong> <strong>void</strong> run()\n<a name=\"269\" href=\"#269\">269</a>                     {\n<a name=\"270\" href=\"#270\">270</a>                         vv.suspend();\n<a name=\"271\" href=\"#271\">271</a> \n<a name=\"272\" href=\"#272\">272</a>                         removeVertex(jmdns, type, name, si);\n<a name=\"273\" href=\"#273\">273</a> \n<a name=\"274\" href=\"#274\">274</a>                         <strong>synchronized</strong>(gd)\n<a name=\"275\" href=\"#275\">275</a>                         {\n<a name=\"276\" href=\"#276\">276</a>                             layout.update();\n<a name=\"277\" href=\"#277\">277</a>                         }\n<a name=\"278\" href=\"#278\">278</a> \n<a name=\"279\" href=\"#279\">279</a>                         <strong>if</strong>(!vv.isVisRunnerRunning())\n<a name=\"280\" href=\"#280\">280</a>                         {\n<a name=\"281\" href=\"#281\">281</a>                             vv.init();\n<a name=\"282\" href=\"#282\">282</a>                         }\n<a name=\"283\" href=\"#283\">283</a>                         <strong>else</strong>\n<a name=\"284\" href=\"#284\">284</a>                         {\n<a name=\"285\" href=\"#285\">285</a>                             vv.unsuspend();\n<a name=\"286\" href=\"#286\">286</a>                         }\n<a name=\"287\" href=\"#287\">287</a> \n<a name=\"288\" href=\"#288\">288</a>                         vv.repaint();\n<a name=\"289\" href=\"#289\">289</a>                         gd.repaint();\n<a name=\"290\" href=\"#290\">290</a>                     }\n<a name=\"291\" href=\"#291\">291</a>                 });\n<a name=\"292\" href=\"#292\">292</a>         }\n<a name=\"293\" href=\"#293\">293</a>     }\n<a name=\"294\" href=\"#294\">294</a> \n<a name=\"295\" href=\"#295\">295</a>     <em>/**<em>*</em></em>\n<a name=\"296\" href=\"#296\">296</a> <em>     * TODO</em>\n<a name=\"297\" href=\"#297\">297</a> <em>     *</em>\n<a name=\"298\" href=\"#298\">298</a> <em>     * @param jmdns TODO</em>\n<a name=\"299\" href=\"#299\">299</a> <em>     * @param type TODO</em>\n<a name=\"300\" href=\"#300\">300</a> <em>     * @param name TODO</em>\n<a name=\"301\" href=\"#301\">301</a> <em>     */</em>\n<a name=\"302\" href=\"#302\">302</a>     <strong>public</strong> <strong>void</strong> resolveService(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> jmdns, String type, String name)\n<a name=\"303\" href=\"#303\">303</a>     {\n<a name=\"304\" href=\"#304\">304</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"305\" href=\"#305\">305</a>         {\n<a name=\"306\" href=\"#306\">306</a>             log.debug(<span class=\"string\">\"Resolved: \"</span> + name);\n<a name=\"307\" href=\"#307\">307</a>         }\n<a name=\"308\" href=\"#308\">308</a>     }\n<a name=\"309\" href=\"#309\">309</a> \n<a name=\"310\" href=\"#310\">310</a>     <em>/**<em>*</em></em>\n<a name=\"311\" href=\"#311\">311</a> <em>     * TODO</em>\n<a name=\"312\" href=\"#312\">312</a> <em>     *</em>\n<a name=\"313\" href=\"#313\">313</a> <em>     * @param jmdns TODO</em>\n<a name=\"314\" href=\"#314\">314</a> <em>     * @param type TODO</em>\n<a name=\"315\" href=\"#315\">315</a> <em>     * @param name TODO</em>\n<a name=\"316\" href=\"#316\">316</a> <em>     * @param info TODO</em>\n<a name=\"317\" href=\"#317\">317</a> <em>     */</em>\n<a name=\"318\" href=\"#318\">318</a>     <strong>public</strong> <strong>void</strong> resolveService(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> jmdns, String type, String name,\n<a name=\"319\" href=\"#319\">319</a>                                <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a> info)\n<a name=\"320\" href=\"#320\">320</a>     {\n<a name=\"321\" href=\"#321\">321</a>         <strong>if</strong>(\n<a name=\"322\" href=\"#322\">322</a>         log.isDebugEnabled())\n<a name=\"323\" href=\"#323\">323</a>         {\n<a name=\"324\" href=\"#324\">324</a>             <em class=\"comment\">//System.out.println(\"Resolved with props: \" + info);</em>\n<a name=\"325\" href=\"#325\">325</a>             log.debug(<span class=\"string\">\"Resolved with props: \"</span> + info);\n<a name=\"326\" href=\"#326\">326</a>         }\n<a name=\"327\" href=\"#327\">327</a>     }\n<a name=\"328\" href=\"#328\">328</a> \n<a name=\"329\" href=\"#329\">329</a>     <em>/**<em>*</em></em>\n<a name=\"330\" href=\"#330\">330</a> <em>     * TODO</em>\n<a name=\"331\" href=\"#331\">331</a> <em>     */</em>\n<a name=\"332\" href=\"#332\">332</a>     <strong>public</strong> <strong>void</strong> start()\n<a name=\"333\" href=\"#333\">333</a>     {\n<a name=\"334\" href=\"#334\">334</a>         <strong>try</strong>\n<a name=\"335\" href=\"#335\">335</a>         {\n<a name=\"336\" href=\"#336\">336</a>             rendezvous.addServiceTypeListener(<strong>this</strong>);\n<a name=\"337\" href=\"#337\">337</a>             rendezvous.addServiceListener(swirlType, <strong>this</strong>);\n<a name=\"338\" href=\"#338\">338</a>         }\n<a name=\"339\" href=\"#339\">339</a>         <strong>catch</strong>(Exception ex)\n<a name=\"340\" href=\"#340\">340</a>         {\n<a name=\"341\" href=\"#341\">341</a>             log.error(<span class=\"string\">\"problem adding SwirlNeighbor to jmdns listeners\"</span>, ex);\n<a name=\"342\" href=\"#342\">342</a>         }\n<a name=\"343\" href=\"#343\">343</a>     }\n<a name=\"344\" href=\"#344\">344</a> \n<a name=\"345\" href=\"#345\">345</a>     <em>/**<em>*</em></em>\n<a name=\"346\" href=\"#346\">346</a> <em>     * TODO</em>\n<a name=\"347\" href=\"#347\">347</a> <em>     */</em>\n<a name=\"348\" href=\"#348\">348</a>     <strong>public</strong> <strong>void</strong> stop()\n<a name=\"349\" href=\"#349\">349</a>     {\n<a name=\"350\" href=\"#350\">350</a>         <strong>if</strong>(selfRegister)\n<a name=\"351\" href=\"#351\">351</a>         {\n<a name=\"352\" href=\"#352\">352</a>             rendezvous.unregisterService(myInfo);\n<a name=\"353\" href=\"#353\">353</a>         }\n<a name=\"354\" href=\"#354\">354</a> \n<a name=\"355\" href=\"#355\">355</a>         rendezvous.removeServiceListener(SwirlNeighbor.<strong>this</strong>);\n<a name=\"356\" href=\"#356\">356</a>         rendezvous.removeServiceTypeListener(SwirlNeighbor.<strong>this</strong>);\n<a name=\"357\" href=\"#357\">357</a>     }\n<a name=\"358\" href=\"#358\">358</a> \n<a name=\"359\" href=\"#359\">359</a>     <em>/**<em>*</em></em>\n<a name=\"360\" href=\"#360\">360</a> <em>     * TODO</em>\n<a name=\"361\" href=\"#361\">361</a> <em>     *</em>\n<a name=\"362\" href=\"#362\">362</a> <em>     * @param peer TODO</em>\n<a name=\"363\" href=\"#363\">363</a> <em>     */</em>\n<a name=\"364\" href=\"#364\">364</a>     <strong>public</strong> <strong>void</strong> userJoined(<a href=\"../../../swirl/workspace/Peer.html\">Peer</a> peer){}\n<a name=\"365\" href=\"#365\">365</a> \n<a name=\"366\" href=\"#366\">366</a>     <em>/**<em>*</em></em>\n<a name=\"367\" href=\"#367\">367</a> <em>     * TODO</em>\n<a name=\"368\" href=\"#368\">368</a> <em>     *</em>\n<a name=\"369\" href=\"#369\">369</a> <em>     * @param jmdns TODO</em>\n<a name=\"370\" href=\"#370\">370</a> <em>     * @param type TODO</em>\n<a name=\"371\" href=\"#371\">371</a> <em>     * @param _name TODO</em>\n<a name=\"372\" href=\"#372\">372</a> <em>     * @param si TODO</em>\n<a name=\"373\" href=\"#373\">373</a> <em>     */</em>\n<a name=\"374\" href=\"#374\">374</a>     <strong>private</strong> <strong>void</strong> addVertex(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> jmdns, String type, String _name,\n<a name=\"375\" href=\"#375\">375</a>                            <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a> si)\n<a name=\"376\" href=\"#376\">376</a>     {\n<a name=\"377\" href=\"#377\">377</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"378\" href=\"#378\">378</a>         {\n<a name=\"379\" href=\"#379\">379</a>             log.debug(<span class=\"string\">\"addVertex \"</span> + type + <span class=\"string\">\"  \"</span> + _name);\n<a name=\"380\" href=\"#380\">380</a>         }\n<a name=\"381\" href=\"#381\">381</a> \n<a name=\"382\" href=\"#382\">382</a>         String name = _name;\n<a name=\"383\" href=\"#383\">383</a> \n<a name=\"384\" href=\"#384\">384</a>         <strong>if</strong>(type.indexOf(swirlType) != -1)\n<a name=\"385\" href=\"#385\">385</a>         {\n<a name=\"386\" href=\"#386\">386</a>             name = si.getURL();\n<a name=\"387\" href=\"#387\">387</a>         }\n<a name=\"388\" href=\"#388\">388</a> \n<a name=\"389\" href=\"#389\">389</a>         <strong>if</strong>(hosts.containsKey(_name))\n<a name=\"390\" href=\"#390\">390</a>         {\n<a name=\"391\" href=\"#391\">391</a>             <strong>return</strong>;\n<a name=\"392\" href=\"#392\">392</a>         }\n<a name=\"393\" href=\"#393\">393</a> \n<a name=\"394\" href=\"#394\">394</a>         hosts.put(_name, name);\n<a name=\"395\" href=\"#395\">395</a> \n<a name=\"396\" href=\"#396\">396</a>         <em class=\"comment\">// add a node,</em>\n<a name=\"397\" href=\"#397\">397</a>         Vertex v = <strong>new</strong> UndirectedSparseVertex();\n<a name=\"398\" href=\"#398\">398</a> \n<a name=\"399\" href=\"#399\">399</a>         g.addVertex(v);\n<a name=\"400\" href=\"#400\">400</a> \n<a name=\"401\" href=\"#401\">401</a>         <strong>if</strong>(log.isDebugEnabled())\n<a name=\"402\" href=\"#402\">402</a>         {\n<a name=\"403\" href=\"#403\">403</a>             log.debug(<span class=\"string\">\"called g.addVertex(\"</span> + v + <span class=\"string\">\")\"</span>);\n<a name=\"404\" href=\"#404\">404</a>         }\n<a name=\"405\" href=\"#405\">405</a> \n<a name=\"406\" href=\"#406\">406</a>         <em class=\"comment\">// associate a type</em>\n<a name=\"407\" href=\"#407\">407</a>         <strong>if</strong>(type.equals(swirlType))\n<a name=\"408\" href=\"#408\">408</a>         {\n<a name=\"409\" href=\"#409\">409</a>             v.setUserDatum(swirlType, swirlType, UserData.CLONE);\n<a name=\"410\" href=\"#410\">410</a>         }\n<a name=\"411\" href=\"#411\">411</a> \n<a name=\"412\" href=\"#412\">412</a>         <em class=\"comment\">// set a label</em>\n<a name=\"413\" href=\"#413\">413</a>         <strong>try</strong>\n<a name=\"414\" href=\"#414\">414</a>         {\n<a name=\"415\" href=\"#415\">415</a>             sl.setLabel(v, name);\n<a name=\"416\" href=\"#416\">416</a>         }\n<a name=\"417\" href=\"#417\">417</a>         <strong>catch</strong>(Exception e)\n<a name=\"418\" href=\"#418\">418</a>         {\n<a name=\"419\" href=\"#419\">419</a>             e.printStackTrace();\n<a name=\"420\" href=\"#420\">420</a>         }\n<a name=\"421\" href=\"#421\">421</a> \n<a name=\"422\" href=\"#422\">422</a>         <em class=\"comment\">/*</em>\n<a name=\"423\" href=\"#423\">423</a> <em class=\"comment\">           //let's connect to a random vertex, too!</em>\n<a name=\"424\" href=\"#424\">424</a> <em class=\"comment\">           Indexer i = Indexer.getAndUpdateIndexer(g);</em>\n<a name=\"425\" href=\"#425\">425</a> <em class=\"comment\">           int rand = (int) (Math.random() * g.numVertices());</em>\n<a name=\"426\" href=\"#426\">426</a> <em class=\"comment\">           Vertex v_rand = (Vertex) i.getVertex(rand);</em>\n<a name=\"427\" href=\"#427\">427</a> <em class=\"comment\">           g.addEdge(new UndirectedSparseEdge(v, v_rand));</em>\n<a name=\"428\" href=\"#428\">428</a> <em class=\"comment\">         */</em>\n<a name=\"429\" href=\"#429\">429</a> \n<a name=\"430\" href=\"#430\">430</a>         <em class=\"comment\">// connect to every node in the same class</em>\n<a name=\"431\" href=\"#431\">431</a>         <strong>synchronized</strong>(g)\n<a name=\"432\" href=\"#432\">432</a>         {\n<a name=\"433\" href=\"#433\">433</a>             Set vs = g.getVertices();\n<a name=\"434\" href=\"#434\">434</a> \n<a name=\"435\" href=\"#435\">435</a>             <strong>for</strong>(Iterator i = vs.iterator(); i.hasNext();)\n<a name=\"436\" href=\"#436\">436</a>             {\n<a name=\"437\" href=\"#437\">437</a>                 Vertex vToConnect = (Vertex)i.next();\n<a name=\"438\" href=\"#438\">438</a> \n<a name=\"439\" href=\"#439\">439</a>                 <strong>if</strong>(!v.equals(vToConnect)\n<a name=\"440\" href=\"#440\">440</a>                    &amp;&amp; (v.getUserDatum(swirlType) == vToConnect.getUserDatum(swirlType)))\n<a name=\"441\" href=\"#441\">441</a>                 {\n<a name=\"442\" href=\"#442\">442</a>                     g.addEdge(<strong>new</strong> UndirectedSparseEdge(v, vToConnect));\n<a name=\"443\" href=\"#443\">443</a>                 }\n<a name=\"444\" href=\"#444\">444</a>             }\n<a name=\"445\" href=\"#445\">445</a>         }\n<a name=\"446\" href=\"#446\">446</a>     }\n<a name=\"447\" href=\"#447\">447</a> \n<a name=\"448\" href=\"#448\">448</a>     <em>/**<em>*</em></em>\n<a name=\"449\" href=\"#449\">449</a> <em>     * TODO</em>\n<a name=\"450\" href=\"#450\">450</a> <em>     *</em>\n<a name=\"451\" href=\"#451\">451</a> <em>     * @param name TODO</em>\n<a name=\"452\" href=\"#452\">452</a> <em>     */</em>\n<a name=\"453\" href=\"#453\">453</a>     <strong>private</strong> <strong>void</strong> init(String name)\n<a name=\"454\" href=\"#454\">454</a>     {\n<a name=\"455\" href=\"#455\">455</a>         <em class=\"comment\">// create a server socket and bind it to an available port</em>\n<a name=\"456\" href=\"#456\">456</a>         <em class=\"comment\">//</em>\n<a name=\"457\" href=\"#457\">457</a>         ServerSocket serv = <strong>null</strong>;\n<a name=\"458\" href=\"#458\">458</a>         <strong>boolean</strong> done = false;\n<a name=\"459\" href=\"#459\">459</a> \n<a name=\"460\" href=\"#460\">460</a>         <strong>for</strong>(<strong>int</strong> i = 1025; (i &lt; 1040) &amp;&amp; !done; i++)\n<a name=\"461\" href=\"#461\">461</a>         {\n<a name=\"462\" href=\"#462\">462</a>             <strong>try</strong>\n<a name=\"463\" href=\"#463\">463</a>             {\n<a name=\"464\" href=\"#464\">464</a>                 serv = <strong>new</strong> ServerSocket(i);\n<a name=\"465\" href=\"#465\">465</a>                 serverThread = <strong>new</strong> Thread(<strong>new</strong> ListenerThread(serv));\n<a name=\"466\" href=\"#466\">466</a>                 serverThread.start();\n<a name=\"467\" href=\"#467\">467</a>                 done = <strong>true</strong>;\n<a name=\"468\" href=\"#468\">468</a>             }\n<a name=\"469\" href=\"#469\">469</a>             <strong>catch</strong>(Exception ex)\n<a name=\"470\" href=\"#470\">470</a>             {\n<a name=\"471\" href=\"#471\">471</a>                 <strong>if</strong>(log.isDebugEnabled())\n<a name=\"472\" href=\"#472\">472</a>                 {\n<a name=\"473\" href=\"#473\">473</a>                     log.debug(<span class=\"string\">\"problem starting neighbor server socket on port \"</span>\n<a name=\"474\" href=\"#474\">474</a>                               + i + <span class=\"string\">\".  Trying next port\"</span>);\n<a name=\"475\" href=\"#475\">475</a>                 }\n<a name=\"476\" href=\"#476\">476</a>             }\n<a name=\"477\" href=\"#477\">477</a>         }\n<a name=\"478\" href=\"#478\">478</a> \n<a name=\"479\" href=\"#479\">479</a>         String serviceName = <span class=\"string\">\"\"</span>;\n<a name=\"480\" href=\"#480\">480</a> \n<a name=\"481\" href=\"#481\">481</a>         <strong>try</strong>\n<a name=\"482\" href=\"#482\">482</a>         {\n<a name=\"483\" href=\"#483\">483</a>             <em class=\"comment\">// advertise ourselves via rendezvous</em>\n<a name=\"484\" href=\"#484\">484</a>             Hashtable serviceProperties = <strong>new</strong> Hashtable();\n<a name=\"485\" href=\"#485\">485</a> \n<a name=\"486\" href=\"#486\">486</a>             serviceProperties.put(<span class=\"string\">\"path\"</span>, <span class=\"string\">\"/local\"</span>);\n<a name=\"487\" href=\"#487\">487</a>             serviceProperties.put(<span class=\"string\">\"aggregator\"</span>, <span class=\"string\">\"/swirl\"</span>);\n<a name=\"488\" href=\"#488\">488</a> \n<a name=\"489\" href=\"#489\">489</a>             <strong>int</strong> serviceWeight = 1;\n<a name=\"490\" href=\"#490\">490</a>             <strong>int</strong> servicePriority = 1;\n<a name=\"491\" href=\"#491\">491</a> \n<a name=\"492\" href=\"#492\">492</a>             String hostName = InetAddress.getLocalHost().getCanonicalHostName();\n<a name=\"493\" href=\"#493\">493</a> \n<a name=\"494\" href=\"#494\">494</a>             <em class=\"comment\">// listen for other non-Swirl services</em>\n<a name=\"495\" href=\"#495\">495</a>             <strong>if</strong>(selfRegister)\n<a name=\"496\" href=\"#496\">496</a>             {\n<a name=\"497\" href=\"#497\">497</a>                 rendezvous.registerServiceType(swirlType);\n<a name=\"498\" href=\"#498\">498</a>             }\n<a name=\"499\" href=\"#499\">499</a> \n<a name=\"500\" href=\"#500\">500</a>             serviceName = name + <span class=\"string\">\"-\"</span> + hostName + <span class=\"string\">\".\"</span> + swirlType;\n<a name=\"501\" href=\"#501\">501</a>             myInfo = <strong>new</strong> <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a>(swirlType, serviceName,\n<a name=\"502\" href=\"#502\">502</a>                                      serv.getLocalPort(), serviceWeight,\n<a name=\"503\" href=\"#503\">503</a>                                      servicePriority, serviceProperties);\n<a name=\"504\" href=\"#504\">504</a> \n<a name=\"505\" href=\"#505\">505</a>             <strong>if</strong>(selfRegister)\n<a name=\"506\" href=\"#506\">506</a>             {\n<a name=\"507\" href=\"#507\">507</a>                 rendezvous.registerService(myInfo);\n<a name=\"508\" href=\"#508\">508</a>             }\n<a name=\"509\" href=\"#509\">509</a> \n<a name=\"510\" href=\"#510\">510</a>             <em class=\"comment\">// create an initial graph with one vertex for the announced service</em>\n<a name=\"511\" href=\"#511\">511</a>             <em class=\"comment\">// otherwise the graphDraw will result in null pointer</em>\n<a name=\"512\" href=\"#512\">512</a>             g = <strong>new</strong> UndirectedSparseGraph();\n<a name=\"513\" href=\"#513\">513</a>             sl = StringLabeller.getLabeller(g);\n<a name=\"514\" href=\"#514\">514</a> \n<a name=\"515\" href=\"#515\">515</a>             <strong>if</strong>(selfRegister)\n<a name=\"516\" href=\"#516\">516</a>             {\n<a name=\"517\" href=\"#517\">517</a>                 addVertex(rendezvous, swirlType, serviceName, myInfo);\n<a name=\"518\" href=\"#518\">518</a>             }\n<a name=\"519\" href=\"#519\">519</a> \n<a name=\"520\" href=\"#520\">520</a>             gd = <strong>new</strong> GraphDraw(g);\n<a name=\"521\" href=\"#521\">521</a>             layout = <strong>new</strong> edu.uci.ics.jung.visualization.SpringLayout(g);\n<a name=\"522\" href=\"#522\">522</a>             gd.setGraphLayout(layout);\n<a name=\"523\" href=\"#523\">523</a>             vv = gd.getVisualizationViewer();\n<a name=\"524\" href=\"#524\">524</a> \n<a name=\"525\" href=\"#525\">525</a>             SettableRenderer sr = gd.getRender();\n<a name=\"526\" href=\"#526\">526</a> \n<a name=\"527\" href=\"#527\">527</a>             sr.setEdgeColor(<strong>new</strong> Color(0, 0, 0, 0.0f));\n<a name=\"528\" href=\"#528\">528</a>             sr.setVertexColorFunction(<strong>new</strong> VertexColorFunction()\n<a name=\"529\" href=\"#529\">529</a>                 {\n<a name=\"530\" href=\"#530\">530</a>                     <strong>public</strong> Color getForeColor(Vertex v)\n<a name=\"531\" href=\"#531\">531</a>                     {\n<a name=\"532\" href=\"#532\">532</a>                         <strong>return</strong> Color.blue;\n<a name=\"533\" href=\"#533\">533</a>                     }\n<a name=\"534\" href=\"#534\">534</a> \n<a name=\"535\" href=\"#535\">535</a>                     <strong>public</strong> Color getBackColor(Vertex v)\n<a name=\"536\" href=\"#536\">536</a>                     {\n<a name=\"537\" href=\"#537\">537</a>                         <strong>if</strong>(v.getUserDatum(swirlType) != <strong>null</strong>)\n<a name=\"538\" href=\"#538\">538</a>                         {\n<a name=\"539\" href=\"#539\">539</a>                             <strong>return</strong> Color.green;\n<a name=\"540\" href=\"#540\">540</a>                         }\n<a name=\"541\" href=\"#541\">541</a>                         <strong>else</strong>\n<a name=\"542\" href=\"#542\">542</a>                         {\n<a name=\"543\" href=\"#543\">543</a>                             <strong>return</strong> Color.red;\n<a name=\"544\" href=\"#544\">544</a>                         }\n<a name=\"545\" href=\"#545\">545</a>                     }\n<a name=\"546\" href=\"#546\">546</a>                 });\n<a name=\"547\" href=\"#547\">547</a>         }\n<a name=\"548\" href=\"#548\">548</a>         <strong>catch</strong>(Exception ex)\n<a name=\"549\" href=\"#549\">549</a>         {\n<a name=\"550\" href=\"#550\">550</a>             log.error(<span class=\"string\">\"som problem\"</span>, ex);\n<a name=\"551\" href=\"#551\">551</a>         }\n<a name=\"552\" href=\"#552\">552</a> \n<a name=\"553\" href=\"#553\">553</a>         setLayout(<strong>new</strong> BorderLayout());\n<a name=\"554\" href=\"#554\">554</a>         add(gd, BorderLayout.CENTER);\n<a name=\"555\" href=\"#555\">555</a> \n<a name=\"556\" href=\"#556\">556</a>         <em class=\"comment\">//add(vv, BorderLayout.CENTER);</em>\n<a name=\"557\" href=\"#557\">557</a>     }\n<a name=\"558\" href=\"#558\">558</a> \n<a name=\"559\" href=\"#559\">559</a>     <em>/**<em>*</em></em>\n<a name=\"560\" href=\"#560\">560</a> <em>     * TODO</em>\n<a name=\"561\" href=\"#561\">561</a> <em>     *</em>\n<a name=\"562\" href=\"#562\">562</a> <em>     * @param jmdns TODO</em>\n<a name=\"563\" href=\"#563\">563</a> <em>     * @param type TODO</em>\n<a name=\"564\" href=\"#564\">564</a> <em>     * @param _name TODO</em>\n<a name=\"565\" href=\"#565\">565</a> <em>     * @param si TODO</em>\n<a name=\"566\" href=\"#566\">566</a> <em>     */</em>\n<a name=\"567\" href=\"#567\">567</a>     <strong>private</strong> <strong>void</strong> removeVertex(<a href=\"../../../javax/jmdns/JmDNS.html\">JmDNS</a> jmdns, String type, String _name,\n<a name=\"568\" href=\"#568\">568</a>                               <a href=\"../../../javax/jmdns/ServiceInfo.html\">ServiceInfo</a> si)\n<a name=\"569\" href=\"#569\">569</a>     {\n<a name=\"570\" href=\"#570\">570</a>         String name = (String)hosts.remove(_name);\n<a name=\"571\" href=\"#571\">571</a> \n<a name=\"572\" href=\"#572\">572</a>         g.removeVertex(sl.getVertex(name));\n<a name=\"573\" href=\"#573\">573</a>         sl.removeLabel(name);\n<a name=\"574\" href=\"#574\">574</a>     }\n<a name=\"575\" href=\"#575\">575</a> \n<a name=\"576\" href=\"#576\">576</a> \t<em class=\"comment\">/*<em class=\"comment\"> (non-Javadoc)</em></em>\n<a name=\"577\" href=\"#577\">577</a> <em class=\"comment\">\t * @see swirl.workspace.viz.ModelListener#flashIt(swirl.workspace.viz.pie.FileElement, java.lang.String)</em>\n<a name=\"578\" href=\"#578\">578</a> <em class=\"comment\">\t */</em>\n<a name=\"579\" href=\"#579\">579</a> \t<strong>public</strong> <strong>void</strong> flashIt(<a href=\"../../../swirl/workspace/viz/pie/FileElement.html\">FileElement</a> fe, String uColor) {\n<a name=\"580\" href=\"#580\">580</a> \t\t<em class=\"comment\">// TODO Auto-generated method stub</em>\n<a name=\"581\" href=\"#581\">581</a> \t\t\n<a name=\"582\" href=\"#582\">582</a> \t}\n<a name=\"583\" href=\"#583\">583</a> \n<a name=\"584\" href=\"#584\">584</a> \t<em class=\"comment\">/*<em class=\"comment\"> (non-Javadoc)</em></em>\n<a name=\"585\" href=\"#585\">585</a> <em class=\"comment\">\t * @see swirl.workspace.viz.ModelListener#backupPromotedToPersistent(swirl.workspace.viz.pie.FileElement)</em>\n<a name=\"586\" href=\"#586\">586</a> <em class=\"comment\">\t */</em>\n<a name=\"587\" href=\"#587\">587</a> \t<strong>public</strong> <strong>void</strong> backupPromotedToPersistent(<a href=\"../../../swirl/workspace/viz/pie/FileElement.html\">FileElement</a> file) {\n<a name=\"588\" href=\"#588\">588</a> \t\t<em class=\"comment\">// TODO Auto-generated method stub</em>\n<a name=\"589\" href=\"#589\">589</a> \t\t\n<a name=\"590\" href=\"#590\">590</a> \t}\n<a name=\"591\" href=\"#591\">591</a> \n<a name=\"592\" href=\"#592\">592</a> \t<em class=\"comment\">/*<em class=\"comment\"> (non-Javadoc)</em></em>\n<a name=\"593\" href=\"#593\">593</a> <em class=\"comment\">\t * @see swirl.workspace.viz.ModelListener#fileUpdated(swirl.workspace.viz.pie.FileElement)</em>\n<a name=\"594\" href=\"#594\">594</a> <em class=\"comment\">\t */</em>\n<a name=\"595\" href=\"#595\">595</a> \t<strong>public</strong> <strong>void</strong> fileUpdated(<a href=\"../../../swirl/workspace/viz/pie/FileElement.html\">FileElement</a> file) {\n<a name=\"596\" href=\"#596\">596</a> \t\t<em class=\"comment\">// TODO Auto-generated method stub</em>\n<a name=\"597\" href=\"#597\">597</a> \t\t\n<a name=\"598\" href=\"#598\">598</a> \t}\n<a name=\"599\" href=\"#599\">599</a> \n<a name=\"600\" href=\"#600\">600</a> }\n<a name=\"601\" href=\"#601\">601</a> \n<a name=\"602\" href=\"#602\">602</a> \n<a name=\"603\" href=\"#603\">603</a> <em>/**<em>*</em></em>\n<a name=\"604\" href=\"#604\">604</a> <em> * TODO</em>\n<a name=\"605\" href=\"#605\">605</a> <em> *</em>\n<a name=\"606\" href=\"#606\">606</a> <em> * @author $author$</em>\n<a name=\"607\" href=\"#607\">607</a> <em> * @version $Revision: 1.19 $</em>\n<a name=\"608\" href=\"#608\">608</a> <em> */</em>\n<a name=\"609\" href=\"#609\">609</a> <strong>class</strong> ListenerThread implements Runnable\n<a name=\"610\" href=\"#610\">610</a> {\n<a name=\"611\" href=\"#611\">611</a>     <em>/**<em>* TODO */</em></em>\n<a name=\"612\" href=\"#612\">612</a>     ServerSocket sock;\n<a name=\"613\" href=\"#613\">613</a> \n<a name=\"614\" href=\"#614\">614</a>     <em>/**<em>*</em></em>\n<a name=\"615\" href=\"#615\">615</a> <em>     * Creates a new ListenerThread object.</em>\n<a name=\"616\" href=\"#616\">616</a> <em>     *</em>\n<a name=\"617\" href=\"#617\">617</a> <em>     * @param sock TODO</em>\n<a name=\"618\" href=\"#618\">618</a> <em>     */</em>\n<a name=\"619\" href=\"#619\">619</a>     <strong>public</strong> ListenerThread(ServerSocket sock)\n<a name=\"620\" href=\"#620\">620</a>     {\n<a name=\"621\" href=\"#621\">621</a>         <strong>super</strong>();\n<a name=\"622\" href=\"#622\">622</a>         <strong>this</strong>.sock = sock;\n<a name=\"623\" href=\"#623\">623</a>     }\n<a name=\"624\" href=\"#624\">624</a> \n<a name=\"625\" href=\"#625\">625</a>     <em>/**<em>*</em></em>\n<a name=\"626\" href=\"#626\">626</a> <em>     * TODO</em>\n<a name=\"627\" href=\"#627\">627</a> <em>     */</em>\n<a name=\"628\" href=\"#628\">628</a>     <strong>public</strong> <strong>void</strong> run()\n<a name=\"629\" href=\"#629\">629</a>     {\n<a name=\"630\" href=\"#630\">630</a>         <strong>try</strong>\n<a name=\"631\" href=\"#631\">631</a>         {\n<a name=\"632\" href=\"#632\">632</a>             <strong>while</strong>(sock.accept() != <strong>null</strong>)\n<a name=\"633\" href=\"#633\">633</a>             {\n<a name=\"634\" href=\"#634\">634</a>                 System.out.println(<span class=\"string\">\"Accepting connection (but ignoring it)\"</span>);\n<a name=\"635\" href=\"#635\">635</a>             }\n<a name=\"636\" href=\"#636\">636</a>         }\n<a name=\"637\" href=\"#637\">637</a>         <strong>catch</strong>(Exception ex)\n<a name=\"638\" href=\"#638\">638</a>         {\n<a name=\"639\" href=\"#639\">639</a>             ex.printStackTrace();\n<a name=\"640\" href=\"#640\">640</a>         }\n<a name=\"641\" href=\"#641\">641</a>     }\n<a name=\"642\" href=\"#642\">642</a> }\n</pre>\n<hr/><div id=\"footer\">This page was automatically generated by <a href=\"http://maven.apache.org/\">Maven</a></div></body>\n</html>\n\n", "id": 32878.0}