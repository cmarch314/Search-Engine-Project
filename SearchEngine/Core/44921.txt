{"text": "Search LoginPreferencesHelp GuideAbout Trac WikiTimelineRoadmapBrowse SourceView TicketsSearch Context Navigation BlameRevision Log source nomatic tags NomaticIM 4 buddy bots src twisted protocols gps nmea py View diff against View revision Visit trunk Last change on this file was 712 checked in by cbaker 7 years ago First draft of nomatic buddy bots oscar bot is functional if you give it good authentication credentials jabber bot is just an example from the web File size 7 8 KB Line 1 test case name twisted test test nmea 2 Copyright c 2 1 2 4 Twisted Matrix Laboratories 3 See LICENSE for details 45 NMEA 183 implementation67Maintainer U Bob Ippolito mailto bob redivi com 89The following NMEA 183 sentences are currently understood 1 GPGGA fix 11 GPGLL position 12 GPRMC position and time 13 GPGSA active satellites 14 15The following NMEA 183 sentences require implementation 16 None really the others aren t generally useful or implemented in most devices anyhow1718Other desired features 19 A NMEA 183 producer to emulate GPS devices 2 2122import operator23from twisted protocols import basic2425POSFIX INVALID POSFIX SPS POSFIX DGPS POSFIX PPS 1 2 326MODE AUTO MODE FORCED A M 27MODE NOFIX MODE 2D MODE 3D 1 2 32829class InvalidSentence Exception 3 pass3132class InvalidChecksum Exception 33 pass3435class NMEAReceiver basic LineReceiver 36 This parses most common NMEA 183 messages presumably from a serial GPS device at 48 bps37 38 delimiter r n 39 dispatch 4 GPGGA fix 41 GPGLL position 42 GPGSA activesatellites 43 GPRMC positiontime 44 GPGSV viewsatellites not implemented45 GPVTG course not implemented46 GPALM almanac not implemented47 GPGRS range not implemented48 GPGST noise not implemented49 GPMSS beacon not implemented5 GPZDA time not implemented51 52 generally you may miss the beginning of the first message53 ignore invalid sentence 154 checksums shouldn t be invalid55 ignore checksum mismatch 56 ignore unknown sentence types57 ignore unknown sentencetypes 58 do we want to even bother checking to see if it s from the 2 th century 59 convert dates before y2k 16 61 def lineReceived self line 62 if not line startswith 63 if self ignore invalid sentence 64 return65 raise InvalidSentence r does not begin with line 66 message is everything between and checksum is xor of all ASCII values of the message67 strmessage checksum line 1 strip split 68 message strmessage split 69 sentencetype message message message 1 7 dispatch self dispatch get sentencetype None 71 if not dispatch and not self ignore unknown sentencetypes 72 raise InvalidSentence sentencetype r sentencetype 73 if not self ignore checksum mismatch 74 checksum calculated checksum int checksum 16 reduce operator xor map ord strmessage 75 if checksum calculated checksum 76 raise InvalidChecksum Given x 2X x 2X checksum calculated checksum 77 handler getattr self handle s dispatch None 78 decoder getattr self decode s dispatch None 79 if not dispatch and handler and decoder 8 missing dispatch handler or decoder81 return82 return handler decoder message 83 try 84 decoded decoder message 85 except Exception e 86 raise InvalidSentence r is not a valid s s sentence line sentencetype dispatch 87 return handler decoded 8889 def decode position self latitude ns longitude ew utc status 9 latitude longitude self decode latlon latitude ns longitude ew 91 utc self decode utc utc 92 if status A 93 status 194 else 95 status 96 return 97 latitude 98 longitude 99 utc 1 status 1 1 1 21 3 def decode positiontime self utc status latitude ns longitude ew speed course utcdate magvar magdir 1 4 utc self decode utc utc 1 5 latitude longitude self decode latlon latitude ns longitude ew 1 6 if speed 1 7 speed float speed 1 8 else 1 9 speed None11 if course 111 course float course 112 else 113 course None114 utcdate 2 int utcdate 4 6 int utcdate 2 4 int utcdate 2 115 if self convert dates before y2k and utcdate 2 73 116 GPS was invented by the US DoD in 1973 but NMEA uses 2 digit year 117 Highly unlikely that we ll be using NMEA or this twisted module in 7 years 118 but remotely possible that you ll be using it to play back data from the 2 th century 119 utcdate utcdate 1 utcdate 1 utcdate 2 12 if magvar 121 magvar float magvar 122 if magdir W 123 magvar magvar124 else 125 magvar None126 return 127 latitude 128 longitude 129 speed 13 course 131 UTC seconds past utcdate132 utc 133 UTC year month day 134 utcdate 135 None or magnetic variation in degrees west is negative 136 magvar 137 138139 def decode utc self utc 14 utc hh utc mm utc ss map float utc 2 utc 2 4 utc 4 141 return utc hh 36 utc mm 6 utc ss142143 def decode latlon self latitude ns longitude ew 144 latitude float latitude 2 float latitude 2 6 145 if ns S 146 latitude latitude147 longitude float longitude 3 float longitude 3 6 148 if ew W 149 longitude longitude15 return latitude longitude 151152 def decode activesatellites self mode1 mode2 args 153 satellites pdop hdop vdop args 12 map float args 12 154 satlist 155 for n in satellites 156 if n 157 satlist append int n 158 else 159 satlist append None 16 mode mode1 int mode2 161 return 162 satellite list by channel163 tuple satlist 164 MODE AUTO MODE FORCED MODE NOFIX MODE 2DFIX MODE 3DFIX 165 mode 166 position dilution of precision167 pdop 168 horizontal dilution of precision169 hdop 17 vertical dilution of precision171 vdop 172 173 174 def decode fix self utc latitude ns longitude ew posfix satellites hdop altitude altitude units geoid separation geoid separation units dgps age dgps station id 175 latitude longitude self decode latlon latitude ns longitude ew 176 utc self decode utc utc 177 posfix int posfix 178 satellites int satellites 179 hdop float hdop 18 altitude float altitude altitude units 181 if geoid separation 182 geoid float geoid separation geoid separation units 183 else 184 geoid None185 if dgps age 186 dgps float dgps age dgps station id 187 else 188 dgps None189 return 19 seconds since UTC191 utc 192 latitude degrees 193 latitude 194 longitude degrees 195 longitude 196 position fix status POSFIX INVALID POSFIX SPS POSFIX DGPS POSFIX PPS 197 posfix 198 number of satellites used for fix satellites 12 199 satellites 2 horizontal dilution of precision2 1 hdop 2 2 None or altitude according to WGS 84 ellipsoid units typically M for meters 2 3 altitude 2 4 None or geoid separation according to WGS 84 ellipsoid units typically M for meters 2 5 geoid 2 6 age of dgps data in seconds dgps station id 2 7 dgps 2 8 Note See TracBrowser for help on using the repository browser Download in other formats Plain Text Original Format Powered by Trac 1 1 By Edgewall Software All content copyright 2 7 2 8 by LUCI http luci ics uci edu ", "_id": "http://djp3-pc2.ics.uci.edu/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py", "title": "\n      nmea.py in nomatic/tags/nomaticim-0.0.4/buddy_bots/src/twisted/protocols/gps\n     \u2013 nomatic*im\n    ", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n  \n  \n\n  \n\n\n  <head>\n\t\t<title>\n      nmea.py in nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps\n     \u2013 Nomatic*IM\n    </title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><link rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search\" /><link rel=\"help\" href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\" /><link rel=\"alternate\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py?format=txt\" type=\"text/plain\" title=\"Plain Text\" /><link rel=\"alternate\" href=\"/LUCICodeRepository/nomaticIM/export/1312/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py\" type=\"application/x-python; charset=iso-8859-15\" title=\"Original Format\" /><link rel=\"start\" href=\"/LUCICodeRepository/nomaticIM/wiki\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/code.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/pygments/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/browser.css\" type=\"text/css\" /><link rel=\"shortcut icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link rel=\"icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link type=\"application/opensearchdescription+xml\" rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search/opensearch\" title=\"Search Nomatic*IM\" /><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/jquery.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/babel.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/messages/en_US.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/trac.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/search.js\"></script><script type=\"text/javascript\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/folding.js\"></script><script type=\"text/javascript\">\n      jQuery(document).ready(function($) {\n        $(\".trac-toggledeleted\").show().click(function() {\n                  $(this).siblings().find(\".trac-deleted\").toggle();\n                  return false;\n        }).click();\n        $(\"#jumploc input\").hide();\n        $(\"#jumploc select\").change(function () {\n          this.parentNode.parentNode.submit();\n        });\n          $('#preview table.code').enableCollapsibleColumns($('#preview table.code thead th.content'));\n      });\n    </script>\n\t</head>\n  <body>\n    <div id=\"banner\">\n      <div id=\"header\">\n        <a id=\"logo\" href=\"http://luci.ics.uci.edu/#code\"><img src=\"http://luci.ics.uci.edu/blog/archives/LUCIhorzTight.jpg\" alt=\"LUCI Code Repository\" /></a>\n      </div>\n      <form id=\"search\" action=\"/LUCICodeRepository/nomaticIM/search\" method=\"get\">\n        <div>\n          <label for=\"proj-search\">Search:</label>\n          <input type=\"text\" id=\"proj-search\" name=\"q\" size=\"18\" value=\"\" />\n          <input type=\"submit\" value=\"Search\" />\n        </div>\n      </form>\n      <div id=\"metanav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/login\">Login</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/prefs\">Preferences</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\">Help/Guide</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/about\">About Trac</a></li>\n    </ul>\n  </div>\n    </div>\n    <div id=\"mainnav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/wiki\">Wiki</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/timeline\">Timeline</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/roadmap\">Roadmap</a></li><li class=\"active\"><a href=\"/LUCICodeRepository/nomaticIM/browser\">Browse Source</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/report\">View Tickets</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/search\">Search</a></li>\n    </ul>\n  </div>\n    <div id=\"main\">\n      <div id=\"ctxtnav\" class=\"nav\">\n        <h2>Context Navigation</h2>\n        <ul>\n          <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/buddy_bots/twisted/protocols/gps/nmea.py?annotate=blame\" title=\"Annotate each line with the last changed revision (this can be time consuming...)\">Blame</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/log/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py\">Revision Log</a></li>\n        </ul>\n        <hr />\n      </div>\n    <div id=\"content\" class=\"browser\">\n        <h1>\n          \n<a class=\"pathentry first\" href=\"/LUCICodeRepository/nomaticIM/browser?order=name\" title=\"Go to repository root\">source:</a>\n<a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic?order=name\" title=\"View nomatic\">nomatic</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags?order=name\" title=\"View tags\">tags</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4?order=name\" title=\"View NomaticIM-0.0.4\">NomaticIM-0.0.4</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots?order=name\" title=\"View buddy_bots\">buddy_bots</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src?order=name\" title=\"View src\">src</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted?order=name\" title=\"View twisted\">twisted</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols?order=name\" title=\"View protocols\">protocols</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps?order=name\" title=\"View gps\">gps</a><span class=\"pathentry sep\">/</span><a class=\"pathentry\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py?order=name\" title=\"View nmea.py\">nmea.py</a>\n<br style=\"clear: both\" />\n\n        </h1>\n        <div id=\"diffrev\">\n          <form action=\"/LUCICodeRepository/nomaticIM/changeset\" method=\"get\">\n            <div>\n              <label title=\"Show the diff against a specific revision\">\n                View diff against: <input type=\"text\" name=\"old\" size=\"6\" />\n                <input type=\"hidden\" name=\"old_path\" value=\"nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py\" />\n                <input type=\"hidden\" name=\"new\" />\n                <input type=\"hidden\" name=\"new_path\" value=\"nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py\" />\n              </label>\n            </div>\n          </form>\n        </div>\n        <div id=\"jumprev\">\n          <form action=\"\" method=\"get\">\n            <div>\n              <label for=\"rev\">\n                View revision:</label>\n              <input type=\"text\" id=\"rev\" name=\"rev\" size=\"6\" />\n            </div>\n          </form>\n        </div>\n        <div id=\"jumploc\">\n          <form action=\"\" method=\"get\">\n            <div class=\"buttons\">\n              <label for=\"preselected\">Visit:</label>\n              <select id=\"preselected\" name=\"preselected\">\n                <option selected=\"selected\"></option>\n                <optgroup label=\"branches\">\n                  <option value=\"/LUCICodeRepository/nomaticIM/browser/trunk\">trunk</option>\n                </optgroup>\n              </select>\n              <input type=\"submit\" value=\"Go!\" title=\"Jump to the chosen preselected path\" />\n            </div>\n          </form>\n        </div>\n        <div class=\"trac-tags\">\n        </div>\n      <table id=\"info\" summary=\"Revision info\">\n        <tr>\n          <th>\n                <a href=\"/LUCICodeRepository/nomaticIM/changeset/712/nomatic/trunk/buddy_bots/twisted/protocols/gps/nmea.py\" title=\"View differences\">Last change</a>\n                  on this file was\n                  <a href=\"/LUCICodeRepository/nomaticIM/changeset/712/\" title=\"View changeset 712\">712</a>,\n                  checked in by cbaker, <a class=\"timeline\" href=\"/LUCICodeRepository/nomaticIM/timeline?from=2008-02-16T08%3A16%3A53-08%3A00&amp;precision=second\" title=\"See timeline at Feb 16, 2008, 8:16:53 AM\">7 years ago</a>\n          </th>\n        </tr>\n        <tr>\n          <td class=\"message searchable\">\n              <p>\nFirst draft of nomatic buddy bots. oscar_bot is functional if you give it good authentication credentials, jabber_bot is just an example from the web <br />\n</p>\n          </td>\n        </tr>\n        <tr><td colspan=\"2\">\n            <strong>File size:</strong>\n            <span title=\"7955 bytes\">7.8 KB</span>\n          </td></tr>\n      </table>\n      <div id=\"preview\" class=\"searchable\">\n        \n  <table class=\"code\"><thead><tr><th class=\"lineno\" title=\"Line numbers\">Line</th><th class=\"content\">\u00a0</th></tr></thead><tbody><tr><th id=\"L1\"><a href=\"#L1\">1</a></th><td><span class=\"c\"># -*- test-case-name: twisted.test.test_nmea -*-</span></td></tr><tr><th id=\"L2\"><a href=\"#L2\">2</a></th><td><span class=\"c\"># Copyright (c) 2001-2004 Twisted Matrix Laboratories.</span></td></tr><tr><th id=\"L3\"><a href=\"#L3\">3</a></th><td><span class=\"c\"># See LICENSE for details.</span></td></tr><tr><th id=\"L4\"><a href=\"#L4\">4</a></th><td></td></tr><tr><th id=\"L5\"><a href=\"#L5\">5</a></th><td><span class=\"sd\">\"\"\"NMEA 0183 implementation</span></td></tr><tr><th id=\"L6\"><a href=\"#L6\">6</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L7\"><a href=\"#L7\">7</a></th><td><span class=\"sd\">Maintainer: U{Bob Ippolito&lt;mailto:bob@redivi.com&gt;}</span></td></tr><tr><th id=\"L8\"><a href=\"#L8\">8</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L9\"><a href=\"#L9\">9</a></th><td><span class=\"sd\">The following NMEA 0183 sentences are currently understood::</span></td></tr><tr><th id=\"L10\"><a href=\"#L10\">10</a></th><td><span class=\"sd\">\u00a0 \u00a0 GPGGA (fix)</span></td></tr><tr><th id=\"L11\"><a href=\"#L11\">11</a></th><td><span class=\"sd\">\u00a0 \u00a0 GPGLL (position)</span></td></tr><tr><th id=\"L12\"><a href=\"#L12\">12</a></th><td><span class=\"sd\">\u00a0 \u00a0 GPRMC (position and time)</span></td></tr><tr><th id=\"L13\"><a href=\"#L13\">13</a></th><td><span class=\"sd\">\u00a0 \u00a0 GPGSA (active satellites)</span></td></tr><tr><th id=\"L14\"><a href=\"#L14\">14</a></th><td><span class=\"sd\">\u00a0</span></td></tr><tr><th id=\"L15\"><a href=\"#L15\">15</a></th><td><span class=\"sd\">The following NMEA 0183 sentences require implementation::</span></td></tr><tr><th id=\"L16\"><a href=\"#L16\">16</a></th><td><span class=\"sd\">\u00a0 \u00a0 None really, the others aren't generally useful or implemented in most devices anyhow</span></td></tr><tr><th id=\"L17\"><a href=\"#L17\">17</a></th><td><span class=\"sd\"></span></td></tr><tr><th id=\"L18\"><a href=\"#L18\">18</a></th><td><span class=\"sd\">Other desired features::</span></td></tr><tr><th id=\"L19\"><a href=\"#L19\">19</a></th><td><span class=\"sd\">\u00a0 \u00a0 - A NMEA 0183 producer to emulate GPS devices (?)</span></td></tr><tr><th id=\"L20\"><a href=\"#L20\">20</a></th><td><span class=\"sd\">\"\"\"</span></td></tr><tr><th id=\"L21\"><a href=\"#L21\">21</a></th><td></td></tr><tr><th id=\"L22\"><a href=\"#L22\">22</a></th><td><span class=\"kn\">import</span>\u00a0<span class=\"nn\">operator</span></td></tr><tr><th id=\"L23\"><a href=\"#L23\">23</a></th><td><span class=\"kn\">from</span>\u00a0<span class=\"nn\">twisted.protocols</span>\u00a0<span class=\"kn\">import</span>\u00a0basic</td></tr><tr><th id=\"L24\"><a href=\"#L24\">24</a></th><td></td></tr><tr><th id=\"L25\"><a href=\"#L25\">25</a></th><td>POSFIX_INVALID<span class=\"p\">,</span>\u00a0POSFIX_SPS<span class=\"p\">,</span>\u00a0POSFIX_DGPS<span class=\"p\">,</span>\u00a0POSFIX_PPS <span class=\"o\">=</span>\u00a0<span class=\"mi\">0</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">1</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">2</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">3</span></td></tr><tr><th id=\"L26\"><a href=\"#L26\">26</a></th><td>MODE_AUTO<span class=\"p\">,</span>\u00a0MODE_FORCED <span class=\"o\">=</span>\u00a0<span class=\"s\">'A'</span><span class=\"p\">,</span>\u00a0<span class=\"s\">'M'</span></td></tr><tr><th id=\"L27\"><a href=\"#L27\">27</a></th><td>MODE_NOFIX<span class=\"p\">,</span>\u00a0MODE_2D<span class=\"p\">,</span>\u00a0MODE_3D <span class=\"o\">=</span>\u00a0<span class=\"mi\">1</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">2</span><span class=\"p\">,</span>\u00a0<span class=\"mi\">3</span></td></tr><tr><th id=\"L28\"><a href=\"#L28\">28</a></th><td></td></tr><tr><th id=\"L29\"><a href=\"#L29\">29</a></th><td><span class=\"k\">class</span>\u00a0<span class=\"nc\">InvalidSentence</span><span class=\"p\">(</span><span class=\"ne\">Exception</span><span class=\"p\">):</span></td></tr><tr><th id=\"L30\"><a href=\"#L30\">30</a></th><td>\u00a0 \u00a0 <span class=\"k\">pass</span></td></tr><tr><th id=\"L31\"><a href=\"#L31\">31</a></th><td></td></tr><tr><th id=\"L32\"><a href=\"#L32\">32</a></th><td><span class=\"k\">class</span>\u00a0<span class=\"nc\">InvalidChecksum</span><span class=\"p\">(</span><span class=\"ne\">Exception</span><span class=\"p\">):</span></td></tr><tr><th id=\"L33\"><a href=\"#L33\">33</a></th><td>\u00a0 \u00a0 <span class=\"k\">pass</span></td></tr><tr><th id=\"L34\"><a href=\"#L34\">34</a></th><td></td></tr><tr><th id=\"L35\"><a href=\"#L35\">35</a></th><td><span class=\"k\">class</span>\u00a0<span class=\"nc\">NMEAReceiver</span><span class=\"p\">(</span>basic<span class=\"o\">.</span>LineReceiver<span class=\"p\">):</span></td></tr><tr><th id=\"L36\"><a href=\"#L36\">36</a></th><td>\u00a0 \u00a0 <span class=\"sd\">\"\"\"This parses most common NMEA-0183 messages, presumably from a serial GPS device at 4800 bps</span></td></tr><tr><th id=\"L37\"><a href=\"#L37\">37</a></th><td><span class=\"sd\">\u00a0 \u00a0 \"\"\"</span></td></tr><tr><th id=\"L38\"><a href=\"#L38\">38</a></th><td>\u00a0 \u00a0 delimiter <span class=\"o\">=</span>\u00a0<span class=\"s\">'</span><span class=\"se\">\\r\\n</span><span class=\"s\">'</span></td></tr><tr><th id=\"L39\"><a href=\"#L39\">39</a></th><td>\u00a0 \u00a0 dispatch <span class=\"o\">=</span>\u00a0<span class=\"p\">{</span></td></tr><tr><th id=\"L40\"><a href=\"#L40\">40</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPGGA'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'fix'</span><span class=\"p\">,</span></td></tr><tr><th id=\"L41\"><a href=\"#L41\">41</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPGLL'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'position'</span><span class=\"p\">,</span></td></tr><tr><th id=\"L42\"><a href=\"#L42\">42</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPGSA'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'activesatellites'</span><span class=\"p\">,</span></td></tr><tr><th id=\"L43\"><a href=\"#L43\">43</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPRMC'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'positiontime'</span><span class=\"p\">,</span></td></tr><tr><th id=\"L44\"><a href=\"#L44\">44</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPGSV'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'viewsatellites'</span><span class=\"p\">,</span>\u00a0 \u00a0 <span class=\"c\"># not implemented</span></td></tr><tr><th id=\"L45\"><a href=\"#L45\">45</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPVTG'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'course'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># not implemented</span></td></tr><tr><th id=\"L46\"><a href=\"#L46\">46</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPALM'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'almanac'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0<span class=\"c\"># not implemented</span></td></tr><tr><th id=\"L47\"><a href=\"#L47\">47</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPGRS'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'range'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0<span class=\"c\"># not implemented</span></td></tr><tr><th id=\"L48\"><a href=\"#L48\">48</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPGST'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'noise'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0<span class=\"c\"># not implemented</span></td></tr><tr><th id=\"L49\"><a href=\"#L49\">49</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPMSS'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'beacon'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># not implemented</span></td></tr><tr><th id=\"L50\"><a href=\"#L50\">50</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"s\">'GPZDA'</span><span class=\"p\">:</span>\u00a0<span class=\"s\">'time'</span><span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># not implemented</span></td></tr><tr><th id=\"L51\"><a href=\"#L51\">51</a></th><td>\u00a0 \u00a0 <span class=\"p\">}</span></td></tr><tr><th id=\"L52\"><a href=\"#L52\">52</a></th><td>\u00a0 \u00a0 <span class=\"c\"># generally you may miss the beginning of the first message</span></td></tr><tr><th id=\"L53\"><a href=\"#L53\">53</a></th><td>\u00a0 \u00a0 ignore_invalid_sentence <span class=\"o\">=</span>\u00a0<span class=\"mi\">1</span></td></tr><tr><th id=\"L54\"><a href=\"#L54\">54</a></th><td>\u00a0 \u00a0 <span class=\"c\"># checksums shouldn't be invalid</span></td></tr><tr><th id=\"L55\"><a href=\"#L55\">55</a></th><td>\u00a0 \u00a0 ignore_checksum_mismatch <span class=\"o\">=</span>\u00a0<span class=\"mi\">0</span></td></tr><tr><th id=\"L56\"><a href=\"#L56\">56</a></th><td>\u00a0 \u00a0 <span class=\"c\"># ignore unknown sentence types</span></td></tr><tr><th id=\"L57\"><a href=\"#L57\">57</a></th><td>\u00a0 \u00a0 ignore_unknown_sentencetypes <span class=\"o\">=</span>\u00a0<span class=\"mi\">0</span></td></tr><tr><th id=\"L58\"><a href=\"#L58\">58</a></th><td>\u00a0 \u00a0 <span class=\"c\"># do we want to even bother checking to see if it's from the 20th century?</span></td></tr><tr><th id=\"L59\"><a href=\"#L59\">59</a></th><td>\u00a0 \u00a0 convert_dates_before_y2k <span class=\"o\">=</span>\u00a0<span class=\"mi\">1</span></td></tr><tr><th id=\"L60\"><a href=\"#L60\">60</a></th><td></td></tr><tr><th id=\"L61\"><a href=\"#L61\">61</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">lineReceived</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0line<span class=\"p\">):</span></td></tr><tr><th id=\"L62\"><a href=\"#L62\">62</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"ow\">not</span>\u00a0line<span class=\"o\">.</span>startswith<span class=\"p\">(</span><span class=\"s\">'$'</span><span class=\"p\">):</span></td></tr><tr><th id=\"L63\"><a href=\"#L63\">63</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>ignore_invalid_sentence<span class=\"p\">:</span></td></tr><tr><th id=\"L64\"><a href=\"#L64\">64</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span></td></tr><tr><th id=\"L65\"><a href=\"#L65\">65</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0InvalidSentence<span class=\"p\">(</span><span class=\"s\">\"</span><span class=\"si\">%r</span><span class=\"s\">\u00a0does not begin with $\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>line<span class=\"p\">,))</span></td></tr><tr><th id=\"L66\"><a href=\"#L66\">66</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># message is everything between $ and *, checksum is xor of all ASCII values of the message</span></td></tr><tr><th id=\"L67\"><a href=\"#L67\">67</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 strmessage<span class=\"p\">,</span>\u00a0checksum <span class=\"o\">=</span>\u00a0line<span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:]</span><span class=\"o\">.</span>strip<span class=\"p\">()</span><span class=\"o\">.</span>split<span class=\"p\">(</span><span class=\"s\">'*'</span><span class=\"p\">)</span></td></tr><tr><th id=\"L68\"><a href=\"#L68\">68</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 message <span class=\"o\">=</span>\u00a0strmessage<span class=\"o\">.</span>split<span class=\"p\">(</span><span class=\"s\">','</span><span class=\"p\">)</span></td></tr><tr><th id=\"L69\"><a href=\"#L69\">69</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 sentencetype<span class=\"p\">,</span>\u00a0message <span class=\"o\">=</span>\u00a0message<span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span>\u00a0message<span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:]</span></td></tr><tr><th id=\"L70\"><a href=\"#L70\">70</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 dispatch <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>dispatch<span class=\"o\">.</span>get<span class=\"p\">(</span>sentencetype<span class=\"p\">,</span>\u00a0<span class=\"bp\">None</span><span class=\"p\">)</span></td></tr><tr><th id=\"L71\"><a href=\"#L71\">71</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"p\">(</span><span class=\"ow\">not</span>\u00a0dispatch<span class=\"p\">)</span>\u00a0<span class=\"ow\">and</span>\u00a0<span class=\"p\">(</span><span class=\"ow\">not</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>ignore_unknown_sentencetypes<span class=\"p\">):</span></td></tr><tr><th id=\"L72\"><a href=\"#L72\">72</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0InvalidSentence<span class=\"p\">(</span><span class=\"s\">\"sentencetype </span><span class=\"si\">%r</span><span class=\"s\">\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>sentencetype<span class=\"p\">,))</span></td></tr><tr><th id=\"L73\"><a href=\"#L73\">73</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"ow\">not</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>ignore_checksum_mismatch<span class=\"p\">:</span></td></tr><tr><th id=\"L74\"><a href=\"#L74\">74</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 checksum<span class=\"p\">,</span>\u00a0calculated_checksum <span class=\"o\">=</span>\u00a0<span class=\"nb\">int</span><span class=\"p\">(</span>checksum<span class=\"p\">,</span>\u00a0<span class=\"mi\">16</span><span class=\"p\">),</span>\u00a0<span class=\"nb\">reduce</span><span class=\"p\">(</span>operator<span class=\"o\">.</span>xor<span class=\"p\">,</span>\u00a0<span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"nb\">ord</span><span class=\"p\">,</span>\u00a0strmessage<span class=\"p\">))</span></td></tr><tr><th id=\"L75\"><a href=\"#L75\">75</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0checksum <span class=\"o\">!=</span>\u00a0calculated_checksum<span class=\"p\">:</span></td></tr><tr><th id=\"L76\"><a href=\"#L76\">76</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0InvalidChecksum<span class=\"p\">(</span><span class=\"s\">\"Given 0x</span><span class=\"si\">%02X</span><span class=\"s\">\u00a0!= 0x</span><span class=\"si\">%02X</span><span class=\"s\">\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>checksum<span class=\"p\">,</span>\u00a0calculated_checksum<span class=\"p\">))</span></td></tr><tr><th id=\"L77\"><a href=\"#L77\">77</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 handler <span class=\"o\">=</span>\u00a0<span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"handle_</span><span class=\"si\">%s</span><span class=\"s\">\"</span>\u00a0<span class=\"o\">%</span>\u00a0dispatch<span class=\"p\">,</span>\u00a0<span class=\"bp\">None</span><span class=\"p\">)</span></td></tr><tr><th id=\"L78\"><a href=\"#L78\">78</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 decoder <span class=\"o\">=</span>\u00a0<span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0<span class=\"s\">\"decode_</span><span class=\"si\">%s</span><span class=\"s\">\"</span>\u00a0<span class=\"o\">%</span>\u00a0dispatch<span class=\"p\">,</span>\u00a0<span class=\"bp\">None</span><span class=\"p\">)</span></td></tr><tr><th id=\"L79\"><a href=\"#L79\">79</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"ow\">not</span>\u00a0<span class=\"p\">(</span>dispatch <span class=\"ow\">and</span>\u00a0handler <span class=\"ow\">and</span>\u00a0decoder<span class=\"p\">):</span></td></tr><tr><th id=\"L80\"><a href=\"#L80\">80</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># missing dispatch, handler, or decoder</span></td></tr><tr><th id=\"L81\"><a href=\"#L81\">81</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span></td></tr><tr><th id=\"L82\"><a href=\"#L82\">82</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># return handler(*decoder(*message))</span></td></tr><tr><th id=\"L83\"><a href=\"#L83\">83</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">try</span><span class=\"p\">:</span></td></tr><tr><th id=\"L84\"><a href=\"#L84\">84</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 decoded <span class=\"o\">=</span>\u00a0decoder<span class=\"p\">(</span><span class=\"o\">*</span>message<span class=\"p\">)</span></td></tr><tr><th id=\"L85\"><a href=\"#L85\">85</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">except</span>\u00a0<span class=\"ne\">Exception</span><span class=\"p\">,</span>\u00a0e<span class=\"p\">:</span></td></tr><tr><th id=\"L86\"><a href=\"#L86\">86</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">raise</span>\u00a0InvalidSentence<span class=\"p\">(</span><span class=\"s\">\"</span><span class=\"si\">%r</span><span class=\"s\">\u00a0is not a valid </span><span class=\"si\">%s</span><span class=\"s\">\u00a0(</span><span class=\"si\">%s</span><span class=\"s\">) sentence\"</span>\u00a0<span class=\"o\">%</span>\u00a0<span class=\"p\">(</span>line<span class=\"p\">,</span>\u00a0sentencetype<span class=\"p\">,</span>\u00a0dispatch<span class=\"p\">))</span></td></tr><tr><th id=\"L87\"><a href=\"#L87\">87</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0handler<span class=\"p\">(</span><span class=\"o\">*</span>decoded<span class=\"p\">)</span></td></tr><tr><th id=\"L88\"><a href=\"#L88\">88</a></th><td></td></tr><tr><th id=\"L89\"><a href=\"#L89\">89</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_position</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0latitude<span class=\"p\">,</span>\u00a0ns<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">,</span>\u00a0ew<span class=\"p\">,</span>\u00a0utc<span class=\"p\">,</span>\u00a0status<span class=\"p\">):</span></td></tr><tr><th id=\"L90\"><a href=\"#L90\">90</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 latitude<span class=\"p\">,</span>\u00a0longitude <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>_decode_latlon<span class=\"p\">(</span>latitude<span class=\"p\">,</span>\u00a0ns<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">,</span>\u00a0ew<span class=\"p\">)</span></td></tr><tr><th id=\"L91\"><a href=\"#L91\">91</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 utc <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>_decode_utc<span class=\"p\">(</span>utc<span class=\"p\">)</span></td></tr><tr><th id=\"L92\"><a href=\"#L92\">92</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0status <span class=\"o\">==</span>\u00a0<span class=\"s\">'A'</span><span class=\"p\">:</span></td></tr><tr><th id=\"L93\"><a href=\"#L93\">93</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 status <span class=\"o\">=</span>\u00a0<span class=\"mi\">1</span></td></tr><tr><th id=\"L94\"><a href=\"#L94\">94</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L95\"><a href=\"#L95\">95</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 status <span class=\"o\">=</span>\u00a0<span class=\"mi\">0</span></td></tr><tr><th id=\"L96\"><a href=\"#L96\">96</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">(</span></td></tr><tr><th id=\"L97\"><a href=\"#L97\">97</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 latitude<span class=\"p\">,</span></td></tr><tr><th id=\"L98\"><a href=\"#L98\">98</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 longitude<span class=\"p\">,</span></td></tr><tr><th id=\"L99\"><a href=\"#L99\">99</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 utc<span class=\"p\">,</span></td></tr><tr><th id=\"L100\"><a href=\"#L100\">100</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 status<span class=\"p\">,</span></td></tr><tr><th id=\"L101\"><a href=\"#L101\">101</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L102\"><a href=\"#L102\">102</a></th><td></td></tr><tr><th id=\"L103\"><a href=\"#L103\">103</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_positiontime</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0utc<span class=\"p\">,</span>\u00a0status<span class=\"p\">,</span>\u00a0latitude<span class=\"p\">,</span>\u00a0ns<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">,</span>\u00a0ew<span class=\"p\">,</span>\u00a0speed<span class=\"p\">,</span>\u00a0course<span class=\"p\">,</span>\u00a0utcdate<span class=\"p\">,</span>\u00a0magvar<span class=\"p\">,</span>\u00a0magdir<span class=\"p\">):</span></td></tr><tr><th id=\"L104\"><a href=\"#L104\">104</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 utc <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>_decode_utc<span class=\"p\">(</span>utc<span class=\"p\">)</span></td></tr><tr><th id=\"L105\"><a href=\"#L105\">105</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 latitude<span class=\"p\">,</span>\u00a0longitude <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>_decode_latlon<span class=\"p\">(</span>latitude<span class=\"p\">,</span>\u00a0ns<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">,</span>\u00a0ew<span class=\"p\">)</span></td></tr><tr><th id=\"L106\"><a href=\"#L106\">106</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0speed <span class=\"o\">!=</span>\u00a0<span class=\"s\">''</span><span class=\"p\">:</span></td></tr><tr><th id=\"L107\"><a href=\"#L107\">107</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 speed <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>speed<span class=\"p\">)</span></td></tr><tr><th id=\"L108\"><a href=\"#L108\">108</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L109\"><a href=\"#L109\">109</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 speed <span class=\"o\">=</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L110\"><a href=\"#L110\">110</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0course <span class=\"o\">!=</span>\u00a0<span class=\"s\">''</span><span class=\"p\">:</span></td></tr><tr><th id=\"L111\"><a href=\"#L111\">111</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 course <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>course<span class=\"p\">)</span></td></tr><tr><th id=\"L112\"><a href=\"#L112\">112</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L113\"><a href=\"#L113\">113</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 course <span class=\"o\">=</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L114\"><a href=\"#L114\">114</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 utcdate <span class=\"o\">=</span>\u00a0<span class=\"mi\">2000</span><span class=\"o\">+</span><span class=\"nb\">int</span><span class=\"p\">(</span>utcdate<span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">:</span><span class=\"mi\">6</span><span class=\"p\">]),</span>\u00a0<span class=\"nb\">int</span><span class=\"p\">(</span>utcdate<span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"mi\">4</span><span class=\"p\">]),</span>\u00a0<span class=\"nb\">int</span><span class=\"p\">(</span>utcdate<span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"mi\">2</span><span class=\"p\">])</span></td></tr><tr><th id=\"L115\"><a href=\"#L115\">115</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>convert_dates_before_y2k <span class=\"ow\">and</span>\u00a0utcdate<span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\u00a0<span class=\"o\">&gt;</span>\u00a0<span class=\"mi\">2073</span><span class=\"p\">:</span></td></tr><tr><th id=\"L116\"><a href=\"#L116\">116</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># GPS was invented by the US DoD in 1973, but NMEA uses 2 digit year.</span></td></tr><tr><th id=\"L117\"><a href=\"#L117\">117</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># Highly unlikely that we'll be using NMEA or this twisted module in 70 years,</span></td></tr><tr><th id=\"L118\"><a href=\"#L118\">118</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># but remotely possible that you'll be using it to play back data from the 20th century.</span></td></tr><tr><th id=\"L119\"><a href=\"#L119\">119</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 utcdate <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span>utcdate<span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\u00a0<span class=\"o\">-</span>\u00a0<span class=\"mi\">100</span><span class=\"p\">,</span>\u00a0utcdate<span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span>\u00a0utcdate<span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">])</span></td></tr><tr><th id=\"L120\"><a href=\"#L120\">120</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0magvar <span class=\"o\">!=</span>\u00a0<span class=\"s\">''</span><span class=\"p\">:</span></td></tr><tr><th id=\"L121\"><a href=\"#L121\">121</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 magvar <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>magvar<span class=\"p\">)</span></td></tr><tr><th id=\"L122\"><a href=\"#L122\">122</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0magdir <span class=\"o\">==</span>\u00a0<span class=\"s\">'W'</span><span class=\"p\">:</span></td></tr><tr><th id=\"L123\"><a href=\"#L123\">123</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 magvar <span class=\"o\">=</span>\u00a0<span class=\"o\">-</span>magvar</td></tr><tr><th id=\"L124\"><a href=\"#L124\">124</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L125\"><a href=\"#L125\">125</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 magvar <span class=\"o\">=</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L126\"><a href=\"#L126\">126</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">(</span></td></tr><tr><th id=\"L127\"><a href=\"#L127\">127</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 latitude<span class=\"p\">,</span></td></tr><tr><th id=\"L128\"><a href=\"#L128\">128</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 longitude<span class=\"p\">,</span></td></tr><tr><th id=\"L129\"><a href=\"#L129\">129</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 speed<span class=\"p\">,</span></td></tr><tr><th id=\"L130\"><a href=\"#L130\">130</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 course<span class=\"p\">,</span></td></tr><tr><th id=\"L131\"><a href=\"#L131\">131</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># UTC seconds past utcdate</span></td></tr><tr><th id=\"L132\"><a href=\"#L132\">132</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 utc<span class=\"p\">,</span></td></tr><tr><th id=\"L133\"><a href=\"#L133\">133</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># UTC (year, month, day)</span></td></tr><tr><th id=\"L134\"><a href=\"#L134\">134</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 utcdate<span class=\"p\">,</span></td></tr><tr><th id=\"L135\"><a href=\"#L135\">135</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># None or magnetic variation in degrees (west is negative)</span></td></tr><tr><th id=\"L136\"><a href=\"#L136\">136</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 magvar<span class=\"p\">,</span></td></tr><tr><th id=\"L137\"><a href=\"#L137\">137</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L138\"><a href=\"#L138\">138</a></th><td></td></tr><tr><th id=\"L139\"><a href=\"#L139\">139</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">_decode_utc</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0utc<span class=\"p\">):</span></td></tr><tr><th id=\"L140\"><a href=\"#L140\">140</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 utc_hh<span class=\"p\">,</span>\u00a0utc_mm<span class=\"p\">,</span>\u00a0utc_ss <span class=\"o\">=</span>\u00a0<span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">,</span>\u00a0<span class=\"p\">(</span>utc<span class=\"p\">[:</span><span class=\"mi\">2</span><span class=\"p\">],</span>\u00a0utc<span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"mi\">4</span><span class=\"p\">],</span>\u00a0utc<span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">:]))</span></td></tr><tr><th id=\"L141\"><a href=\"#L141\">141</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0utc_hh <span class=\"o\">*</span>\u00a0<span class=\"mf\">3600.0</span>\u00a0<span class=\"o\">+</span>\u00a0utc_mm <span class=\"o\">*</span>\u00a0<span class=\"mf\">60.0</span>\u00a0<span class=\"o\">+</span>\u00a0utc_ss</td></tr><tr><th id=\"L142\"><a href=\"#L142\">142</a></th><td></td></tr><tr><th id=\"L143\"><a href=\"#L143\">143</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">_decode_latlon</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0latitude<span class=\"p\">,</span>\u00a0ns<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">,</span>\u00a0ew<span class=\"p\">):</span></td></tr><tr><th id=\"L144\"><a href=\"#L144\">144</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 latitude <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>latitude<span class=\"p\">[:</span><span class=\"mi\">2</span><span class=\"p\">])</span>\u00a0<span class=\"o\">+</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>latitude<span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">:])</span><span class=\"o\">/</span><span class=\"mf\">60.0</span></td></tr><tr><th id=\"L145\"><a href=\"#L145\">145</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0ns <span class=\"o\">==</span>\u00a0<span class=\"s\">'S'</span><span class=\"p\">:</span></td></tr><tr><th id=\"L146\"><a href=\"#L146\">146</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 latitude <span class=\"o\">=</span>\u00a0<span class=\"o\">-</span>latitude</td></tr><tr><th id=\"L147\"><a href=\"#L147\">147</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 longitude <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>longitude<span class=\"p\">[:</span><span class=\"mi\">3</span><span class=\"p\">])</span>\u00a0<span class=\"o\">+</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>longitude<span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">:])</span><span class=\"o\">/</span><span class=\"mf\">60.0</span></td></tr><tr><th id=\"L148\"><a href=\"#L148\">148</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0ew <span class=\"o\">==</span>\u00a0<span class=\"s\">'W'</span><span class=\"p\">:</span></td></tr><tr><th id=\"L149\"><a href=\"#L149\">149</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 longitude <span class=\"o\">=</span>\u00a0<span class=\"o\">-</span>longitude</td></tr><tr><th id=\"L150\"><a href=\"#L150\">150</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">(</span>latitude<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">)</span></td></tr><tr><th id=\"L151\"><a href=\"#L151\">151</a></th><td></td></tr><tr><th id=\"L152\"><a href=\"#L152\">152</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_activesatellites</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0mode1<span class=\"p\">,</span>\u00a0mode2<span class=\"p\">,</span>\u00a0<span class=\"o\">*</span>args<span class=\"p\">):</span></td></tr><tr><th id=\"L153\"><a href=\"#L153\">153</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 satellites<span class=\"p\">,</span>\u00a0<span class=\"p\">(</span>pdop<span class=\"p\">,</span>\u00a0hdop<span class=\"p\">,</span>\u00a0vdop<span class=\"p\">)</span>\u00a0<span class=\"o\">=</span>\u00a0args<span class=\"p\">[:</span><span class=\"mi\">12</span><span class=\"p\">],</span>\u00a0<span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">,</span>\u00a0args<span class=\"p\">[</span><span class=\"mi\">12</span><span class=\"p\">:])</span></td></tr><tr><th id=\"L154\"><a href=\"#L154\">154</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 satlist <span class=\"o\">=</span>\u00a0<span class=\"p\">[]</span></td></tr><tr><th id=\"L155\"><a href=\"#L155\">155</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">for</span>\u00a0n <span class=\"ow\">in</span>\u00a0satellites<span class=\"p\">:</span></td></tr><tr><th id=\"L156\"><a href=\"#L156\">156</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0n<span class=\"p\">:</span></td></tr><tr><th id=\"L157\"><a href=\"#L157\">157</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 satlist<span class=\"o\">.</span>append<span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">(</span>n<span class=\"p\">))</span></td></tr><tr><th id=\"L158\"><a href=\"#L158\">158</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L159\"><a href=\"#L159\">159</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 satlist<span class=\"o\">.</span>append<span class=\"p\">(</span><span class=\"bp\">None</span><span class=\"p\">)</span></td></tr><tr><th id=\"L160\"><a href=\"#L160\">160</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 mode <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span>mode1<span class=\"p\">,</span>\u00a0<span class=\"nb\">int</span><span class=\"p\">(</span>mode2<span class=\"p\">))</span></td></tr><tr><th id=\"L161\"><a href=\"#L161\">161</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">(</span></td></tr><tr><th id=\"L162\"><a href=\"#L162\">162</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># satellite list by channel</span></td></tr><tr><th id=\"L163\"><a href=\"#L163\">163</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"nb\">tuple</span><span class=\"p\">(</span>satlist<span class=\"p\">),</span></td></tr><tr><th id=\"L164\"><a href=\"#L164\">164</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># (MODE_AUTO/MODE_FORCED, MODE_NOFIX/MODE_2DFIX/MODE_3DFIX)</span></td></tr><tr><th id=\"L165\"><a href=\"#L165\">165</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 mode<span class=\"p\">,</span></td></tr><tr><th id=\"L166\"><a href=\"#L166\">166</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># position dilution of precision</span></td></tr><tr><th id=\"L167\"><a href=\"#L167\">167</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pdop<span class=\"p\">,</span></td></tr><tr><th id=\"L168\"><a href=\"#L168\">168</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># horizontal dilution of precision</span></td></tr><tr><th id=\"L169\"><a href=\"#L169\">169</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 hdop<span class=\"p\">,</span></td></tr><tr><th id=\"L170\"><a href=\"#L170\">170</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># vertical dilution of precision</span></td></tr><tr><th id=\"L171\"><a href=\"#L171\">171</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 vdop<span class=\"p\">,</span></td></tr><tr><th id=\"L172\"><a href=\"#L172\">172</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr><tr><th id=\"L173\"><a href=\"#L173\">173</a></th><td>\u00a0 \u00a0 </td></tr><tr><th id=\"L174\"><a href=\"#L174\">174</a></th><td>\u00a0 \u00a0 <span class=\"k\">def</span>\u00a0<span class=\"nf\">decode_fix</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span>\u00a0utc<span class=\"p\">,</span>\u00a0latitude<span class=\"p\">,</span>\u00a0ns<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">,</span>\u00a0ew<span class=\"p\">,</span>\u00a0posfix<span class=\"p\">,</span>\u00a0satellites<span class=\"p\">,</span>\u00a0hdop<span class=\"p\">,</span>\u00a0altitude<span class=\"p\">,</span>\u00a0altitude_units<span class=\"p\">,</span>\u00a0geoid_separation<span class=\"p\">,</span>\u00a0geoid_separation_units<span class=\"p\">,</span>\u00a0dgps_age<span class=\"p\">,</span>\u00a0dgps_station_id<span class=\"p\">):</span></td></tr><tr><th id=\"L175\"><a href=\"#L175\">175</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 latitude<span class=\"p\">,</span>\u00a0longitude <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>_decode_latlon<span class=\"p\">(</span>latitude<span class=\"p\">,</span>\u00a0ns<span class=\"p\">,</span>\u00a0longitude<span class=\"p\">,</span>\u00a0ew<span class=\"p\">)</span></td></tr><tr><th id=\"L176\"><a href=\"#L176\">176</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 utc <span class=\"o\">=</span>\u00a0<span class=\"bp\">self</span><span class=\"o\">.</span>_decode_utc<span class=\"p\">(</span>utc<span class=\"p\">)</span></td></tr><tr><th id=\"L177\"><a href=\"#L177\">177</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 posfix <span class=\"o\">=</span>\u00a0<span class=\"nb\">int</span><span class=\"p\">(</span>posfix<span class=\"p\">)</span></td></tr><tr><th id=\"L178\"><a href=\"#L178\">178</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 satellites <span class=\"o\">=</span>\u00a0<span class=\"nb\">int</span><span class=\"p\">(</span>satellites<span class=\"p\">)</span></td></tr><tr><th id=\"L179\"><a href=\"#L179\">179</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 hdop <span class=\"o\">=</span>\u00a0<span class=\"nb\">float</span><span class=\"p\">(</span>hdop<span class=\"p\">)</span></td></tr><tr><th id=\"L180\"><a href=\"#L180\">180</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 altitude <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">(</span>altitude<span class=\"p\">),</span>\u00a0altitude_units<span class=\"p\">)</span></td></tr><tr><th id=\"L181\"><a href=\"#L181\">181</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0geoid_separation <span class=\"o\">!=</span>\u00a0<span class=\"s\">''</span><span class=\"p\">:</span></td></tr><tr><th id=\"L182\"><a href=\"#L182\">182</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 geoid <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">(</span>geoid_separation<span class=\"p\">),</span>\u00a0geoid_separation_units<span class=\"p\">)</span></td></tr><tr><th id=\"L183\"><a href=\"#L183\">183</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L184\"><a href=\"#L184\">184</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 geoid <span class=\"o\">=</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L185\"><a href=\"#L185\">185</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">if</span>\u00a0dgps_age <span class=\"o\">!=</span>\u00a0<span class=\"s\">''</span><span class=\"p\">:</span></td></tr><tr><th id=\"L186\"><a href=\"#L186\">186</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 dgps <span class=\"o\">=</span>\u00a0<span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">(</span>dgps_age<span class=\"p\">),</span>\u00a0dgps_station_id<span class=\"p\">)</span></td></tr><tr><th id=\"L187\"><a href=\"#L187\">187</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">else</span><span class=\"p\">:</span></td></tr><tr><th id=\"L188\"><a href=\"#L188\">188</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 dgps <span class=\"o\">=</span>\u00a0<span class=\"bp\">None</span></td></tr><tr><th id=\"L189\"><a href=\"#L189\">189</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"k\">return</span>\u00a0<span class=\"p\">(</span></td></tr><tr><th id=\"L190\"><a href=\"#L190\">190</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># seconds since 00:00 UTC</span></td></tr><tr><th id=\"L191\"><a href=\"#L191\">191</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 utc<span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0</td></tr><tr><th id=\"L192\"><a href=\"#L192\">192</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># latitude (degrees)</span></td></tr><tr><th id=\"L193\"><a href=\"#L193\">193</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 latitude<span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0</td></tr><tr><th id=\"L194\"><a href=\"#L194\">194</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># longitude (degrees)</span></td></tr><tr><th id=\"L195\"><a href=\"#L195\">195</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 longitude<span class=\"p\">,</span>\u00a0 \u00a0 \u00a0</td></tr><tr><th id=\"L196\"><a href=\"#L196\">196</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># position fix status (POSFIX_INVALID, POSFIX_SPS, POSFIX_DGPS, POSFIX_PPS)</span></td></tr><tr><th id=\"L197\"><a href=\"#L197\">197</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 posfix<span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0</td></tr><tr><th id=\"L198\"><a href=\"#L198\">198</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># number of satellites used for fix 0 &lt;= satellites &lt;= 12 </span></td></tr><tr><th id=\"L199\"><a href=\"#L199\">199</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 satellites<span class=\"p\">,</span>\u00a0 \u00a0</td></tr><tr><th id=\"L200\"><a href=\"#L200\">200</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># horizontal dilution of precision</span></td></tr><tr><th id=\"L201\"><a href=\"#L201\">201</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 hdop<span class=\"p\">,</span>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0</td></tr><tr><th id=\"L202\"><a href=\"#L202\">202</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># None or (altitude according to WGS-84 ellipsoid, units (typically 'M' for meters)) </span></td></tr><tr><th id=\"L203\"><a href=\"#L203\">203</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 altitude<span class=\"p\">,</span></td></tr><tr><th id=\"L204\"><a href=\"#L204\">204</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># None or (geoid separation according to WGS-84 ellipsoid, units (typically 'M' for meters))</span></td></tr><tr><th id=\"L205\"><a href=\"#L205\">205</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 geoid<span class=\"p\">,</span></td></tr><tr><th id=\"L206\"><a href=\"#L206\">206</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 <span class=\"c\"># (age of dgps data in seconds, dgps station id)</span></td></tr><tr><th id=\"L207\"><a href=\"#L207\">207</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 dgps<span class=\"p\">,</span></td></tr><tr><th id=\"L208\"><a href=\"#L208\">208</a></th><td>\u00a0 \u00a0 \u00a0 \u00a0 <span class=\"p\">)</span></td></tr></tbody></table>\n\n      </div>\n      <div id=\"anydiff\">\n        <form action=\"/LUCICodeRepository/nomaticIM/diff\" method=\"get\">\n          <div class=\"buttons\">\n            <input type=\"hidden\" name=\"new_path\" value=\"/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py\" />\n            <input type=\"hidden\" name=\"old_path\" value=\"/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py\" />\n            <input type=\"hidden\" name=\"new_rev\" />\n            <input type=\"hidden\" name=\"old_rev\" />\n            <input type=\"submit\" value=\"View changes...\" title=\"Select paths and revs for Diff\" />\n          </div>\n        </form>\n      </div>\n      <div id=\"help\"><strong>Note:</strong> See <a href=\"/LUCICodeRepository/nomaticIM/wiki/TracBrowser\">TracBrowser</a>\n        for help on using the repository browser.</div>\n    </div>\n    <div id=\"altlinks\">\n      <h3>Download in other formats:</h3>\n      <ul>\n        <li class=\"first\">\n          <a rel=\"nofollow\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py?format=txt\">Plain Text</a>\n        </li><li class=\"last\">\n          <a rel=\"nofollow\" href=\"/LUCICodeRepository/nomaticIM/export/1312/nomatic/tags/NomaticIM-0.0.4/buddy_bots/src/twisted/protocols/gps/nmea.py\">Original Format</a>\n        </li>\n      </ul>\n    </div>\n    </div>\n    <div id=\"footer\" lang=\"en\" xml:lang=\"en\"><hr />\n      <a id=\"tracpowered\" href=\"http://trac.edgewall.org/\"><img src=\"/LUCICodeRepository/nomaticIM/chrome/common/trac_logo_mini.png\" height=\"30\" width=\"107\" alt=\"Trac Powered\" /></a>\n      <p class=\"left\">Powered by <a href=\"/LUCICodeRepository/nomaticIM/about\"><strong>Trac 1.0.1</strong></a><br />\n        By <a href=\"http://www.edgewall.org/\">Edgewall Software</a>.</p>\n      <p class=\"right\">All content copyright 2007-2008 by LUCI <br /><a href=\"http://luci.ics.uci.edu/\">http://luci.ics.uci.edu/</a></p>\n    </div>\n\t\t<div id=\"sitefooter\">\n\t\t\t<script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\n\t\t\t</script>\n\t\t\t<script type=\"text/javascript\">\n\t\t\t\t_uacct = \"UA-338915-2\";\n\t\t\t\turchinTracker();\n\t\t\t</script>\n\t\t</div>\n\t</body>\n</html>", "id": 44921.0}