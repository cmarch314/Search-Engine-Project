{"text": "OEChem Python Theory Manual Version 1 3 1 Previous 6 2 Looping over the Up 6 Traversing the Atoms Next 6 4 Looping over subsets 6 3 Looping over the Neighbors of an Atom Often it is not the bonds around the atoms that you wish to loop over but the neighboring atoms One way to do this would be to use the GetBonds method described in the previous section and use the GetNbr method of each OEBondBase to get the atom across the bond from the input atom usr bin env python ch6 3 py from openeye oechem import def ShowNeighbors atom for bond in atom GetBonds nbor bond GetNbr atom print nbor GetIdx print mol OEGraphMol OEParseSmiles mol c1ccccc1 for atom in mol GetAtoms print atom GetIdx ShowNeighbors atom Download as text However this can be done even more conveniently using the GetAtoms method of an OEAtomBase directly which allows loops over the neighbor atoms usr bin env python ch6 4 py from openeye oechem import def ShowNeighbors atom for nbor in atom GetAtoms print nbor GetIdx print mol OEGraphMol OEParseSmiles mol c1ccccc1 for atom in mol GetAtoms print atom GetIdx ShowNeighbors atom Download as text OEChem Python Theory Manual Version 1 3 1 Previous 6 2 Looping over the Up 6 Traversing the Atoms Next 6 4 Looping over subsets Documentation released on July 3 2 4 ", "_id": "http://www.ics.uci.edu/~dock/manuals/oechem/pyprog/node48.html", "title": "6.3 looping over the neighbors of an atom", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<html>\n<head>\n<title>6.3 Looping over the Neighbors of an Atom</title>\n<META NAME=\"description\" CONTENT=\"6.3 Looping over the Neighbors of an Atom\">\n<META NAME=\"keywords\" CONTENT=\"pyprog\">\n<META NAME=\"resource-type\" CONTENT=\"document\">\n<META NAME=\"distribution\" CONTENT=\"global\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<link rel=\"STYLESHEET\" href=\"pyprog.css\">\n<link rel=\"first\" href=\"pyprog.html\">\n<link rel=\"contents\" href=\"contents.html\" title=\"Contents\">\n\n<LINK REL=\"next\" HREF=\"node49.html\">\n<LINK REL=\"previous\" HREF=\"node47.html\">\n<LINK REL=\"up\" HREF=\"node45.html\">\n<LINK REL=\"next\" HREF=\"node49.html\">\n</head>\n<body>\n<DIV CLASS=\"navigation\">\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node47.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node45.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node49.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - Python Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"genindex.html\"><img src=\"../icons/index.gif\"\n  border=\"0\" alt=\"Index\"></A></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node47.html\">6.2 Looping over the</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node45.html\">6. Traversing the Atoms</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node49.html\">6.4 Looping over subsets</A>\n<br><hr>\n</DIV>\n<!--End of Navigation Panel-->\n\n<H1><A NAME=\"SECTION008300000000000000000\">\n6.3 Looping over the Neighbors of an Atom</A>\n</H1>\n\n<P>\nOften it is not the bonds around the atoms that you wish to loop over,\nbut the neighboring atoms. One way to do this would be to use the\nGetBonds method described in the previous section and use the GetNbr\nmethod of each OEBondBase to get the atom across the bond from the\ninput atom.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#!/usr/bin/env python\n# ch6-3.py\nfrom openeye.oechem import *\n\ndef ShowNeighbors(atom):\n    for bond in atom.GetBonds():\n        nbor = bond.GetNbr(atom)\n        print nbor.GetIdx(),\n    print\n\nmol = OEGraphMol()\nOEParseSmiles(mol, \"c1ccccc1\")\n\nfor atom in mol.GetAtoms():\n    print atom.GetIdx(),\n    ShowNeighbors(atom)\n</pre>\n<div class=\"verbatiminput-footer\">\n<a href=\"ch6-3.txt\" type=\"text/plain\">Download as text.</a>\n</div>\n</dd></dl>\n\n<P>\nHowever this can be done even more conveniently using the GetAtoms\nmethod of an OEAtomBase directly, which allows loops over the neighbor\natoms.\n\n<P>\n<dl><dd><pre class=\"verbatim\">#!/usr/bin/env python\n# ch6-4.py\nfrom openeye.oechem import *\n\ndef ShowNeighbors(atom):\n    for nbor in atom.GetAtoms():\n        print nbor.GetIdx(),\n    print\n\nmol = OEGraphMol()\nOEParseSmiles(mol, \"c1ccccc1\")\n\nfor atom in mol.GetAtoms():\n    print atom.GetIdx(),\n    ShowNeighbors(atom)\n</pre>\n<div class=\"verbatiminput-footer\">\n<a href=\"ch6-4.txt\" type=\"text/plain\">Download as text.</a>\n</div>\n</dd></dl>\n\n<P>\n\n<DIV CLASS=\"navigation\">\n<p><hr>\n<table align=\"center\" border=\"0\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n<tr>\n<td rowspan=2><A HREF=\"node47.html\"><img src=\"../icons/previous.gif\"\n  border=\"0\" alt=\"Previous Page\"></A></td>\n<td rowspan=2><A HREF=\"node45.html\"><img src=\"../icons/up.gif\"\n  border=\"0\" alt=\"Up One Level\"></A></td>\n<td rowspan=2><A HREF=\"node49.html\"><img src=\"../icons/next.gif\"\n  border=\"0\" alt=\"Next Page\"></A></td><td width=\"100%\" rowspan=\"2\"> </td>\n<td valign=\"center\" align=\"right\" height=\"56\" background=\"../icons/title_bkgd.gif\" colspan=4 class=\"navigation\">OEChem - Python Theory Manual\n<BR>\nVersion 1.3.1</td></tr>\n<tr><td><img src=\"../icons/spacer_1.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"contents.html\"><img src=\"../icons/contents.gif\"\n  border=\"0\" alt=\"Contents\"></A></td>\n<td><img src=\"../icons/spacer_2.gif\"\n  border=\"0\" alt=\"\"></td>\n<td><A href=\"genindex.html\"><img src=\"../icons/index.gif\"\n  border=\"0\" alt=\"Index\"></A></td>\n</tr></table>\n<b class=\"navlabel\">Previous:</b> <a class=\"sectref\" HREF=\"node47.html\">6.2 Looping over the</A>\n<b class=\"navlabel\">Up:</b> <a class=\"sectref\" HREF=\"node45.html\">6. Traversing the Atoms</A>\n<b class=\"navlabel\">Next:</b> <a class=\"sectref\" HREF=\"node49.html\">6.4 Looping over subsets</A>\n<hr>\n<span class=\"release-info\">Documentation released on July 30, 2004.</span>\n</DIV>\n<!--End of Navigation Panel-->\n\n</BODY>\n</HTML>\n", "id": 37490.0}