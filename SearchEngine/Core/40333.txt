{"text": " Home Trees Indices Help Package CHEM Package Common Module ChemicalSearch Class ChemicalSearch hide private frames no frames Class ChemicalSearch Given a SMILES string and a limit on the results size returns the most similar fingerprints known by the fingerprint server specified in the Env py file as well as a similarity score of each found fingerprint to the original search string Additional methods include an option to actually retrieve the database information for the chemicals with those fingerprints while still keeping the similarity scores Input searchString SMILES format of a molecule or component to search for similarity by maxResults Maximum number of similar fingerprints to return resultsStart First result index to take out of the full possible results set Output resultsFile Output is the the fingerprint strings found to be most similar to the search criteria Alternatively an option allows for the return of the full database information for the chemicals with those fingerprints Redirection to stdout possible by specifying the filename Instance Methods hide private init self Constructor similarMolSearchByQuery self query histogramOnly False Most of the similarity search work is done here but separate it out assuming the basic query string has already been constructed similarMolQuery self searchModel histogramOnly False Build the fingerprint server query based on the list of similarMols in the search model findChemicals self searchModel Given a ChemicalSearchModel see if it has a similarMols list of OEMolBase objects then find all of the chemical database records that match all of those critiera and return that data including the supplementary search information like similarityScores findChemicalsStrict self searchModel The main work of searching the database for chemical records but only strict standard DB criteria are considerd here advancedCriteriaSearch self searchModel advancedResultsStart advancedMaxResults Find chemicals but only using one of the advanced criteria probably requiring a request to a separate specialized index server searchModelContainsAdvancedCriteria self searchModel Determines whether the searchModel includes advanced crtieria that requires search requests to special index servers beyond basic database filtering setupAdvancedSearch self searchModel Do any setup necessary to facilitate subsequent advanced criteria search runs applyAdvancedCriteriaFilter self searchModel results Filter by strict substructure when appropriate strictSubstructureFilters self substructureMols Initializes and returns a list of OESubSearch objects to filter molecules based on the given substructureMols as substructures fingerprintQuery self query Submit the query string to the fingerprint server chemicalTextSearch self searchModel resultsStart maxResults Forward the chemical text search request on to the text search server searchSources self Return all information on all SOURCE table rows as RowItemModels Method Details hide private similarMolSearchByQuery self query histogramOnly False Most of the similarity search work is done here but separate it out assuming the basic query string has already been constructed If histogramOnly is True assume the query is only to retrieve the score distribution histogram not individual items In that case return it but also just save it to the class public member variable for future access similarMolQuery self searchModel histogramOnly False Build the fingerprint server query based on the list of similarMols in the search model Specifically don t use the resultsStart and resultsEnd parameters here instead the string formatted query returned by this method will have two d entries that should be replaced by the desired values like query self similarMolQuery searchModel query query resultsStart resultsStart maxResults If similarityThreshold is provided in the searchModel can use fast search method to only check for targets that can have a similarity score greater than this threshold If histogramOnly is True will construct a query not to retrieve individual items but just to retrieve the histogram of similarity score distributions findChemicals self searchModel Given a ChemicalSearchModel see if it has a similarMols list of OEMolBase objects then find all of the chemical database records that match all of those critiera and return that data including the supplementary search information like similarityScores If not just look for other search criteria in the model and find chemicals by those criteria and return the same data minus the similarityScore etc Example Usage from CHEM Common ChemicalSearch import ChemicalSearch from CHEM Common Model import ChemicalSearchModel from CHEM Common Util import molBySmiles mol molBySmiles c1ccccc1N C O chemicalSearch ChemicalSearch chemicalQuery ChemicalSearchModel chemicalQuery maxResults 1 chemicalQuery similarityThreshold 5 chemicalQuery addSimilarMol mol resultChemicalModels chemicalSearch findChemicals chemicalQuery for chemical in resultChemicalModels print chemical can smiles findChemicalsStrict self searchModel The main work of searching the database for chemical records but only strict standard DB criteria are considerd here No funny similarity searches etc advancedCriteriaSearch self searchModel advancedResultsStart advancedMaxResults Find chemicals but only using one of the advanced criteria probably requiring a request to a separate specialized index server Figure out which is the proper one to call based on the searchModel contents and defer accordingly fingerprintQuery self query Submit the query string to the fingerprint server Depending on environment settings and what s available this may occur via a direct telnet connection or indirectly via a web service call to the cdb web server Home Trees Indices Help Generated by Epydoc 3 beta1 on Thu Nov 8 17 49 28 2 7 http epydoc sourceforge net", "_id": "http://www.ics.uci.edu/~dock/CHEM_docs/CHEM.Common.ChemicalSearch.ChemicalSearch-class.html", "title": "chem.common.chemicalsearch.chemicalsearch", "html": "<?xml version=\"1.0\" encoding=\"ascii\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n          \"DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n  <title>CHEM.Common.ChemicalSearch.ChemicalSearch</title>\n  <link rel=\"stylesheet\" href=\"epydoc.css\" type=\"text/css\" />\n  <script type=\"text/javascript\" src=\"epydoc.js\"></script>\n</head>\n\n<body bgcolor=\"white\" text=\"black\" link=\"blue\" vlink=\"#204080\"\n      alink=\"#204080\">\n<!-- ==================== NAVIGATION BAR ==================== -->\n<table class=\"navbar\" border=\"0\" width=\"100%\" cellpadding=\"0\"\n       bgcolor=\"#a0c0ff\" cellspacing=\"0\">\n  <tr valign=\"middle\">\n  <!-- Home link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"CHEM-module.html\">Home</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Tree link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"module-tree.html\">Trees</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Index link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"identifier-index.html\">Indices</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Help link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"help.html\">Help</a>&nbsp;&nbsp;&nbsp;</th>\n\n      <th class=\"navbar\" width=\"100%\"></th>\n  </tr>\n</table>\n<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n  <tr valign=\"top\">\n    <td width=\"100%\">\n      <span class=\"breadcrumbs\">\n        <a href=\"CHEM-module.html\">Package&nbsp;CHEM</a> ::\n        <a href=\"CHEM.Common-module.html\">Package&nbsp;Common</a> ::\n        <a href=\"CHEM.Common.ChemicalSearch-module.html\">Module&nbsp;ChemicalSearch</a> ::\n        Class&nbsp;ChemicalSearch\n      </span>\n    </td>\n    <td>\n      <table cellpadding=\"0\" cellspacing=\"0\">\n        <!-- hide/show private -->\n        <tr><td align=\"right\"><span class=\"options\">[<a href=\"javascript:void(0);\" class=\"privatelink\"\n    onclick=\"toggle_private();\">hide&nbsp;private</a>]</span></td></tr>\n        <tr><td align=\"right\"><span class=\"options\"\n            >[<a href=\"frames.html\" target=\"_top\">frames</a\n            >]&nbsp;|&nbsp;<a href=\"CHEM.Common.ChemicalSearch.ChemicalSearch-class.html\"\n            target=\"_top\">no&nbsp;frames</a>]</span></td></tr>\n      </table>\n    </td>\n  </tr>\n</table>\n<!-- ==================== CLASS DESCRIPTION ==================== -->\n<h1 class=\"epydoc\">Class ChemicalSearch</h1><br /><br />\n<pre class=\"literalblock\">\nGiven a SMILES string (and a limit on the results size), returns\nthe most similar fingerprints known by the fingerprint server \n(specified in the Env.py file) as well as a similarity score\nof each found fingerprint to the original search string.\n\nAdditional methods include an option to actually retrieve the \ndatabase information for the chemicals with those fingerprints\n(while still keeping the similarity scores).\n\nInput: \n- searchString:  \n    SMILES format of a molecule or component to search for similarity by.\n- maxResults:  \n    Maximum number of similar fingerprints to return\n- resultsStart:  \n    First result index to take out of the full possible results set\n\nOutput:\n- resultsFile:\n    Output is the the fingerprint strings found to be most similar to the \n    search criteria.  Alternatively, an option allows for the return of\n    the full-database information for the chemicals with those fingerprints.\n\n    Redirection to stdout possible by specifying the filename &quot;-&quot;\n\n</pre><br /><br />\n\n<!-- ==================== INSTANCE METHODS ==================== -->\n<a name=\"section-InstanceMethods\"></a>\n<table class=\"summary\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr bgcolor=\"#70b0f0\" class=\"table-header\">\n  <td colspan=\"2\" class=\"table-header\">\n    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n      <tr valign=\"top\">\n        <td align=\"left\"><span class=\"table-header\">Instance Methods</span></td>\n        <td align=\"right\" valign=\"top\"\n         ><span class=\"options\">[<a href=\"#section-InstanceMethods\"\n         class=\"privatelink\" onclick=\"toggle_private();\"\n         >hide private</a>]</span></td>\n      </tr>\n    </table>\n  </td>\n</tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"__init__\"></a><span class=\"summary-sig-name\">__init__</span>(<span class=\"summary-sig-arg\">self</span>)</span><br />\n      Constructor</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr class=\"private\">\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a href=\"CHEM.Common.ChemicalSearch.ChemicalSearch-class.html#__similarMolSearchByQuery\" class=\"summary-sig-name\">__similarMolSearchByQuery</a>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">query</span>,\n        <span class=\"summary-sig-arg\">histogramOnly</span>=<span class=\"summary-sig-default\">False</span>)</span><br />\n      Most of the similarity search work is done here, but separate it \n      out, assuming the basic query string has already been \n      constructed.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr class=\"private\">\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a href=\"CHEM.Common.ChemicalSearch.ChemicalSearch-class.html#__similarMolQuery\" class=\"summary-sig-name\">__similarMolQuery</a>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">searchModel</span>,\n        <span class=\"summary-sig-arg\">histogramOnly</span>=<span class=\"summary-sig-default\">False</span>)</span><br />\n      Build the fingerprint server query based on the list of \n      similarMols in the search model.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a href=\"CHEM.Common.ChemicalSearch.ChemicalSearch-class.html#findChemicals\" class=\"summary-sig-name\">findChemicals</a>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">searchModel</span>)</span><br />\n      Given a ChemicalSearchModel, see if it has a \nsimilarMols list of OEMolBase objects, then find all of the \nchemical database records that match all of those critiera\nand return that data, including the supplementary search\ninformation like similarityScores.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr class=\"private\">\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a href=\"CHEM.Common.ChemicalSearch.ChemicalSearch-class.html#__findChemicalsStrict\" class=\"summary-sig-name\">__findChemicalsStrict</a>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">searchModel</span>)</span><br />\n      The main work of searching the database for chemical records, but \n      only strict / standard DB criteria are considerd here.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr class=\"private\">\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a href=\"CHEM.Common.ChemicalSearch.ChemicalSearch-class.html#__advancedCriteriaSearch\" class=\"summary-sig-name\">__advancedCriteriaSearch</a>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">searchModel</span>,\n        <span class=\"summary-sig-arg\">advancedResultsStart</span>,\n        <span class=\"summary-sig-arg\">advancedMaxResults</span>)</span><br />\n      Find chemicals, but only using one of the advanced criteria, \n      probably requiring a request to a separate specialized index \n      server.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr class=\"private\">\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"__searchModelContainsAdvancedCriteria\"></a><span class=\"summary-sig-name\">__searchModelContainsAdvancedCriteria</span>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">searchModel</span>)</span><br />\n      Determines whether the searchModel includes advanced crtieria that\n      requires search requests to special index servers, beyond basic \n      database filtering.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr class=\"private\">\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"__setupAdvancedSearch\"></a><span class=\"summary-sig-name\">__setupAdvancedSearch</span>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">searchModel</span>)</span><br />\n      Do any setup necessary to facilitate subsequent advanced criteria \n      search runs</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr class=\"private\">\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"__applyAdvancedCriteriaFilter\"></a><span class=\"summary-sig-name\">__applyAdvancedCriteriaFilter</span>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">searchModel</span>,\n        <span class=\"summary-sig-arg\">results</span>)</span><br />\n      Filter by strict substructure when appropriate</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr class=\"private\">\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"__strictSubstructureFilters\"></a><span class=\"summary-sig-name\">__strictSubstructureFilters</span>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">substructureMols</span>)</span><br />\n      Initializes and returns a list of OESubSearch objects to filter \n      molecules based on the given substructureMols as substructures.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a href=\"CHEM.Common.ChemicalSearch.ChemicalSearch-class.html#fingerprintQuery\" class=\"summary-sig-name\">fingerprintQuery</a>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">query</span>)</span><br />\n      Submit the query string to the fingerprint server.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"chemicalTextSearch\"></a><span class=\"summary-sig-name\">chemicalTextSearch</span>(<span class=\"summary-sig-arg\">self</span>,\n        <span class=\"summary-sig-arg\">searchModel</span>,\n        <span class=\"summary-sig-arg\">resultsStart</span>,\n        <span class=\"summary-sig-arg\">maxResults</span>)</span><br />\n      Forward the chemical text search request on to the text search \n      server.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n<tr>\n    <td width=\"15%\" align=\"right\" valign=\"top\" class=\"summary\">\n      <span class=\"summary-type\">&nbsp;</span>\n    </td><td class=\"summary\">\n      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          <td><span class=\"summary-sig\"><a name=\"searchSources\"></a><span class=\"summary-sig-name\">searchSources</span>(<span class=\"summary-sig-arg\">self</span>)</span><br />\n      Return all information on all SOURCE table rows as \n      RowItemModels.</td>\n          <td align=\"right\" valign=\"top\">\n            \n            \n          </td>\n        </tr>\n      </table>\n      \n    </td>\n  </tr>\n</table>\n<!-- ==================== METHOD DETAILS ==================== -->\n<a name=\"section-MethodDetails\"></a>\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr bgcolor=\"#70b0f0\" class=\"table-header\">\n  <td colspan=\"2\" class=\"table-header\">\n    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n      <tr valign=\"top\">\n        <td align=\"left\"><span class=\"table-header\">Method Details</span></td>\n        <td align=\"right\" valign=\"top\"\n         ><span class=\"options\">[<a href=\"#section-MethodDetails\"\n         class=\"privatelink\" onclick=\"toggle_private();\"\n         >hide private</a>]</span></td>\n      </tr>\n    </table>\n  </td>\n</tr>\n</table>\n<a name=\"__similarMolSearchByQuery\"></a>\n<div class=\"private\">\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr><td>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n  <tr valign=\"top\"><td>\n  <h3 class=\"epydoc\"><span class=\"sig\"><span class=\"sig-name\">__similarMolSearchByQuery</span>(<span class=\"sig-arg\">self</span>,\n        <span class=\"sig-arg\">query</span>,\n        <span class=\"sig-arg\">histogramOnly</span>=<span class=\"sig-default\">False</span>)</span>\n  </h3>\n  </td><td align=\"right\" valign=\"top\"\n    >&nbsp;\n    </td>\n  </table>\n  \n  <p>Most of the similarity search work is done here, but separate it out, \n  assuming the basic query string has already been constructed.</p>\n  If histogramOnly is True, assume the query is only to retrieve the \n  score distribution histogram, not individual items.  In that case, return\n  it but also just save it to the class' public member variable for future \n  access.\n  <dl class=\"fields\">\n  </dl>\n</td></tr></table>\n</div>\n<a name=\"__similarMolQuery\"></a>\n<div class=\"private\">\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr><td>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n  <tr valign=\"top\"><td>\n  <h3 class=\"epydoc\"><span class=\"sig\"><span class=\"sig-name\">__similarMolQuery</span>(<span class=\"sig-arg\">self</span>,\n        <span class=\"sig-arg\">searchModel</span>,\n        <span class=\"sig-arg\">histogramOnly</span>=<span class=\"sig-default\">False</span>)</span>\n  </h3>\n  </td><td align=\"right\" valign=\"top\"\n    >&nbsp;\n    </td>\n  </table>\n  \n  <p>Build the fingerprint server query based on the list of similarMols in\n  the search model. Specifically don't use the resultsStart and resultsEnd \n  parameters here, instead the string formatted query returned by this \n  method will have two %d entries that should be replaced by the desired \n  values like...</p>\n  <p>query = self.__similarMolQuery(searchModel); query = query % \n  (resultsStart,resultsStart+maxResults);</p>\n  <p>If similarityThreshold is provided in the searchModel, can use fast \n  search method to only check for targets that can have a similarity score \n  greater than this threshold.</p>\n  If histogramOnly is True, will construct a query not to retrieve \n  individual items, but just to retrieve the histogram of similarity score \n  distributions.\n  <dl class=\"fields\">\n  </dl>\n</td></tr></table>\n</div>\n<a name=\"findChemicals\"></a>\n<div>\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr><td>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n  <tr valign=\"top\"><td>\n  <h3 class=\"epydoc\"><span class=\"sig\"><span class=\"sig-name\">findChemicals</span>(<span class=\"sig-arg\">self</span>,\n        <span class=\"sig-arg\">searchModel</span>)</span>\n  </h3>\n  </td><td align=\"right\" valign=\"top\"\n    >&nbsp;\n    </td>\n  </table>\n  \n  <pre class=\"literalblock\">\nGiven a ChemicalSearchModel, see if it has a \nsimilarMols list of OEMolBase objects, then find all of the \nchemical database records that match all of those critiera\nand return that data, including the supplementary search\ninformation like similarityScores.\n\nIf not, just look for other search criteria in the model and find chemicals\nby those criteria and return the same data (minus the similarityScore, etc.).\n\nExample Usage:\n\nfrom CHEM.Common.ChemicalSearch import ChemicalSearch;\nfrom CHEM.Common.Model import ChemicalSearchModel;\nfrom CHEM.Common.Util import molBySmiles;\n\nmol = molBySmiles(&quot;c1ccccc1N=C=O&quot;);\nchemicalSearch = ChemicalSearch()\n\nchemicalQuery = ChemicalSearchModel();\nchemicalQuery.maxResults = 10;\nchemicalQuery.similarityThreshold = 0.5;\nchemicalQuery.addSimilarMol(mol);\n\nresultChemicalModels = chemicalSearch.findChemicals(chemicalQuery);\n\nfor chemical in resultChemicalModels:\n    print chemical[&quot;can_smiles&quot;];\n\n</pre>\n  <dl class=\"fields\">\n  </dl>\n</td></tr></table>\n</div>\n<a name=\"__findChemicalsStrict\"></a>\n<div class=\"private\">\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr><td>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n  <tr valign=\"top\"><td>\n  <h3 class=\"epydoc\"><span class=\"sig\"><span class=\"sig-name\">__findChemicalsStrict</span>(<span class=\"sig-arg\">self</span>,\n        <span class=\"sig-arg\">searchModel</span>)</span>\n  </h3>\n  </td><td align=\"right\" valign=\"top\"\n    >&nbsp;\n    </td>\n  </table>\n  \n  The main work of searching the database for chemical records, but only\n  strict / standard DB criteria are considerd here. No funny similarity \n  searches, etc.\n  <dl class=\"fields\">\n  </dl>\n</td></tr></table>\n</div>\n<a name=\"__advancedCriteriaSearch\"></a>\n<div class=\"private\">\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr><td>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n  <tr valign=\"top\"><td>\n  <h3 class=\"epydoc\"><span class=\"sig\"><span class=\"sig-name\">__advancedCriteriaSearch</span>(<span class=\"sig-arg\">self</span>,\n        <span class=\"sig-arg\">searchModel</span>,\n        <span class=\"sig-arg\">advancedResultsStart</span>,\n        <span class=\"sig-arg\">advancedMaxResults</span>)</span>\n  </h3>\n  </td><td align=\"right\" valign=\"top\"\n    >&nbsp;\n    </td>\n  </table>\n  \n  Find chemicals, but only using one of the advanced criteria, probably \n  requiring a request to a separate specialized index server.  Figure out \n  which is the proper one to call based on the searchModel contents and \n  defer accordingly.\n  <dl class=\"fields\">\n  </dl>\n</td></tr></table>\n</div>\n<a name=\"fingerprintQuery\"></a>\n<div>\n<table class=\"details\" border=\"1\" cellpadding=\"3\"\n       cellspacing=\"0\" width=\"100%\" bgcolor=\"white\">\n<tr><td>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n  <tr valign=\"top\"><td>\n  <h3 class=\"epydoc\"><span class=\"sig\"><span class=\"sig-name\">fingerprintQuery</span>(<span class=\"sig-arg\">self</span>,\n        <span class=\"sig-arg\">query</span>)</span>\n  </h3>\n  </td><td align=\"right\" valign=\"top\"\n    >&nbsp;\n    </td>\n  </table>\n  \n  Submit the query string to the fingerprint server. Depending on \n  environment settings and what's available, this may occur via a direct \n  telnet connection or indirectly via a web service call to the cdb web \n  server.\n  <dl class=\"fields\">\n  </dl>\n</td></tr></table>\n</div>\n<br />\n<!-- ==================== NAVIGATION BAR ==================== -->\n<table class=\"navbar\" border=\"0\" width=\"100%\" cellpadding=\"0\"\n       bgcolor=\"#a0c0ff\" cellspacing=\"0\">\n  <tr valign=\"middle\">\n  <!-- Home link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"CHEM-module.html\">Home</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Tree link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"module-tree.html\">Trees</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Index link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"identifier-index.html\">Indices</a>&nbsp;&nbsp;&nbsp;</th>\n\n  <!-- Help link -->\n      <th>&nbsp;&nbsp;&nbsp;<a\n        href=\"help.html\">Help</a>&nbsp;&nbsp;&nbsp;</th>\n\n      <th class=\"navbar\" width=\"100%\"></th>\n  </tr>\n</table>\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%%\">\n  <tr>\n    <td align=\"left\" class=\"footer\">\n    Generated by Epydoc 3.0beta1 on Thu Nov  8 17:49:28 2007\n    </td>\n    <td align=\"right\" class=\"footer\">\n      <a href=\"http://epydoc.sourceforge.net\">http://epydoc.sourceforge.net</a>\n    </td>\n  </tr>\n</table>\n\n<script type=\"text/javascript\">\n  <!--\n  // Private objects are initially displayed (because if\n  // javascript is turned off then we want them to be\n  // visible); but by default, we want to hide them.  So hide\n  // them unless we have a cookie that says to show them.\n  checkCookie()\n  // -->\n</script>\n  \n</body>\n</html>\n", "id": 40333.0}