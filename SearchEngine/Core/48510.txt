{"text": "Search LoginPreferencesHelp GuideAbout Trac WikiTimelineRoadmapBrowse SourceView TicketsSearch Context Navigation Previous ChangeNext Change Changeset 1 62 for nomatic trunk service native wifi mac sensor c View differences inlineside by side Show lines around each change Show the changes in full context Ignore Blank lines Case changes White space changes Timestamp Mar 6 2 9 1 33 12 PM 6 years ago Author djp3Message Mac Wifi Sensor is built and compiling Location nomatic trunk service native wifi mac Files 2 edited modified 1 prop sensor c modified 8 diffs Legend UnmodifiedAddedRemoved nomatic trunk service native wifi mac Property svn ignore old new 1 jni h 2 jnilib 1 nomatic trunk service native wifi mac sensor c r1 61 r1 62 99 1 1 static WirelessContextPtr sys 11 static WirelessInfo info 11static WirelessInfo info 1212 1313 14 Helper functions 15 14 Set up and allocate static variables 1615bool init 1716 1817 int ret WirelessAttach sys 19 WirelessInfo info calloc sizeof WirelessInfo 1 2 if ret sys NULL info NULL 18 if ret sys NULL 2119 return false 222 2624 2725 26 Release static variables 2827bool shutdown 2928 3 if sys NULL 31 free sys 32 sys NULL 33 34 35 if info NULL 36 free info 37 info NULL 38 39 29 WirelessDetach sys 4 3 return true 4131 4232 33 Utility to throw a java exception 4334void throwException JNIEnv env char why 4435 ifndef SENSOR EXAMPLE 5243 5344 45 Get a fresh update of the wireless environment 5446void getWirelessInfo JNIEnv env 5547 56 if sys NULL info NULL 48 int ret WirelessGetInfo sys info 49 if sys NULL 575 throwException env getWirelessInfo failed because of a null pointer 58 return 5951 6 52 else 61 int ret WirelessGetInfo sys info 6253 if ret 6354 throwException env WirelessGetInfo failed 64 return 65 66 else 67 return 6855 6956 7 57 71 7258 73 char getAPSSID JNIEnv env 59 Get and Format the connected AP SSID into a string 6 char getAPSSID 7461 75 return strdup char info name 62 return strdup char info name 7663 7764 78 int getApSignalStrength JNIEnv env 65 Calculate AP Signal Strength 66int getAPSignalStrength int signal 7967 8 68 define NOISE MASK x x 1 7 1 81 return info signal 1 7 1 info signal 15 16 69 return signal 1 7 1 signal 15 16 827 8371 84 85 char formatAPMAC JNIEnv env 72 Format the connected AP and signal strength into a string 73char formatAPMAC int a int b int c int d int e int f int ss 8674 8775 char mac calloc sizeof char 32 88 sprintf mac 2x 2x 2x 2x 2x 2x d 89 info macAddress info macAddress 1 9 info macAddress 2 info macAddress 3 91 info macAddress 4 info macAddress 5 92 getApSignalStrength env 76 sprintf mac 2x 2x 2x 2x 2x 2x 2d a b c d e f ss 9377 return mac 94 95 96 char formatAPMACList JNIEnv env 97 CFArrayRef apList NULL 98 CFArrayRef adHocList NULL 99 1 if sys NULL 1 1 throwException env formatAPMACList failed because sys NULL 1 2 return 1 3 1 4 else 1 5 int ret WirelessScanSplit sys apList adHocList 1 6 if ret apList NULL 1 7 throwException env WirelessScanSplit failed 1 8 return NULL 1 9 11 else 111 WirelessNetworkInfo netInfo WirelessNetworkInfo CFDataGetBytePtr CFArrayGetValueAtIndex apList i 112 if netInfo NULL 113 throwException env formatAPMACList failed because netInfo null 114 return NULL 115 116 else 117 for i i CFArrayGetCount apList i 118 char mac calloc sizeof char 32 119 sprintf mac 2x 2x 2x 2x 2x 2x d 12 netInfo macAddress netInfo macAddress 1 121 netInfo macAddress 2 netInfo macAddress 3 122 netInfo macAddress 4 netInfo macAddress 5 123 getApSignalStrength netInfo 124 env SetObjectArrayElement env results i env NewStringUTF env char mac 125 free mac 126 127 128 else 129 return mac 13 13178 13279 1338 13481 Java wrappers 135 13682 ifndef SENSOR EXAMPLE 137 13883JNIEXPORT void JNICALL Java edu uci ics luci nomatic service sensors MacWifiSensor nativeInit JNIEnv env jobject ob 13984 14 if init 85 if init 14186 throwException env Mac WiFi Initialization failed 14287 1459 JNIEXPORT void JNICALL Java edu uci ics luci nomatic service sensors MacWifiSensor nativeShutdown JNIEnv env jobject ob 14691 147 if shutdown 92 if shutdown 14893 throwException env Mac WiFi Shutdown failed 14994 15297JNIEXPORT jstring JNICALL Java edu uci ics luci nomatic service sensors MacWifiSensor getAPSSID JNIEnv env jobject ob 15398 154 char ssid getAPSSID env 99 getWirelessInfo env 1 char ssid getAPSSID env 1551 1 if ssid NULL 1561 2 throwException env Unable to get AP SSID 168114 169115 getWirelessInfo env 17 return getApSignalStrength env 116 return getAPSignalStrength info signal 171117 172118 17412 JNIEXPORT jstring JNICALL Java edu uci ics luci nomatic service sensors MacWifiSensor getAPMAC JNIEnv env jobject ob 175121 176 char mac formatAPMAC 122 getWirelessInfo env 123 char mac formatAPMAC info macAddress 124 info macAddress 1 125 info macAddress 2 126 info macAddress 3 127 info macAddress 4 128 info macAddress 5 129 getAPSignalStrength info signal 17713 jstring ret env NewStringUTF env char mac 178131 free mac 182135JNIEXPORT jobjectArray JNICALL Java edu uci ics luci nomatic service sensors MacWifiSensor getAllAPMAC JNIEnv env jobject ob 183136 184 185 for i i CFArrayGetCount apList i 186 char mac formatAPMACList env 187 env SetObjectArrayElement env results i env NewStringUTF env char mac 188 free mac 137 getWirelessInfo env 138 139 CFArrayRef apList NULL 14 CFArrayRef adHocList NULL 141 142 if sys NULL 143 throwException env getAllAPMac failed because sys NULL 144 return NULL 145 146 else 147 jobjectArray results env NewObjectArray env CFArrayGetCount apList env FindClass env java lang String 148 if results NULL 149 throwException env getAllAPMac failed because results NULL 15 return NULL 189151 19 return results 152 else 153 int ret WirelessScanSplit sys apList adHocList 154 if ret apList NULL 155 throwException env WirelessScanSplit failed 156 157 else 158 int i 159 for i i CFArrayGetCount apList i 16 WirelessNetworkInfo netInfo WirelessNetworkInfo CFDataGetBytePtr CFArrayGetValueAtIndex apList i 161 if netInfo NULL 162 throwException env formatAPMACList failed because netInfo null 163 164 else 165 char mac formatAPMAC netInfo macAddress 166 netInfo macAddress 1 167 netInfo macAddress 2 168 netInfo macAddress 3 169 netInfo macAddress 4 17 netInfo macAddress 5 171 getAPSignalStrength netInfo signal 172 env SetObjectArrayElement env results i env NewStringUTF env char mac 173 free mac 174 175 176 177 178 return results 191179 19218 193181 194 JNIEXPORT void JNICALL Java edu uci ics luci nomatic service sensors MacWifiSensor nativeShutdown 195 JNIEnv env jobject ob 196 197 WirelessDetach sys 198 199182 2 183 endif Note See TracChangeset for help on using the changeset viewer Download in other formats Unified Diff Zip Archive Powered by Trac 1 1 By Edgewall Software All content copyright 2 7 2 8 by LUCI http luci ics uci edu ", "_id": "http://djp3-pc2.ics.uci.edu/LUCICodeRepository/nomaticIM/changeset/1062/nomatic/trunk/service/native/wifi/mac/sensor.c", "title": "\n      changeset 1062 for nomatic/trunk/service/native/wifi/mac/sensor.c \u2013 nomatic*im\n    ", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n  \n  \n\n  \n\n\n  <head>\n\t\t<title>\n      Changeset 1062 for nomatic/trunk/service/native/wifi/mac/sensor.c \u2013 Nomatic*IM\n    </title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><link rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search\" /><link rel=\"help\" href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\" /><link rel=\"alternate\" href=\"?format=diff&amp;new=1062\" type=\"text/plain\" class=\"diff\" title=\"Unified Diff\" /><link rel=\"alternate\" href=\"?format=zip&amp;new=1062\" type=\"application/zip\" class=\"zip\" title=\"Zip Archive\" /><link rel=\"start\" href=\"/LUCICodeRepository/nomaticIM/wiki\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/trac.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/diff.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/changeset.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/LUCICodeRepository/nomaticIM/chrome/common/css/code.css\" type=\"text/css\" /><link rel=\"prev\" href=\"/LUCICodeRepository/nomaticIM/changeset/1061/nomatic/trunk/service/native/wifi/mac/sensor.c\" title=\"Changeset 1061 for nomatic/trunk/service/native/wifi/mac/sensor.c\" /><link rel=\"shortcut icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link rel=\"icon\" href=\"http://luci.ics.uci.edu/logo32by32.gif\" type=\"image/gif\" /><link type=\"application/opensearchdescription+xml\" rel=\"search\" href=\"/LUCICodeRepository/nomaticIM/search/opensearch\" title=\"Search Nomatic*IM\" /><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/jquery.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/babel.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/messages/en_US.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/trac.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/search.js\"></script><script type=\"text/javascript\" charset=\"utf-8\" src=\"/LUCICodeRepository/nomaticIM/chrome/common/js/diff.js\"></script><script type=\"text/javascript\">\n      jQuery(document).ready(function($) {\n        $(\".trac-toggledeleted\").show().click(function() {\n                  $(this).siblings().find(\".trac-deleted\").toggle();\n                  return false;\n        }).click();\n        $(\"#content\").find(\"li.entry h2 a\").parent().addAnchor(_(\"Link to this diff\"));\n      });\n    </script>\n\t</head>\n  <body>\n    <div id=\"banner\">\n      <div id=\"header\">\n        <a id=\"logo\" href=\"http://luci.ics.uci.edu/#code\"><img src=\"http://luci.ics.uci.edu/blog/archives/LUCIhorzTight.jpg\" alt=\"LUCI Code Repository\" /></a>\n      </div>\n      <form id=\"search\" action=\"/LUCICodeRepository/nomaticIM/search\" method=\"get\">\n        <div>\n          <label for=\"proj-search\">Search:</label>\n          <input type=\"text\" id=\"proj-search\" name=\"q\" size=\"18\" value=\"\" />\n          <input type=\"submit\" value=\"Search\" />\n        </div>\n      </form>\n      <div id=\"metanav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/login\">Login</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/prefs\">Preferences</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/wiki/TracGuide\">Help/Guide</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/about\">About Trac</a></li>\n    </ul>\n  </div>\n    </div>\n    <div id=\"mainnav\" class=\"nav\">\n    <ul>\n      <li class=\"first\"><a href=\"/LUCICodeRepository/nomaticIM/wiki\">Wiki</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/timeline\">Timeline</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/roadmap\">Roadmap</a></li><li class=\"active\"><a href=\"/LUCICodeRepository/nomaticIM/browser\">Browse Source</a></li><li><a href=\"/LUCICodeRepository/nomaticIM/report\">View Tickets</a></li><li class=\"last\"><a href=\"/LUCICodeRepository/nomaticIM/search\">Search</a></li>\n    </ul>\n  </div>\n    <div id=\"main\">\n      <div id=\"ctxtnav\" class=\"nav\">\n        <h2>Context Navigation</h2>\n        <ul>\n          <li class=\"first\"><span>&larr; <a class=\"prev\" href=\"/LUCICodeRepository/nomaticIM/changeset/1061/nomatic/trunk/service/native/wifi/mac/sensor.c\" title=\"Changeset 1061 for nomatic/trunk/service/native/wifi/mac/sensor.c\">Previous Change</a></span></li><li class=\"last\"><span class=\"missing\">Next Change &rarr;</span></li>\n        </ul>\n        <hr />\n      </div>\n    <div id=\"content\" class=\"changeset\">\n      <div id=\"title\">\n            <h1>Changeset <a title=\"Show full changeset\" href=\"/LUCICodeRepository/nomaticIM/changeset/1062\">1062</a>\n              for <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062\">nomatic/trunk/service/native/wifi/mac/sensor.c</a></h1>\n      </div>\n      <form id=\"prefs\" action=\"\">\n        <div>\n          \n  <label for=\"style\">View differences</label>\n  <select id=\"style\" name=\"style\">\n    <option selected=\"selected\" value=\"inline\">inline</option>\n    <option value=\"sidebyside\">side by side</option>\n  </select>\n  <div class=\"field\">\n    <label><input type=\"radio\" name=\"contextall\" value=\"0\" checked=\"checked\" />\n             Show</label>\n      <label><input type=\"text\" name=\"contextlines\" id=\"contextlines\" size=\"2\" maxlength=\"3\" value=\"2\" />\n             lines around each change</label><br />\n    <label><input type=\"radio\" name=\"contextall\" value=\"1\" />\n           Show the changes in full context</label>\n  </div>\n  <fieldset id=\"ignore\">\n    <legend>Ignore:</legend>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignoreblanklines\" name=\"ignoreblanklines\" />\n      <label for=\"ignoreblanklines\">Blank lines</label>\n    </div>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignorecase\" name=\"ignorecase\" />\n      <label for=\"ignorecase\">Case changes</label>\n    </div>\n    <div class=\"field\">\n      <input type=\"checkbox\" id=\"ignorewhitespace\" name=\"ignorewhitespace\" />\n      <label for=\"ignorewhitespace\">White space changes</label>\n    </div>\n  </fieldset>\n  <div class=\"buttons\">\n    <input type=\"submit\" name=\"update\" value=\"Update\" />\n  </div>\n\n        </div>\n      </form>\n      <dl id=\"overview\">\n          <dt class=\"property time\">Timestamp:</dt>\n          <dd class=\"time\">\n             Mar 6, 2009, 1:33:12 PM\n             (<a class=\"timeline\" href=\"/LUCICodeRepository/nomaticIM/timeline?from=2009-03-06T13%3A33%3A12-08%3A00&amp;precision=second\" title=\"See timeline at Mar 6, 2009, 1:33:12 PM\">6 years</a> ago)\n          </dd>\n          <dt class=\"property author\">Author:</dt>\n          <dd class=\"author\">djp3</dd>\n          <dt class=\"property message\">Message:</dt>\n          <dd class=\"message searchable\">\n            \n            \n              <p>\nMac Wifi Sensor is built and compiling<br />\n</p>\n\n            \n            \n          </dd>\n          <dt class=\"property location\">Location:</dt>\n          <dd class=\"searchable\"><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac?rev=1062\">nomatic/trunk/service/native/wifi/mac</a></dd>\n        <dt class=\"property files\">\n          Files:\n        </dt>\n        <dd class=\"files\">\n          <div class=\"legend\" id=\"file-legend\">\n            <dl>\n              <dt class=\"mod\"></dt><dd>2 edited</dd>\n            </dl>\n          </div>\n          <br />\n          <ul>\n            <li>\n          <div class=\"mod\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac?rev=1062\">\n              .\n            </a>\n          <span class=\"comment\">(modified)</span>\n              (<a title=\"Show differences\" href=\"#file0\">1 prop</a>)\n            </li><li>\n          <div class=\"mod\"> </div>\n            <a title=\"Show entry in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062\">\n              sensor.c\n            </a>\n          <span class=\"comment\">(modified)</span>\n              (<a title=\"Show differences\" href=\"#file1\">8 diffs</a>)\n            </li>\n          </ul>\n        </dd>\n      </dl>\n      <div class=\"diff\">\n        <div class=\"legend\" id=\"diff-legend\">\n          <h3>Legend:</h3>\n          <dl>\n            <dt class=\"unmod\"></dt><dd>Unmodified</dd>\n            <dt class=\"add\"></dt><dd>Added</dd>\n            <dt class=\"rem\"></dt><dd>Removed</dd>\n          </dl>\n        </div>\n        <div class=\"diff\">\n  <ul class=\"entries\">\n      <li class=\"entry\">\n        <h2 id=\"file0\">\n          <a href=\"/LUCICodeRepository/nomaticIM/changeset/1062/nomatic/trunk/service/native/wifi/mac\" title=\"Show the changeset 1062 restricted to nomatic/trunk/service/native/wifi/mac\">nomatic/trunk/service/native/wifi/mac</a>\n        </h2>\n        <ul class=\"props\">\n            <li>Property <strong>svn:ignore</strong><div class=\"diff\">\n  <ul class=\"entries\">\n      <li class=\"entry\">\n        <h2>\n          \u00a0\n        </h2>\n        <table class=\"trac-diff inline\" summary=\"Differences\" cellspacing=\"0\">\n              <colgroup><col class=\"lineno\" /><col class=\"lineno\" /><col class=\"content\" /></colgroup>\n              <thead>\n                <tr>\n                  <th title=\"File \">\n                      old\n                  </th>\n                  <th title=\"File \">\n                      new\n                  </th>\n                  <td><em></em>\u00a0</td>\n                </tr>\n              </thead>\n            <tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>1</th><th>\u00a0</th><td class=\"l\"><span>jni.h</span>\u00a0</td>\n                      </tr><tr>\n                        <th>2</th><th>\u00a0</th><td class=\"l\"><span>*.jnilib</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>1</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr>\n            </tbody>\n        </table>\n      </li>\n  </ul>\n</div></li>\n        </ul>\n      </li>\n      <li class=\"entry\">\n        <h2 id=\"file1\">\n          <a href=\"/LUCICodeRepository/nomaticIM/changeset/1062/nomatic/trunk/service/native/wifi/mac/sensor.c\" title=\"Show the changeset 1062 restricted to nomatic/trunk/service/native/wifi/mac/sensor.c\">nomatic/trunk/service/native/wifi/mac/sensor.c</a>\n        </h2>\n        <table class=\"trac-diff inline\" summary=\"Differences\" cellspacing=\"0\">\n              <colgroup><col class=\"lineno\" /><col class=\"lineno\" /><col class=\"content\" /></colgroup>\n              <thead>\n                <tr>\n                  <th title=\"Revision 1061\">\n                    <a title=\"Show revision 1061 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1061#L9\">\n                      r1061</a>\n                  </th>\n                  <th title=\"Revision 1062\">\n                    <a title=\"Show revision 1062 of this file in browser\" href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062#L9\">\n                      r1062</a>\n                  </th>\n                  <td>\u00a0</td>\n                </tr>\n              </thead>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>9</th><th>9</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>10</th><th>10</th><td class=\"l\"><span>static WirelessContextPtr sys;</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>11</th><th>\u00a0</th><td class=\"l\"><span>static WirelessInfo <del>*</del>info;</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>11</th><td class=\"r\"><span>static WirelessInfo <ins></ins>info;</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>12</th><th>12</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>13</th><th>13</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>14</th><th>\u00a0</th><td class=\"l\"><span>/** Helper functions **/</span>\u00a0</td>\n                      </tr><tr>\n                        <th>15</th><th>\u00a0</th><td class=\"l\"><span></span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>14</th><td class=\"r\"><span>/** Set up and allocate static variables**/</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>16</th><th>15</th><td class=\"l\"><span>bool init()</span>\u00a0</td>\n                  </tr><tr>\n                          <th>17</th><th>16</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr><tr>\n                          <th>18</th><th>17</th><td class=\"l\"><span>&nbsp; &nbsp; int ret = WirelessAttach(&amp;sys, 0);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>19</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; WirelessInfo *info = calloc(sizeof(WirelessInfo),1);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>20</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if (ret != 0 || sys == NULL || info == NULL) {</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>18</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if (ret != 0 || sys == NULL) {</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>21</th><th>19</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(false);</span>\u00a0</td>\n                  </tr><tr>\n                          <th>22</th><th>20</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1061#L26\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062#L24\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>26</th><th>24</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>27</th><th>25</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"last first\">\n                          <th>\u00a0</th><th>26</th><td class=\"r\"><ins>/** Release static variables */</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>28</th><th>27</th><td class=\"l\"><span>bool shutdown()</span>\u00a0</td>\n                  </tr><tr>\n                          <th>29</th><th>28</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>30</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if(sys != NULL){</span>\u00a0</td>\n                      </tr><tr>\n                        <th>31</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; free(sys);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>32</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sys = NULL;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>33</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>34</th><th>\u00a0</th><td class=\"l\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>35</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if(info != NULL){</span>\u00a0</td>\n                      </tr><tr>\n                        <th>36</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; free(info);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>37</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info = NULL;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>38</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>39</th><th>\u00a0</th><td class=\"l\"><span></span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>29</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; WirelessDetach(sys);</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>40</th><th>30</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return(true);</span>\u00a0</td>\n                  </tr><tr>\n                          <th>41</th><th>31</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>42</th><th>32</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"last first\">\n                          <th>\u00a0</th><th>33</th><td class=\"r\"><ins>/** Utility to throw a java exception */</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>43</th><th>34</th><td class=\"l\"><span>void throwException(JNIEnv *env, char *why){</span>\u00a0</td>\n                  </tr><tr>\n                          <th>44</th><th>35</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; #ifndef __SENSOR_EXAMPLE__ </span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1061#L52\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062#L43\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>52</th><th>43</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>53</th><th>44</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"add\">\n                  <tr class=\"last first\">\n                          <th>\u00a0</th><th>45</th><td class=\"r\"><ins>/** Get a fresh update of the wireless environment */</ins>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>54</th><th>46</th><td class=\"l\"><span>void getWirelessInfo(JNIEnv *env){</span>\u00a0</td>\n                  </tr><tr>\n                          <th>55</th><th>47</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>56</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if(sys == NULL || info == NULL){&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>48</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; int ret = WirelessGetInfo(sys, &amp;info);</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>49</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if(sys == NULL){&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>57</th><th>50</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"getWirelessInfo failed because of a null pointer.\");</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"last first\">\n                          <th>58</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>59</th><th>51</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr><tr>\n                          <th>60</th><th>52</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; else{</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"last first\">\n                          <th>61</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int ret = WirelessGetInfo(sys, info);</del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>62</th><th>53</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (ret != 0){</span>\u00a0</td>\n                  </tr><tr>\n                          <th>63</th><th>54</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env, \"WirelessGetInfo failed.\");</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"first\">\n                          <th>64</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</del>\u00a0</td>\n                  </tr><tr>\n                          <th>65</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del>\u00a0</td>\n                  </tr><tr>\n                          <th>66</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else{</del>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>67</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>68</th><th>55</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr><tr>\n                          <th>69</th><th>56</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr><tr>\n                          <th>70</th><th>57</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"last first\">\n                          <th>71</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; </del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>72</th><th>58</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>73</th><th>\u00a0</th><td class=\"l\"><span>char *getAPSSID(JNIEnv *env)</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>59</th><td class=\"r\"><span>/** Get and Format the connected AP SSID into a string*/</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>60</th><td class=\"r\"><span>char *getAPSSID()</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>74</th><th>61</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>75</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return(strdup((char *)info<del>-&gt;</del>name));</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>62</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return(strdup((char *)info<ins>.</ins>name));</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>76</th><th>63</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>77</th><th>64</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>78</th><th>\u00a0</th><td class=\"l\"><span>int getApSignalStrength(JNIEnv *env)</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>65</th><td class=\"r\"><span>/** Calculate AP Signal Strength */</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>66</th><td class=\"r\"><span>int getAPSignalStrength(int signal)</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>79</th><th>67</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr><tr>\n                          <th>80</th><th>68</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; #define NOISE_MASK(x)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;((x)&amp;((1&lt;&lt;7)-1))</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>81</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return (((<del>info-&gt;signal)&amp;((1&lt;&lt;7)-1))-(((info-&gt;</del>signal)&gt;&gt;15)*16));</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>69</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return (((<ins>signal)&amp;((1&lt;&lt;7)-1))-(((</ins>signal)&gt;&gt;15)*16));</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>82</th><th>70</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>83</th><th>71</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>84</th><th>\u00a0</th><td class=\"l\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>85</th><th>\u00a0</th><td class=\"l\"><span>char *formatAPMAC(<del>JNIEnv *env</del>){</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>72</th><td class=\"r\"><span>/** Format the connected AP and signal strength into a string */</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>73</th><td class=\"r\"><span>char *formatAPMAC(<ins>int a,int b, int c, int d, int e, int f,int ss</ins>){</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>86</th><th>74</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>87</th><th>75</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; char *mac = calloc(sizeof(char),32);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>88</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; sprintf(mac, \"%02x:%02x:%02x:%02x:%02x:%02x(%d)\",</span>\u00a0</td>\n                      </tr><tr>\n                        <th>89</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info-&gt;macAddress[0], info-&gt;macAddress[1],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>90</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info-&gt;macAddress[2], info-&gt;macAddress[3],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>91</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info-&gt;macAddress[4], info-&gt;macAddress[5],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>92</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _getApSignalStrength(env));</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>76</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; sprintf(mac, \"%02x:%02x:%02x:%02x:%02x:%02x(%02d)\",a,b,c,d,e,f,ss);</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>93</th><th>77</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return(mac);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"first\">\n                          <th>94</th><th>\u00a0</th><td class=\"l\"><del>}</del>\u00a0</td>\n                  </tr><tr>\n                          <th>95</th><th>\u00a0</th><td class=\"l\"><del></del>\u00a0</td>\n                  </tr><tr>\n                          <th>96</th><th>\u00a0</th><td class=\"l\"><del>char *formatAPMACList(JNIEnv *env){</del>\u00a0</td>\n                  </tr><tr>\n                          <th>97</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; CFArrayRef apList = NULL;</del>\u00a0</td>\n                  </tr><tr>\n                          <th>98</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; CFArrayRef adHocList = NULL;</del>\u00a0</td>\n                  </tr><tr>\n                          <th>99</th><th>\u00a0</th><td class=\"l\"><del></del>\u00a0</td>\n                  </tr><tr>\n                          <th>100</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; if(sys == NULL){&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </del>\u00a0</td>\n                  </tr><tr>\n                          <th>101</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"_formatAPMACList failed because sys == NULL\");</del>\u00a0</td>\n                  </tr><tr>\n                          <th>102</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</del>\u00a0</td>\n                  </tr><tr>\n                          <th>103</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del>\u00a0</td>\n                  </tr><tr>\n                          <th>104</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; else{</del>\u00a0</td>\n                  </tr><tr>\n                          <th>105</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int ret = WirelessScanSplit(sys, &amp;apList, &amp;adHocList, 0);</del>\u00a0</td>\n                  </tr><tr>\n                          <th>106</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (ret != 0 || apList == NULL) {</del>\u00a0</td>\n                  </tr><tr>\n                          <th>107</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"WirelessScanSplit failed.\");</del>\u00a0</td>\n                  </tr><tr>\n                          <th>108</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(NULL);</del>\u00a0</td>\n                  </tr><tr>\n                          <th>109</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del>\u00a0</td>\n                  </tr><tr>\n                          <th>110</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else{</del>\u00a0</td>\n                  </tr><tr>\n                          <th>111</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WirelessNetworkInfo *netInfo = (WirelessNetworkInfo *)CFDataGetBytePtr(CFArrayGetValueAtIndex(apList, i));</del>\u00a0</td>\n                  </tr><tr>\n                          <th>112</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(netInfo == NULL){</del>\u00a0</td>\n                  </tr><tr>\n                          <th>113</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"_formatAPMACList failed because netInfo == null\");</del>\u00a0</td>\n                  </tr><tr>\n                          <th>114</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(NULL);</del>\u00a0</td>\n                  </tr><tr>\n                          <th>115</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del>\u00a0</td>\n                  </tr><tr>\n                          <th>116</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else{</del>\u00a0</td>\n                  </tr><tr>\n                          <th>117</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(i=0; i &lt; CFArrayGetCount(apList); i++) {</del>\u00a0</td>\n                  </tr><tr>\n                          <th>118</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char *mac = calloc(sizeof(char),32);</del>\u00a0</td>\n                  </tr><tr>\n                          <th>119</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sprintf(mac, \"%02x:%02x:%02x:%02x:%02x:%02x(%d)\",</del>\u00a0</td>\n                  </tr><tr>\n                          <th>120</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netInfo.macAddress[0], netInfo.macAddress[1],</del>\u00a0</td>\n                  </tr><tr>\n                          <th>121</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netInfo.macAddress[2], netInfo.macAddress[3],</del>\u00a0</td>\n                  </tr><tr>\n                          <th>122</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netInfo.macAddress[4], netInfo.macAddress[5],</del>\u00a0</td>\n                  </tr><tr>\n                          <th>123</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _getApSignalStrength(netInfo));</del>\u00a0</td>\n                  </tr><tr>\n                          <th>124</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (*env)-&gt;SetObjectArrayElement(env, results, i, (*env)-&gt;NewStringUTF( env, (char*)mac ));</del>\u00a0</td>\n                  </tr><tr>\n                          <th>125</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; free(mac);</del>\u00a0</td>\n                  </tr><tr>\n                          <th>126</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del>\u00a0</td>\n                  </tr><tr>\n                          <th>127</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del>\u00a0</td>\n                  </tr><tr>\n                          <th>128</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; else{</del>\u00a0</td>\n                  </tr><tr>\n                          <th>129</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(mac);</del>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>130</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>131</th><th>78</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>132</th><th>79</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>133</th><th>80</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>134</th><th>81</th><td class=\"l\"><span>/** Java wrappers **/</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"last first\">\n                          <th>135</th><th>\u00a0</th><td class=\"l\"><del></del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>136</th><th>82</th><td class=\"l\"><span>#ifndef __SENSOR_EXAMPLE__ </span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"last first\">\n                          <th>137</th><th>\u00a0</th><td class=\"l\"><del></del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>138</th><th>83</th><td class=\"l\"><span>JNIEXPORT void JNICALL Java_edu_uci_ics_luci_nomatic_service_sensors_MacWifiSensor_nativeInit (JNIEnv * env, jobject ob)</span>\u00a0</td>\n                  </tr><tr>\n                          <th>139</th><th>84</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>140</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if (!<del>_</del>init()) {</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>85</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if (!<ins></ins>init()) {</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>141</th><th>86</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"Mac WiFi Initialization failed.\");</span>\u00a0</td>\n                  </tr><tr>\n                          <th>142</th><th>87</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1061#L145\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062#L90\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>145</th><th>90</th><td class=\"l\"><span>JNIEXPORT void JNICALL Java_edu_uci_ics_luci_nomatic_service_sensors_MacWifiSensor_nativeShutdown (JNIEnv * env, jobject ob)</span>\u00a0</td>\n                  </tr><tr>\n                          <th>146</th><th>91</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>147</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if (!<del>_</del>shutdown()) {</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>92</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if (!<ins></ins>shutdown()) {</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>148</th><th>93</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"Mac WiFi Shutdown failed.\");</span>\u00a0</td>\n                  </tr><tr>\n                          <th>149</th><th>94</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1061#L152\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062#L97\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>152</th><th>97</th><td class=\"l\"><span>JNIEXPORT jstring JNICALL Java_edu_uci_ics_luci_nomatic_service_sensors_MacWifiSensor_getAPSSID (JNIEnv * env, jobject ob)</span>\u00a0</td>\n                  </tr><tr>\n                          <th>153</th><th>98</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>154</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; char *ssid = _getAPSSID(env);</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>99</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; getWirelessInfo(env);</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>100</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; char *ssid = getAPSSID(env);</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>155</th><th>101</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if (ssid == NULL){</span>\u00a0</td>\n                  </tr><tr>\n                          <th>156</th><th>102</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env, \"Unable to get AP SSID.\");</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1061#L168\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062#L114\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>168</th><th>114</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr><tr>\n                          <th>169</th><th>115</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; getWirelessInfo(env);</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>170</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return <del>_getApSignalStrength(env</del>);</span>\u00a0</td>\n                      </tr>\n                      <tr class=\"last\">\n                        <th>\u00a0</th><th>116</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; return <ins>getAPSignalStrength(info.signal</ins>);</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>171</th><th>117</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>172</th><th>118</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1061#L174\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062#L120\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>174</th><th>120</th><td class=\"l\"><span>JNIEXPORT jstring JNICALL Java_edu_uci_ics_luci_nomatic_service_sensors_MacWifiSensor__getAPMAC (JNIEnv * env, jobject ob)</span>\u00a0</td>\n                  </tr><tr>\n                          <th>175</th><th>121</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>176</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; char *mac = _formatAPMAC();</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>122</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; getWirelessInfo(env);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>123</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; char *mac = formatAPMAC(info.macAddress[0],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>124</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info.macAddress[1],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>125</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info.macAddress[2],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>126</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info.macAddress[3],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>127</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info.macAddress[4],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>128</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info.macAddress[5],</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>129</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; getAPSignalStrength(info.signal));</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>177</th><th>130</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; jstring ret = (*env)-&gt;NewStringUTF(env, (char*)mac);</span>\u00a0</td>\n                  </tr><tr>\n                          <th>178</th><th>131</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; free(mac);</span>\u00a0</td>\n                  </tr>\n            </tbody>\n              <tbody class=\"skipped\">\n                <tr>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1061#L182\">\u2026</a></th>\n                  <th><a href=\"/LUCICodeRepository/nomaticIM/browser/nomatic/trunk/service/native/wifi/mac/sensor.c?rev=1062#L135\">\u2026</a></th>\n                  <td>\u00a0</td>\n                </tr>\n              </tbody>\n            <tbody class=\"unmod\">\n                  <tr>\n                          <th>182</th><th>135</th><td class=\"l\"><span>JNIEXPORT jobjectArray JNICALL Java_edu_uci_ics_luci_nomatic_service_sensors_MacWifiSensor__getAllAPMAC (JNIEnv * env, jobject ob)</span>\u00a0</td>\n                  </tr><tr>\n                          <th>183</th><th>136</th><td class=\"l\"><span>{</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>184</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>185</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(i=0; i &lt; CFArrayGetCount(apList); i++) {</span>\u00a0</td>\n                      </tr><tr>\n                        <th>186</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char *mac = _formatAPMACList(env);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>187</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (*env)-&gt;SetObjectArrayElement(env, results, i, (*env)-&gt;NewStringUTF( env, (char*)mac ));</span>\u00a0</td>\n                      </tr><tr>\n                        <th>188</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; free(mac);</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>137</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; getWirelessInfo(env);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>138</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>139</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; CFArrayRef apList = NULL;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>140</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; CFArrayRef adHocList = NULL;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>141</th><td class=\"r\"><span></span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>142</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; if(sys == NULL){&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>143</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"_getAllAPMac failed because sys == NULL\");</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>144</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return NULL;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>145</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>146</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; else{</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>147</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jobjectArray results = (*env)-&gt;NewObjectArray(env, CFArrayGetCount(apList), (*env)-&gt;FindClass(env, \"java/lang/String\"), 0);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>148</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(results == NULL){&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>149</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"_getAllAPMac failed because results == NULL\");</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>150</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return NULL;</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>189</th><th>151</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"mod\">\n                      <tr class=\"first\">\n                        <th>190</th><th>\u00a0</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return results;</span>\u00a0</td>\n                      </tr>\n                      <tr>\n                        <th>\u00a0</th><th>152</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else{</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>153</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int ret = WirelessScanSplit(sys, &amp;apList, &amp;adHocList, 0);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>154</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (ret != 0 || apList == NULL) {</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>155</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"WirelessScanSplit failed.\");</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>156</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>157</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else{</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>158</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int i;</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>159</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(i=0; i &lt; CFArrayGetCount(apList); i++) {</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>160</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WirelessNetworkInfo *netInfo = (WirelessNetworkInfo *)CFDataGetBytePtr(CFArrayGetValueAtIndex(apList, i));</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>161</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(netInfo == NULL){</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>162</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throwException(env,\"_formatAPMACList failed because netInfo == null\");</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>163</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>164</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else{</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>165</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char *mac = formatAPMAC(netInfo-&gt;macAddress[0],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>166</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netInfo-&gt;macAddress[1],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>167</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netInfo-&gt;macAddress[2],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>168</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netInfo-&gt;macAddress[3],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>169</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netInfo-&gt;macAddress[4],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>170</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; netInfo-&gt;macAddress[5],</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>171</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; getAPSignalStrength(netInfo-&gt;signal));</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>172</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (*env)-&gt;SetObjectArrayElement(env, results, i, (*env)-&gt;NewStringUTF( env, (char*)mac ));</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>173</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; free(mac);</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>174</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>175</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>176</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr>\n                        <th>\u00a0</th><th>177</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                      </tr><tr class=\"last\">\n                        <th>\u00a0</th><th>178</th><td class=\"r\"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(results);</span>\u00a0</td>\n                      </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>191</th><th>179</th><td class=\"l\"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span>\u00a0</td>\n                  </tr><tr>\n                          <th>192</th><th>180</th><td class=\"l\"><span>}</span>\u00a0</td>\n                  </tr><tr>\n                          <th>193</th><th>181</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"rem\">\n                  <tr class=\"first\">\n                          <th>194</th><th>\u00a0</th><td class=\"l\"><del>JNIEXPORT void JNICALL Java_edu_uci_ics_luci_nomatic_service_sensors_MacWifiSensor_nativeShutdown</del>\u00a0</td>\n                  </tr><tr>\n                          <th>195</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; (JNIEnv * env, jobject ob)</del>\u00a0</td>\n                  </tr><tr>\n                          <th>196</th><th>\u00a0</th><td class=\"l\"><del>{</del>\u00a0</td>\n                  </tr><tr>\n                          <th>197</th><th>\u00a0</th><td class=\"l\"><del>&nbsp; &nbsp; &nbsp; &nbsp; WirelessDetach(sys);</del>\u00a0</td>\n                  </tr><tr class=\"last\">\n                          <th>198</th><th>\u00a0</th><td class=\"l\"><del>}</del>\u00a0</td>\n                  </tr>\n            </tbody><tbody class=\"unmod\">\n                  <tr>\n                          <th>199</th><th>182</th><td class=\"l\"><span></span>\u00a0</td>\n                  </tr><tr>\n                          <th>200</th><th>183</th><td class=\"l\"><span>#endif</span>\u00a0</td>\n                  </tr>\n            </tbody>\n        </table>\n      </li>\n  </ul>\n</div>\n        <div id=\"help\"><strong>Note:</strong> See <a href=\"/LUCICodeRepository/nomaticIM/wiki/TracChangeset\">TracChangeset</a>\n          for help on using the changeset viewer.</div>\n      </div>\n    </div>\n    <div id=\"altlinks\">\n      <h3>Download in other formats:</h3>\n      <ul>\n        <li class=\"first\">\n          <a rel=\"nofollow\" href=\"?format=diff&amp;new=1062\" class=\"diff\">Unified Diff</a>\n        </li><li class=\"last\">\n          <a rel=\"nofollow\" href=\"?format=zip&amp;new=1062\" class=\"zip\">Zip Archive</a>\n        </li>\n      </ul>\n    </div>\n    </div>\n    <div id=\"footer\" lang=\"en\" xml:lang=\"en\"><hr />\n      <a id=\"tracpowered\" href=\"http://trac.edgewall.org/\"><img src=\"/LUCICodeRepository/nomaticIM/chrome/common/trac_logo_mini.png\" height=\"30\" width=\"107\" alt=\"Trac Powered\" /></a>\n      <p class=\"left\">Powered by <a href=\"/LUCICodeRepository/nomaticIM/about\"><strong>Trac 1.0.1</strong></a><br />\n        By <a href=\"http://www.edgewall.org/\">Edgewall Software</a>.</p>\n      <p class=\"right\">All content copyright 2007-2008 by LUCI <br /><a href=\"http://luci.ics.uci.edu/\">http://luci.ics.uci.edu/</a></p>\n    </div>\n\t\t<div id=\"sitefooter\">\n\t\t\t<script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\n\t\t\t</script>\n\t\t\t<script type=\"text/javascript\">\n\t\t\t\t_uacct = \"UA-338915-2\";\n\t\t\t\turchinTracker();\n\t\t\t</script>\n\t\t</div>\n\t</body>\n</html>", "id": 48510.0}