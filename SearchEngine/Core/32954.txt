{"text": "View Javadoc 1 Z M I G 2 3 This library is free software you can redistribute it and or 4 modify it under the terms of the GNU Lesser General Public 5 License as published by the Free Software Foundation either 6 version 2 1 of the License or at your option any later version 7 8 This library is distributed in the hope that it will be useful 9 but WITHOUT ANY WARRANTY without even the implied warranty of 1 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE See the GNU 11 Lesser General Public License for more details 12 13 You should have received a copy of the GNU Lesser General Public 14 License along with this library if not write to the Free Software 15 Foundation Inc 59 Temple Place Suite 33 Boston MA 2111 13 7 USA 16 package javax jmdns 17 18 import java io IOException 19 import java util Hashtable 2 21 22 An outgoing DNS message 23 24 author Arthur van Hoff 25 version I G 26 27 final class DNSOutgoing extends DNSConstants 28 29 TODO 3 Hashtable names 31 32 TODO 33 byte data 34 35 TODO 36 boolean multicast 37 38 TODO 39 int flags 4 41 TODO 42 int id 43 44 TODO 45 int len 46 47 TODO 48 int numAdditionals 49 5 TODO 51 int numAnswers 52 53 TODO 54 int numAuthorities 55 56 TODO 57 int numQuestions 58 59 TODO 6 int off 61 62 63 Create an outgoing multicast query or response 64 65 param flags TODO 66 67 DNSOutgoing int flags 68 69 this flags true 7 71 72 73 Create an outgoing query or response 74 75 param flags TODO 76 param multicast TODO 77 78 DNSOutgoing int flags boolean multicast 79 8 this flags flags 81 this multicast multicast 82 names new Hashtable 83 data new byte MAX MSG TYPICAL 84 off 12 85 86 87 88 Add an additional answer to the record Omit if there is no room 89 9 param in TODO 91 param rec TODO 92 93 throws IOException TODO 94 95 void addAdditionalAnswer DNSIncoming in DNSRecord rec throws IOException 96 97 if off MAX MSG TYPICAL 2 rec suppressedBy in 98 99 numAdditionals 1 writeRecord rec 1 1 1 2 1 3 1 4 1 5 Add an answer if it is not suppressed 1 6 1 7 param in TODO 1 8 param rec TODO 1 9 11 throws IOException TODO 111 112 void addAnswer DNSIncoming in DNSRecord rec throws IOException 113 114 if rec suppressedBy in 115 116 addAnswer rec 117 118 119 12 121 Add an answer to the message 122 123 param rec TODO 124 param now TODO 125 126 throws IOException TODO 127 128 void addAnswer DNSRecord rec long now throws IOException 129 13 if rec null 131 132 if now rec isExpired now 133 134 numAnswers 135 writeRecord rec now 136 137 138 139 14 141 Add an authoritive answer to the message 142 143 param rec TODO 144 145 throws IOException TODO 146 147 void addAuthorativeAnswer DNSRecord rec throws IOException 148 149 numAuthorities 15 writeRecord rec 151 152 153 154 Add a question to the message 155 156 param rec TODO 157 158 throws IOException TODO 159 16 void addQuestion DNSQuestion rec throws IOException 161 162 numQuestions 163 writeQuestion rec 164 165 166 167 Finish the message before sending it off 168 169 throws IOException TODO 17 171 void finish throws IOException 172 173 int save off 174 175 off 176 177 writeShort multicast id 178 writeShort flags 179 writeShort numQuestions 18 writeShort numAnswers 181 writeShort numAuthorities 182 writeShort numAdditionals 183 off save 184 185 186 187 TODO 188 189 param value TODO 19 191 throws IOException TODO 192 193 void writeByte int value throws IOException 194 195 if off data length 196 197 throw new IOException buffer full 198 199 2 data off byte value 2 1 2 2 2 3 2 4 TODO 2 5 2 6 param str TODO 2 7 param off TODO 2 8 param len TODO 2 9 21 throws IOException TODO 211 212 void writeBytes String str int off int len throws IOException 213 214 for int i i len i 215 216 writeByte str charAt off i 217 218 219 22 221 TODO 222 223 param data TODO 224 param off TODO 225 param len TODO 226 227 throws IOException TODO 228 229 void writeBytes byte data int off int len throws IOException 23 231 for int i i len i 232 233 writeByte data off i 234 235 236 237 238 TODO 239 24 param value TODO 241 242 throws IOException TODO 243 244 void writeInt int value throws IOException 245 246 writeShort value 16 247 writeShort value 248 249 25 251 TODO 252 253 param name TODO 254 255 throws IOException TODO 256 257 void writeName String name throws IOException 258 259 while true 26 261 int n name indexOf 262 263 if n 264 265 n name length 266 267 268 if n 269 27 writeByte 271 272 return 273 274 275 Integer offset Integer names get name 276 277 if offset null 278 279 int val offset intValue 28 281 writeByte val 8 xC 282 writeByte val 283 284 return 285 286 287 names put name new Integer off 288 writeUTF name n 289 name name substring n 29 291 if name startsWith 292 293 name name substring 1 294 295 296 297 298 299 TODO 3 3 1 param question TODO 3 2 3 3 throws IOException TODO 3 4 3 5 void writeQuestion DNSQuestion question throws IOException 3 6 3 7 writeName question name 3 8 writeShort question type 3 9 writeShort question clazz 31 311 312 313 TODO 314 315 param rec TODO 316 param now TODO 317 318 throws IOException TODO 319 32 void writeRecord DNSRecord rec long now throws IOException 321 322 writeName rec name 323 writeShort rec type 324 writeShort rec clazz rec unique multicast CLASS UNIQUE 325 writeInt now rec ttl rec getRemainingTTL now 326 writeShort 327 328 int start off 329 33 rec write this 331 332 int len off start 333 334 data start 2 byte len 8 335 data start 1 byte len xFF 336 337 338 339 TODO 34 341 param value TODO 342 343 throws IOException TODO 344 345 void writeShort int value throws IOException 346 347 writeByte value 8 348 writeByte value 349 35 351 352 TODO 353 354 param str TODO 355 param off TODO 356 param len TODO 357 358 throws IOException TODO 359 36 void writeUTF String str int off int len throws IOException 361 362 compute utf length 363 int utflen 364 365 for int i i len i 366 367 int ch str charAt off i 368 369 if ch x 1 ch x 7F 37 371 utflen 1 372 373 else if ch x 7FF 374 375 utflen 3 376 377 else 378 379 utflen 2 38 381 382 383 write utf length 384 writeByte utflen 385 386 write utf data 387 for int i i len i 388 389 int ch str charAt off i 39 391 if ch x 1 ch x 7F 392 393 writeByte ch 394 395 else if ch x 7FF 396 397 writeByte xE ch 12 x F 398 writeByte x8 ch 6 x3F 399 writeByte x8 ch x3F 4 4 1 else 4 2 4 3 writeByte xC ch 6 x1F 4 4 writeByte x8 ch x3F 4 5 4 6 4 7 4 8 This page was automatically generated by Maven", "_id": "http://drzaius.ics.uci.edu/~swirl/impromptu-0.20/xref/javax/jmdns/DNSOutgoing.html", "title": "dnsoutgoing xref", "html": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=ISO-8859-1\" /><title>DNSOutgoing xref</title>\n<link type=\"text/css\" rel=\"stylesheet\" href=\"../../stylesheet.css\" />\n</head>\n<body>\n<div id=\"overview\"><a href=\"../../../apidocs/javax/jmdns/DNSOutgoing.html\">View Javadoc</a></div><pre>\n\n<a name=\"1\" href=\"#1\">1</a>   <em class=\"comment\">// %Z%%M%, %I%, %G%</em>\n<a name=\"2\" href=\"#2\">2</a>   <em class=\"comment\">//</em>\n<a name=\"3\" href=\"#3\">3</a>   <em class=\"comment\">// This library is free software; you can redistribute it and/or</em>\n<a name=\"4\" href=\"#4\">4</a>   <em class=\"comment\">// modify it under the terms of the GNU Lesser General Public</em>\n<a name=\"5\" href=\"#5\">5</a>   <em class=\"comment\">// License as published by the Free Software Foundation; either</em>\n<a name=\"6\" href=\"#6\">6</a>   <em class=\"comment\">// version 2.1 of the License, or (at your option) any later version.</em>\n<a name=\"7\" href=\"#7\">7</a>   <em class=\"comment\">// </em>\n<a name=\"8\" href=\"#8\">8</a>   <em class=\"comment\">// This library is distributed in the hope that it will be useful,</em>\n<a name=\"9\" href=\"#9\">9</a>   <em class=\"comment\">// but WITHOUT ANY WARRANTY; without even the implied warranty of</em>\n<a name=\"10\" href=\"#10\">10</a>  <em class=\"comment\">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</em>\n<a name=\"11\" href=\"#11\">11</a>  <em class=\"comment\">// Lesser General Public License for more details.</em>\n<a name=\"12\" href=\"#12\">12</a>  <em class=\"comment\">// </em>\n<a name=\"13\" href=\"#13\">13</a>  <em class=\"comment\">// You should have received a copy of the GNU Lesser General Public</em>\n<a name=\"14\" href=\"#14\">14</a>  <em class=\"comment\">// License along with this library; if not, write to the Free Software</em>\n<a name=\"15\" href=\"#15\">15</a>  <em class=\"comment\">// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</em>\n<a name=\"16\" href=\"#16\">16</a>  <strong>package</strong> <a href=\"../../javax/jmdns/package-summary.html\">javax.jmdns</a>;\n<a name=\"17\" href=\"#17\">17</a>  \n<a name=\"18\" href=\"#18\">18</a>  <strong>import</strong> java.io.IOException;\n<a name=\"19\" href=\"#19\">19</a>  <strong>import</strong> java.util.Hashtable;\n<a name=\"20\" href=\"#20\">20</a>  \n<a name=\"21\" href=\"#21\">21</a>  <em>/**<em>*</em></em>\n<a name=\"22\" href=\"#22\">22</a>  <em> * An outgoing DNS message.</em>\n<a name=\"23\" href=\"#23\">23</a>  <em> *</em>\n<a name=\"24\" href=\"#24\">24</a>  <em> * @author Arthur van Hoff</em>\n<a name=\"25\" href=\"#25\">25</a>  <em> * @version %I%, %G%</em>\n<a name=\"26\" href=\"#26\">26</a>  <em> */</em>\n<a name=\"27\" href=\"#27\">27</a>  <strong>final</strong> <strong>class</strong> <a href=\"../../javax/jmdns/DNSOutgoing.html\">DNSOutgoing</a> <strong>extends</strong> <a href=\"../../javax/jmdns/DNSConstants.html\">DNSConstants</a>\n<a name=\"28\" href=\"#28\">28</a>  {\n<a name=\"29\" href=\"#29\">29</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"30\" href=\"#30\">30</a>      Hashtable names;\n<a name=\"31\" href=\"#31\">31</a>  \n<a name=\"32\" href=\"#32\">32</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"33\" href=\"#33\">33</a>      byte[] data;\n<a name=\"34\" href=\"#34\">34</a>  \n<a name=\"35\" href=\"#35\">35</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"36\" href=\"#36\">36</a>      <strong>boolean</strong> multicast;\n<a name=\"37\" href=\"#37\">37</a>  \n<a name=\"38\" href=\"#38\">38</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"39\" href=\"#39\">39</a>      <strong>int</strong> flags;\n<a name=\"40\" href=\"#40\">40</a>  \n<a name=\"41\" href=\"#41\">41</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"42\" href=\"#42\">42</a>      <strong>int</strong> id;\n<a name=\"43\" href=\"#43\">43</a>  \n<a name=\"44\" href=\"#44\">44</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"45\" href=\"#45\">45</a>      <strong>int</strong> len;\n<a name=\"46\" href=\"#46\">46</a>  \n<a name=\"47\" href=\"#47\">47</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"48\" href=\"#48\">48</a>      <strong>int</strong> numAdditionals;\n<a name=\"49\" href=\"#49\">49</a>  \n<a name=\"50\" href=\"#50\">50</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"51\" href=\"#51\">51</a>      <strong>int</strong> numAnswers;\n<a name=\"52\" href=\"#52\">52</a>  \n<a name=\"53\" href=\"#53\">53</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"54\" href=\"#54\">54</a>      <strong>int</strong> numAuthorities;\n<a name=\"55\" href=\"#55\">55</a>  \n<a name=\"56\" href=\"#56\">56</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"57\" href=\"#57\">57</a>      <strong>int</strong> numQuestions;\n<a name=\"58\" href=\"#58\">58</a>  \n<a name=\"59\" href=\"#59\">59</a>      <em>/**<em>* TODO */</em></em>\n<a name=\"60\" href=\"#60\">60</a>      <strong>int</strong> off;\n<a name=\"61\" href=\"#61\">61</a>  \n<a name=\"62\" href=\"#62\">62</a>      <em>/**<em>*</em></em>\n<a name=\"63\" href=\"#63\">63</a>  <em>     * Create an outgoing multicast query or response.</em>\n<a name=\"64\" href=\"#64\">64</a>  <em>     *</em>\n<a name=\"65\" href=\"#65\">65</a>  <em>     * @param flags TODO</em>\n<a name=\"66\" href=\"#66\">66</a>  <em>     */</em>\n<a name=\"67\" href=\"#67\">67</a>      <a href=\"../../javax/jmdns/DNSOutgoing.html\">DNSOutgoing</a>(<strong>int</strong> flags)\n<a name=\"68\" href=\"#68\">68</a>      {\n<a name=\"69\" href=\"#69\">69</a>          <strong>this</strong>(flags, <strong>true</strong>);\n<a name=\"70\" href=\"#70\">70</a>      }\n<a name=\"71\" href=\"#71\">71</a>  \n<a name=\"72\" href=\"#72\">72</a>      <em>/**<em>*</em></em>\n<a name=\"73\" href=\"#73\">73</a>  <em>     * Create an outgoing query or response.</em>\n<a name=\"74\" href=\"#74\">74</a>  <em>     *</em>\n<a name=\"75\" href=\"#75\">75</a>  <em>     * @param flags TODO</em>\n<a name=\"76\" href=\"#76\">76</a>  <em>     * @param multicast TODO</em>\n<a name=\"77\" href=\"#77\">77</a>  <em>     */</em>\n<a name=\"78\" href=\"#78\">78</a>      <a href=\"../../javax/jmdns/DNSOutgoing.html\">DNSOutgoing</a>(<strong>int</strong> flags, <strong>boolean</strong> multicast)\n<a name=\"79\" href=\"#79\">79</a>      {\n<a name=\"80\" href=\"#80\">80</a>          <strong>this</strong>.flags = flags;\n<a name=\"81\" href=\"#81\">81</a>          <strong>this</strong>.multicast = multicast;\n<a name=\"82\" href=\"#82\">82</a>          names = <strong>new</strong> Hashtable();\n<a name=\"83\" href=\"#83\">83</a>          data = <strong>new</strong> byte[MAX_MSG_TYPICAL];\n<a name=\"84\" href=\"#84\">84</a>          off = 12;\n<a name=\"85\" href=\"#85\">85</a>      }\n<a name=\"86\" href=\"#86\">86</a>  \n<a name=\"87\" href=\"#87\">87</a>      <em>/**<em>*</em></em>\n<a name=\"88\" href=\"#88\">88</a>  <em>     * Add an additional answer to the record. Omit if there is no room.</em>\n<a name=\"89\" href=\"#89\">89</a>  <em>     *</em>\n<a name=\"90\" href=\"#90\">90</a>  <em>     * @param in TODO</em>\n<a name=\"91\" href=\"#91\">91</a>  <em>     * @param rec TODO</em>\n<a name=\"92\" href=\"#92\">92</a>  <em>     *</em>\n<a name=\"93\" href=\"#93\">93</a>  <em>     * @throws IOException TODO</em>\n<a name=\"94\" href=\"#94\">94</a>  <em>     */</em>\n<a name=\"95\" href=\"#95\">95</a>      <strong>void</strong> addAdditionalAnswer(<a href=\"../../javax/jmdns/DNSIncoming.html\">DNSIncoming</a> in, <a href=\"../../javax/jmdns/DNSRecord.html\">DNSRecord</a> rec) throws IOException\n<a name=\"96\" href=\"#96\">96</a>      {\n<a name=\"97\" href=\"#97\">97</a>          <strong>if</strong>((off &lt; (MAX_MSG_TYPICAL - 200)) &amp;&amp; !rec.suppressedBy(in))\n<a name=\"98\" href=\"#98\">98</a>          {\n<a name=\"99\" href=\"#99\">99</a>              numAdditionals++;\n<a name=\"100\" href=\"#100\">100</a>             writeRecord(rec, 0);\n<a name=\"101\" href=\"#101\">101</a>         }\n<a name=\"102\" href=\"#102\">102</a>     }\n<a name=\"103\" href=\"#103\">103</a> \n<a name=\"104\" href=\"#104\">104</a>     <em>/**<em>*</em></em>\n<a name=\"105\" href=\"#105\">105</a> <em>     * Add an answer if it is not suppressed.</em>\n<a name=\"106\" href=\"#106\">106</a> <em>     *</em>\n<a name=\"107\" href=\"#107\">107</a> <em>     * @param in TODO</em>\n<a name=\"108\" href=\"#108\">108</a> <em>     * @param rec TODO</em>\n<a name=\"109\" href=\"#109\">109</a> <em>     *</em>\n<a name=\"110\" href=\"#110\">110</a> <em>     * @throws IOException TODO</em>\n<a name=\"111\" href=\"#111\">111</a> <em>     */</em>\n<a name=\"112\" href=\"#112\">112</a>     <strong>void</strong> addAnswer(<a href=\"../../javax/jmdns/DNSIncoming.html\">DNSIncoming</a> in, <a href=\"../../javax/jmdns/DNSRecord.html\">DNSRecord</a> rec) throws IOException\n<a name=\"113\" href=\"#113\">113</a>     {\n<a name=\"114\" href=\"#114\">114</a>         <strong>if</strong>(!rec.suppressedBy(in))\n<a name=\"115\" href=\"#115\">115</a>         {\n<a name=\"116\" href=\"#116\">116</a>             addAnswer(rec, 0);\n<a name=\"117\" href=\"#117\">117</a>         }\n<a name=\"118\" href=\"#118\">118</a>     }\n<a name=\"119\" href=\"#119\">119</a> \n<a name=\"120\" href=\"#120\">120</a>     <em>/**<em>*</em></em>\n<a name=\"121\" href=\"#121\">121</a> <em>     * Add an answer to the message.</em>\n<a name=\"122\" href=\"#122\">122</a> <em>     *</em>\n<a name=\"123\" href=\"#123\">123</a> <em>     * @param rec TODO</em>\n<a name=\"124\" href=\"#124\">124</a> <em>     * @param now TODO</em>\n<a name=\"125\" href=\"#125\">125</a> <em>     *</em>\n<a name=\"126\" href=\"#126\">126</a> <em>     * @throws IOException TODO</em>\n<a name=\"127\" href=\"#127\">127</a> <em>     */</em>\n<a name=\"128\" href=\"#128\">128</a>     <strong>void</strong> addAnswer(<a href=\"../../javax/jmdns/DNSRecord.html\">DNSRecord</a> rec, <strong>long</strong> now) throws IOException\n<a name=\"129\" href=\"#129\">129</a>     {\n<a name=\"130\" href=\"#130\">130</a>         <strong>if</strong>(rec != <strong>null</strong>)\n<a name=\"131\" href=\"#131\">131</a>         {\n<a name=\"132\" href=\"#132\">132</a>             <strong>if</strong>((now == 0) || !rec.isExpired(now))\n<a name=\"133\" href=\"#133\">133</a>             {\n<a name=\"134\" href=\"#134\">134</a>                 numAnswers++;\n<a name=\"135\" href=\"#135\">135</a>                 writeRecord(rec, now);\n<a name=\"136\" href=\"#136\">136</a>             }\n<a name=\"137\" href=\"#137\">137</a>         }\n<a name=\"138\" href=\"#138\">138</a>     }\n<a name=\"139\" href=\"#139\">139</a> \n<a name=\"140\" href=\"#140\">140</a>     <em>/**<em>*</em></em>\n<a name=\"141\" href=\"#141\">141</a> <em>     * Add an authoritive answer to the message.</em>\n<a name=\"142\" href=\"#142\">142</a> <em>     *</em>\n<a name=\"143\" href=\"#143\">143</a> <em>     * @param rec TODO</em>\n<a name=\"144\" href=\"#144\">144</a> <em>     *</em>\n<a name=\"145\" href=\"#145\">145</a> <em>     * @throws IOException TODO</em>\n<a name=\"146\" href=\"#146\">146</a> <em>     */</em>\n<a name=\"147\" href=\"#147\">147</a>     <strong>void</strong> addAuthorativeAnswer(<a href=\"../../javax/jmdns/DNSRecord.html\">DNSRecord</a> rec) throws IOException\n<a name=\"148\" href=\"#148\">148</a>     {\n<a name=\"149\" href=\"#149\">149</a>         numAuthorities++;\n<a name=\"150\" href=\"#150\">150</a>         writeRecord(rec, 0);\n<a name=\"151\" href=\"#151\">151</a>     }\n<a name=\"152\" href=\"#152\">152</a> \n<a name=\"153\" href=\"#153\">153</a>     <em>/**<em>*</em></em>\n<a name=\"154\" href=\"#154\">154</a> <em>     * Add a question to the message.</em>\n<a name=\"155\" href=\"#155\">155</a> <em>     *</em>\n<a name=\"156\" href=\"#156\">156</a> <em>     * @param rec TODO</em>\n<a name=\"157\" href=\"#157\">157</a> <em>     *</em>\n<a name=\"158\" href=\"#158\">158</a> <em>     * @throws IOException TODO</em>\n<a name=\"159\" href=\"#159\">159</a> <em>     */</em>\n<a name=\"160\" href=\"#160\">160</a>     <strong>void</strong> addQuestion(<a href=\"../../javax/jmdns/DNSQuestion.html\">DNSQuestion</a> rec) throws IOException\n<a name=\"161\" href=\"#161\">161</a>     {\n<a name=\"162\" href=\"#162\">162</a>         numQuestions++;\n<a name=\"163\" href=\"#163\">163</a>         writeQuestion(rec);\n<a name=\"164\" href=\"#164\">164</a>     }\n<a name=\"165\" href=\"#165\">165</a> \n<a name=\"166\" href=\"#166\">166</a>     <em>/**<em>*</em></em>\n<a name=\"167\" href=\"#167\">167</a> <em>     * Finish the message before sending it off.</em>\n<a name=\"168\" href=\"#168\">168</a> <em>     *</em>\n<a name=\"169\" href=\"#169\">169</a> <em>     * @throws IOException TODO</em>\n<a name=\"170\" href=\"#170\">170</a> <em>     */</em>\n<a name=\"171\" href=\"#171\">171</a>     <strong>void</strong> finish() throws IOException\n<a name=\"172\" href=\"#172\">172</a>     {\n<a name=\"173\" href=\"#173\">173</a>         <strong>int</strong> save = off;\n<a name=\"174\" href=\"#174\">174</a> \n<a name=\"175\" href=\"#175\">175</a>         off = 0;\n<a name=\"176\" href=\"#176\">176</a> \n<a name=\"177\" href=\"#177\">177</a>         writeShort(multicast ? 0 : id);\n<a name=\"178\" href=\"#178\">178</a>         writeShort(flags);\n<a name=\"179\" href=\"#179\">179</a>         writeShort(numQuestions);\n<a name=\"180\" href=\"#180\">180</a>         writeShort(numAnswers);\n<a name=\"181\" href=\"#181\">181</a>         writeShort(numAuthorities);\n<a name=\"182\" href=\"#182\">182</a>         writeShort(numAdditionals);\n<a name=\"183\" href=\"#183\">183</a>         off = save;\n<a name=\"184\" href=\"#184\">184</a>     }\n<a name=\"185\" href=\"#185\">185</a> \n<a name=\"186\" href=\"#186\">186</a>     <em>/**<em>*</em></em>\n<a name=\"187\" href=\"#187\">187</a> <em>     * TODO</em>\n<a name=\"188\" href=\"#188\">188</a> <em>     *</em>\n<a name=\"189\" href=\"#189\">189</a> <em>     * @param value TODO</em>\n<a name=\"190\" href=\"#190\">190</a> <em>     *</em>\n<a name=\"191\" href=\"#191\">191</a> <em>     * @throws IOException TODO</em>\n<a name=\"192\" href=\"#192\">192</a> <em>     */</em>\n<a name=\"193\" href=\"#193\">193</a>     <strong>void</strong> writeByte(<strong>int</strong> value) throws IOException\n<a name=\"194\" href=\"#194\">194</a>     {\n<a name=\"195\" href=\"#195\">195</a>         <strong>if</strong>(off >= data.length)\n<a name=\"196\" href=\"#196\">196</a>         {\n<a name=\"197\" href=\"#197\">197</a>             <strong>throw</strong> <strong>new</strong> IOException(<span class=\"string\">\"buffer full\"</span>);\n<a name=\"198\" href=\"#198\">198</a>         }\n<a name=\"199\" href=\"#199\">199</a> \n<a name=\"200\" href=\"#200\">200</a>         data[off++] = (byte)value;\n<a name=\"201\" href=\"#201\">201</a>     }\n<a name=\"202\" href=\"#202\">202</a> \n<a name=\"203\" href=\"#203\">203</a>     <em>/**<em>*</em></em>\n<a name=\"204\" href=\"#204\">204</a> <em>     * TODO</em>\n<a name=\"205\" href=\"#205\">205</a> <em>     *</em>\n<a name=\"206\" href=\"#206\">206</a> <em>     * @param str TODO</em>\n<a name=\"207\" href=\"#207\">207</a> <em>     * @param off TODO</em>\n<a name=\"208\" href=\"#208\">208</a> <em>     * @param len TODO</em>\n<a name=\"209\" href=\"#209\">209</a> <em>     *</em>\n<a name=\"210\" href=\"#210\">210</a> <em>     * @throws IOException TODO</em>\n<a name=\"211\" href=\"#211\">211</a> <em>     */</em>\n<a name=\"212\" href=\"#212\">212</a>     <strong>void</strong> writeBytes(String str, <strong>int</strong> off, <strong>int</strong> len) throws IOException\n<a name=\"213\" href=\"#213\">213</a>     {\n<a name=\"214\" href=\"#214\">214</a>         <strong>for</strong>(<strong>int</strong> i = 0; i &lt; len; i++)\n<a name=\"215\" href=\"#215\">215</a>         {\n<a name=\"216\" href=\"#216\">216</a>             writeByte(str.charAt(off + i));\n<a name=\"217\" href=\"#217\">217</a>         }\n<a name=\"218\" href=\"#218\">218</a>     }\n<a name=\"219\" href=\"#219\">219</a> \n<a name=\"220\" href=\"#220\">220</a>     <em>/**<em>*</em></em>\n<a name=\"221\" href=\"#221\">221</a> <em>     * TODO</em>\n<a name=\"222\" href=\"#222\">222</a> <em>     *</em>\n<a name=\"223\" href=\"#223\">223</a> <em>     * @param data TODO</em>\n<a name=\"224\" href=\"#224\">224</a> <em>     * @param off TODO</em>\n<a name=\"225\" href=\"#225\">225</a> <em>     * @param len TODO</em>\n<a name=\"226\" href=\"#226\">226</a> <em>     *</em>\n<a name=\"227\" href=\"#227\">227</a> <em>     * @throws IOException TODO</em>\n<a name=\"228\" href=\"#228\">228</a> <em>     */</em>\n<a name=\"229\" href=\"#229\">229</a>     <strong>void</strong> writeBytes(byte[] data, <strong>int</strong> off, <strong>int</strong> len) throws IOException\n<a name=\"230\" href=\"#230\">230</a>     {\n<a name=\"231\" href=\"#231\">231</a>         <strong>for</strong>(<strong>int</strong> i = 0; i &lt; len; i++)\n<a name=\"232\" href=\"#232\">232</a>         {\n<a name=\"233\" href=\"#233\">233</a>             writeByte(data[off + i]);\n<a name=\"234\" href=\"#234\">234</a>         }\n<a name=\"235\" href=\"#235\">235</a>     }\n<a name=\"236\" href=\"#236\">236</a> \n<a name=\"237\" href=\"#237\">237</a>     <em>/**<em>*</em></em>\n<a name=\"238\" href=\"#238\">238</a> <em>     * TODO</em>\n<a name=\"239\" href=\"#239\">239</a> <em>     *</em>\n<a name=\"240\" href=\"#240\">240</a> <em>     * @param value TODO</em>\n<a name=\"241\" href=\"#241\">241</a> <em>     *</em>\n<a name=\"242\" href=\"#242\">242</a> <em>     * @throws IOException TODO</em>\n<a name=\"243\" href=\"#243\">243</a> <em>     */</em>\n<a name=\"244\" href=\"#244\">244</a>     <strong>void</strong> writeInt(<strong>int</strong> value) throws IOException\n<a name=\"245\" href=\"#245\">245</a>     {\n<a name=\"246\" href=\"#246\">246</a>         writeShort(value >> 16);\n<a name=\"247\" href=\"#247\">247</a>         writeShort(value);\n<a name=\"248\" href=\"#248\">248</a>     }\n<a name=\"249\" href=\"#249\">249</a> \n<a name=\"250\" href=\"#250\">250</a>     <em>/**<em>*</em></em>\n<a name=\"251\" href=\"#251\">251</a> <em>     * TODO</em>\n<a name=\"252\" href=\"#252\">252</a> <em>     *</em>\n<a name=\"253\" href=\"#253\">253</a> <em>     * @param name TODO</em>\n<a name=\"254\" href=\"#254\">254</a> <em>     *</em>\n<a name=\"255\" href=\"#255\">255</a> <em>     * @throws IOException TODO</em>\n<a name=\"256\" href=\"#256\">256</a> <em>     */</em>\n<a name=\"257\" href=\"#257\">257</a>     <strong>void</strong> writeName(String name) throws IOException\n<a name=\"258\" href=\"#258\">258</a>     {\n<a name=\"259\" href=\"#259\">259</a>         <strong>while</strong>(<strong>true</strong>)\n<a name=\"260\" href=\"#260\">260</a>         {\n<a name=\"261\" href=\"#261\">261</a>             <strong>int</strong> n = name.indexOf('.');\n<a name=\"262\" href=\"#262\">262</a> \n<a name=\"263\" href=\"#263\">263</a>             <strong>if</strong>(n &lt; 0)\n<a name=\"264\" href=\"#264\">264</a>             {\n<a name=\"265\" href=\"#265\">265</a>                 n = name.length();\n<a name=\"266\" href=\"#266\">266</a>             }\n<a name=\"267\" href=\"#267\">267</a> \n<a name=\"268\" href=\"#268\">268</a>             <strong>if</strong>(n &lt;= 0)\n<a name=\"269\" href=\"#269\">269</a>             {\n<a name=\"270\" href=\"#270\">270</a>                 writeByte(0);\n<a name=\"271\" href=\"#271\">271</a> \n<a name=\"272\" href=\"#272\">272</a>                 <strong>return</strong>;\n<a name=\"273\" href=\"#273\">273</a>             }\n<a name=\"274\" href=\"#274\">274</a> \n<a name=\"275\" href=\"#275\">275</a>             Integer offset = (Integer)names.get(name);\n<a name=\"276\" href=\"#276\">276</a> \n<a name=\"277\" href=\"#277\">277</a>             <strong>if</strong>(offset != <strong>null</strong>)\n<a name=\"278\" href=\"#278\">278</a>             {\n<a name=\"279\" href=\"#279\">279</a>                 <strong>int</strong> val = offset.<strong>int</strong>Value();\n<a name=\"280\" href=\"#280\">280</a> \n<a name=\"281\" href=\"#281\">281</a>                 writeByte((val >> 8) | 0xC0);\n<a name=\"282\" href=\"#282\">282</a>                 writeByte(val);\n<a name=\"283\" href=\"#283\">283</a> \n<a name=\"284\" href=\"#284\">284</a>                 <strong>return</strong>;\n<a name=\"285\" href=\"#285\">285</a>             }\n<a name=\"286\" href=\"#286\">286</a> \n<a name=\"287\" href=\"#287\">287</a>             names.put(name, <strong>new</strong> Integer(off));\n<a name=\"288\" href=\"#288\">288</a>             writeUTF(name, 0, n);\n<a name=\"289\" href=\"#289\">289</a>             name = name.substring(n);\n<a name=\"290\" href=\"#290\">290</a> \n<a name=\"291\" href=\"#291\">291</a>             <strong>if</strong>(name.startsWith(<span class=\"string\">\".\"</span>))\n<a name=\"292\" href=\"#292\">292</a>             {\n<a name=\"293\" href=\"#293\">293</a>                 name = name.substring(1);\n<a name=\"294\" href=\"#294\">294</a>             }\n<a name=\"295\" href=\"#295\">295</a>         }\n<a name=\"296\" href=\"#296\">296</a>     }\n<a name=\"297\" href=\"#297\">297</a> \n<a name=\"298\" href=\"#298\">298</a>     <em>/**<em>*</em></em>\n<a name=\"299\" href=\"#299\">299</a> <em>     * TODO</em>\n<a name=\"300\" href=\"#300\">300</a> <em>     *</em>\n<a name=\"301\" href=\"#301\">301</a> <em>     * @param question TODO</em>\n<a name=\"302\" href=\"#302\">302</a> <em>     *</em>\n<a name=\"303\" href=\"#303\">303</a> <em>     * @throws IOException TODO</em>\n<a name=\"304\" href=\"#304\">304</a> <em>     */</em>\n<a name=\"305\" href=\"#305\">305</a>     <strong>void</strong> writeQuestion(<a href=\"../../javax/jmdns/DNSQuestion.html\">DNSQuestion</a> question) throws IOException\n<a name=\"306\" href=\"#306\">306</a>     {\n<a name=\"307\" href=\"#307\">307</a>         writeName(question.name);\n<a name=\"308\" href=\"#308\">308</a>         writeShort(question.type);\n<a name=\"309\" href=\"#309\">309</a>         writeShort(question.clazz);\n<a name=\"310\" href=\"#310\">310</a>     }\n<a name=\"311\" href=\"#311\">311</a> \n<a name=\"312\" href=\"#312\">312</a>     <em>/**<em>*</em></em>\n<a name=\"313\" href=\"#313\">313</a> <em>     * TODO</em>\n<a name=\"314\" href=\"#314\">314</a> <em>     *</em>\n<a name=\"315\" href=\"#315\">315</a> <em>     * @param rec TODO</em>\n<a name=\"316\" href=\"#316\">316</a> <em>     * @param now TODO</em>\n<a name=\"317\" href=\"#317\">317</a> <em>     *</em>\n<a name=\"318\" href=\"#318\">318</a> <em>     * @throws IOException TODO</em>\n<a name=\"319\" href=\"#319\">319</a> <em>     */</em>\n<a name=\"320\" href=\"#320\">320</a>     <strong>void</strong> writeRecord(<a href=\"../../javax/jmdns/DNSRecord.html\">DNSRecord</a> rec, <strong>long</strong> now) throws IOException\n<a name=\"321\" href=\"#321\">321</a>     {\n<a name=\"322\" href=\"#322\">322</a>         writeName(rec.name);\n<a name=\"323\" href=\"#323\">323</a>         writeShort(rec.type);\n<a name=\"324\" href=\"#324\">324</a>         writeShort(rec.clazz | ((rec.unique &amp;&amp; multicast) ? CLASS_UNIQUE : 0));\n<a name=\"325\" href=\"#325\">325</a>         writeInt((now == 0) ? rec.ttl : rec.getRemainingTTL(now));\n<a name=\"326\" href=\"#326\">326</a>         writeShort(0);\n<a name=\"327\" href=\"#327\">327</a> \n<a name=\"328\" href=\"#328\">328</a>         <strong>int</strong> start = off;\n<a name=\"329\" href=\"#329\">329</a> \n<a name=\"330\" href=\"#330\">330</a>         rec.write(<strong>this</strong>);\n<a name=\"331\" href=\"#331\">331</a> \n<a name=\"332\" href=\"#332\">332</a>         <strong>int</strong> len = off - start;\n<a name=\"333\" href=\"#333\">333</a> \n<a name=\"334\" href=\"#334\">334</a>         data[start - 2] = (byte)(len >> 8);\n<a name=\"335\" href=\"#335\">335</a>         data[start - 1] = (byte)(len &amp; 0xFF);\n<a name=\"336\" href=\"#336\">336</a>     }\n<a name=\"337\" href=\"#337\">337</a> \n<a name=\"338\" href=\"#338\">338</a>     <em>/**<em>*</em></em>\n<a name=\"339\" href=\"#339\">339</a> <em>     * TODO</em>\n<a name=\"340\" href=\"#340\">340</a> <em>     *</em>\n<a name=\"341\" href=\"#341\">341</a> <em>     * @param value TODO</em>\n<a name=\"342\" href=\"#342\">342</a> <em>     *</em>\n<a name=\"343\" href=\"#343\">343</a> <em>     * @throws IOException TODO</em>\n<a name=\"344\" href=\"#344\">344</a> <em>     */</em>\n<a name=\"345\" href=\"#345\">345</a>     <strong>void</strong> writeShort(<strong>int</strong> value) throws IOException\n<a name=\"346\" href=\"#346\">346</a>     {\n<a name=\"347\" href=\"#347\">347</a>         writeByte(value >> 8);\n<a name=\"348\" href=\"#348\">348</a>         writeByte(value);\n<a name=\"349\" href=\"#349\">349</a>     }\n<a name=\"350\" href=\"#350\">350</a> \n<a name=\"351\" href=\"#351\">351</a>     <em>/**<em>*</em></em>\n<a name=\"352\" href=\"#352\">352</a> <em>     * TODO</em>\n<a name=\"353\" href=\"#353\">353</a> <em>     *</em>\n<a name=\"354\" href=\"#354\">354</a> <em>     * @param str TODO</em>\n<a name=\"355\" href=\"#355\">355</a> <em>     * @param off TODO</em>\n<a name=\"356\" href=\"#356\">356</a> <em>     * @param len TODO</em>\n<a name=\"357\" href=\"#357\">357</a> <em>     *</em>\n<a name=\"358\" href=\"#358\">358</a> <em>     * @throws IOException TODO</em>\n<a name=\"359\" href=\"#359\">359</a> <em>     */</em>\n<a name=\"360\" href=\"#360\">360</a>     <strong>void</strong> writeUTF(String str, <strong>int</strong> off, <strong>int</strong> len) throws IOException\n<a name=\"361\" href=\"#361\">361</a>     {\n<a name=\"362\" href=\"#362\">362</a>         <em class=\"comment\">// compute utf length</em>\n<a name=\"363\" href=\"#363\">363</a>         <strong>int</strong> utflen = 0;\n<a name=\"364\" href=\"#364\">364</a> \n<a name=\"365\" href=\"#365\">365</a>         <strong>for</strong>(<strong>int</strong> i = 0; i &lt; len; i++)\n<a name=\"366\" href=\"#366\">366</a>         {\n<a name=\"367\" href=\"#367\">367</a>             <strong>int</strong> ch = str.charAt(off + i);\n<a name=\"368\" href=\"#368\">368</a> \n<a name=\"369\" href=\"#369\">369</a>             <strong>if</strong>((ch >= 0x0001) &amp;&amp; (ch &lt;= 0x007F))\n<a name=\"370\" href=\"#370\">370</a>             {\n<a name=\"371\" href=\"#371\">371</a>                 utflen += 1;\n<a name=\"372\" href=\"#372\">372</a>             }\n<a name=\"373\" href=\"#373\">373</a>             <strong>else</strong> <strong>if</strong>(ch > 0x07FF)\n<a name=\"374\" href=\"#374\">374</a>             {\n<a name=\"375\" href=\"#375\">375</a>                 utflen += 3;\n<a name=\"376\" href=\"#376\">376</a>             }\n<a name=\"377\" href=\"#377\">377</a>             <strong>else</strong>\n<a name=\"378\" href=\"#378\">378</a>             {\n<a name=\"379\" href=\"#379\">379</a>                 utflen += 2;\n<a name=\"380\" href=\"#380\">380</a>             }\n<a name=\"381\" href=\"#381\">381</a>         }\n<a name=\"382\" href=\"#382\">382</a> \n<a name=\"383\" href=\"#383\">383</a>         <em class=\"comment\">// write utf length</em>\n<a name=\"384\" href=\"#384\">384</a>         writeByte(utflen);\n<a name=\"385\" href=\"#385\">385</a> \n<a name=\"386\" href=\"#386\">386</a>         <em class=\"comment\">// write utf data</em>\n<a name=\"387\" href=\"#387\">387</a>         <strong>for</strong>(<strong>int</strong> i = 0; i &lt; len; i++)\n<a name=\"388\" href=\"#388\">388</a>         {\n<a name=\"389\" href=\"#389\">389</a>             <strong>int</strong> ch = str.charAt(off + i);\n<a name=\"390\" href=\"#390\">390</a> \n<a name=\"391\" href=\"#391\">391</a>             <strong>if</strong>((ch >= 0x0001) &amp;&amp; (ch &lt;= 0x007F))\n<a name=\"392\" href=\"#392\">392</a>             {\n<a name=\"393\" href=\"#393\">393</a>                 writeByte(ch);\n<a name=\"394\" href=\"#394\">394</a>             }\n<a name=\"395\" href=\"#395\">395</a>             <strong>else</strong> <strong>if</strong>(ch > 0x07FF)\n<a name=\"396\" href=\"#396\">396</a>             {\n<a name=\"397\" href=\"#397\">397</a>                 writeByte(0xE0 | ((ch >> 12) &amp; 0x0F));\n<a name=\"398\" href=\"#398\">398</a>                 writeByte(0x80 | ((ch >> 6) &amp; 0x3F));\n<a name=\"399\" href=\"#399\">399</a>                 writeByte(0x80 | ((ch >> 0) &amp; 0x3F));\n<a name=\"400\" href=\"#400\">400</a>             }\n<a name=\"401\" href=\"#401\">401</a>             <strong>else</strong>\n<a name=\"402\" href=\"#402\">402</a>             {\n<a name=\"403\" href=\"#403\">403</a>                 writeByte(0xC0 | ((ch >> 6) &amp; 0x1F));\n<a name=\"404\" href=\"#404\">404</a>                 writeByte(0x80 | ((ch >> 0) &amp; 0x3F));\n<a name=\"405\" href=\"#405\">405</a>             }\n<a name=\"406\" href=\"#406\">406</a>         }\n<a name=\"407\" href=\"#407\">407</a>     }\n<a name=\"408\" href=\"#408\">408</a> }\n</pre>\n<hr/><div id=\"footer\">This page was automatically generated by <a href=\"http://maven.apache.org/\">Maven</a></div></body>\n</html>\n\n", "id": 32954.0}